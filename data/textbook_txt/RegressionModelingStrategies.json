{"Filename": "RegressionModelingStrategies", "Pages": [{"Page_number": 1, "text": "springer series in statistics\n\nfrank e. harrell, jr.\n\nregression \nmodeling \nstrategies\n\nwith applications to linear models, \nlogistic and ordinal regression, \nand survival analysis\nsecond edition\n\n "}, {"Page_number": 2, "text": "springer series in statistics\n\nadvisors:\np. bickel, p. diggle, s.e. feinberg, u. gather,\ni. olkin, s. zeger\n\nmore information about this series at http://www.springer.com/series/692\n\n "}, {"Page_number": 3, "text": " "}, {"Page_number": 4, "text": "frank e. harrell, jr.\n\nregression modeling\nstrategies\n\nwith applications to linear models,\nlogistic and ordinal regression,\nand survival analysis\n\nsecond edition\n\n123\n\n "}, {"Page_number": 5, "text": "frank e. harrell, jr.\ndepartment of biostatistics\nschool of medicine\nvanderbilt university\nnashville, tn, usa\n\nissn 0172-7397\nspringer series in statistics\nisbn 978-3-319-19424-0\ndoi 10.1007/978-3-319-19425-7\n\nissn 2197-568x (electronic)\n\nisbn 978-3-319-19425-7 (ebook)\n\nlibrary of congress control number: 2015942921\n\nspringer cham heidelberg new york dordrecht london\n\u00a9 springer science+business media new york 2001\n\u00a9 springer international publishing switzerland 2015\nthis work is subject to copyright. all rights are reserved by the publisher, whether the whole or part of\nthe material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation,\nbroadcasting, reproduction on microfilms or in any other physical way, and transmission or information\nstorage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology\nnow known or hereafter developed.\nthe use of general descriptive names, registered names, trademarks, service marks, etc. in this publication\ndoes not imply, even in the absence of a specific statement, that such names are exempt from the relevant\nprotective laws and regulations and therefore free for general use.\nthe publisher, the authors and the editors are safe to assume that the advice and information in this book\nare believed to be true and accurate at the date of publication. neither the publisher nor the authors or\nthe editors give a warranty, express or implied, with respect to the material contained herein or for any\nerrors or omissions that may have been made.\n\nprinted on acid-free paper\n\nspringer international publishing ag switzerland is part of springer science+business media (www.\nspringer.com)\n\n "}, {"Page_number": 6, "text": "to the memories of frank e. harrell, sr.,\nrichard jackson, l. richard smith, john\nburdeshaw, and todd nick, and with\nappreciation to liana and charlotte\nharrell, two high school math teachers:\ncarolyn wailes (n\u00b4ee gaston) and floyd\nchristian, two college professors: david\nhurst (who advised me to choose the field\nof biostatistics) and doug stocks, and my\ngraduate advisor p. k. sen.\n\n "}, {"Page_number": 7, "text": " "}, {"Page_number": 8, "text": "preface\n\nthere are many books that are excellent sources of knowledge about\nindividual statistical tools (survival models, general linear models, etc.), but\nthe art of data analysis is about choosing and using multiple tools. in the\nwords of chatfield [100, p. 420] \u201c. . . students typically know the technical de-\ntails of regression for example, but not necessarily when and how to apply it.\nthis argues the need for a better balance in the literature and in statistical\nteaching between techniques and problem solving strategies.\u201d whether ana-\nlyzing risk factors, adjusting for biases in observational studies, or developing\npredictive models, there are common problems that few regression texts ad-\ndress. for example, there are missing data in the majority of datasets one is\nlikely to encounter (other than those used in textbooks!) but most regression\ntexts do not include methods for dealing with such data effectively, and most\ntexts on missing data do not cover regression modeling.\n\nthis book links standard regression modeling approaches with\n\n\u2022 methods for relaxing linearity assumptions that still allow one to easily\nobtain predictions and confidence limits for future observations, and to do\nformal hypothesis tests,\ninteractions are always linear \u00d7 linear,\n\n\u2022 non-additive modeling approaches not requiring the assumption that\n\n\u2022 methods for imputing missing data and for penalizing variances for incom-\n\nplete data,\n\n\u2022 methods for handling large numbers of predictors without resorting to\n\nproblematic stepwise variable selection techniques,\n\n\u2022 data reduction methods (unsupervised learning methods, some of which\nare based on multivariate psychometric techniques too seldom used in\nstatistics) that help with the problem of \u201ctoo many variables to analyze and\nnot enough observations\u201d as well as making the model more interpretable\nwhen there are predictor variables containing overlapping information,\n\n\u2022 methods for quantifying predictive accuracy of a fitted model,\n\nvii\n\n "}, {"Page_number": 9, "text": "viii\n\npreface\n\n\u2022 powerful model validation techniques based on the bootstrap that allow the\nanalyst to estimate predictive accuracy nearly unbiasedly without holding\nback data from the model development process, and\n\n\u2022 graphical methods for understanding complex models.\n\non the last point, this text has special emphasis on what could be called\n\u201cpresentation graphics for fitted models\u201d to help make regression analyses\nmore palatable to non-statisticians. for example, nomograms have long been\nused to make equations portable, but they are not drawn routinely because\ndoing so is very labor-intensive. an r function called nomogram in the package\ndescribed below draws nomograms from a regression fit, and these diagrams\ncan be used to communicate modeling results as well as to obtain predicted\nvalues manually even in the presence of complex variable transformations.\n\nmost of the methods in this text apply to all regression models, but special\nemphasis is given to some of the most popular ones: multiple regression using\nleast squares and its generalized least squares extension for serial (repeated\nmeasurement) data, the binary logistic model, models for ordinal responses,\nparametric survival regression models, and the cox semiparametric survival\nmodel. there is also a chapter on nonparametric transform-both-sides regres-\nsion. emphasis is given to detailed case studies for these methods as well as\nfor data reduction, imputation, model simplification, and other tasks. ex-\ncept for the case study on survival of titanic passengers, all examples are\nfrom biomedical research. however, the methods presented here have broad\napplication to other areas including economics, epidemiology, sociology, psy-\nchology, engineering, and predicting consumer behavior and other business\noutcomes.\n\nthis text is intended for masters or phd level graduate students who\nhave had a general introductory probability and statistics course and who\nare well versed in ordinary multiple regression and intermediate algebra. the\nbook is also intended to serve as a reference for data analysts and statistical\nmethodologists. readers without a strong background in applied statistics\nmay wish to first study one of the many introductory applied statistics and\nregression texts that are available. the author\u2019s course notes biostatistics\nfor biomedical research on the text\u2019s web site covers basic regression and\nmany other topics. the paper by nick and hardin [476] also provides a good\nintroduction to multivariable modeling and interpretation. there are many\nexcellent intermediate level texts on regression analysis. one of them is by\nfox, which also has a companion software-based text [200, 201]. for readers\ninterested in medical or epidemiologic research, steyerberg\u2019s excellent text\nclinical prediction models [586] is an ideal companion for regression modeling\nstrategies. steyerberg\u2019s book provides further explanations, examples, and\nsimulations of many of the methods presented here. and no text on regression\nmodeling should fail to mention the seminal work of john nelder [450].\n\nthe overall philosophy of this book is summarized by the following state-\n\nments.\n\n "}, {"Page_number": 10, "text": "preface\n\nix\n\n\u2022 satisfaction of model assumptions improves precision and increases statis-\n\ntical power.\n\n\u2022 it is more productive to make a model fit step by step (e.g., transformation\nestimation) than to postulate a simple model and find out what went\nwrong.\n\n\u2022 graphical methods should be married to formal inference.\n\u2022 overfitting occurs frequently, so data reduction and model validation are\n\nimportant.\n\n\u2022 in most research projects, the cost of data collection far outweighs the cost\nof data analysis, so it is important to use the most efficient and accurate\nmodeling techniques, to avoid categorizing continuous variables, and to\nnot remove data from the estimation sample just to be able to validate the\nmodel.\n\n\u2022 the bootstrap is a breakthrough for statistical modeling, and the analyst\nshould use it for many steps of the modeling strategy, including deriva-\ntion of distribution-free confidence intervals and estimation of optimism\nin model fit that takes into account variations caused by the modeling\nstrategy.\n\n\u2022 imputation of missing data is better than discarding incomplete observa-\n\ntions.\n\n\u2022 variance often dominates bias, so biased methods such as penalized max-\nimum likelihood estimation yield models that have a greater chance of\naccurately predicting future observations.\n\n\u2022 software without multiple facilities for assessing and fixing model fit may\n\nonly seem to be user-friendly.\n\n\u2022 carefully fitting an improper model is better than badly fitting (and over-\n\nfitting) a well-chosen one.\n\n\u2022 methods that work for all types of regression models are the most valuable.\n\u2022 using the data to guide the data analysis is almost as dangerous as not\n\ndoing so.\n\n\u2022 there are benefits to modeling by deciding how many degrees of freedom\n(i.e., number of regression parameters) can be \u201cspent,\u201d deciding where they\nshould be spent, and then spending them.\n\non the last point, the author believes that significance tests and p -values\nare problematic, especially when making modeling decisions. judging by the\nincreased emphasis on confidence intervals in scientific journals there is reason\nto believe that hypothesis testing is gradually being de-emphasized. yet the\nreader will notice that this text contains many p -values. how does that make\nsense when, for example, the text recommends against simplifying a model\nwhen a test of linearity is not significant? first, some readers may wish to\nemphasize hypothesis testing in general, and some hypotheses have special\ninterest, such as in pharmacology where one may be interested in whether\nthe effect of a drug is linear in log dose. second, many of the more interesting\nhypothesis tests in the text are tests of complexity (nonlinearity, interaction)\nof the overall model. null hypotheses of linearity of effects in particular are\n\n "}, {"Page_number": 11, "text": "x\n\npreface\n\nfrequently rejected, providing formal evidence that the analyst\u2019s investment\nof time to use more than simple statistical models was warranted.\n\nthe rapid development of bayesian modeling methods and rise in their use\nis exciting. full bayesian modeling greatly reduces the need for the approxi-\nmations made for confidence intervals and distributions of test statistics, and\nbayesian methods formalize the still rather ad hoc frequentist approach to\npenalized maximum likelihood estimation by using skeptical prior distribu-\ntions to obtain well-defined posterior distributions that automatically deal\nwith shrinkage. the bayesian approach also provides a formal mechanism for\nincorporating information external to the data. although bayesian methods\nare beyond the scope of this text, the text is bayesian in spirit by emphasizing\nthe careful use of subject matter expertise while building statistical models.\nthe text emphasizes predictive modeling, but as discussed in chapter 1,\ndeveloping good predictions goes hand in hand with accurate estimation of\neffects and with hypothesis testing (when appropriate). besides emphasis\non multivariable modeling, the text includes a chapter 17 introducing sur-\nvival analysis and methods for analyzing various types of single and multiple\nevents. this book does not provide examples of analyses of one common\ntype of response variable, namely, cost and related measures of resource con-\nsumption. however, least squares modeling presented in chapter 15.1, the\nrobust rank-based methods presented in chapters 13, 15, and 20, and the\ntransform-both-sides regression models discussed in chapter 16 are very ap-\nplicable and robust for modeling economic outcomes. see [167] and [260] for\nexample analyses of such dependent variables using, respectively, the cox\nmodel and nonparametric additive regression. the central web site for this\nbook (see the appendix) has much more material on the use of the cox model\nfor analyzing costs.\n\nthis text does not address some important study design issues that if not\nrespected can doom a predictive modeling or estimation project to failure.\nsee laupacis, sekar, and stiell [378] for a list of some of these issues.\n\nheavy use is made of the s language used by r. r is the focus because\nit is an elegant object-oriented system in which it is easy to implement new\nstatistical ideas. many r users around the world have done so, and their work\nhas benefited many of the procedures described here. r also has a uniform\nsyntax for specifying statistical models (with respect to categorical predictors,\ninteractions, etc.), no matter which type of model is being fitted [96].\n\nthe free, open-source statistical software system r has been adopted by\nanalysts and research statisticians worldwide. its capabilities are growing\nexponentially because of the involvement of an ever-growing community of\nstatisticians who are adding new tools to the base r system through con-\ntributed packages. all of the functions used in this text are available in r.\nsee the book\u2019s web site for updated information about software availability.\nreaders who don\u2019t use r or any other statistical software environment will\nstill find the statistical methods and case studies in this text useful, and it is\nhoped that the code that is presented will make the statistical methods more\n\n "}, {"Page_number": 12, "text": "preface\n\nxi\n\nconcrete. at the very least, the code demonstrates that all of the methods\npresented in the text are feasible.\n\nthis text does not teach analysts how to use r. for that, the reader may\nwish to see reading recommendations on www.r-project.org as well as venables\nand ripley [635] (which is also an excellent companion to this text) and the\nmany other excellent texts on r. see the appendix for more information.\n\nin addition to powerful features that are built into r, this text uses a\npackage of freely available r functions called rms written by the author. rms\ntracks modeling details related to the expanded x or design matrix. it is a\nseries of over 200 functions for model fitting, testing, estimation, validation,\ngraphics, prediction, and typesetting by storing enhanced model design at-\ntributes in the fit. rms includes functions for least squares and penalized least\nsquares multiple regression modeling in addition to functions for binary and\nordinal regression, generalized least squares for analyzing serial data, quan-\ntile regression, and survival analysis that are emphasized in this text. other\nfreely available miscellaneous r functions used in the text are found in the\nhmisc package also written by the author. functions in hmisc include facilities\nfor data reduction, imputation, power and sample size calculation, advanced\ntable making, recoding variables, importing and inspecting data, and general\ngraphics. consult the appendix for information on obtaining hmisc and rms.\nthe author and his colleagues have written sas macros for fitting re-\nstricted cubic splines and for other basic operations. see the appendix for\nmore information. it is unfair not to mention some excellent capabilities of\nother statistical packages such as stata (which has also been extended to\nprovide regression splines and other modeling tools), but the extendability\nand graphics of r makes it especially attractive for all aspects of the compre-\nhensive modeling strategy presented in this book.\n\nportions of chapters 4 and 20 were published as reference [269]. some of\n\nchapter 13 was published as reference [272].\n\nthe author may be contacted by electronic mail at f.harrell@\nvanderbilt.edu and would appreciate being informed of unclear points, er-\nrors, and omissions in this book. suggestions for improvements and for future\ntopics are also welcome. as described in the web site, instructors may con-\ntact the author to obtain copies of quizzes and extra assignments (both with\nanswers) related to much of the material in the earlier chapters, and to obtain\nfull solutions (with graphical output) to the majority of assignments in the\ntext.\n\nmajor changes since the first edition include the following:\n\n1. creation of a now mature r package, rms, that replaces and greatly ex-\n\ntends the design library used in the first edition\n\n2. conversion of all of the book\u2019s code to r\n3. conversion of the book source into knitr [677] reproducible documents\n4. all code from the text is executable and is on the web site\n5. use of color graphics and use of the ggplot2 graphics package [667]\n6. scanned images were re-drawn\n\n "}, {"Page_number": 13, "text": "xii\n\npreface\n\n7. new text about problems with dichotomization of continuous variables\n\nand with classification (as opposed to prediction)\n\n8. expanded material on multiple imputation and predictive mean match-\ning and emphasis on multiple imputation (using the hmisc aregimpute\nfunction) instead of single imputation\n\n9. addition of redundancy analysis\n\n10. added a new section in chapter 5 on bootstrap confidence intervals for\n\nrankings of predictors\n\n11. replacement of the u.s. presidential election data with analyses of a new\n\ndiabetes dataset from nhanes using ordinal and quantile regression\n\n12. more emphasis on semiparametric ordinal regression models for contin-\nuous y , as direct competitors of ordinary multiple regression, with a\ndetailed case study\n\n13. a new chapter on generalized least squares for analysis of serial response\n\ndata\n\n14. the case study in imputation and data reduction was completely reworked\nand now focuses only on data reduction, with the addition of sparse prin-\ncipal components\n\n15. more information about indexes of predictive accuracy\n16. augmentation of the chapter on maximum likelihood to include more\nflexible ways of testing contrasts as well as new methods for obtaining\nsimultaneous confidence intervals\n\n17. binary logistic regression case study 1 was completely re-worked, now\nproviding examples of model selection and model approximation accuracy\n\n18. single imputation was dropped from binary logistic case study 2\n19. the case study in transform-both-sides regression modeling has been re-\nworked using simulated data where true transformations are known, and\na new example of the smearing estimator was added\n\n20. addition of 225 references, most of them published 2001\u20132014\n21. new guidance on minimum sample sizes needed by some of the models\n22. de-emphasis of bootstrap bumping [610] for obtaining simultaneous con-\n\nfidence regions, in favor of a general multiplicity approach [307].\n\nacknowledgments\n\na good deal of the writing of the first edition of this book was done during\nmy 17 years on the faculty of duke university. i wish to thank my close col-\nleague kerry lee for providing many valuable ideas, fruitful collaborations,\nand well-organized lecture notes from which i have greatly benefited over the\npast years. terry therneau of mayo clinic has given me many of his wonderful\nideas for many years, and has written state-of-the-art r software for survival\nanalysis that forms the core of survival analysis software in my rms package.\nmichael symons of the department of biostatistics of the university of north\n\n "}, {"Page_number": 14, "text": "preface\n\nxiii\n\ncarolina at chapel hill and timothy morgan of the division of public health\nsciences at wake forest university school of medicine also provided course\nmaterials, some of which motivated portions of this text. my former clini-\ncal colleagues in the cardiology division at duke university, robert califf,\nphillip harris, mark hlatky, dan mark, david pryor, and robert rosati,\nfor many years provided valuable motivation, feedback, and ideas through\nour interaction on clinical problems. besides kerry lee, statistical colleagues\nl. richard smith, lawrence muhlbaier, and elizabeth delong clarified my\nthinking and gave me new ideas on numerous occasions. charlotte nelson\nand carlos alzola frequently helped me debug s routines when they thought\nthey were just analyzing data.\n\nformer students bercedis peterson, james herndon, robert mcmahon,\nand yuan-li shen have provided many insights into logistic and survival mod-\neling. associations with doug wagner and william knaus of the university\nof virginia, ken offord of mayo clinic, david naftel of the university of al-\nabama in birmingham, phil miller of washington university, and phil good-\nman of the university of nevada reno have provided many valuable ideas and\nmotivations for this work, as have michael schemper of vienna university,\njanez stare of ljubljana university, slovenia, ewout steyerberg of erasmus\nuniversity, rotterdam, karel moons of utrecht university, and drew levy of\ngenentech. richard goldstein, along with several anonymous reviewers, pro-\nvided many helpful criticisms of a previous version of this manuscript that\nresulted in significant improvements, and critical reading by bob edson (va\ncooperative studies program, palo alto) resulted in many error corrections.\nthanks to brian ripley of the university of oxford for providing many help-\nful software tools and statistical insights that greatly aided in the production\nof this book, and to bill venables of csiro australia for wisdom, both sta-\ntistical and otherwise. this work would also not have been possible without\nthe s environment developed by rick becker, john chambers, allan wilks,\nand the r language developed by ross ihaka and robert gentleman.\n\nwork for the second edition was done in the excellent academic environ-\nment of vanderbilt university, where biostatistical and biomedical colleagues\nand graduate students provided new insights and stimulating discussions.\nthanks to nick cox, durham university, uk, who provided from his careful\nreading of the first edition a very large number of improvements and correc-\ntions that were incorporated into the second. four anonymous reviewers of\nthe second edition also made numerous suggestions that improved the text.\n\nnashville, tn, usa\njuly 2015\n\nfrank e. harrell, jr.\n\n "}, {"Page_number": 15, "text": " "}, {"Page_number": 16, "text": "contents\n\ntypographical conventions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxv\n\n1\n\nintroduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1\n1\n1.1 hypothesis testing, estimation, and prediction . . . . . . . . . . .\n3\nexamples of uses of predictive multivariable modeling . . . . .\n1.2\n4\nprediction vs. classification . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.3\n6\nplanning for modeling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n1.4\n8\n1.4.1\nemphasizing continuous variables . . . . . . . . . . . . . . .\nchoice of the model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n8\nfurther reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n1.5\n1.6\n\n2 general aspects of fitting regression models . . . . . . . . . . . . 13\n2.1 notation for multivariable regression models . . . . . . . . . . . . . 13\n2.2 model formulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\ninterpreting model parameters . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n2.3\n2.3.1 nominal predictors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\ninteractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n2.3.2\n2.3.3\nexample: inference for a simple model . . . . . . . . . . . . 17\n2.4 relaxing linearity assumption for continuous predictors . . 18\n2.4.1 avoiding categorization . . . . . . . . . . . . . . . . . . . . . . . . . 18\nsimple nonlinear terms . . . . . . . . . . . . . . . . . . . . . . . . . 21\n2.4.2\nsplines for estimating shape of regression\n2.4.3\nfunction and determining predictor\ntransformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\ncubic spline functions . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n2.4.4\nrestricted cubic splines . . . . . . . . . . . . . . . . . . . . . . . . 24\n2.4.5\n2.4.6\nchoosing number and position of knots . . . . . . . . . . 26\n2.4.7 nonparametric regression . . . . . . . . . . . . . . . . . . . . . . . 28\n2.4.8 advantages of regression splines over\n\nother methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nxv\n\n "}, {"Page_number": 17, "text": "xvi\n\ncontents\n\n2.5 recursive partitioning: tree-based models . . . . . . . . . . . . . . . . 30\n2.6 multiple degree of freedom tests of association . . . . . . . . . . 31\n2.7 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n2.7.1\nregression assumptions . . . . . . . . . . . . . . . . . . . . . . . . . 33\n2.7.2 modeling and testing complex interactions . . . . . . . 36\n2.7.3\nfitting ordinal predictors . . . . . . . . . . . . . . . . . . . . . . . 38\n2.7.4 distributional assumptions . . . . . . . . . . . . . . . . . . . . . . 39\nfurther reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\nproblems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\n2.8\n2.9\n\n3 missing data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\ntypes of missing data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n3.1\n3.2\nprelude to modeling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46\n3.3 missing values for different types of response variables . . . 47\nproblems with simple alternatives to imputation . . . . . . . . . 47\n3.4\nstrategies for developing an imputation model . . . . . . . . . . . . 49\n3.5\n3.6\nsingle conditional mean imputation . . . . . . . . . . . . . . . . . . . . . 52\n3.7\npredictive mean matching . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n3.8 multiple imputation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n3.8.1\n\nthe aregimpute and other chained equations\napproaches . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n3.9 diagnostics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n3.10 summary and rough guidelines . . . . . . . . . . . . . . . . . . . . . . . . . 56\n3.11 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n3.12 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n4 multivariable modeling strategies . . . . . . . . . . . . . . . . . . . . . . . . 63\n\n4.1\n\n4.2\n\nprespecification of predictor complexity without\nlater simplification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64\nchecking assumptions of multiple predictors\nsimultaneously . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n4.3 variable selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n4.4\n\nsample size, overfitting, and limits on number\nof predictors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\nshrinkage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n4.5\n4.6\ncollinearity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n4.7 data reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n4.7.1\nredundancy analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n4.7.2 variable clustering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n4.7.3\n\ntransformation and scaling variables without\nusing y . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\nsimultaneous transformation and imputation . . . . . . 83\n4.7.4\nsimple scoring of variable clusters . . . . . . . . . . . . . . . 85\n4.7.5\n4.7.6\nsimplifying cluster scores . . . . . . . . . . . . . . . . . . . . . . . 87\n4.7.7 how much data reduction is necessary? . . . . . . . . . 87\n\n "}, {"Page_number": 18, "text": "contents\n\nxvii\n\n4.8 other approaches to predictive modeling . . . . . . . . . . . . . . . . 89\n4.9 overly influential observations . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n4.10 comparing two models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n4.11 improving the practice of multivariable prediction . . . . . . . . 94\n4.12 summary: possible modeling strategies . . . . . . . . . . . . . . . . . . 94\n4.12.1 developing predictive models . . . . . . . . . . . . . . . . . . . . 95\n4.12.2 developing models for effect estimation . . . . . . . . . . 98\n4.12.3 developing models for hypothesis testing . . . . . . . . . 99\n4.13 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100\n4.14 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102\n\n5 describing, resampling, validating, and simplifying\n\nthe model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n5.1 describing the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\ninterpreting effects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n5.1.1\n5.1.2\nindexes of model performance . . . . . . . . . . . . . . . . . . . 104\n5.2\nthe bootstrap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106\n5.3 model validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n5.3.1\nintroduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n5.3.2 which quantities should be used in validation? . . . 110\n5.3.3 data-splitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111\n5.3.4\nimprovements on data-splitting: resampling . . . . . . 112\n5.3.5 validation using the bootstrap . . . . . . . . . . . . . . . . . . 114\nbootstrapping ranks of predictors . . . . . . . . . . . . . . . . . . . . . . . 117\nsimplifying the final model by approximating it . . . . . . . . . . 118\n5.5.1 difficulties using full models . . . . . . . . . . . . . . . . . . . . 118\n5.5.2 approximating the full model . . . . . . . . . . . . . . . . . . . 119\nfurther reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121\nproblem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124\n\n5.4\n5.5\n\n5.6\n5.7\n\n6\n\nr software . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127\nthe r modeling language . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128\n6.1\n6.2 user-contributed functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129\n6.3\nthe rms package . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130\n6.4 other functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141\nfurther reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142\n6.5\n\n7 modeling longitudinal responses using generalized\n\nleast squares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n7.1 notation and data setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n7.2 model specification for effects on e(y ) . . . . . . . . . . . . . . . . . . 144\n7.3 modeling within-subject dependence . . . . . . . . . . . . . . . . . . . . 144\n7.4\nparameter estimation procedure . . . . . . . . . . . . . . . . . . . . . . . . 147\ncommon correlation structures . . . . . . . . . . . . . . . . . . . . . . . . . 147\n7.5\n7.6\nchecking model fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148\n\n "}, {"Page_number": 19, "text": "xviii\n\ncontents\n\n7.7\n7.8\n7.9\n\nsample size considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148\nr software . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\ncase study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\n7.9.1 graphical exploration of data . . . . . . . . . . . . . . . . . . . 150\n7.9.2 using generalized least squares . . . . . . . . . . . . . . . . . 151\n7.10 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158\n\n8 case study in data reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n8.1 data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n8.2 how many parameters can be estimated? . . . . . . . . . . . . . . . 164\n8.3 redundancy analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164\n8.4 variable clustering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166\n8.5\ntransformation and single imputation using transcan . . . . . 167\n8.6 data reduction using principal components . . . . . . . . . . . . . 170\n8.6.1\nsparse principal components . . . . . . . . . . . . . . . . . . . . 175\ntransformation using nonparametric smoothers . . . . . . . . . . 176\nfurther reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177\nproblems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178\n\n8.7\n8.8\n8.9\n\n9 overview of maximum likelihood estimation . . . . . . . . . . . . 181\n9.1 general notions\u2014simple cases . . . . . . . . . . . . . . . . . . . . . . . . . 181\n9.2 hypothesis tests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185\n9.2.1\nlikelihood ratio test . . . . . . . . . . . . . . . . . . . . . . . . . . . 185\n9.2.2 wald test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186\n9.2.3\nscore test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186\n9.2.4 normal distribution\u2014one sample . . . . . . . . . . . . . . . 187\n9.3 general case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188\n9.3.1 global test statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . 189\ntesting a subset of the parameters . . . . . . . . . . . . . . . 190\n9.3.2\n9.3.3\ntests based on contrasts . . . . . . . . . . . . . . . . . . . . . . . . 192\n9.3.4 which test statistics to use when . . . . . . . . . . . . . . . 193\n9.3.5\n\nexample: binomial\u2014comparing two\nproportions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194\n9.4\niterative ml estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195\n9.5 robust estimation of the covariance matrix . . . . . . . . . . . . . . 196\n9.6 wald, score, and likelihood-based confidence intervals . . . . 198\n9.6.1\nsimultaneous wald confidence regions . . . . . . . . . . . 199\nbootstrap confidence regions . . . . . . . . . . . . . . . . . . . . . . . . . . . 199\nfurther use of the log likelihood . . . . . . . . . . . . . . . . . . . . . . . 203\nrating two models, penalizing for complexity . . . . . 203\n9.8.1\ntesting whether one model is better\n9.8.2\nthan another . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204\n9.8.3 unitless index of predictive ability . . . . . . . . . . . . . . . 205\n9.8.4 unitless index of adequacy of a subset\n\n9.7\n9.8\n\nof predictors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207\n9.9 weighted maximum likelihood estimation . . . . . . . . . . . . . . . 208\n9.10 penalized maximum likelihood estimation . . . . . . . . . . . . . . . 209\n\n "}, {"Page_number": 20, "text": "contents\n\nxix\n\n9.11 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 213\n9.12 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216\n\n10 binary logistic regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219\n10.1 model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219\n\n10.1.1 model assumptions and interpretation\n\nof parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221\n10.1.2 odds ratio, risk ratio, and risk difference . . . . . . . 224\n10.1.3 detailed example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225\n10.1.4 design formulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230\n10.2 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 231\n10.2.1 maximum likelihood estimates . . . . . . . . . . . . . . . . . . 231\n10.2.2 estimation of odds ratios and probabilities . . . . . . . 232\n10.2.3 minimum sample size requirement . . . . . . . . . . . . . . 233\n10.3 test statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234\n10.4 residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235\n10.5 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236\n10.6 collinearity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 255\n10.7 overly influential observations . . . . . . . . . . . . . . . . . . . . . . . . . . 255\n10.8 quantifying predictive ability . . . . . . . . . . . . . . . . . . . . . . . . . . 256\n10.9 validating the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 259\n10.10 describing the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 264\n10.11 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 269\n10.12 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 271\n10.13 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273\n\n11 binary logistic regression case study 1 . . . . . . . . . . . . . . . . . 275\n11.1 overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275\n11.2 background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275\n11.3 data transformations and single imputation . . . . . . . . . . . . . 276\n11.4 regression on original variables, principal components\n\nand pretransformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 277\n11.5 description of fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278\n11.6 backwards step-down . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 280\n11.7 model approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287\n\n12 logistic model case study 2: survival of titanic\n\npassengers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291\n12.1 descriptive statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291\n12.2 exploring trends with nonparametric regression . . . . . . . . . . 294\n12.3 binary logistic model with casewise deletion\n\nof missing values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296\n12.4 examining missing data patterns . . . . . . . . . . . . . . . . . . . . . . . 302\n12.5 multiple imputation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304\n12.6 summarizing the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . 307\n\n "}, {"Page_number": 21, "text": "xx\n\ncontents\n\n13 ordinal logistic regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 311\n13.1 background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 311\n13.2 ordinality assumption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 312\n13.3 proportional odds model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 313\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 313\n13.3.1 model\n13.3.2 assumptions and interpretation of parameters . . . . . 313\n13.3.3 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 314\n13.3.4 residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 314\n13.3.5 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . 315\n13.3.6 quantifying predictive ability . . . . . . . . . . . . . . . . . . . 318\n13.3.7 describing the fitted model . . . . . . . . . . . . . . . . . . . . . 318\n13.3.8 validating the fitted model . . . . . . . . . . . . . . . . . . . . . 318\n13.3.9 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319\n13.4 continuation ratio model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319\n13.4.1 model\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319\n13.4.2 assumptions and interpretation of parameters . . . . . 320\n13.4.3 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 320\n13.4.4 residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 321\n13.4.5 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . 321\n13.4.6 extended cr model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 321\n13.4.7 role of penalization in extended cr model . . . . . . . 322\n13.4.8 validating the fitted model . . . . . . . . . . . . . . . . . . . . . 322\n13.4.9 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 323\n13.5 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 324\n13.6 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 324\n\n14 case study in ordinal regression, data reduction,\n\nand penalization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 327\n14.1 response variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 328\n14.2 variable clustering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329\n14.3 developing cluster summary scores . . . . . . . . . . . . . . . . . . . . . 330\n14.4 assessing ordinality of y for each x, and unadjusted\n\nchecking of po and cr assumptions . . . . . . . . . . . . . . . . . . . . 333\n. . . . . . . . . . . . . . . 333\n14.5 a tentative full proportional odds model\n14.6 residual plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 336\n14.7 graphical assessment of fit of cr model . . . . . . . . . . . . . . . . 338\n14.8 extended continuation ratio model . . . . . . . . . . . . . . . . . . . . . 340\n14.9 penalized estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 342\n14.10 using approximations to simplify the model\n. . . . . . . . . . . . . 348\n14.11 validating the model\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353\n14.12 summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 355\n14.13 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 356\n14.14 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 357\n\n "}, {"Page_number": 22, "text": "contents\n\nxxi\n\n15 regression models for continuous y and case study\n\nin ordinal regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 359\n15.1 the linear model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 359\n15.2 quantile regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 360\n15.3 ordinal regression models for continuous y . . . . . . . . . . . . . . 361\n15.3.1 minimum sample size requirement . . . . . . . . . . . . . . 363\n15.4 comparison of assumptions of various models . . . . . . . . . . . . 364\n15.5 dataset and descriptive statistics . . . . . . . . . . . . . . . . . . . . . . . 365\n15.5.1 checking assumptions of ols and other models . . . 368\n15.6 ordinal regression applied to hba1c . . . . . . . . . . . . . . . . . . . . 370\n15.6.1 checking fit for various models using age . . . . . . . . 370\n15.6.2 examination of bmi . . . . . . . . . . . . . . . . . . . . . . . . . . . . 374\n15.6.3 consideration of all body size measurements . . . . . . 375\n\n16 transform-both-sides regression . . . . . . . . . . . . . . . . . . . . . . . . . 389\n16.1 background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 389\n16.2 generalized additive models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390\n16.3 nonparametric estimation of y -transformation . . . . . . . . . . . 390\n16.4 obtaining estimates on the original scale . . . . . . . . . . . . . . . . 391\n16.5 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 392\n16.6 case study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 393\n\n17 introduction to survival analysis . . . . . . . . . . . . . . . . . . . . . . . . . 399\n17.1 background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 399\n17.2 censoring, delayed entry, and truncation . . . . . . . . . . . . . . . . 401\n17.3 notation, survival, and hazard functions . . . . . . . . . . . . . . . . 402\n17.4 homogeneous failure time distributions . . . . . . . . . . . . . . . . . 407\n17.5 nonparametric estimation of s and \u03bb . . . . . . . . . . . . . . . . . . . 409\n17.5.1 kaplan\u2013meier estimator . . . . . . . . . . . . . . . . . . . . . . . . 409\n17.5.2 altschuler\u2013nelson estimator . . . . . . . . . . . . . . . . . . . . . 413\n17.6 analysis of multiple endpoints . . . . . . . . . . . . . . . . . . . . . . . . . . 413\n17.6.1 competing risks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414\n17.6.2 competing dependent risks . . . . . . . . . . . . . . . . . . . . . 414\n17.6.3 state transitions and multiple types of nonfatal\n\nevents . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 416\n17.6.4 joint analysis of time and severity of an event . . . . 417\n17.6.5 analysis of multiple events . . . . . . . . . . . . . . . . . . . . . . 417\n17.7 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418\n17.8 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 420\n17.9 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421\n\n18 parametric survival models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 423\n18.1 homogeneous models (no predictors) . . . . . . . . . . . . . . . . . . . . 423\n18.1.1 specific models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 423\n18.1.2 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 424\n18.1.3 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . 426\n\n "}, {"Page_number": 23, "text": "xxii\n\ncontents\n\n18.2 parametric proportional hazards models . . . . . . . . . . . . . . . . . 427\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 427\n\n18.2.1 model\n18.2.2 model assumptions and interpretation\n\nof parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 428\n18.2.3 hazard ratio, risk ratio, and risk difference . . . . . 430\n18.2.4 specific models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 431\n18.2.5 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432\n18.2.6 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . 434\n18.3 accelerated failure time models . . . . . . . . . . . . . . . . . . . . . . . . 436\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 436\n\n18.3.1 model\n18.3.2 model assumptions and interpretation\n\nof parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 436\n18.3.3 specific models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437\n18.3.4 estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 438\n18.3.5 residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440\n18.3.6 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . 440\n18.3.7 validating the fitted model . . . . . . . . . . . . . . . . . . . . . 446\n18.4 buckley\u2013james regression model . . . . . . . . . . . . . . . . . . . . . . . . 447\n18.5 design formulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447\n18.6 test statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447\n18.7 quantifying predictive ability . . . . . . . . . . . . . . . . . . . . . . . . . . 447\n18.8 time-dependent covariates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447\n18.9 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 448\n18.10 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 450\n18.11 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 451\n\n19 case study in parametric survival modeling and model\n\napproximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453\n19.1 descriptive statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453\n19.2 checking adequacy of log-normal accelerated failure\n\ntime model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 458\n19.3 summarizing the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . 466\n19.4 internal validation of the fitted model using\n\nthe bootstrap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 466\n19.5 approximating the full model . . . . . . . . . . . . . . . . . . . . . . . . . . 469\n19.6 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 473\n\n20 cox proportional hazards regression model . . . . . . . . . . . . . 475\n20.1 model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 475\n20.1.1 preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 475\n20.1.2 model definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 476\n20.1.3 estimation of \u03b2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 476\n20.1.4 model assumptions and interpretation\n\nof parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 478\n20.1.5 example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 478\n\n "}, {"Page_number": 24, "text": "contents\n\nxxiii\n\n20.1.6 design formulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 480\n20.1.7 extending the model by stratification . . . . . . . . . . . . 481\n\n20.2 estimation of survival probability and secondary\n\nparameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 483\n20.3 sample size considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 486\n20.4 test statistics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 486\n20.5 residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 487\n20.6 assessment of model fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 487\n20.6.1 regression assumptions . . . . . . . . . . . . . . . . . . . . . . . . . 487\n20.6.2 proportional hazards assumption . . . . . . . . . . . . . . . . 494\n20.7 what to do when ph fails . . . . . . . . . . . . . . . . . . . . . . . . . . . . 501\n20.8 collinearity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 503\n20.9 overly influential observations . . . . . . . . . . . . . . . . . . . . . . . . . . 504\n20.10 quantifying predictive ability . . . . . . . . . . . . . . . . . . . . . . . . . . 504\n20.11 validating the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 506\n20.11.1 validation of model calibration . . . . . . . . . . . . . . . . . . 506\n20.11.2 validation of discrimination and other statistical\n\nindexes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 507\n20.12 describing the fitted model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 509\n20.13 r functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 513\n20.14 further reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 517\n\n21 case study in cox regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . 521\n\n21.1 choosing the number of parameters and fitting\n\nthe model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 521\n21.2 checking proportional hazards . . . . . . . . . . . . . . . . . . . . . . . . . 525\n21.3 testing interactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 527\n21.4 describing predictor effects . . . . . . . . . . . . . . . . . . . . . . . . . . . . 527\n21.5 validating the model\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 529\n21.6 presenting the model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 530\n21.7 problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 531\n\na datasets, r packages, and internet resources . . . . . . . . . . . . . 535\n\nreferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 539\n\nindex . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 571\n\n "}, {"Page_number": 25, "text": " "}, {"Page_number": 26, "text": "typographical conventions\n\nboxed numbers in the margins such as\n1 correspond to numbers at the end\nof chapters in sections named \u201cfurther reading.\u201d bracketed numbers and\nnumeric superscripts in the text refer to the bibliography, while alphabetic\nsuperscripts indicate footnotes.\n\nr language commands and names of r functions and packages are set in\ntypewriter font, as are most variable names.\n\nr code blocks are set off with a shadowbox, and r output that is not directly\nusing latex appears in a box that is framed on three sides.\nin the s language upon which r is based, x \u2190 y is read \u201cx gets the value of\ny.\u201d the assignment operator \u2190, used in the text for aesthetic reasons (as are\n\u2264 and \u2265), is entered by the user as <-. comments begin with #, subscripts\nuse brackets ([ ]), and the missing value is denoted by na (not available).\n\nin ordinary text and mathematical expressions, [logical variable] and [logical\nexpression] imply a value of 1 if the logical variable or expression is true, and\n0 otherwise.\n\nxxv\n\n "}, {"Page_number": 27, "text": "chapter 1\nintroduction\n\n1.1 hypothesis testing, estimation, and prediction\n\nstatistics comprises among other areas study design, hypothesis testing,\nestimation, and prediction. this text aims at the last area, by presenting\nmethods that enable an analyst to develop models that will make accurate\npredictions of responses for future observations. prediction could be consid-\nered a superset of hypothesis testing and estimation, so the methods presented\nhere will also assist the analyst in those areas. it is worth pausing to explain\nhow this is so.\n\nin traditional hypothesis testing one often chooses a null hypothesis de-\nfined as the absence of some effect. for example, in testing whether a vari-\nable such as cholesterol is a risk factor for sudden death, one might test the\nnull hypothesis that an increase in cholesterol does not increase the risk of\ndeath. hypothesis testing can easily be done within the context of a statistical\nmodel, but a model is not required. when one only wishes to assess whether\nan effect is zero, p -values may be computed using permutation or rank (non-\nparametric) tests while making only minimal assumptions. but there are still\nreasons for preferring a model-based approach over techniques that only yield\np -values.\n\n1. permutation and rank tests do not easily give rise to estimates of magni-\n\ntudes of effects.\n\n2. these tests cannot be readily extended to incorporate complexities such\n\nas cluster sampling or repeated measurements within subjects.\n\n3. once the analyst is familiar with a model, that model may be used to carry\nout many different statistical tests; there is no need to learn specific for-\nmulas to handle the special cases. the two-sample t-test is a special case\nof the ordinary multiple regression model having as its sole x variable\na dummy variable indicating group membership. the wilcoxon-mann-\nwhitney test is a special case of the proportional odds ordinal logistic\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 1\n\n1\n\n "}, {"Page_number": 28, "text": "2\n\n1 introduction\n\nmodel.664 the analysis of variance (multiple group) test and the kruskal\u2013\nwallis test can easily be obtained from these two regression models by\nusing more than one dummy predictor variable.\n\neven without complexities such as repeated measurements, problems can\narise when many hypotheses are to be tested. testing too many hypotheses\nis related to fitting too many predictors in a regression model. one commonly\nhears the statement that \u201cthe dataset was too small to allow modeling, so we\njust did hypothesis tests.\u201d it is unlikely that the resulting inferences would be\nreliable. if the sample size is insufficient for modeling it is often insufficient\nfor tests or estimation. this is especially true when one desires to publish\nan estimate of the effect corresponding to the hypothesis yielding the small-\nest p -value. ordinary point estimates are known to be badly biased when\nthe quantity to be estimated was determined by \u201cdata dredging.\u201d this can\nbe remedied by the same kind of shrinkage used in multivariable modeling\n(section 9.10).\n\nstatistical estimation is usually model-based. for example, one might use a\nsurvival regression model to estimate the relative effect of increasing choles-\nterol from 200 to 250 mg/dl on the hazard of death. variables other than\ncholesterol may also be in the regression model, to allow estimation of the\neffect of increasing cholesterol, holding other risk factors constant. but ac-\ncurate estimation of the cholesterol effect will depend on how cholesterol as\nwell as each of the adjustment variables is assumed to relate to the hazard\nof death. if linear relationships are incorrectly assumed, estimates will be\ninaccurate. accurate estimation also depends on avoiding overfitting the ad-\njustment variables. if the dataset contains 200 subjects, 30 of whom died, and\nif one adjusted for 15 \u201cconfounding\u201d variables, the estimates would be \u201cover-\nadjusted\u201d for the effects of the 15 variables, as some of their apparent effects\nwould actually result from spurious associations with the response variable\n(time until death). the overadjustment would reduce the cholesterol effect.\nthe resulting unreliability of estimates equals the degree to which the overall\nmodel fails to validate on an independent sample.\n\nit is often useful to think of effect estimates as differences between two\npredicted values from a model. this way, one can account for nonlinearities\nand interactions. for example, if cholesterol is represented nonlinearly in a\nlogistic regression model, predicted values on the \u201clinear combination of x\u2019s\nscale\u201d are predicted log odds of an event. the increase in log odds from raising\ncholesterol from 200 to 250 mg/dl is the difference in predicted values, where\ncholesterol is set to 250 and then to 200, and all other variables are held\nconstant. the point estimate of the 250:200 mg/dl odds ratio is the anti-log\nof this difference. if cholesterol is represented nonlinearly in the model, it\ndoes not matter how many terms in the model involve cholesterol as long as\nthe overall predicted values are obtained.\n\n "}, {"Page_number": 29, "text": "1.2 examples of uses of predictive multivariable modeling\n\n3\n\nthus when one develops a reasonable multivariable predictive model, hy-\npothesis testing and estimation of effects are byproducts of the fitted model.\nso predictive modeling is often desirable even when prediction is not the main\ngoal.\n\n1.2 examples of uses of predictive multivariable\n\nmodeling\n\nthere is an endless variety of uses for multivariable models. predictive mod-\nels have long been used in business to forecast financial performance and\nto model consumer purchasing and loan pay-back behavior. in ecology, re-\ngression models are used to predict the probability that a fish species will\ndisappear from a lake. survival models have been used to predict product\nlife (e.g., time to burn-out of an mechanical part, time until saturation of a\ndisposable diaper). models are commonly used in discrimination litigation in\nan attempt to determine whether race or sex is used as the basis for hiring\nor promotion, after taking other personnel characteristics into account.\n\nmultivariable models are used extensively in medicine, epidemiology, bio-\nstatistics, health services research, pharmaceutical research, and related\nfields. the author has worked primarily in these fields, so most of the ex-\namples in this text come from those areas. in medicine, two of the major\nareas of application are diagnosis and prognosis. there models are used to\npredict the probability that a certain type of patient will be shown to have a\nspecific disease, or to predict the time course of an already diagnosed disease.\nin observational studies in which one desires to compare patient outcomes\nbetween two or more treatments, multivariable modeling is very important\nbecause of the biases caused by nonrandom treatment assignment. here the\nsimultaneous effects of several uncontrolled variables must be controlled (held\nconstant mathematically if using a regression model) so that the effect of the\nfactor of interest can be more purely estimated. a newer technique for more\naggressively adjusting for nonrandom treatment assignment, the propensity\nscore,116, 530 provides yet another opportunity for multivariable modeling (see\nsection 10.1.4). the propensity score is merely the predicted value from a\nmultivariable model where the response variable is the exposure or the treat-\nment actually used. the estimated propensity score is then used in a second\nstep as an adjustment variable in the model for the response of interest.\n\nit is not widely recognized that multivariable modeling is extremely valu-\nable even in well-designed randomized experiments. such studies are often\ndesigned to make relative comparisons of two or more treatments, using odds\nratios, hazard ratios, and other measures of relative effects. but to be able\nto estimate absolute effects one must develop a multivariable model of the\nresponse variable. this model can predict, for example, the probability that a\npatient on treatment a with characteristics x will survive five years, or it can\n\n "}, {"Page_number": 30, "text": "4\n\n1 introduction\n\npredict the life expectancy for this patient. by making the same prediction\nfor a patient on treatment b with the same characteristics, one can estimate\nthe absolute difference in probabilities or life expectancies. this approach\nrecognizes that low-risk patients must have less absolute benefit of treatment\n(lower change in outcome probability) than high-risk patients,351 a fact that\nhas been ignored in many clinical trials. another reason for multivariable\nmodeling in randomized clinical trials is that when the basic response model\nis nonlinear (e.g., logistic, cox, parametric survival models), the unadjusted\nestimate of the treatment effect is not correct if there is moderate heterogene-\nity of subjects, even with perfect balance of baseline characteristics across\nthe treatment groups.a9, 24, 198, 588 so even when investigators are interested\nin simple comparisons of two groups\u2019 responses, multivariable modeling can\nbe advantageous and sometimes mandatory.\n\ncost-effectiveness analysis is becoming increasingly used in health care re-\nsearch, and the \u201ceffectiveness\u201d (denominator of the cost-effectiveness ratio)\nis always a measure of absolute effectiveness. as absolute effectiveness varies\ndramatically with the risk profiles of subjects, it must be estimated for indi-\nvidual subjects using a multivariable model90, 344.\n\n1.3 prediction vs. classification\n\nfor problems ranging from bioinformatics to marketing, many analysts desire\nto develop \u201cclassifiers\u201d instead of developing predictive models. consider an\noptimum case for classifier development, in which the response variable is\nbinary, the two levels represent a sharp dichotomy with no gray zone (e.g.,\ncomplete success vs. total failure with no possibility of a partial success), the\nuser of the classifier is forced to make one of the two choices, the cost of\nmisclassification is the same for every future observation, and the ratio of the\ncost of a false positive to that of a false negative equals the (often hidden)\nratio implied by the analyst\u2019s classification rule. even if all of those condi-\ntions are met, classification is still inferior to probability modeling for driving\nthe development of a predictive instrument or for estimation or hypothesis\ntesting. it is far better to use the full information in the data to develop a\nprobability model, then develop classification rules on the basis of estimated\nprobabilities. at the least, this forces the analyst to use a proper accuracy\nscore219 in finding or weighting data features.\n\nwhen the dependent variable is ordinal or continuous, classification through\nforced up-front dichotomization in an attempt to simplify the problem results\nin arbitrariness and major information loss even when the optimum cut point\na for example, unadjusted odds ratios from 2 \u00d7 2 tables are different from adjusted\nodds ratios when there is variation in subjects\u2019 risk factors within each treatment\ngroup, even when the distribution of the risk factors is identical between the two\ngroups.\n\n "}, {"Page_number": 31, "text": "1.3 prediction vs. classification\n\n5\n\n(the median) is used. dichtomizing the outcome at a different point may re-\nquire a many-fold increase in sample size to make up for the lost informa-\ntion187. in the area of medical diagnosis, it is often the case that the disease\nis really on a continuum, and predicting the severity of disease (rather than\njust its presence or absence) will greatly increase power and precision, not to\nmention making the result less arbitrary.\n\nit is important to note that two-group classification represents an artificial\nforced choice. it is not often the case that the user of the classifier needs to\nbe limited to two possible actions. the best option for many subjects may\nbe to refuse to make a decision or to obtain more data (e.g., order another\nmedical diagnostic test). a gray zone can be helpful, and predictions include\ngray zones automatically.\n\nunlike prediction (e.g., of absolute risk), classification implicitly uses util-\nity functions (also called loss or cost functions, e.g., cost of a false positive\nclassification). implicit utility functions are highly problematic. first, it is\nwell known that the utility function depends on variables that are not pre-\ndictive of outcome and are not collected (e.g., subjects\u2019 preferences) that\nare available only at the decision point. second, the approach assumes every\nsubject has the same utility functionb. third, the analyst presumptuously\nassumes that the subject\u2019s utility coincides with his own.\n\nformal decision analysis uses subject-specific utilities and optimum predic-\ntions based on all available data62, 74, 183, 210, 219, 642c. it follows that receiver\n\nb simple examples to the contrary are the less weight given to a false negative diagno-\nsis of cancer in the elderly and the aversion of some subjects to surgery or chemother-\napy.\nc to make an optimal decision you need to know all relevant data about an individual\n(used to estimate the probability of an outcome), and the utility (cost, loss function)\nof making each decision. sensitivity and specificity do not provide this information.\nfor example, if one estimated that the probability of a disease given age, sex, and\nsymptoms is 0.1 and the \u201ccost\u201dof a false positive equaled the \u201ccost\u201d of a false negative,\none would act as if the person does not have the disease. given other utilities, one\nwould make different decisions. if the utilities are unknown, one gives the best estimate\nof the probability of the outcome to the decision maker and let her incorporate her\nown unspoken utilities in making an optimum decision for her.\n\nbesides the fact that cutoffs that are not individualized do not apply to individuals,\nonly to groups, individual decision making does not utilize sensitivity and specificity.\nfor an individual we can compute prob(y = 1|x = x); we don\u2019t care about prob(y =\n1|x > c), and an individual having x = x would be quite puzzled if she were given\nprob(x > c|future unknown y) when she already knows x = x so x is no longer a\nrandom variable.\n\neven when group decision making is needed, sensitivity and specificity can be\nbypassed. for mass marketing, for example, one can rank order individuals by the\nestimated probability of buying the product, to create a lift curve. this is then used\nto target the k most likely buyers where k is chosen to meet total program cost\nconstraints.\n\n "}, {"Page_number": 32, "text": "1\n\n6\n\n1 introduction\n\noperating characteristic curve (rocd) analysis is misleading except for the\nspecial case of mass one-time group decision making with unknown utilities\n(e.g., launching a flu vaccination program).\n\nan analyst\u2019s goal should be the development of the most accurate and\nreliable predictive model or the best model on which to base estimation or\nhypothesis testing. in the vast majority of cases, classification is the task of\nthe user of the predictive model, at the point in which utilities (costs) and\npreferences are known.\n\n1.4 planning for modeling\n\nwhen undertaking the development of a model to predict a response, one\nof the first questions the researcher must ask is \u201cwill this model actually be\nused?\u201d many models are never used, for several reasons522 including: (1) it\nwas not deemed relevant to make predictions in the setting envisioned by\nthe authors; (2) potential users of the model did not trust the relationships,\nweights, or variables used to make the predictions; and (3) the variables\nnecessary to make the predictions were not routinely available.\n\nonce the researcher convinces herself that a predictive model is worth\ndeveloping, there are many study design issues to be addressed.18, 378 models\nare often developed using a \u201cconvenience sample,\u201d that is, a dataset that was\nnot collected with such predictions in mind. the resulting models are often\nfraught with difficulties such as the following.\n\n1. the most important predictor or response variables may not have been\ncollected, tempting the researchers to make do with variables that do not\ncapture the real underlying processes.\n\n2. the subjects appearing in the dataset are ill-defined, or they are not repre-\nsentative of the population for which inferences are to be drawn; similarly,\nthe data collection sites may not represent the kind of variation in the\npopulation of sites.\n\n3. key variables are missing in large numbers of subjects.\n4. data are not missing at random; for example, data may not have been\ncollected on subjects who dropped out of a study early, or on patients who\nwere too sick to be interviewed.\n\n5. operational definitions of some of the key variables were never made.\n6. observer variability studies may not have been done, so that the relia-\nbility of measurements is unknown, or there are other kinds of important\nmeasurement errors.\n\na predictive model will be more accurate, as well as useful, when data col-\nlection is planned prospectively. that way one can design data collection\n\nd the roc curve is a plot of sensitivity vs. one minus specificity as one varies a\ncutoff on a continuous predictor used to make a decision.\n\n "}, {"Page_number": 33, "text": "1.4 planning for modeling\n\n7\n\ninstruments containing the necessary variables, and all terms can be given\nstandard definitions (for both descriptive and response variables) for use at\nall data collection sites. also, steps can be taken to minimize the amount of\nmissing data.\n\nin the context of describing and modeling health outcomes, iezzoni317 has\nan excellent discussion of the dimensions of risk that should be captured by\nvariables included in the model. she lists these general areas that should be\nquantified by predictor variables:\n\n1. age,\n2. sex,\n3. acute clinical stability,\n4. principal diagnosis,\n5. severity of principal diagnosis,\n6. extent and severity of comorbidities,\n7. physical functional status,\n8. psychological, cognitive, and psychosocial functioning,\n9. cultural, ethnic, and socioeconomic attributes and behaviors,\n\n10. health status and quality of life, and\n11. patient attitudes and preferences for outcomes.\n\nsome baseline covariates to be sure to capture in general include\n\n1. a baseline measurement of the response variable,\n2. the subject\u2019s most recent status,\n3. the subject\u2019s trajectory as of time zero or past levels of a key variable,\n4. variables explaining much of the variation in the response, and\n5. more subtle predictors whose distributions strongly differ between the\n\nlevels of a key variable of interest in an observational study.\n\nmany things can go wrong in statistical modeling, including the following.\n\n1. the process generating the data is not stable.\n2. the model is misspecified with regard to nonlinearities or interactions, or\n\nthere are predictors missing.\n\n3. the model is misspecified in terms of the transformation of the response\n\nvariable or the model\u2019s distributional assumptions.\n\n4. the model contains discontinuities (e.g., by categorizing continuous predic-\ntors or fitting regression shapes with sudden changes) that can be gamed\nby users.\n\n5. correlations among subjects are not specified, or the correlation structure\nis misspecified, resulting in inefficient parameter estimates and overconfi-\ndent inference.\n\n6. the model is overfitted, resulting in predictions that are too extreme or\n\npositive associations that are false.\n\n "}, {"Page_number": 34, "text": "8\n\n1 introduction\n\n7. the user of the model relies on predictions obtained by extrapolating to\ncombinations of predictor values well outside the range of the dataset used\nto develop the model.\n\n8. accurate and discriminating predictions can lead to behavior changes that\n\nmake future predictions inaccurate.\n\n1.4.1 emphasizing continuous variables\n\nwhen designing the data collection it is important to emphasize the use of\ncontinuous variables over categorical ones. some categorical variables are sub-\njective and hard to standardize, and on the average they do not contain the\nsame amount of statistical information as continuous variables. above all, it\nis unwise to categorize naturally continuous variables during data collection,e\nas the original values can then not be recovered, and if another researcher\nfeels that the (arbitrary) cutoff values were incorrect, other cutoffs cannot\nbe substituted. many researchers make the mistake of assuming that catego-\nrizing a continuous variable will result in less measurement error. this is a\nfalse assumption, for if a subject is placed in the wrong interval this will be\nas much as a 100% error. thus the magnitude of the error multiplied by the\nprobability of an error is no better with categorization.\n\n1.5 choice of the model\n\nthe actual method by which an underlying statistical model should be chosen\nby the analyst is not well developed. a. p. dawid is quoted in lehmann397\nas saying the following.\n\nwhere do probability models come from? to judge by the resounding silence\nover this question on the part of most statisticians, it seems highly embarrass-\ning. in general, the theoretician is happy to accept that his abstract probability\ntriple (\u03c9, a, p ) was found under a gooseberry bush, while the applied statisti-\ncian\u2019s model \u201cjust growed\u201d.\n\nin biostatistics, epidemiology, economics, psychology, sociology, and many\nother fields it is seldom the case that subject matter knowledge exists that\nwould allow the analyst to pre-specify a model (e.g., weibull or log-normal\nsurvival model), a transformation for the response variable, and a structure\n\ne an exception may be sensitive variables such as income level. subjects may be more\nwilling to check a box corresponding to a wide interval containing their income. it\nis unlikely that a reduction in the probability that a subject will inflate her income\nwill offset the loss of precision due to categorization of income, but there will be a\ndecrease in the number of refusals. this reduction in missing data can more than\noffset the lack of precision.\n\n2\n\n3\n\n "}, {"Page_number": 35, "text": "1.5 choice of the model\n\n9\n\nfor how predictors appear in the model (e.g., transformations, addition of\nnonlinear terms, interaction terms). indeed, some authors question whether\nthe notion of a true model even exists in many cases.100 we are for bet-\nter or worse forced to develop models empirically in the majority of cases.\nfortunately, careful and objective validation of the accuracy of model pre-\ndictions against observable responses can lend credence to a model, if a good\nvalidation is not merely the result of overfitting (see section 5.3).\n\nthere are a few general guidelines that can help in choosing the basic form\n\nof the statistical model.\n\n1. the model must use the data efficiently. if, for example, one were inter-\nested in predicting the probability that a patient with a specific set of\ncharacteristics would live five years from diagnosis, an inefficient model\nwould be a binary logistic model. a more efficient method, and one that\nwould also allow for losses to follow-up before five years, would be a semi-\nparametric (rank based) or parametric survival model. such a model uses\nindividual times of events in estimating coefficients, but it can easily be\nused to estimate the probability of surviving five years. as another exam-\nple, if one were interested in predicting patients\u2019 quality of life on a scale\nof excellent, very good, good, fair, and poor, a polytomous (multinomial)\ncategorical response model would not be efficient as it would not make use\nof the ordering of responses.\n\n2. choose a model that fits overall structures likely to be present in the\ndata. in modeling survival time in chronic disease one might feel that the\nimportance of most of the risk factors is constant over time. in that case,\na proportional hazards model such as the cox or weibull model would\nbe a good initial choice. if on the other hand one were studying acutely\nill patients whose risk factors wane in importance as the patients survive\nlonger, a model such as the log-normal or log-logistic regression model\nwould be more appropriate.\n\n3. choose a model that is robust to problems in the data that are difficult to\ncheck. for example, the cox proportional hazards model and ordinal logis-\ntic models are not affected by monotonic transformations of the response\nvariable.\n\n4. choose a model whose mathematical form is appropriate for the response\nbeing modeled. this often has to do with minimizing the need for in-\nteraction terms that are included only to address a basic lack of fit. for\nexample, many researchers have used ordinary linear regression models\nfor binary responses, because of their simplicity. but such models allow\npredicted probabilities to be outside the interval [0, 1], and strange in-\nteractions among the predictor variables are needed to make predictions\nremain in the legal range.\n\n5. choose a model that is readily extendible. the cox model, by its use of\nstratification, easily allows a few of the predictors, especially if they are\ncategorical, to violate the assumption of equal regression coefficients over\n\n "}, {"Page_number": 36, "text": "10\n\n1 introduction\n\ntime (proportional hazards assumption). the continuation ratio ordinal\nlogistic model can also be generalized easily to allow for varying coefficients\nof some of the predictors as one proceeds across categories of the response.\n\nr. a. fisher as quoted in lehmann397 had these suggestions about model\nbuilding: \u201c(a) we must confine ourselves to those forms which we know how\nto handle,\u201d and (b) \u201cmore or less elaborate forms will be suitable according\nto the volume of the data.\u201d ameen [100, p. 453] stated that a good model is\n\u201c(a) satisfactory in performance relative to the stated objective, (b) logically\nsound, (c) representative, (d) questionable and subject to on-line interroga-\ntion, (e) able to accommodate external or expert information and (f) able to\nconvey information.\u201d\n\nit is very typical to use the data to make decisions about the form of\nthe model as well as about how predictors are represented in the model.\nthen, once a model is developed, the entire modeling process is routinely\nforgotten, and statistical quantities such as standard errors, confidence limits,\np -values, and r2 are computed as if the resulting model were entirely pre-\nspecified. however, faraway,186 draper,163 chatfield,100 buckland et al.80\nand others have written about the severe problems that result from treating\nan empirically derived model as if it were pre-specified and as if it were the\ncorrect model. as chatfield states [100, p. 426]:\u201cit is indeed strange that we\noften admit model uncertainty by searching for a best model but then ignore\nthis uncertainty by making inferences and predictions as if certain that the\nbest fitting model is actually true.\u201d\n\nstepwise variable selection is one of the most widely used and abused of\nall data analysis techniques. much is said about this technique later (see sec-\ntion 4.3), but there are many other elements of model development that will\nneed to be accounted for when making statistical inferences, and unfortu-\nnately it is difficult to derive quantities such as confidence limits that are\nproperly adjusted for uncertainties such as the data-based choice between a\nweibull and a log-normal regression model.\n\nye678 developed a general method for estimating the \u201cgeneralized degrees\nof freedom\u201d (gdf) for any \u201cdata mining\u201d or model selection procedure based\non least squares. the gdf is an extremely useful index of the amount of\n\u201cdata dredging\u201d or overfitting that has been done in a modeling process.\nit is also useful for estimating the residual variance with less bias. in one\nexample, ye developed a regression tree using recursive partitioning involving\n10 candidate predictor variables on 100 observations. the resulting tree had\n19 nodes and gdf of 76. the usual way of estimating the residual variance\ninvolves dividing the pooled within-node sum of squares by 100 \u2212 19, but ye\nshowed that dividing by 100 \u2212 76 instead yielded a much less biased (and\nmuch higher) estimate of \u03c32. in another example, ye considered stepwise\nvariable selection using 20 candidate predictors and 22 observations. when\nthere is no true association between any of the predictors and the response,\nye found that gdf = 14.1 for a strategy that selected the best five-variable\nmodel.\n\n4\n\n5\n\n "}, {"Page_number": 37, "text": "1.6 further reading\n\n11\n\ngiven that the choice of the model has been made (e.g., a log-normal\nmodel), penalized maximum likelihood estimation has major advantages in\nthe battle between making the model fit adequately and avoiding overfitting\n(sections 9.10 and 13.4.7). penalization lessens the need for model selection.\n\n1.6 further reading\n\n1\n\nbriggs and zaretzki74 eloquently state the problem with roc curves and the\nareas under them (auc):\n\nstatistics such as the auc are not especially relevant to someone who\nmust make a decision about a particular xc. . . . roc curves lack or ob-\nscure several quantities that are necessary for evaluating the operational\neffectiveness of diagnostic tests. . . . roc curves were first used to check\nhow radio receivers (like radar receivers) operated over a range of fre-\nquencies. . . . this is not how must roc curves are used now, particularly\nin medicine. the receiver of a diagnostic measurement . . . wants to make\na decision based on some xc, and is not especially interested in how well\nhe would have done had he used some different cutoff.\n\nin the discussion to their paper, david hand states\n\nwhen integrating to yield the overall auc measure, it is necessary to\ndecide what weight to give each value in the integration. the auc im-\nplicitly does this using a weighting derived empirically from the data.\nthis is nonsensical. the relative importance of misclassifying a case as\na noncase, compared to the reverse, cannot come from the data itself. it\nmust come externally, from considerations of the severity one attaches to\nthe different kinds of misclassifications.\n\n2\n\n3\n\n4\n\n5\n\nauc, only because it equals the concordance probability in the binary y case,\nis still often useful as a predictive discrimination measure.\nmore severe problems caused by dichotomizing continuous variables are dis-\ncussed in [13, 17, 45, 82, 185, 294, 379, 521, 597].\nsee the excellent editorial by mallows434 for more about model choice. see\nbreiman and discussants67 for an interesting debate about the use of data\nmodels vs. algorithms. this material also covers interpretability vs. predictive\naccuracy and several other topics.\nsee [15, 80, 100, 163, 186, 415] for information about accounting for model selec-\ntion in making final inferences. faraway186 demonstrated that the bootstrap\nhas good potential in related although somewhat simpler settings, and buck-\nland et al.80 developed a promising bootstrap weighting method for accounting\nfor model uncertainty.\ntibshirani and knight611 developed another approach to estimating the gener-\nalized degrees of freedom. luo et al.430 developed a way to add noise of known\nvariance to the response variable to tune the stopping rule used for variable\nselection. zou et al.689 showed that the lasso, an approach that simultaneously\nselects variables and shrinks coefficients, has a nice property. since it uses pe-\nnalization (shrinkage), an unbiased estimate of its effective number of degrees\nof freedom is the number of nonzero regression coefficients in the final model.\n\n "}, {"Page_number": 38, "text": "chapter 2\ngeneral aspects of fitting\nregression models\n\n2.1 notation for multivariable regression models\n\nthe ordinary multiple linear regression model is frequently used and has\nparameters that are easily interpreted. in this chapter we study a general\nclass of regression models, those stated in terms of a weighted sum of a set\nof independent or predictor variables. it is shown that after linearizing the\nmodel with respect to the predictor variables, the parameters in such re-\ngression models are also readily interpreted. also, all the designs used in\nordinary linear regression can be used in this general setting. these designs\ninclude analysis of variance (anova) setups, interaction effects, and nonlin-\near effects. besides describing and interpreting general regression models, this\nchapter also describes, in general terms, how the three types of assumptions\nof regression models can be examined.\n\nfirst we introduce notation for regression models. let y denote the re-\nsponse (dependent) variable, and let x = x1, x2, . . . , xp denote a list or\nvector of predictor variables (also called covariables or independent, descrip-\ntor, or concomitant variables). these predictor variables are assumed to be\nconstants for a given individual or subject from the population of interest.\nlet \u03b2 = \u03b20, \u03b21, . . . , \u03b2p denote the list of regression coefficients (parameters).\n\u03b20 is an optional intercept parameter, and \u03b21, . . . , \u03b2p are weights or regression\ncoefficients corresponding to x1, . . . , xp. we use matrix or vector notation\nto describe a weighted sum of the xs:\n\nx\u03b2 = \u03b20 + \u03b21x1 + . . . + \u03b2pxp,\n\n(2.1)\n\nwhere there is an implied x0 = 1.\na regression model is stated in terms of a connection between the predic-\ntors x and the response y . let c(y |x) denote a property of the distribution\nof y given x (as a function of x). for example, c(y |x) could be e(y |x),\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 2\n\n13\n\n "}, {"Page_number": 39, "text": "14\n\n2 general aspects of fitting regression models\n\nthe expected value or average of y given x, or c(y |x) could be the proba-\nbility that y = 1 given x (where y = 0 or 1).\n\n2.2 model formulations\n\nwe define a regression function as a function that describes interesting prop-\nerties of y that may vary across individuals in the population. x describes the\nlist of factors determining these properties. stated mathematically, a general\nregression model is given by\n\nc(y |x) = g(x).\n\n(2.2)\n\nwe restrict our attention to models that, after a certain transformation, are\nlinear in the unknown parameters, that is, models that involve x only through\na weighted sum of all the xs. the general linear regression model is given by\n\nc(y |x) = g(x\u03b2).\n\nfor example, the ordinary linear regression model is\nc(y |x) = e(y |x) = x\u03b2,\n\n(2.3)\n\n(2.4)\n\nand given x, y has a normal distribution with mean x\u03b2 and constant vari-\nance \u03c32. the binary logistic regression model129, 647 is\n\nc(y |x) = prob{y = 1|x} = (1 + exp(\u2212x\u03b2))\n\n\u22121,\n\n(2.5)\n\nwhere y can take on the values 0 and 1. in general the model, when\nstated in terms of the property c(y |x), may not be linear in x\u03b2; that\nis c(y |x) = g(x\u03b2), where g(u) is nonlinear in u. for example, a regression\nmodel could be e(y |x) = (x\u03b2).5. the model may be made linear in the\nunknown parameters by a transformation in the property c(y |x):\n\nh(c(y |x)) = x\u03b2,\n\n(2.6)\n\u22121(u), the inverse function of g. as an example consider the\n\nwhere h(u) = g\nbinary logistic regression model given by\n\nc(y |x) = prob{y = 1|x} = (1 + exp(\u2212x\u03b2))\n\n\u22121.\n\nif h(u) = logit(u) = log(u/(1 \u2212 u)), the transformed model becomes\n\nh(prob(y = 1|x)) = log(exp(x\u03b2)) = x\u03b2.\n\n(2.7)\n\n(2.8)\n\n "}, {"Page_number": 40, "text": "2.3 interpreting model parameters\n\n15\n\nthe transformation h(c(y |x)) is sometimes called a link function. let\n(y |x). the general linear regression model then\nh(c(y |x)) be denoted by c\nbecomes\n\n(cid:2)\n\n(cid:2)\n\n(y |x) = x\u03b2.\n\nc\n\n(2.9)\n\n(y |x) = e(y |x). in the logistic regression case, c\n\nof y , given x, is\nin other words, the model states that some property c\na weighted sum of the xs (x\u03b2). in the ordinary linear regression model,\n(y |x) is the logit of\n(cid:2)\nc\nthe probability that y = 1, log prob{y = 1}/[1 \u2212 prob{y = 1}]. this is the\nlog of the odds that y = 1 versus y = 0.\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\nit is important to note that the general linear regression model has two\n(y |x) and x\u03b2. the first part has to do with a property\nmajor components: c\nor transformation of y . the second, x\u03b2, is the linear regression or linear\npredictor part. the method of least squares can sometimes be used to fit\n(y |x) = e(y |x). other cases must be handled using other\nthe model if c\nmethods such as maximum likelihood estimation or nonlinear least squares.\n\n(cid:2)\n\n2.3 interpreting model parameters\nin the original model, c(y |x) specifies the way in which x affects a property\nof y . except in the ordinary linear regression model, it is difficult to interpret\nthe individual parameters if the model is stated in terms of c(y |x). in the\n(y |x) = x\u03b2 = \u03b20 + \u03b21x1 + . . . + \u03b2pxp, the regression parameter\nmodel c\n\u03b2j is interpreted as the change in the property c\nthe descriptor variable xj, all other descriptors remaining constanta:\n\nof y per unit change in\n\n(cid:2)\n\n(cid:2)\n\n\u03b2j = c\n\n(cid:2)\n\n(y |x1, x2, . . . , xj + 1, . . . , xp) \u2212 c\n\n(cid:2)\n\n(y |x1, x2, . . . , xj, . . . , xp).\n\n(2.10)\n\nin the ordinary linear regression model, for example, \u03b2j is the change in\nexpected value of y per unit change in xj. in the logistic regression model\n\u03b2j is the change in log odds that y = 1 per unit change in xj. when a\nnon-interacting xj is a dichotomous variable or a continuous one that is\nlinearly related to c\n, xj is represented by a single term in the model and\nits contribution is described fully by \u03b2j.\nand assume that c(y |x) is the\n\nin all that follows, we drop the\n\nfrom c\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\nproperty of y that is linearly related to the weighted sum of the xs.\n\na note that it is not necessary to \u201chold constant\u201d all other variables to be able to\ninterpret the effect of one predictor. it is sufficient to hold constant the weighted sum\nof all the variables other than xj. and in many cases it is not physically possible to\nhold other variables constant while varying one, e.g., when a model contains x and\nx 2 (david hoaglin, personal communication).\n\n "}, {"Page_number": 41, "text": "16\n\n2 general aspects of fitting regression models\n\n2.3.1 nominal predictors\n\nsuppose that we wish to model the effect of two or more treatments and be\nable to test for differences between the treatments in some property of y .\na nominal or polytomous factor such as treatment group having k levels, in\nwhich there is no definite ordering of categories, is fully described by a series of\nk\u22121 binary indicator variables (sometimes called dummy variables). suppose\nthat there are four treatments, j, k, l, and m , and the treatment factor is\ndenoted by t . the model can be written as\n\nc(y |t = j) = \u03b20\nc(y |t = k) = \u03b20 + \u03b21\nc(y |t = l) = \u03b20 + \u03b22\nc(y |t = m ) = \u03b20 + \u03b23.\n\n(2.11)\n\nthe four treatments are thus completely specified by three regression param-\neters and one intercept that we are using to denote treatment j, the reference\ntreatment. this model can be written in the previous notation as\n\nc(y |t ) = x\u03b2 = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x3,\n\n(2.12)\n\nwhere\n\nx1 = 1 if t = k, 0 otherwise\nx2 = 1 if t = l, 0 otherwise\nx3 = 1 if t = m, 0 otherwise.\n\n(2.13)\n\nfor treatment j (t = j), all three xs are zero and c(y |t = j) = \u03b20.\n\nthe test for any differences in the property c(y ) between treatments is\nh0 : \u03b21 = \u03b22 = \u03b23 = 0.\n\nthis model is an analysis of variance or k-sample-type model. if there are\nother descriptor covariables in the model, it becomes an analysis of covari-\nance-type model.\n\n2.3.2 interactions\n\nsuppose that a model has descriptor variables x1 and x2 and that the effect\nof the two xs cannot be separated; that is the effect of x1 on y depends on\nthe level of x2 and vice versa. one simple way to describe this interaction is\nto add the constructed variable x3 = x1x2 to the model:\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x1x2.\n\n(2.14)\n\n "}, {"Page_number": 42, "text": "2.3 interpreting model parameters\n\n17\n\nit is now difficult to interpret \u03b21 and \u03b22 in isolation. however, we may quantify\nthe effect of a one-unit increase in x1 if x2 is held constant as\n\ntable 2.1 parameters in a simple model with interaction\n\nparameter\n\u03b20\n\u03b21\n\u03b22\n\u03b23\n\nmeaning\n\nc(y |age = 0, sex = m)\nc(y |age = x + 1, sex = m) \u2212 c(y |age = x, sex = m)\nc(y |age = 0, sex = f ) \u2212 c(y |age = 0, sex = m)\nc(y |age = x + 1, sex = f ) \u2212 c(y |age = x, sex = f )\u2212\n[c(y |age = x + 1, sex = m) \u2212 c(y |age = x, sex = m)]\n\nc(y |x1 + 1, x2) \u2212 c(y |x1, x2)\n\n= \u03b20 + \u03b21(x1 + 1) + \u03b22x2\n+ \u03b23(x1 + 1)x2\n\u2212 [\u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x1x2]\n= \u03b21 + \u03b23x2.\n\n(2.15)\n\nlikewise, the effect of a one-unit increase in x2 on c if x1 is held constant is\n\u03b22 +\u03b23x1. interactions can be much more complex than can be modeled with\na product of two terms. if x1 is binary, the interaction may take the form\nof a difference in shape (and/or distribution) of x2 versus c(y ) depending\non whether x1 = 0 or x1 = 1 (e.g., logarithm vs. square root). when both\nvariables are continuous, the possibilities are much greater (this case is dis-\ncussed later). interactions among more than two variables can be exceedingly\ncomplex.\n\n2.3.3 example: inference for a simple model\n\nsuppose we postulated the model\n\nc(y |age, sex) = \u03b20 + \u03b21age + \u03b22[sex = f ] + \u03b23age[sex = f ],\n\nwhere [sex = f ] is a 0\u20131 indicator variable for sex = female; the reference cell\nis sex = male corresponding to a zero value of the indicator variable. this is\na model that assumes\n\n1. age is linearly related to c(y ) for males,\n2. age is linearly related to c(y ) for females, and\n3. whatever distribution, variance, and independence assumptions are appro-\n\npriate for the model being considered.\n\n "}, {"Page_number": 43, "text": "18\n\n2 general aspects of fitting regression models\n\nwe are thus assuming that the interaction between age and sex is simple;\nthat is it only alters the slope of the age effect. the parameters in the model\nhave interpretations shown in table 2.1. \u03b23 is the difference in slopes (female\n\u2013 male).\n\nthere are many useful hypotheses that can be tested for this model. first\nlet\u2019s consider two hypotheses that are seldom appropriate although they are\nroutinely tested.\n\n1. h0 : \u03b21 = 0: this tests whether age is associated with y for males.\n2. h0 : \u03b22 = 0: this tests whether sex is associated with y for zero-year olds.\n\nnow consider more useful hypotheses. for each hypothesis we should write\nwhat is being tested, translate this to tests in terms of parameters, write the\nalternative hypothesis, and describe what the test has maximum power to\ndetect. the latter component of a hypothesis test needs to be emphasized, as\nalmost every statistical test is focused on one specific pattern to detect. for\nexample, a test of association against an alternative hypothesis that a slope\nis nonzero will have maximum power when the true association is linear.\nif the true regression model is exponential in x, a linear regression test\nwill have some power to detect \u201cnon-flatness\u201d but it will not be as powerful\nas the test from a well-specified exponential regression effect. if the true\neffect is u-shaped, a test of association based on a linear model will have\nalmost no power to detect association. if one tests for association against\na quadratic (parabolic) alternative, the test will have some power to detect\na logarithmic shape but it will have very little power to detect a cyclical\ntrend having multiple \u201chumps.\u201d in a quadratic regression model, a test of\nlinearity against a quadratic alternative hypothesis will have reasonable power\nto detect a quadratic nonlinear effect but very limited power to detect a\nmultiphase cyclical trend. therefore in the tests in table 2.2 keep in mind\nthat power is maximal when linearity of the age relationship holds for both\nsexes. in fact it may be useful to write alternative hypotheses as, for example,\n\u201cha : age is associated with c(y ), powered to detect a linear relationship.\u201d\nnote that if there is an interaction effect, we know that there is both an\nage and a sex effect. however, there can also be age or sex effects when the\nlines are parallel. that\u2019s why the tests of total association have 2 d.f.\n\n2.4 relaxing linearity assumption for continuous\n\npredictors\n\n2.4.1 avoiding categorization\n\nrelationships among variables are seldom linear, except in special cases\nsuch as when one variable is compared with itself measured at a different\ntime. it is a common belief among practitioners who do not study bias and\n\n "}, {"Page_number": 44, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n19\n\nefficiency in depth that the presence of non-linearity should be dealt with by\nchopping continuous variables into intervals. nothing could be more disas-\ntrous.13, 14, 17, 45, 82, 185, 187, 215, 294, 300, 379, 446, 465, 521, 533, 559, 597, 646\n\ntable 2.2 most useful tests for linear age \u00d7 sex model\nnull or alternative hypothesis\n\nmathematical\n\nstatement\n\nh0 : \u03b23 = 0\n\nha : \u03b23 (cid:5)= 0\n\neffect of age is independent of sex or\neffect of sex is independent of age or\nage and sex are additive\nage effects are parallel\nage interacts with sex\nage modifies effect of sex\nsex modifies effect of age\nsex and age are non-additive (synergistic)\nage is not associated with y\nage is associated with y\nage is associated with y for either\nfemales or males\nsex is not associated with y\nsex is associated with y\nsex is associated with y for some\nvalue of age\nneither age nor sex is associated with y h0 : \u03b21 = \u03b22 = \u03b23 = 0\neither age or sex is associated with y\n\nh0 : \u03b21 = \u03b23 = 0\nha : \u03b21 (cid:5)= 0 or \u03b23 (cid:5)= 0\n\nh0 : \u03b22 = \u03b23 = 0\nha : \u03b22 (cid:5)= 0 or \u03b23 (cid:5)= 0\n\nha : \u03b21 (cid:5)= 0 or \u03b22 (cid:5)= 0 or \u03b23 (cid:5)= 0\n\nproblems caused by dichotomization include the following.\n\n1. estimated values will have reduced precision, and associated tests will have re-\n\nduced power.\n\n2. categorization assumes that the relationship between the predictor and the re-\nsponse is flat within intervals; this assumption is far less reasonable than a lin-\nearity assumption in most cases.\n\n3. to make a continuous predictor be more accurately modeled when categorization\nis used, multiple intervals are required. the needed indicator variables will spend\nmore degrees of freedom than will fitting a smooth relationship, hence power and\nprecision will suffer. and because of sample size limitations in the very low and\nvery high range of the variable, the outer intervals (e.g., outer quintiles) will be\nwide, resulting in significant heterogeneity of subjects within those intervals, and\nresidual confounding.\n\n4. categorization assumes that there is a discontinuity in response as interval bound-\naries are crossed. other than the effect of time (e.g., an instant stock price drop\nafter bad news), there are very few examples in which such discontinuities have\nbeen shown to exist.\n\n5. categorization only seems to yield interpretable estimates such as odds ratios.\nfor example, suppose one computes the odds ratio for stroke for persons with\na systolic blood pressure > 160 mmhg compared with persons with a blood\n\n "}, {"Page_number": 45, "text": "20\n\n2 general aspects of fitting regression models\npressure \u2264 160 mmhg. the interpretation of the resulting odds ratio will depend\non the exact distribution of blood pressures in the sample (the proportion of\nsubjects > 170, > 180, etc.). on the other hand, if blood pressure is modeled as\na continuous variable (e.g., using a regression spline, quadratic, or linear effect)\none can estimate the ratio of odds for exact settings of the predictor, e.g., the\nodds ratio for 200 mmhg compared with 120 mmhg.\n\n6. categorization does not condition on full information. when, for example, the\nrisk of stroke is being assessed for a new subject with a known blood pressure\n(say 162 mmhg), the subject does not report to her physician \u201cmy blood pressure\nexceeds 160\u201d but rather reports 162 mmhg. the risk for this subject will be much\nlower than that of a subject with a blood pressure of 200 mmhg.\n\n7. if cutpoints are determined in a way that is not blinded to the response vari-\nable, calculation of p -values and confidence intervals requires special simulation\ntechniques; ordinary inferential methods are completely invalid. for example, if\ncutpoints are chosen by trial and error in a way that utilizes the response, even\ninformally, ordinary p -values will be too small and confidence intervals will not\nhave the claimed coverage probabilities. the correct monte-carlo simulations\nmust take into account both multiplicities and uncertainty in the choice of cut-\npoints. for example, if a cutpoint is chosen that minimizes the p -value and the\nresulting p -value is 0.05, the true type i error can easily be above 0.5300.\n\n8. likewise, categorization that is not blinded to the response variable results in\n\nbiased effect estimates17, 559.\n\n9. \u201coptimal\u201d cutpoints do not replicate over studies. hollander et al.300 state that\n\u201c. . . the optimal cutpoint approach has disadvantages. one of these is that in al-\nmost every study where this method is applied, another cutpoint will emerge.\nthis makes comparisons across studies extremely difficult or even impossible.\naltman et al. point out this problem for studies of the prognostic relevance of the\ns-phase fraction in breast cancer published in the literature. they identified 19\ndifferent cutpoints used in the literature; some of them were solely used because\nthey emerged as the \u2018optimal\u2019 cutpoint in a specific data set. in a meta-analysis on\nthe relationship between cathepsin-d content and disease-free survival in node-\nnegative breast cancer patients, 12 studies were in included with 12 different\ncutpoints . . . interestingly, neither cathepsin-d nor the s-phase fraction are rec-\nommended to be used as prognostic markers in breast cancer in the recent update\nof the american society of clinical oncology.\u201d giannoni et al.215 demonstrated\nthat many claimed \u201coptimal cutpoints\u201d are just the observed median values in the\nsample, which happens to optimize statistical power for detecting a separation in\noutcomes and have nothing to do with true outcome thresholds. disagreements\nin cutpoints (which are bound to happen whenever one searches for things that\ndo not exist) cause severe interpretation problems. one study may provide an\nodds ratio for comparing body mass index (bmi) > 30 with bmi \u2264 30, another\nfor comparing bmi > 28 with bmi \u2264 28. neither of these odds ratios has a good\ndefinition and the two estimates are not comparable.\n\n10. cutpoints are arbitrary and manipulatable; cutpoints can be found that can result\n\nin both positive and negative associations646.\n\n11. if a confounder is adjusted for by categorization, there will be residual confound-\ning that can be explained away by inclusion of the continuous form of the predictor\nin the model in addition to the categories.\n\nwhen cutpoints are chosen using y , categorization represents one of those\n\nfew times in statistics where both type i and type ii errors are elevated.\n\na scientific quantity is a quantity which can be defined outside of the\nspecifics of the current experiment. the kind of high:low estimates that re-\nsult from categorizing a continuous variable are not scientific quantities; their\ninterpretation depends on the entire sample distribution of continuous mea-\nsurements within the chosen intervals.\n\n "}, {"Page_number": 46, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n21\n\nto summarize problems with categorization it is useful to examine its\neffective assumptions. suppose one assumes there is a single cutpoint c for\npredictor x. assumptions implicit in seeking or using this cutpoint include\n(1) the relationship between x and the response y is discontinuous at x = c\nand only x = c; (2) c is correctly found as the cutpoint; (3) x vs. y is\nflat to the left of c; (4) x vs. y is flat to the right of c; (5) the \u201coptimal\u201d\ncutpoint does not depend on the values of other predictors. failure to have\nthese assumptions satisfied will result in great error in estimating c (because\nit doesn\u2019t exist), low predictive accuracy, serious lack of model fit, residual\nconfounding, and overestimation of effects of remaining variables.\n\na better approach that maximizes power and that only assumes a smooth\nrelationship is to use regression splines for predictors that are not known\nto predict linearly. use of flexible parametric approaches such as this allows\nstandard inference techniques (p -values, confidence limits) to be used, as\nwill be described below. before introducing splines, we consider the simplest\napproach to allowing for nonlinearity.\n\n2.4.2 simple nonlinear terms\n\nif a continuous predictor is represented, say, as x1 in the model, the model\nis assumed to be linear in x1. often, however, the property of y of interest\ndoes not behave linearly in all the predictors. the simplest way to describe\na nonlinear effect of x1 is to include a term for x2 = x 2\n\n1 in the model:\n\nc(y |x1) = \u03b20 + \u03b21x1 + \u03b22x 2\n1 .\n\n(2.16)\n\nif the model is truly linear in x1, \u03b22 will be zero. this model formulation\nallows one to test h0 : model is linear in x1 against ha : model is quadratic\n(parabolic) in x1 by testing h0 : \u03b22 = 0.\n\nnonlinear effects will frequently not be of a parabolic nature. if a trans-\nformation of the predictor is known to induce linearity, that transformation\n(e.g., log(x)) may be substituted for the predictor. however, often the trans-\nformation is not known. higher powers of x1 may be included in the model\nto approximate many types of relationships, but polynomials have some un-\ndesirable properties (e.g., undesirable peaks and valleys, and the fit in one\nregion of x can be greatly affected by data in other regions433) and will not\nadequately fit many functional forms.156 for example, polynomials do not\nadequately fit logarithmic functions or \u201cthreshold\u201d effects.\n\n "}, {"Page_number": 47, "text": "22\n\n2 general aspects of fitting regression models\n\n2.4.3 splines for estimating shape of regression\n\nfunction and determining predictor\ntransformations\n\na draftsman\u2019s spline is a flexible strip of metal or rubber used to draw curves.\nspline functions are piecewise polynomials used in curve fitting. that is, they\nare polynomials within intervals of x that are connected across different\nintervals of x. splines have been used, principally in the physical sciences,\nto approximate a wide variety of functions. the simplest spline function is a\nlinear spline function, a piecewise linear function. suppose that the x axis is\ndivided into intervals with endpoints at a, b, and c, called knots. the linear\nspline function is given by\n\nf (x) = \u03b20 + \u03b21x + \u03b22(x \u2212 a)+ + \u03b23(x \u2212 b)+ + \u03b24(x \u2212 c)+,\n\n(2.17)\n\nwhere\n\n(u)+ = u, u > 0,\n0, u \u2264 0.\n\n(2.18)\n\nthe number of knots can vary depending on the amount of available data for\nfitting the function. the linear spline function can be rewritten as\n\nf (x)\n\n= \u03b20 + \u03b21x,\n\nx \u2264 a\na < x \u2264 b\n= \u03b20 + \u03b21x + \u03b22(x \u2212 a) + \u03b23(x \u2212 b) b < x \u2264 c\n\n= \u03b20 + \u03b21x + \u03b22(x \u2212 a)\n= \u03b20 + \u03b21x + \u03b22(x \u2212 a)\n+\u03b23(x \u2212 b) + \u03b24(x \u2212 c)\n\nc < x.\n\n(2.19)\n\na linear spline is depicted in figure 2.1.\n\nthe general linear regression model can be written assuming only piecewise\n\nlinearity in x by incorporating constructed variables x2, x3, and x4 :\n\nc(y |x) = f (x) = x\u03b2,\n\nwhere x\u03b2 = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x3 + \u03b24x4, and\nx1 = x x2 = (x \u2212 a)+\nx3 = (x \u2212 b)+ x4 = (x \u2212 c)+.\n\n(2.20)\n\n(2.21)\n\nby modeling a slope increment for x in an interval (a, b] in terms of (x\u2212a)+,\n\nthe function is constrained to join (\u201cmeet\u201d) at the knots. overall linearity in\nx can be tested by testing h0 : \u03b22 = \u03b23 = \u03b24 = 0.\n\n "}, {"Page_number": 48, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n23\n\n)\n\nx\n\n(\n\nf\n\n0\n\n1\n\n2\n\n3\nx\n\n4\n\n5\n\n6\n\nfig. 2.1 a linear spline function with knots at a = 1, b = 3, c = 5.\n\n2.4.4 cubic spline functions\n\nalthough the linear spline is simple and can approximate many common\nrelationships, it is not smooth and will not fit highly curved functions well.\nthese problems can be overcome by using piecewise polynomials of order\nhigher than linear. cubic polynomials have been found to have nice properties\nwith good ability to fit sharply curving shapes. cubic splines can be made to\nbe smooth at the join points (knots) by forcing the first and second derivatives\nof the function to agree at the knots. such a smooth cubic spline function\nwith three knots (a, b, c) is given by\n\nf (x) = \u03b20 + \u03b21x + \u03b22x 2 + \u03b23x 3\n+ + \u03b25(x \u2212 b)3\n\n+ \u03b24(x \u2212 a)3\n\n+ + \u03b26(x \u2212 c)3\n\n+\n\n= x\u03b2\n\nwith the following constructed variables:\n\nx1 = x x2 = x 2\nx3 = x 3 x4 = (x \u2212 a)3\n+\n+ x6 = (x \u2212 c)3\n+.\n\nx5 = (x \u2212 b)3\n\n(2.22)\n\n(2.23)\n\nif the cubic spline function has k knots, the function will require estimat-\ning k + 3 regression coefficients besides the intercept. see section 2.4.6 for\ninformation on choosing the number and location of knots.\n\nthere are more numerically stable ways to form a design matrix for cubic\nspline functions that are based on b-splines instead of the truncated power\nbasis152, 575 used here. however, b-splines are more complex and do not allow\nfor extrapolation beyond the outer knots, and the truncated power basis\nseldom presents estimation problems (see section 4.6) when modern methods\nsuch as the q\u2013r decomposition are used for matrix inversion.\n\n1\n\n2\n\n "}, {"Page_number": 49, "text": "24\n\n2 general aspects of fitting regression models\n\n2.4.5 restricted cubic splines\n\nstone and koo595 have found that cubic spline functions do have a drawback\nin that they can be poorly behaved in the tails, that is before the first knot and\nafter the last knot. they cite advantages of constraining the function to be\nlinear in the tails. their restricted cubic spline function (also called natural\nsplines) has the additional advantage that only k \u2212 1 parameters must be\nestimated (besides the intercept) as opposed to k + 3 parameters with the\nunrestricted cubic spline. the restricted spline function with k knots t1, . . . , tk\nis given by156\n\nf (x) = \u03b20 + \u03b21x1 + \u03b22x2 + . . . + \u03b2k\u22121xk\u22121,\n\n(2.24)\n\nwhere x1 = x and for j = 1, . . . , k \u2212 2,\n\n3\n\nxj+1 = (x \u2212 tj)3\n+ (x \u2212 tk)3\n\n+\n\n\u2212 (x \u2212 tk\u22121)3\n+(tk\u22121 \u2212 tj)/(tk \u2212 tk\u22121).\n\n+(tk \u2212 tj)/(tk \u2212 tk\u22121)\n\n(2.25)\nit can be shown that xj is linear in x for x \u2265 tk. for numerical behavior and\nto put all basis functions for x on the same scale, r hmisc and rms package\nfunctions by default divide the terms in eq. 2.25 by\n\n\u03c4 = (tk \u2212 t1)2.\n\n(2.26)\n\nfigure 2.2 displays the \u03c4 -scaled spline component variables xj for j =\n2, 3, 4 and k = 5 and one set of knots. the left graph magnifies the lower\nportion of the curves.\n\nrequire ( hmisc )\n\nx \u2190 rcspline.eval ( seq (0 ,1 , .01 ),\nxm \u2190 x\nxm [ xm > .0106 ] \u2190 na\n\nknots = seq ( .05 , .95 , length =5) , inclx = t )\n\nmatplot ( x [ ,1] , xm , type = \" l \" , ylim = c (0 , .01 ),\nxlab = expression (x ), ylab = ' ' , lty =1)\n\nmatplot ( x [ ,1] , x ,\n\ntype = \" l \" ,\n\nxlab = expression (x ), ylab = ' ' , lty =1)\n\nfigure 2.3 displays some typical shapes of restricted cubic spline functions\n\nwith k = 3, 4, 5, and 6. these functions were generated using random \u03b2.\n\n "}, {"Page_number": 50, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n25\n\n0.010\n\n0.008\n\n0.006\n\n0.004\n\n0.002\n\n0.000\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n0.0\n\n0.4\n\nx\n\n0.8\n\n0.0\n\n0.8\n\n0.4\n\nx\n\nfig. 2.2 restricted cubic spline component variables for k = 5 and knots at x =\n.05, .275, .5, .725, and .95. nonlinear basis functions are scaled by \u03c4 . the left panel\nis a y\u2013magnification of the right panel. fitted functions such as those in figure 2.3\nwill be linear combinations of these basis functions as long as knots are at the same\nlocations used here.\n\nx \u2190 seq (0 , 1, length =300)\n\nfor ( nk in 3:6) {\n\nset.seed ( nk )\n\nknots \u2190 seq ( .05 , .95 , length = nk )\nxx \u2190 rcspline.eval (x , knots = knots , inclx = t )\n\nfor ( i in 1 : ( nk - 1))\n\nxx [, i ] \u2190 ( xx [, i] - min ( xx [, i ])) /\n\n( max ( xx [, i ]) - min ( xx [, i ]))\n\nfor ( i in 1 : 20) {\n\nbeta \u2190 2 * runif ( nk-1 ) - 1\nxbeta \u2190 xx % * % beta + 2 * runif (1) - 1\nxbeta \u2190 ( xbeta - min ( xbeta )) /\n\n( max ( xbeta ) - min ( xbeta ))\n\nif ( i == 1) {\n\nplot (x , xbeta , type = \" l \" , lty =1 ,\n\nxlab = expression (x ), ylab = ' ' , bty = \" l \" )\n\ntitle ( sub = paste (nk , \" knots \" ), adj =0 , cex = .75 )\nfor ( j in 1 : nk )\n\narrows ( knots [ j ], .04 , knots [ j ], -.03 ,\nangle =20 , length = .07 , lwd =1 .5 )\n\n}\nelse lines (x , xbeta , col = i )\n\n}\n\n}\n\n "}, {"Page_number": 51, "text": "26\n\n2 general aspects of fitting regression models\n\nonce \u03b20, . . . , \u03b2k\u22121 are estimated, the restricted cubic spline can be restated\n\nin the form\n\nf (x) = \u03b20 + \u03b21x + \u03b22(x \u2212 t1)3\n+ . . . + \u03b2k+1(x \u2212 tk)3\n\n+\n\n+ + \u03b23(x \u2212 t2)3\n\n+\n\n(2.27)\n\nby dividing \u03b22, . . . , \u03b2k\u22121 by \u03c4 (eq. 2.26) and computing\n\n\u03b2k = [\u03b22(t1 \u2212 tk)+ \u03b23(t2 \u2212 tk)+ . . . + \u03b2k\u22121(tk\u22122 \u2212 tk)]/(tk \u2212 tk\u22121)\n\n\u03b2k+1 = [\u03b22(t1 \u2212 tk\u22121)+ \u03b23(t2 \u2212 tk\u22121)+ . . . + \u03b2k\u22121(tk\u22122 \u2212 tk\u22121)]/(tk\u22121 \u2212 tk).\n\n(2.28)\n\n4\n\n5\n\na test of linearity in x can be obtained by testing\n\nh0 : \u03b22 = \u03b23 = . . . = \u03b2k\u22121 = 0.\n\n(2.29)\n\nthe truncated power basis for restricted cubic splines does allow for\nrational (i.e., linear) extrapolation beyond the outer knots. however, when\nthe outer knots are in the tails of the data, extrapolation can still be danger-\nous.\n\nwhen nonlinear terms in equation 2.25 are normalized, for example, by\ndividing them by the square of the difference in the outer knots to make all\nterms have units of x, the ordinary truncated power basis has no numerical\ndifficulties when modern matrix algebra software is used.\n\n2.4.6 choosing number and position of knots\n\nwe have assumed that the locations of the knots are specified in advance;\nthat is, the knot locations are not treated as free parameters to be estimated.\nif knots were free parameters, the fitted function would have more flexibility\nbut at the cost of instability of estimates, statistical inference problems, and\ninability to use standard regression modeling software for estimating regres-\nsion parameters.\n\nhow then does the analyst pre-assign knot locations? if the regression\nrelationship were described by prior experience, pre-specification of knot lo-\ncations would be easy. for example, if a function were known to change\ncurvature at x = a, a knot could be placed at a. however, in most situations\nthere is no way to pre-specify knots. fortunately, stone593 has found that\nthe location of knots in a restricted cubic spline model is not very crucial in\nmost situations; the fit depends much more on the choice of k, the number of\nknots. placing knots at fixed quantiles (percentiles) of a predictor\u2019s marginal\ndistribution is a good approach in most datasets. this ensures that enough\npoints are available in each interval, and also guards against letting outliers\noverly influence knot placement. recommended equally spaced quantiles are\nshown in table 2.3.\n\n "}, {"Page_number": 52, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n27\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nx\n\n3 knots\n\nx\n\n4 knots\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nx\n\n5 knots\n\nx\n\n6 knots\n\nfig. 2.3 some typical restricted cubic spline functions for k = 3, 4, 5, 6. the y\u2013axis\nis x\u03b2. arrows indicate knots. these curves were derived by randomly choosing values\nof \u03b2 subject to standard deviations of fitted functions being normalized.\n\ntable 2.3 default quantiles for knots\n\nquantiles\n.5 .90\n.35 .65\n\nk\n3\n4\n5\n.05\n6 .05 .23\n7 .025 .1833 .3417 .5 .6583 .8167 .975\n\n.10\n.05\n.95\n.275 .5 .725 .95\n.41\n.95\n\n.59 .77\n\n "}, {"Page_number": 53, "text": "28\n\n2 general aspects of fitting regression models\n\nthe principal reason for using less extreme default quantiles for k = 3 and\nmore extreme ones for k = 7 is that one usually uses k = 3 for small sample\nsizes and k = 7 for large samples. when the sample size is less than 100, the\nouter quantiles should be replaced by the fifth smallest and fifth largest data\npoints, respectively.595 what about the choice of k? the flexibility of possible\nfits must be tempered by the sample size available to estimate the unknown\nparameters. stone593 has found that more than 5 knots are seldom required\nin a restricted cubic spline model. the principal decision then is between\nk = 3, 4, or 5. for many datasets, k = 4 offers an adequate fit of the model\nand is a good compromise between flexibility and loss of precision caused\nby overfitting a small sample. when the sample size is large (e.g., n \u2265 100\nwith a continuous uncensored response variable), k = 5 is a good choice.\nsmall samples (< 30, say) may require the use of k = 3. akaike\u2019s information\ncriterion (aic, section 9.8.1) can be used for a data-based choice of k. the\nvalue of k maximizing the model likelihood ratio \u03c72 \u2212 2k would be the best\n\u201cfor the money\u201d using aic.\n\nthe analyst may wish to devote more knots to variables that are thought\nto be more important, and risk lack of fit for less important variables. in this\nway the total number of estimated parameters can be controlled (section 4.1).\n\n2.4.7 nonparametric regression\n\none of the most important results of an analysis is the estimation of the\ntendency (trend) of how x relates to y . this trend is useful in its own right\nand it may be sufficient for obtaining predicted values in some situations, but\ntrend estimates can also be used to guide formal regression modeling (by sug-\ngesting predictor variable transformations) and to check model assumptions.\nnonparametric smoothers are excellent tools for determining the shape\nof the relationship between a predictor and the response. the standard non-\nparametric smoothers work when one is interested in assessing one continuous\npredictor at a time and when the property of the response that should be lin-\nearly related to the predictor is a standard measure of central tendency. for\nexample, when c(y ) is e(y ) or pr[y = 1], standard smoothers are useful,\nbut when c(y ) is a measure of variability or a rate (instantaneous risk), or\nwhen y is only incompletely measured for some subjects (e.g., y is censored\nfor some subjects), simple smoothers will not work.\n\nthe oldest and simplest nonparametric smoother is the moving average.\nsuppose that the data consist of the points x = 1, 2, 3, 5, and 8, with the\ncorresponding y values 2.1, 3.8, 5.7, 11.1, and 17.2. to smooth the relationship\nwe could estimate e(y |x = 2) by (2.1 + 3.8 + 5.7)/3 and e(y |x = (2 + 3 +\n5)/3) by (3.8 + 5.7 + 11.1)/3. note that overlap is fine; that is one point may\nbe contained in two sets that are averaged. you can immediately see that the\n\n "}, {"Page_number": 54, "text": "2.4 relaxing linearity assumption for continuous predictors\n\n29\n\nsimple moving average has a problem in estimating e(y ) at the outer values\nof x. the estimates are quite sensitive to the choice of the number of points\n(or interval width) to use in \u201cbinning\u201d the data.\n\na moving least squares linear regression smoother is far superior to a\nmoving flat line smoother (moving average). cleveland\u2019s111 moving linear\nregression smoother loess has become the most popular smoother. to obtain\nthe smoothed value of y at x = x, we take all the data having x values\nwithin a suitable interval about x. then a linear regression is fitted to all\nof these points, and the predicted value from this regression at x = x is\ntaken as the estimate of e(y |x = x). actually, loess uses weighted least\nsquares estimates, which is why it is called a locally weighted least squares\nmethod. the weights are chosen so that points near x = x are given the\nmost weightb in the calculation of the slope and intercept. surprisingly, a\ngood default choice for the interval about x is an interval containing 2/3 of\nthe data points! the weighting function is devised so that points near the\nextremes of this interval receive almost no weight in the calculation of the\nslope and intercept.\n\nbecause loess uses a moving straight line rather than a moving flat one,\nit provides much better behavior at the extremes of the xs. for example,\none can fit a straight line to the first three data points and then obtain the\npredicted value at the lowest x, which takes into account that this x is not\nthe middle of the three xs.\n\nloess obtains smoothed values for e(y ) at each observed value of x.\n\nestimates for other xs are obtained by linear interpolation.\n\nthe loess algorithm has another component. after making an initial es-\ntimate of the trend line, loess can look for outliers off this trend. it can\nthen delete or down-weight those apparent outliers to obtain a more robust\ntrend estimate. now, different points will appear to be outliers with respect\nto this second trend estimate. the new set of outliers is taken into account\nand another trend line is derived. by default, the process stops after these\nthree iterations. loess works exceptionally well for binary y as long as the\niterations that look for outliers are not done, that is only one iteration is\nperformed.\n\nfor a single x, friedman\u2019s\u201csuper smoother\u201d207 is another efficient and flex-\nible nonparametric trend estimator. for both loess and the super smoother\nthe amount of smoothing can be controlled by the analyst. hastie and\ntibshirani275 provided an excellent description of smoothing methods and\ndeveloped a generalized additive model for multiple xs,\nin which each\ncontinuous predictor is fitted with a nonparametric smoother (see chap-\nter 16). interactions are not allowed. cleveland et al.96 have extended two-\ndimensional smoothers to multiple dimensions without assuming additivity.\ntheir local regression model is feasible for up to four or so predictors. local\nregression models are extremely flexible, allowing parts of the model to be\n\nb this weight is not to be confused with the regression coefficient; rather the weights\nare w1, w2, . . . , wn and the fitting criterion is\n\nn\n\n(cid:2)\ni wi(yi \u2212 \u02c6yi)2.\n\n6\n\n "}, {"Page_number": 55, "text": "30\n\n2 general aspects of fitting regression models\n\nparametrically specified, and allowing the analyst to choose the amount of\nsmoothing or the effective number of degrees of freedom of the fit.\n\nsmoothing splines are related to nonparametric smoothers. here a knot\nis placed at every data point, but a penalized likelihood is maximized to\nderive the smoothed estimates. gray237, 238 developed a general method that\nis halfway between smoothing splines and regression splines. he pre-specified,\nsay, 10 fixed knots, but uses a penalized likelihood for estimation. this allows\nthe analyst to control the effective number of degrees of freedom used.\n\nbesides using smoothers to estimate regression relationships, smoothers are\nvaluable for examining trends in residual plots. see sections 14.6 and 21.2\nfor examples.\n\n7\n\n2.4.8 advantages of regression splines\n\nover other methods\n\nthere are several advantages of regression splines:271\n\n1. parametric splines are piecewise polynomials and can be fitted using any\nexisting regression program after the constructed predictors are computed.\nspline regression is equally suitable to multiple linear regression, survival\nmodels, and logistic models for discrete outcomes.\n\n2. regression coefficients for the spline function are estimated using stan-\ndard techniques (maximum likelihood or least squares), and statistical\ninferences can readily be drawn. formal tests of no overall association,\nlinearity, and additivity can readily be constructed. confidence limits for\nthe estimated regression function are derived by standard theory.\n3. the fitted spline function directly estimates the transformation that a\npredictor should receive to yield linearity in c(y |x). the fitted spline\ntransformation sometimes suggests a simple transformation (e.g., square\nroot) of a predictor that can be used if one is not concerned about the\nproper number of degrees of freedom for testing association of the predictor\nwith the response.\n\n4. the spline function can be used to represent the predictor in the final\n\nmodel. nonparametric methods do not yield a prediction equation.\n\n5. splines can be extended to non-additive models (see below). multidimen-\nsional nonparametric estimators often require burdensome computations.\n\n2.5 recursive partitioning: tree-based models\n\nbreiman et al.69 have developed an essentially model-free approach called\nclassification and regression trees (cart), a form of recursive partitioning.\n\n "}, {"Page_number": 56, "text": "2.6 multiple degree of freedom tests of association\n\n31\n\nfor some implementations of cart, we say \u201cessentially\u201d model-free since a\nmodel-based statistic is sometimes chosen as a splitting criterion. the essence\nof recursive partitioning is as follows.\n\n1. find the predictor so that the best possible binary split on that predictor\nhas a larger value of some statistical criterion than any other split on any\nother predictor. for ordinal and continuous predictors, the split is of the\nform x < c versus x \u2265 c. for polytomous predictors, the split involves\nfinding the best separation of categories, without preserving order.\n\n2. within each previously formed subset, find the best predictor and best\nsplit that maximizes the criterion in the subset of observations passing the\nprevious split.\n\n3. proceed in like fashion until fewer than k observations remain to be split,\n\nwhere k is typically 20 to 100.\n\n4. obtain predicted values using a statistic that summarizes each terminal\n\nnode (e.g., mean or proportion).\n\n5. prune the tree backward so that a tree with the same number of nodes\ndeveloped on 0.9 of the data validates best on the remaining 0.1 of the\ndata (average over the 10 cross-validations). alternatively, shrink the node\nestimates toward the mean, using a progressively stronger shrinkage factor,\nuntil the best cross-validation results.\n\ntree models have the advantage of not requiring any functional form for\nthe predictors and of not assuming additivity of predictors (i.e., recursive\npartitioning can identify complex interactions). trees can deal with miss-\ning data flexibly. they have the disadvantages of not utilizing continuous\nvariables effectively and of overfitting in three directions: searching for best\npredictors, for best splits, and searching multiple times. the penalty for the\nextreme amount of data searching required by recursive partitioning surfaces\nwhen the tree does not cross-validate optimally until it is pruned all the way\nback to two or three splits. thus reliable trees are often not very discrimi-\nnating.\n\ntree models are especially useful in messy situations or settings in which\noverfitting is not so problematic, such as confounder adjustment using propen-\nsity scores117 or in missing value imputation. a major advantage of tree mod-\neling is savings of analyst time, but this is offset by the underfitting needed\nto make trees validate.\n\n2.6 multiple degree of freedom tests of association\n\nwhen a factor is a linear or binary term in the regression model, the test\nof association for that factor with the response involves testing only a single\nregression parameter. nominal factors and predictors that are represented as\na quadratic or spline function require multiple regression parameters to be\n\n8\n\n9\n\n "}, {"Page_number": 57, "text": "32\n\n2 general aspects of fitting regression models\n\ntested simultaneously in order to assess association with the response. for a\nnominal factor having k levels, the overall anova-type test with k \u2212 1 d.f.\ntests whether there are any differences in responses between the k categories.\nit is recommended that this test be done before attempting to interpret in-\ndividual parameter estimates. if the overall test is not significant, it can be\ndangerous to rely on individual pairwise comparisons because the type i error\nwill be increased. likewise, for a continuous predictor for which linearity is\nnot assumed, all terms involving the predictor should be tested simultane-\nously to check whether the factor is associated with the outcome. this test\nshould precede the test for linearity and should usually precede the attempt\nto eliminate nonlinear terms. for example, in the model\n\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x 2\n2 ,\n\n(2.30)\n\none should test h0 : \u03b22 = \u03b23 = 0 with 2 d.f. to assess association between\nx2 and outcome. in the five-knot restricted cubic spline model\n\nc(y |x) = \u03b20 + \u03b21x + \u03b22x\n\n(cid:2)\n\n+ \u03b23x\n\n(cid:2)(cid:2)\n\n+ \u03b24x\n\n(cid:2)(cid:2)(cid:2)\n\n,\n\n(2.31)\n\nthe hypothesis h0 : \u03b21 = . . . = \u03b24 = 0 should be tested with 4 d.f. to\nassess whether there is any association between x and y . if this 4 d.f. test is\ninsignificant, it is dangerous to interpret the shape of the fitted spline function\nbecause the hypothesis that the overall function is flat has not been rejected.\na dilemma arises when an overall test of association, say one having 4\nd.f., is insignificant, the 3 d.f. test for linearity is insignificant, but the 1 d.f.\ntest for linear association, after deleting nonlinear terms, becomes significant.\nhad the test for linearity been borderline significant, it would not have been\nwarranted to drop these terms in order to test for a linear association. but\nwith the evidence for nonlinearity not very great, one could attempt to test\nfor association with 1 d.f. this however is not fully justified, because the 1\nd.f. test statistic does not have a \u03c72 distribution with 1 d.f. since pretesting\nwas done. the original 4 d.f. test statistic does have a \u03c72 distribution with 4\nd.f. because it was for a pre-specified test.\n\nfor quadratic regression, grambsch and o\u2019brien234 showed that the 2\nd.f. test of association is nearly optimal when pretesting is done, even when\nthe true relationship is linear. they considered an ordinary regression model\n\ne(y |x) = \u03b20 + \u03b21x + \u03b22x 2 and studied tests of association between x and\n\ny . the strategy they studied was as follows. first, fit the quadratic model\nand obtain the partial test of h0 : \u03b22 = 0, that is the test of linearity. if this\npartial f -test is significant at the \u03b1 = 0.05 level, report as the final test of\nassociation between x and y the 2 d.f. f -test of h0 : \u03b21 = \u03b22 = 0. if the\ntest of linearity is insignificant, the model is refitted without the quadratic\nterm and the test of association is then a 1 d.f. test, h0 : \u03b21 = 0|\u03b22 = 0.\n\ngrambsch and o\u2019brien demonstrated that the type i error from this two-\nstage test is greater than the stated \u03b1, and in fact a fairly accurate p -value\ncan be obtained if it is computed from an f distribution with 2 numerator\n\n "}, {"Page_number": 58, "text": "2.7 assessment of model fit\n\n33\n\nd.f. even when testing at the second stage. this is because in the original\n2 d.f. test of association, the 1 d.f. corresponding to the nonlinear effect is\ndeleted if the nonlinear effect is very small; that is one is retaining the most\nsignificant part of the 2 d.f. f statistic.\n\nif we use a 2 d.f. f critical value to assess the x effect even when x 2 is not\nin the model, it is clear that the two-stage approach can only lose power and\nhence it has no advantage whatsoever. that is because the sum of squares\ndue to regression from the quadratic model is greater than the sum of squares\ncomputed from the linear model.\n\n2.7 assessment of model fit\n\n2.7.1 regression assumptions\n\nin this section, the regression part of the model is isolated, and methods are\ndescribed for validating the regression assumptions or modifying the model\nto meet the assumptions. the general linear regression model is\n\nc(y |x) = x\u03b2 = \u03b20 + \u03b21x1 + \u03b22x2 + . . . + \u03b2kxk.\n\n(2.32)\n\nthe assumptions of linearity and additivity need to be verified. we begin\nwith a special case of the general model,\n\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x2,\n\n(2.33)\n\nwhere x1 is binary and x2 is continuous. one needs to verify that the prop-\nerty of the response c(y ) is related to x1 and x2 according to figure 2.4.\nthere are several methods for checking the fit of this model. the first\nmethod below is based on critiquing the simple model, and the other methods\ndirectly \u201cestimate\u201d the model.\n\n1. fit the simple linear additive model and critically examine residual plots\nfor evidence of systematic patterns. for least squares fits one can compute\n\nestimated residuals e = y \u2212 x \u02c6\u03b2 and box plots of e stratified by x1 and\nscatterplots of e versus x1 and \u02c6y with trend curves. if one is assuming\nconstant conditional variance of y , the spread of the residual distribution\nagainst each of the variables can be checked at the same time. if the nor-\nmality assumption is needed (i.e., if significance tests or confidence limits\nare used), the distribution of e can be compared with a normal distribu-\ntion with mean zero. advantage: simplicity. disadvantages: standard\nresiduals can only be computed for continuous uncensored response vari-\nables. the judgment of non-randomness is largely subjective, it is difficult\nto detect interaction, and if interaction is present it is difficult to check\nany of the other assumptions. unless trend lines are added to plots, pat-\n\n "}, {"Page_number": 59, "text": "34\n\n2 general aspects of fitting regression models\n\n)\n\n(\n\ny\nc\n\nx1 = 1\n\nx1 = 0\n\nfig. 2.4 regression assumptions for one binary and one continuous predictor\n\nx2\n\nterns may be difficult to discern if the sample size is very large. detecting\npatterns in residuals does not always inform the analyst of what corrective\naction to take, although partial residual plots can be used to estimate the\nneeded transformations if interaction is absent.\n\n2. make a scatterplot of y versus x2 using different symbols according to\nvalues of x1. advantages: simplicity, and one can sometimes see all re-\ngression patterns including interaction. disadvantages: scatterplots can-\nnot be drawn for binary, categorical, or censored y . patterns are difficult\nto see if relationships are weak or if the sample size is very large.\n\n3. stratify the sample by x1 and quantile groups (e.g., deciles) of x2. within\neach x1 \u00d7 x2 stratum an estimate of c(y |x1, x2) is computed. if x1 is\ncontinuous, the same method can be used after grouping x1 into quantile\ngroups. advantages: simplicity, ability to see interaction patterns, can\nhandle censored y if care is taken. disadvantages: subgrouping requires\nrelatively large sample sizes and does not use continuous factors effectively\nas it does not attempt any interpolation. the ordering of quantile groups is\nnot utilized by the procedure. subgroup estimates have low precision (see\np. 488 for an example). each stratum must contain enough information\nto allow trends to be apparent above noise in the data. the method of\ngrouping chosen (e.g., deciles vs. quintiles vs. rounding) can alter the shape\nof the plot.\n\n4. fit a nonparametric smoother separately for levels of x1 (section 2.4.7)\nrelating x2 to y . advantages: all regression aspects of the model can\nbe summarized efficiently with minimal assumptions. disadvantages:\ndoes not easily apply to censored y , and does not easily handle multiple\npredictors.\n\n "}, {"Page_number": 60, "text": "2.7 assessment of model fit\n\n35\n\n5. fit a flexible parametric model that allows for most of the departures from\nthe linear additive model that you wish to entertain. advantages: one\nframework is used for examining the model assumptions, fitting the model,\nand drawing formal inference. degrees of freedom are well defined and\nall aspects of statistical inference \u201cwork as advertised.\u201d disadvantages:\ncomplexity, and it is generally difficult to allow for interactions when\nassessing patterns of effects.\n\nthe first four methods each have the disadvantage that if confidence limits\nor formal inferences are desired it is difficult to know how many degrees of\nfreedom were effectively used so that, for example, confidence limits will have\nthe stated coverage probability. for method five, the restricted cubic spline\nfunction is an excellent tool for estimating the true relationship between x2\nand c(y ) for continuous variables without assuming linearity. by fitting a\nmodel containing x2 expanded into k \u2212 1 terms, where k is the number of\nknots, one can obtain an estimate of the function of x2 that could be used\nlinearly in the model:\n\n\u02c6c(y |x) = \u02c6\u03b20 + \u02c6\u03b21x1 + \u02c6\u03b22x2 + \u02c6\u03b23x\n\n(cid:2)\n2 + \u02c6\u03b24x\n\n(cid:2)(cid:2)\n2\n\n= \u02c6\u03b20 + \u02c6\u03b21x1 + \u02c6f (x2),\n\nwhere\n\n\u02c6f (x2) = \u02c6\u03b22x2 + \u02c6\u03b23x\n\n(cid:2)\n2 + \u02c6\u03b24x\n\n(cid:2)(cid:2)\n2 ,\n\n(cid:2)\n2 and x\n\n(cid:2)(cid:2)\nand x\n2 are constructed spline variables (when k = 4) as described\npreviously. we call \u02c6f (x2) the spline-estimated transformation of x2. plotting\nthe estimated spline function \u02c6f (x2) versus x2 will generally shed light on\nhow the effect of x2 should be modeled. if the sample is sufficiently large,\nthe spline function can be fitted separately for x1 = 0 and x1 = 1, allowing\ndetection of even unusual interaction patterns. a formal test of linearity in\nx2 is obtained by testing h0 : \u03b23 = \u03b24 = 0, using a computationally efficient\nscore test, for example (section 9.2.3).\n\n(cid:2)\n2, and x\n\nif the model is nonlinear in x2, either a transformation suggested by the\nspline function plot (e.g., log(x2)) or the spline function itself (by placing\n(cid:2)(cid:2)\nx2, x\n2 simultaneously in any model fitted) may be used to describe\nx2 in the model. if a tentative transformation of x2 is specified, say g(x2),\nthe adequacy of this transformation can be tested by expanding g(x2) in a\nspline function and testing for linearity. if one is concerned only with predic-\ntion and not with statistical inference, one can attempt to find a simplifying\ntransformation for a predictor by plotting g(x2) against \u02c6f (x2) (the estimated\nspline transformation) for a variety of g, seeking a linearizing transformation\nof x2. when there are nominal or binary predictors in the model in addi-\ntion to the continuous predictors, it should be noted that there are no shape\nassumptions to verify for the binary/nominal predictors. one need only test\nfor interactions between these predictors and the others.\n\n(2.34)\n\n(2.35)\n\n "}, {"Page_number": 61, "text": "36\n\n2 general aspects of fitting regression models\n\nif the model contains more than one continuous predictor, all may be ex-\npanded with spline functions in order to test linearity or to describe nonlinear\nrelationships. if one did desire to assess simultaneously, for example, the lin-\nearity of predictors x2 and x3 in the presence of a linear or binary predictor\nx1, the model could be specified as\n\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x\n\n(cid:2)\n2 + \u03b24x\n\n(cid:2)(cid:2)\n2\n\n(cid:2)\n3 + \u03b27x\n\n(cid:2)(cid:2)\n3 ,\n\n+ \u03b25x3 + \u03b26x\n(cid:2)(cid:2)\n3 represent components of four knot restricted cubic\n\n(2.36)\n\n(cid:2)(cid:2)\nwhere x\n2 , x\nspline functions.\n\n(cid:2)\n2, x\n\n(cid:2)\n3, and x\n\nthe test of linearity for x2 (with 2 d.f.) is h0 : \u03b23 = \u03b24 = 0. the overall\ntest of linearity for x2 and x3 is h0 : \u03b23 = \u03b24 = \u03b26 = \u03b27 = 0, with 4 d.f.\nbut as described further in section 4.1, even though there are many reasons\nfor allowing relationships to be nonlinear, there are reasons for not testing\nthe nonlinear components for significance, as this might tempt the analyst to\nsimplify the model thus distorting inference.234 testing for linearity is usually\nbest done to justify to non-statisticians the need for complexity to explain or\npredict outcomes.\n\n2.7.2 modeling and testing complex interactions\n\nfor testing interaction between x1 and x2 (after a needed transformation\nmay have been applied), often a product term (e.g., x1x2) can be added\nto the model and its coefficient tested. a more general simultaneous test of\nlinearity and lack of interaction for a two-variable model in which one variable\nis binary (or is assumed linear) is obtained by fitting the model\n\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x\n\n(cid:2)\n2 + \u03b24x\n\n(cid:2)(cid:2)\n2\n\n(2.37)\n\n+ \u03b25x1x2 + \u03b26x1x\n\n(cid:2)\n2 + \u03b27x1x\n\n(cid:2)(cid:2)\n2\n\n10\n\nand testing h0 : \u03b23 = . . . = \u03b27 = 0. this formulation allows the shape of the\nx2 effect to be completely different for each level of x1. there is virtually\nno departure from linearity and additivity that cannot be detected from this\nexpanded model formulation if the number of knots is adequate and x1 is\nbinary. for binary logistic models, this method is equivalent to fitting two\nseparate spline regressions in x2.\n\ninteractions can be complex when all variables are continuous. an ap-\nproximate approach is to reduce the variables to two transformed variables,\nin which case interaction may sometimes be approximated by a single product\nof the two new variables. a disadvantage of this approach is that the esti-\nmates of the transformations for the two variables will be different depending\n\n "}, {"Page_number": 62, "text": "2.7 assessment of model fit\n\n37\n\non whether interaction terms are adjusted for when estimating \u201cmain effects.\u201d\na good compromise method involves fitting interactions of the form x1f (x2)\nand x2g(x1):\n\nc(y |x) = \u03b20 + \u03b21x1 + \u03b22x\n\n(cid:2)\n1 + \u03b23x\n\n(cid:2)(cid:2)\n1\n\n(cid:2)\n2 + \u03b26x\n\n(cid:2)(cid:2)\n2\n\n+ \u03b24x2 + \u03b25x\n+ \u03b27x1x2 + \u03b28x1x\n+ \u03b210x2x\n\n(cid:2)\n1 + \u03b211x2x\n\n(cid:2)(cid:2)\n1\n\n(cid:2)\n2 + \u03b29x1x\n\n(cid:2)(cid:2)\n2\n\n(2.38)\n\n(for k = 4 knots for both variables). the test of additivity is h0 : \u03b27 = \u03b28 =\n. . . = \u03b211 = 0 with 5 d.f. a test of lack of fit for the simple product interaction\nwith x2 is h0 : \u03b28 = \u03b29 = 0, and a test of lack of fit for the simple product\ninteraction with x1 is h0 : \u03b210 = \u03b211 = 0.\nlarger number of parameters to be estimated, is based on modeling the x1 \u00d7\nx2 \u00d7 y relationship with a smooth three-dimensional surface. a cubic spline\nsurface can be constructed by covering the x1 \u2212 x2 plane with a grid and\n\na general way to model and test interactions, although one requiring a\n\nfitting a patch-wise cubic polynomial in two variables. the grid is (ui, vj), i =\n1, . . . , k, j = 1, . . . , k, where knots for x1 are (u1, . . . , uk) and knots for x2\nare (v1, . . . , vk). the number of parameters can be reduced by constraining\nthe surface to be of the form ax1 + bx2 + cx1x2 in the lower left and\nupper right corners of the plane. the resulting restricted cubic spline surface\nis described by a multiple regression model containing spline expansions in\nx1 and x2 and all cross-products of the restricted cubic spline components\n(cid:2)\n(e.g., x1x\n2). if the same number of knots k is used for both predictors,\nthe number of interaction terms is (k \u2212 1)2. examples of various ways of\nmodeling interaction are given in chapter 10. spline functions made up of\ncross-products of all terms of individual spline functions are called tensor\nsplines.50, 274\n\nthe presence of more than two predictors increases the complexity of tests\nfor interactions because of the number of two-way interactions and because\nof the possibility of interaction effects of order higher than two. for example,\nin a model containing age, sex, and diabetes, the important interaction could\nbe that older male diabetics have an exaggerated risk. however, higher-order\ninteractions are often ignored unless specified a priori based on knowledge of\nthe subject matter. indeed, the number of two-way interactions alone is often\ntoo large to allow testing them all with reasonable power while controlling\nmultiple comparison problems. often, the only two-way interactions we can\nafford to test are those that were thought to be important before examining\nthe data. a good approach is to test for all such pre-specified interaction\neffects with a single global (pooled) test. then, unless interactions involving\nonly one of the predictors are of special interest, one can either drop all\ninteractions or retain all of them.\n\n11\n\n "}, {"Page_number": 63, "text": "38\n\n2 general aspects of fitting regression models\n\nfor some problems a reasonable approach is, for each predictor separately,\nto test simultaneously the joint importance of all interactions involving that\npredictor. for p predictors this results in p tests each with p \u2212 1 degrees\nof freedom. the multiple comparison problem would then be reduced from\np(p \u2212 1)/2 tests (if all two-way interactions were tested individually) to p\ntests.\n\nin the fields of biostatistics and epidemiology, some types of interactions\nthat have consistently been found to be important in predicting outcomes\nand thus may be pre-specified are the following.\n\n1. interactions between treatment and the severity of disease being treated.\n\npatients with little disease can receive little benefit.\n\n2. interactions involving age and risk factors. older subjects are generally\nless affected by risk factors. they had to have been robust to survive to\ntheir current age with risk factors present.\n\n3. interactions involving age and type of disease. some diseases are incurable\nand have the same prognosis regardless of age. others are treatable or\nhave less effect on younger patients.\n\n4. interactions between a measurement and the state of a subject during a\nmeasurement. respiration rate measured during sleep may have greater\npredictive value and thus have a steeper slope versus outcome than res-\npiration rate measured during activity.\n\n5. interaction between menopausal status and treatment or risk factors.\n6. interactions between race and disease.\n7. interactions between calendar time and treatment. some treatments have\n\nlearning curves causing secular trends in the associations.\n\n8. interactions between month of the year and other predictors, due to sea-\n\n9. interaction between the quality and quantity of a symptom, for example,\n\nsonal effects.\ndaily frequency of chest pain \u00d7 severity of a typical pain episode.\n\n12\n\n10. interactions between study center and treatment.\n\n2.7.3 fitting ordinal predictors\n\nfor the case of an ordinal predictor, spline functions are not useful unless\nthere are so many categories that in essence the variable is continuous. when\nthe number of categories k is small (three to five, say), the variable is usu-\nally modeled as a polytomous factor using indicator variables or equivalently\nas one linear term and k \u2212 2 indicators. the latter coding facilitates testing\nfor linearity. for more categories, it may be reasonable to stratify the data\nby levels of the variable and to compute summary statistics (e.g., logit pro-\nportions for a logistic model) or to examine regression coefficients associated\nwith indicator variables over categories. then one can attempt to summarize\nthe pattern with a linear or some other simple trend. later hypothesis tests\n\n "}, {"Page_number": 64, "text": "2.7 assessment of model fit\n\n39\n\nmust take into account this data-driven scoring (by using > 1 d.f., for exam-\nple), but the scoring can save degrees of freedom when testing for interaction\nwith other factors. in one dataset, the number of comorbid diseases was used\nto summarize the risk of a set of diseases that was too large to model. by\nplotting the logit of the proportion of deaths versus the number of diseases,\nit was clear that the square of the number of diseases would properly score\nthe variables.\nsometimes it is useful to code an ordinal predictor with k \u2212 1 indicator\nvariables of the form [x \u2265 vj], where j = 2, . . . , k and [h] is 1 if h is true,\n0 otherwise.648 although a test of linearity does not arise immediately from\nthis coding, the regression coefficients are interpreted as amounts of change\nfrom the previous category. a test of whether the last m categories can be\ncombined with the category k \u2212 m does follow easily from this coding.\n\n2.7.4 distributional assumptions\nthe general linear regression model is stated as c(y |x) = x\u03b2 to highlight its\nregression assumptions. for logistic regression models for binary or nominal\nresponses, there is no distributional assumption if simple random sampling\nis used and subjects\u2019 responses are independent. that is, the binary logistic\nmodel and all of its assumptions are contained in the expression logit{y =\n1|x} = x\u03b2. for ordinary multiple regression with constant variance \u03c32, we\nusually assume that y \u2212x\u03b2 is normally distributed with mean 0 and variance\n\u03c32. this assumption can be checked by estimating \u03b2 with \u02c6\u03b2 and plotting the\noverall distribution of the residuals y \u2212 x \u02c6\u03b2, the residuals against \u02c6y , and the\nresiduals against each x. for the latter two, the residuals should be normally\ndistributed within each neighborhood of \u02c6y or x. a weaker requirement is that\nthe overall distribution of residuals is normal; this will be satisfied if all of the\nstratified residual distributions are normal. note a hidden assumption in both\nmodels, namely, that there are no omitted predictors. other models, such as\nthe weibull survival model or the cox132 proportional hazards model, also\nhave distributional assumptions that are not fully specified by c(y |x) = x\u03b2.\nhowever, regression and distributional assumptions of some of these models\nare encapsulated by\n\nc(y |x) = c(y = y|x) = d(y) + x\u03b2\n\n(2.39)\nfor some choice of c. here c(y = y|x) is a property of the response y\nevaluated at y = y, given the predictor values x, and d(y) is a component of\nthe distribution of y . for the cox proportional hazards model, c(y = y|x)\ncan be written as the log of the hazard of the event at time y, or equivalently\nas the log of the \u2212 log of the survival probability at time y, and d(y) can be\nthought of as a log hazard function for a \u201cstandard\u201d subject.\n\n "}, {"Page_number": 65, "text": "40\n\n2 general aspects of fitting regression models\n\nif we evaluated the property c(y = y|x) at predictor values x 1 and x 2,\n\nthe difference in properties is\n\nc(y = y|x 1) \u2212 c(y = y|x 2) = d(y) + x 1\u03b2\n\u2212 [d(y) + x 2\u03b2]\n= (x 1 \u2212 x 2)\u03b2,\n\n(2.40)\n\nwhich is independent of y. one way to verify part of the distributional as-\nsumption is to estimate c(y = y|x 1) and c(y = y|x 2) for set values of\nx 1 and x 2 using a method that does not make the assumption, and to plot\nc(y = y|x 1) \u2212 c(y = y|x 2) versus y. this function should be flat if the\ndistributional assumption holds. the assumption can be tested formally if\nd(y) can be generalized to be a function of x as well as y. a test of whether\nd(y|x) depends on x is a test of one part of the distributional assumption.\nfor example, writing d(y|x) = d(y) + x\u03b3 log(y) where\n\nx\u03b3 = \u03b31x1 + \u03b32x2 + . . . + \u03b3kxk\n\n(2.41)\n\nand testing h0 : \u03b31 = . . . = \u03b3k = 0 is one way to test whether d(y|x) de-\n\npends on x. for semiparametric models such as the cox proportional hazards\nmodel, the only distributional assumption is the one stated above, namely,\nthat the difference in properties between two subjects depends only on the dif-\nference in the predictors between the two subjects. other, parametric, models\nassume in addition that the property c(y = y|x) has a specific shape as a\nfunction of y, that is that d(y) has a specific functional form. for example,\nthe weibull survival model has a specific assumption regarding the shape of\nthe hazard or survival distribution as a function of y.\n\nassessments of distributional assumptions are best understood by applying\n\nthese methods to individual models as is demonstrated in later chapters.\n\n2.8 further reading\n\n1\n2\n3\n\n4\n5\n\nreferences [152, 575, 578] have more information about cubic splines.\nsee smith578 for a good overview of spline functions.\nmore material about natural splines may be found in de boor152. mcneil et al.451\ndiscuss the overall smoothness of natural splines in terms of the integral of the\nsquare of the second derivative of the regression function, over the range of\nthe data. govindarajulu et al.230 compared restricted cubic splines, penalized\nsplines, and fractional polynomial532 fits and found that the first two methods\nagreed with each other more than with estimated fractional polynomials.\na tutorial on restricted cubic splines is in [271].\ndurrleman and simon168 provide examples in which knots are allowed to be\nestimated as free parameters, jointly with the regression coefficients. they found\nthat even though the \u201coptimal\u201d knots were often far from a priori knot locations,\nthe model fits were virtually identical.\n\n "}, {"Page_number": 66, "text": "2.8 further reading\n\n41\n\n6\n\n7\n\n8\n\n9\n10\n\ncontrast hastie and tibshirani\u2019s generalized nonparametric additive models275\nwith stone and koo\u2019s595 additive model in which each continuous predictor is\nrepresented with a restricted cubic spline function.\ngray237, 238 provided some comparisons with ordinary regression splines, but he\ncompared penalized regression splines with non-restricted splines with only two\nknots. two knots were chosen so as to limit the degrees of freedom needed by the\nregression spline method to a reasonable number. gray argued that regression\nsplines are sensitive to knot locations, and he is correct when only two knots\nare allowed and no linear tail restrictions are imposed. two knots also prevent\nthe (ordinary maximum likelihood) fit from utilizing some local behavior of\nthe regression relationship. for penalized likelihood estimation using b-splines,\ngray238 provided extensive simulation studies of type i and ii error for testing\nassociation in which the true regression function, number of knots, and amount\nof likelihood penalization were varied. he studied both normal regression and\ncox regression.\nbreiman et al.\u2019s original cart method69 used the gini criterion for splitting.\nlater work has used log-likelihoods.109 segal,562 leblanc and crowley,389 and\nciampi et al.107, 108 and kele\u00b8s and segal342have extended recursive partitioning\nto censored survival data using the log-rank statistic as the criterion. zhang682\nextended tree models to handle multivariate binary responses. schmoor et al.556\nused a more general splitting criterion that is useful in therapeutic trials, namely,\na cox test for main and interacting effects. davis and anderson149 used an\nexponential survival model as the basis for tree construction. ahn and loh7\ndeveloped a cox proportional hazards model adaptation of recursive partition-\ning along with bootstrap and cross-validation-based methods to protect against\n\u201cover-splitting.\u201d the cox-based regression tree methods of ciampi et al.107 have\na unique feature that allows for construction of \u201ctreatment interaction trees\u201d\nwith hierarchical adjustment for baseline variables. zhang et al.683 provided a\nnew method for handling missing predictor values that is simpler than using\nsurrogate splits. see [34, 140, 270, 629] for examples using recursive partitioning\nfor binary responses in which the prediction trees did not validate well.\n443, 629 discuss other problems with tree models.\nfor ordinary linear models, the regression estimates are the same as obtained\nwith separate fits, but standard errors are different (since a pooled standard\nerror is used for the combined fit). for cox132 regression, separate fits can be\nslightly different since each subset would use a separate ranking of y .\n\n11 gray\u2019s penalized fixed-knot regression splines can be useful for estimating joint\neffects of two continuous variables while allowing the analyst to control the\neffective number of degrees of freedom in the fit [237, 238, section 3.2]. when\ny is a non-censored variable, the local regression model of cleveland et al.,96\na multidimensional scatterplot smoother mentioned in section 2.4.7, provides a\ngood graphical assessment of the joint effects of several predictors so that the\nforms of interactions can be chosen. see wang et al.653 and gustafson248 for\nseveral other flexible approaches to analyzing interactions among continuous\nvariables.\nstudy site by treatment interaction is often the interaction that is worried about\nthe most in multi-center randomized clinical trials, because regulatory agencies\nare concerned with consistency of treatment effects over study centers. however,\nthis type of interaction is usually the weakest and is difficult to assess when\nthere are many centers due to the number of interaction parameters to estimate.\nschemper545 discusses various types of interactions and a general nonparametric\ntest for interaction.\n\n12\n\n "}, {"Page_number": 67, "text": "42\n\n2 general aspects of fitting regression models\n\n2.9 problems\n\nfor problems 1 to 3, state each model statistically, identifying each predictor\nwith one or more component variables. identify and interpret each regression\nparameter except for coefficients of nonlinear terms in spline functions. state\neach hypothesis below as a formal statistical hypothesis involving the proper\nparameters, and give the (numerator) degrees of freedom of the test. state\nalternative hypotheses carefully with respect to unions or intersections of\nconditions and list the type of alternatives to the null hypothesis that the\ntest is designed to detect.c\n\n1. a property of y such as the mean is linear in age and blood pressure\nand there may be an interaction between the two predictors. test h0 :\nthere is no interaction between age and blood pressure. also test h0 :\nblood pressure is not associated with y (in any fashion). state the effect\nof blood pressure as a function of age, and the effect of age as a function\nof blood pressure.\n\n2. consider a linear additive model involving three treatments (control, drug\nz, and drug q) and one continuous adjustment variable, age. test h0 :\ntreatment group is not associated with response, adjusted for age. also\ntest h0 : response for drug z has the same property as the response for\ndrug q, adjusted for age.\n\n3. consider models each with two predictors, temperature and white blood\ncount (wbc), for which temperature is always assumed to be linearly\nrelated to the appropriate property of the response, and wbc may or\nmay not be linear (depending on the particular model you formulate for\neach question). test:\n\na. h0 : wbc is not associated with the response versus ha : wbc is\n\nlinearly associated with the property of the response.\n\nb. h0 : wbc is not associated with y versus ha : wbc is quadratically\nassociated with y . also write down the formal test of linearity against\nthis quadratic alternative.\n\nc. h0 : wbc is not associated with y versus ha : wbc related to the\nproperty of the response through a smooth spline function; for example,\n(cid:2)(cid:2)\nfor wbc the model requires the variables wbc, wbc\n(cid:2)\nwhere wbc\nrepresent nonlinear components (if there are\nfour knots in a restricted cubic spline function). also write down the\nformal test of linearity against this spline function alternative.\n\n, and wbc\n\nand wbc\n\n(cid:2)(cid:2)\n\n(cid:2)\n\nd. test for a lack of fit (combined nonlinearity or non-additivity) in an\noverall model that takes the form of an interaction between temperature\nand wbc, allowing wbc to be modeled with a smooth spline function.\n\n4. for a fitted model y = a + bx + cx 2 derive the estimate of the effect on\n\ny of changing x from x1 to x2.\n\nc in other words, under what assumptions does the test have maximum power?\n\n "}, {"Page_number": 68, "text": "2.9 problems\n\n43\n\n5. in \u201cthe class of 1988: a statistical portrait,\u201d the college board reported\nmean sat scores for each state. use an ordinary least squares multiple\nregression model to study the mean verbal sat score as a function of the\npercentage of students taking the test in each state. provide plots of fitted\nfunctions and defend your choice of the \u201cbest\u201d fit. make sure the shape of\nthe chosen fit agrees with what you know about the variables. add the\nraw data points to plots.\n\na. fit a linear spline function with a knot at x = 50%. plot the data\nand the fitted function and do a formal test for linearity and a test\nfor association between x and y . give a detailed interpretation of the\nestimated coefficients in the linear spline model, and use the partial\nt-test to test linearity in this model.\n\nb. fit a restricted cubic spline function with knots at x = 6, 12, 58, and\n68% (not percentile).d plot the fitted function and do a formal test of\nassociation between x and y . do two tests of linearity that test the\nsame hypothesis:\ni. by using a contrast to simultaneously test the correct set of coeffi-\n\ncients against zero (done by the anova function in rms);e\n\nii. by comparing the r2 from the complex model with that from a simple\n\nlinear model using a partial f -test.\n\nexplain why the tests of linearity have the d.f. they have.\n\nc. using subject matter knowledge, pick a final model (from among the\n\nprevious models or using another one) that makes sense.\n\nthe data are found in table 2.4 and may be created in r using the sat.r\ncode on the rms course web site.\n\nwithout cubing or squaring any terms.\n\n6. derive the formulas for the restricted cubic spline component variables\n7. prove that each component variable is linear in x when x \u2265 tk, the\nlast knot, using general principles and not algebra or calculus. derive an\nexpression for the restricted spline regression function when x \u2265 tk.\n8. consider a two\u2013stage procedure in which one tests for linearity of the effect\nof a predictor x on a property of the response c(y |x) against a quadratic\nalternative. if the two\u2013tailed test of linearity is significant at the \u03b1 level,\na two d.f. test of association between x and y is done. if the test for\nlinearity is not significant, the square term is dropped and a linear model\nis fitted. the test of association between x and y is then (apparently) a\none d.f. test.\n\na. write a formal expression for the test statistic for association.\n\nd note: to pre-specify knots for restricted cubic spline functions, use something like\nrcs(predictor, c(t1,t2,t3,t4)), where the knot locations are t1, t2, t3, t4.\ne note that anova in rms computes all needed test statistics from a single model fit\nobject.\n\n "}, {"Page_number": 69, "text": "44\n\n2 general aspects of fitting regression models\n\nb. write an expression for the nominal p \u2013value for testing association\n\nusing this strategy.\n\nc. write an expression for the actual p \u2013value or alternatively for the type\u2013\n\ni error if using a fixed critical value for the test of association.\nd. for the same two\u2013stage strategy consider an estimate of the effect on\nc(y |x) of increasing x from a to b. write a brief symbolic algorithm\nfor deriving a true two\u2013sided 1\u2212 \u03b1 confidence interval for the b : a effect\n(difference in c(y )) using the bootstrap.\n\ntable 2.4 sat data from the college board, 1988\n\n% taking sat mean verbal % taking sat mean verbal\n\n(x)\n\nscore (y )\n\n4\n5\n5\n6\n6\n7\n9\n9\n10\n10\n10\n10\n12\n12\n13\n13\n14\n14\n14\n16\n17\n18\n20\n22\n23\n\n482\n498\n513\n498\n511\n479\n480\n483\n475\n476\n487\n494\n474\n478\n457\n485\n451\n471\n473\n467\n470\n464\n471\n455\n452\n\n(x)\n24\n29\n37\n43\n44\n45\n49\n50\n52\n55\n57\n58\n59\n60\n62\n63\n63\n63\n64\n64\n68\n69\n72\n73\n81\n\nscore (y )\n\n440\n460\n448\n441\n424\n417\n422\n441\n408\n412\n400\n401\n430\n433\n433\n404\n424\n430\n431\n437\n446\n424\n420\n432\n436\n\n "}, {"Page_number": 70, "text": "chapter 3\nmissing data\n\n3.1 types of missing data\n\nthere are missing data in the majority of datasets one is likely to encounter.\nbefore discussing some of the problems of analyzing data in which some\nvariables are missing for some subjects, we define some nomenclature.\n\n1\n\nmissing completely at random (mcar)\n\ndata are missing for reasons that are unrelated to any characteristics or re-\nsponses for the subject, including the value of the missing value, were it to\nbe known. examples include missing laboratory measurements because of a\ndropped test tube (if it was not dropped because of knowledge of any mea-\nsurements), a study that ran out of funds before some subjects could return\nfor follow-up visits, and a survey in which a subject omitted her response to\na question for reasons unrelated to the response she would have made or to\nany other of her characteristics.\n\nmissing at random (mar)\n\ndata are not missing at random, but the probability that a value is missing\ndepends on values of variables that were actually measured. as an example,\nconsider a survey in which females are less likely to provide their personal\nincome in general (but the likelihood of responding is independent of her\nactual income). if we know the sex of every subject and have income levels\nfor some of the females, unbiased sex-specific income estimates can be made.\nthat is because the incomes we do have for some of the females are a random\nsample of all females\u2019 incomes. another way of saying that a variable is mar\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 3\n\n45\n\n "}, {"Page_number": 71, "text": "46\n\n3 missing data\n\nis that given the values of other available variables, subjects having missing\nvalues are only randomly different from other subjects.535 or to paraphrase\ngreenland and finkle,242 for mar the missingness of a covariable cannot\ndepend on unobserved covariable values; for example whether a predictor is\nobserved cannot depend on another predictor when the latter is missing but\nit can depend on the latter when it is observed. mar and mcar data are\nalso called ignorable non-responses.\n\ninformative missing (im)\n\nthe tendency for a variable to be missing is a function of data that are not\navailable, including the case when data tend to be missing if their true values\nare systematically higher or lower. an example is when subjects with lower\nincome levels or very high incomes are less likely to provide their personal in-\ncome in an interview. im is also called nonignorable non-response and missing\nnot at random (mnar).\n\nim is the most difficult type of missing data to handle. in many cases, there\nis no fix for im nor is there a way to use the data to test for the existence of\nim. external considerations must dictate the choice of missing data models,\nand there are few clues for specifying a model under im. mcar is the easiest\ncase to handle. our ability to correctly analyze mar data depends on the\navailability of other variables (the sex of the subject in the example above).\nmost of the methods available for dealing with missing data assume the data\nare mar. fortunately, even though the mar assumption is not testable, it\nmay hold approximately if enough variables are included in the imputation\nmodels256.\n\n3.2 prelude to modeling\n\nno matter whether one deletes incomplete cases, carefully imputes (esti-\nmates) missing data, or uses a full maximum likelihood or bayesian tech-\nniques to incorporate partial data, it is beneficial to characterize patterns\nof missingness using exploratory data analysis techniques. these techniques\ninclude binary logistic models and recursive partitioning for predicting the\nprobability that a given variable is missing. patterns of missingness should be\nreported to help readers understand the limitations of incomplete data. if you\ndo decide to use imputation, it is also important to describe how variables are\nsimultaneously missing. a cluster analysis of missing value status of all the\nvariables is useful here. this can uncover cases where imputation is not as ef-\nfective. for example, if the only variable moderately related to diastolic blood\npressure is systolic pressure, but both pressures are missing on the same sub-\njects, systolic pressure cannot be used to estimate diastolic blood pressure. r\n\n "}, {"Page_number": 72, "text": "3.4 problems with simple alternatives to imputation\n\n47\n\nfunctions naclus and naplot in the hmisc package (see p. 142) can help detect\nhow variables are simultaneously missing. recursive partitioning (regression\ntree) algorithms (see section 2.5) are invaluable for describing which kinds of\nsubjects are missing on a variable. logistic regression is also an excellent tool\nfor this purpose. a later example (p. 302) demonstrates these procedures.\n\nit can also be helpful to explore the distribution of non-missing y by the\nnumber of missing variables in x (including zero, i.e., complete cases on x).\n\n3.3 missing values for different types\n\nof response variables\n\nwhen the response variable y is collected serially but some subjects drop out\nof the study before completion, there are many ways of dealing with partial\ninformation42, 412, 480 including multiple imputation in phases,381 or efficiently\nanalyzing all available serial data using a full likelihood model. when y is the\ntime until an event, there are actually no missing values of y but follow-up\nwill be curtailed for some subjects. that leaves the case where the response\nis completely measured once.\n\nit is common practice to discard subjects having missing y . before doing\nso, at minimum an analysis should be done to characterize the tendency\nfor y to be missing, as just described. for example, logistic regression or\nrecursive partitioning can be used to predict whether y is missing and to\ntest for systematic tendencies as opposed to y being missing completely at\nrandom. in many models, though, more efficient and less biased estimates of\nregression coefficients can be made by also utilizing observations missing on\ny that are non-missing on x. hence there is a definite place for imputation\nof y . von hippel645 found advantages of using all variables to impute all\nothers, and once imputation is finished, discarding those observations having\nmissing y . however if missing y values are mcar, up-front deletion of cases\nhaving missing y may sometimes be preferred, as imputation requires correct\nspecification of the imputation model.\n\n2\n\n3.4 problems with simple alternatives\n\nto imputation\n\nincomplete predictor information is a very common missing data problem.\nstatistical software packages use casewise deletion in handling missing predic-\ntors; that is, any subject having any predictor or y missing will be excluded\nfrom a regression analysis. casewise deletion results in regression coefficient\nestimates that can be terribly biased, imprecise, or both353. first consider an\nexample where bias is the problem. suppose that the response is death and\n\n "}, {"Page_number": 73, "text": "48\n\n3 missing data\n\nthe predictors are age, sex, and blood pressure, and that age and sex were\nrecorded for every subject. suppose that blood pressure was not measured\nfor a fraction of 0.10 of the subjects, and the most common reason for not\nobtaining a blood pressure was that the subject was about to die. deletion\nof these very sick patients will cause a major bias (downward) in the model\u2019s\nintercept parameter. in general, casewise deletion will bias the estimate of\nthe model\u2019s intercept parameter (as well as others) when the probability of\na case being incomplete is related to y and not just to x [422, example\n3.3]. van der heijden et al.628 discuss how complete case analysis (casewise\ndeletion) usually assumes mcar.\n\nnow consider an example in which casewise deletion of incomplete records\nis inefficient. the inefficiency comes from the reduction of sample size, which\ncauses standard errors to increase,162 confidence intervals to widen, and power\nof tests of association and tests of lack of fit to decrease. suppose that the\nresponse is the presence of coronary artery disease and the predictors are\nage, sex, ldl cholesterol, hdl cholesterol, blood pressure, triglyceride, and\nsmoking status. suppose that age, sex, and smoking are recorded for all sub-\njects, but that ldl is missing in 0.18 of the subjects, hdl is missing in 0.20,\nand triglyceride is missing in 0.21. assume that all missing data are mcar\nand that all of the subjects missing ldl are also missing hdl and that\noverall 0.28 of the subjects have one or more predictors missing and hence\nwould be excluded from the analysis. if total cholesterol were known on every\nsubject, even though it does not appear in the model, it (along perhaps with\nage and sex) can be used to estimate (impute) ldl and hdl cholesterol and\ntriglyceride, perhaps using regression equations from other studies. doing the\nanalysis on a \u201cfilled in\u201d dataset will result in more precise estimates because\nthe sample size would then include the other 0.28 of the subjects.\n\nin general, observations should only be discarded if the mcar assump-\ntion is justified, there is a rarely missing predictor of overriding importance\nthat cannot be reliably imputed from other information, or if the fraction of\nobservations excluded is very small and the original sample size is large. even\nthen, there is no advantage of such deletion other than saving analyst time.\nif a predictor is mar but its missingness depends on y , casewise deletion is\nbiased.\n\nthe first blood pressure example points out why it can be dangerous to\nhandle missing values by adding a dummy variable to the model. many ana-\nlysts would set missing blood pressures to a constant (it doesn\u2019t matter which\nconstant) and add a variable to the model such as is.na(blood.pressure) in\nr notation. the coefficient for the latter dummy variable will be quite large\nin the earlier example, and the model will appear to have great ability to\npredict death. this is because some of the left-hand side of the model con-\ntaminates the right-hand side; that is, is.na(blood.pressure) is correlated\nwith death. for categorical variables, another common practice is to add a\nnew category to denote missing, adding one more degree of freedom to the\n\n3\n\n4\n\n "}, {"Page_number": 74, "text": "3.5 strategies for developing an imputation model\n\n49\n\npredictor and changing its meaning.a jones326, allison [12, pp. 9\u201311], don-\nders et al.161, knol et al.353 and van der heijden et al.628 describe why both\nof these missing-indicator methods are invalid even when mcar holds.\n\n5\n\n3.5 strategies for developing an imputation model\n\nexcept in special circumstances that usually involve only very simple models,\nthe primary alternative to deleting incomplete observations is imputation of\nthe missing values. many non-statisticians find the notion of estimating data\ndistasteful, but the way to think about imputation of missing values is that\n\u201cmaking up\u201d data is better than discarding valuable data. it is especially dis-\ntressing to have to delete subjects who are missing on an adjustment variable\nwhen a major variable of interest is not missing. so one goal of imputation\nis to use as much information as possible for examining any one predictor\u2019s\nadjusted association with y . the overall goal of imputation is to preserve the\ninformation and meaning of the non-missing data.\n\nat this point the analyst must make some decisions about the information\n\nto use in computing predicted values for missing values.\n\n1. imputation of missing values for one of the variables can ignore all other\ninformation. missing values can be filled in by sampling non-missing values\nof the variable, or by using a constant such as the median or mean non-\nmissing value.\n\n2. imputation algorithms can be based only on external information not oth-\nerwise used in the model for y in addition to variables included in later\nmodeling. for example, family income can be imputed on the basis of loca-\ntion of residence when such information is to remain confidential for other\naspects of the analysis or when such information would require too many\ndegrees of freedom to be spent in the ultimate response model.\n\n3. imputations can be derived by only analyzing interrelationships among\n\nthe xs.\n\n4. imputations can use relationships among the xs and between x and y .\n5. imputations can use x, y , and auxiliary variables not in the model\n\npredicting y .\n\n6. imputations can take into account the reason for non-response if known.\n\nthe model to estimate the missing values in a sometimes-missing (target)\nvariable should include all variables that are either\n\na this may work if values are \u201cmissing\u201d because of \u201cnot applicable\u201d, e.g. one has a\nmeasure of marital happiness, dichotomized as high or low, but the sample contains\nsome unmarried people. one could have a 3-category variable with values high, low,\nand unmarried (paul allison, impute e-mail list, 4jul09).\n\n "}, {"Page_number": 75, "text": "50\n\n3 missing data\n\n1. related to the missing data mechanism;\n2. have distributions that differ between subjects that have the target variable\n\nmissing and those that have it measured;\n\n3. are associated with the target variable when it is not missing; or\n4. are included in the final response model43.\n\nthe imputation and analysis (response) models should be \u201ccongenial\u201d or the\nimputation model should be more general than the response model or make\nwell-founded assumptions256.\n\nwhen a variable, say xj, is to be included as a predictor of y , and xj\nis sometimes missing, ignoring the relationship between xj and y for those\nobservations for which both are known will bias regression coefficients for\nxj toward zero in the outcome model.421 on the other hand, using y to\nsingly impute xj using a conditional mean will cause a large inflation in\nthe apparent importance of xj in the final model. in other words, when the\nmissing xj are replaced with a mean that is conditional on y without a\nrandom component, this will result in a falsely strong relationship between\nthe imputed xj values and y .\n\nat first glance it might seem that using y to impute one or more of the xs,\neven with allowance for the correct amount of random variation, would result\nin a circular analysis in which the importance of the xs will be exaggerated.\nbut the relationship between x and y in the subset of imputed observations\nwill only be as strong as the associations between x and y that are evidenced\nby the non-missing data. in other words, regression coefficients estimated\nfrom a dataset that is completed by imputation will not in general be biased\nhigh as long as the imputed values have similar variation as non-missing data\nvalues.\n\nthe next important decision about developing imputation algorithms is\n\nthe choice of how missing values are estimated.\n\n1. missings can be estimated using single \u201cbest guesses\u201d (e.g., predicted con-\nditional expected values or means) based on relationships between non-\nmissing values. this is called single imputation of conditional means.\n\n2. missing xj (or y ) can be estimated using single individual predicted val-\nues, where by predicted value we mean a random variable value from the\nwhole conditional distribution of xj. if one uses ordinary multiple regres-\nsion to estimate xj from y and the other xs, a random residual would\nbe added to the predicted mean value. if assuming a normal distribution\nfor xj conditional on the other data, such a residual could be computed\nby a gaussian random number generator given an estimate of the residual\nstandard deviation. if normality is not assumed, the residual could be a\nrandomly chosen residual from the actual computed residuals. when m\nmissing values need imputation for xj, the residuals could be sampled\nwith replacement from the entire vector of residuals as in the bootstrap.\nbetter still according to rubin and schenker535 would be to use the \u201cap-\nproximate bayesian bootstrap\u201d which involves sampling n residuals with\n\n "}, {"Page_number": 76, "text": "6\n\n7\n\n3.5 strategies for developing an imputation model\n\n51\n\nreplacement from the original n estimated residuals (from observations not\nmissing on xj), then sampling m residuals with replacement from the first\nsampled set.\n\n3. more than one random predicted value (as just defined) can be generated\nfor each missing value. this process is called multiple imputation and it\nhas many advantages over the other methods in general. this is discussed\nin section 3.8.\n\n4. matching methods can be used to obtain random draws of other subject\u2019s\nvalues to replace missing values. nearest neighbor matching can be used\nto select a subject that is \u201cclose\u201d to the subject in need of imputation,\non the basis of a series of variables. this method requires the analyst to\nmake decisions about what constitutes \u201ccloseness.\u201d to simplify the match-\ning process into a single dimension, little420 proposed the predictive mean\nmatching method where matching is done on the basis of predicted values\nfrom a regression model for predicting the sometimes-missing variable (sec-\ntion 3.7). according to little, in large samples predictive mean matching\nmay be more robust to model misspecification than the method of adding\na random residual to the subject\u2019s predicted value, but because of diffi-\nculties in finding matches the random residual method may be better in\nsmaller samples. the random residual method may be easier to use when\nmultiple imputations are needed, but care must be taken to create the\ncorrect degree of uncertainty in residuals.\n\nwhat if xj needs to be imputed for some subjects based on other variables\nthat themselves may be missing on the same subjects missing on xj? this is\na place where recursive partitioning with \u201csurrogate splits\u201d in case of missing\npredictors may be a good method for developing imputations (see section 2.5\nand p. 142). if using regression to estimate missing values, an algorithm\nto cycle through all sometimes-missing variables for multiple iterations may\nperform well. this algorithm is used by the r transcan function described\nin section 4.7.4 as well as the to\u2013be\u2013described aregimpute function. first, all\nmissing values are initialized to medians (modes for categorical variables).\nthen every time missing values are estimated for a certain variable, those\nestimates are inserted the next time the variable is used to predict other\nsometimes-missing variables.\n\nif you want to assess the importance of a specific predictor that is fre-\nquently missing, it is a good idea to perform a sensitivity analysis in which\nall observations containing imputed values for that predictor are temporarily\ndeleted. the test based on a model that included the imputed values may be\ndiluted by the imputation or it may test the wrong hypothesis, especially if\ny is not used in imputing x.\n\nlittle argues for down-weighting observations containing imputations, to\nobtain a more accurate variance\u2013covariance matrix. for the ordinary linear\nmodel, the weights have been worked out for some cases [421, p. 1231].\n\n "}, {"Page_number": 77, "text": "52\n\n3 missing data\n\n3.6 single conditional mean imputation\n\nfor a continuous or binary x that is unrelated to all other predictor vari-\nables, the mean or median may be substituted for missing values without\nmuch loss of efficiency,162 although regression coefficients will be biased low\nsince y was not utilized in the imputation. when the variable of interest\nis related to the other xs, it is far more efficient to use an individual pre-\ndictive model for each x based on the other variables.79, 525, 612 the \u201cbest\nguess\u201d imputation method fills in missings with predicted expected values\nusing the multivariable imputation model based on non-missing datab. it is\ntrue that conditional means are the best estimates of unknown values, but\nexcept perhaps for binary logistic regression621, 623 their use will result in bi-\nased estimates and very biased (low) variance estimates. the latter problem\narises from the reduced variability of imputed values [174, p. 464].\n\ntree-based models (section 2.5) may be very useful for imputation since\nthey do not require linearity or additivity assumptions, although such models\noften have poor discrimination when they don\u2019t overfit. when a continuous\nx being imputed needs to be non-monotonically transformed to best relate\nit to the other xs (e.g., blood pressure vs. heart rate), trees and ordinary\nregression are inadequate. here a general transformation modeling procedure\n(section 4.7) may be needed.\n\nschemper et al.551, 553 proposed imputing missing binary covariables by\npredicted probabilities. for categorical sometimes-missing variables, imputa-\ntion models can be derived using polytomous logistic regression or a classifi-\ncation tree method. for missing values, the most likely value for each subject\n(from the series of predicted probabilities from the logistic or recursive par-\ntitioning model) can be substituted to avoid creating a new category that is\nfalsely highly correlated with y . for an ordinal x, the predicted mean value\n(possibly rounded to the nearest actual data value) or median value from an\nordinal logistic model is sometimes useful.\n\n3.7 predictive mean matching\n\nin predictive mean matching 422 (pmm), one replaces a missing (na) value\nfor the target variable being imputed with the actual value from a donor\nobservation. donors are identified by matching in only one dimension, namely\nthe predicted value (e.g., predicted mean) of the target. key considerations\nare how to\n\nb predictors of the target variable include all the other xs along with auxiliary\nvariables that are not included in the final outcome model, as long as they precede\nthe variable being imputed in the causal chain (unlike with multiple imputation).\n\n8\n\n "}, {"Page_number": 78, "text": "3.8 multiple imputation\n\n53\n\n1. model the target when it is not na\n2. match donors on predicted values\n3. avoid overuse of \u201cgood\u201d donors to disallow excessive ties in imputed data\n4. account for all uncertainties (section 3.8).\n\nthe predictive model for each target variable uses any outcome variables, all\npredictors in the final outcome model, plus any needed auxiliary variables.\nthe modeling method should be flexible, not assuming linearity. many meth-\nods will suffice; parametric additive models are often good choices. beauties\nof pmm include the lack of need for distributional assumptions (as no resid-\nuals are calculated), and predicted values need only be monotonically related\nto real predicted valuesc\n\nin the original pmm method the donor for an na was the complete obser-\nvation whose predicted target was closest to the predicted value of the target\nfrom all complete observationsd. this approach can result in some donors\nbeing used repeatedly. this can be addressed by sampling from a multino-\nmial distribution, where the probabilities are scaled distances of all potential\nof the missing target. tukey\u2019s\ndonors\u2019 predictions to the predicted value y\ntricube function (used in loess) is a good weighting function, implemented in\nthe hmisc aregimpute function:\n\n\u2217\n\nwi = (1 \u2212 min(di/s, 1)3)3,\ndi\ns = 0.2 \u00d7 mean| \u02c6yi \u2212 y\n\n= | \u02c6yi \u2212 y\n\n\u2217|.\n\n\u2217|\n\ns above is a good default scale factor, and the wi are scaled so that\n\n(cid:2)\n\n(3.1)\n\nwi = 1.\n\n3.8 multiple imputation\n\nimputing missing values and then doing an ordinary analysis as if the imputed\nvalues were real measurements is usually better than excluding subjects with\nincomplete data. however, ordinary formulas for standard errors and other\nstatistics are invalid unless imputation is taken into account.651 methods for\nproperly accounting for having incomplete data can be complex. the boot-\nstrap (described later) is an easy method to implement, but the computations\ncan be slowe.\n\nc thus when modeling binary or categorical targets one can frequently take least\nsquares shortcuts in place of maximum likelihood for binary, ordinal, or multinomial\nlogistic models.\nd 662 discusses an alternative method based on choosing a donor observation at\nrandom from the q closest matches (q = 3, for example).\ne to use the bootstrap to correctly estimate variances of regression coefficients, one\nmust repeat the imputation process and the model fitting perhaps 100 times using a\n\n "}, {"Page_number": 79, "text": "9\n\n10\n\n54\n\n3 missing data\n\nmultiple imputation uses random draws from the conditional distribu-\ntion of the target variable given the other variables (and any additional in-\nformation that is relevant)85, 417, 421, 536. the additional information used to\npredict the missing values can contain any variables that are potentially pre-\ndictive, including variables measured in the future; the causal chain is not\nrelevant.421, 463 when a regression model is used for imputation, the process\ninvolves adding a random residual to the \u201cbest guess\u201d for missing values, to\nyield the same conditional variance as the original variable. methods for esti-\nmating residuals were listed in section 3.5. to properly account for variability\ndue to unknown values, the imputation is repeated m times, where m \u2265 3.\neach repetition results in a \u201ccompleted\u201d dataset that is analyzed using the\nstandard method. parameter estimates are averaged over these multiple im-\nputations to obtain better estimates than those from single imputation. the\nvariance\u2013covariance matrix of the averaged parameter estimates, adjusted for\nvariability due to imputation, is estimated using422\n\nm(cid:3)\n\ni\n\n\u22121\n\nv = m\n\nvi +\n\nm + 1\n\nm\n\nb,\n\n(3.2)\n\nwhere vi is the ordinary complete data estimate of the variance\u2013covariance\nmatrix for the model parameters from the ith imputation, and b is the\nbetween-imputation sample variance\u2013covariance matrix, the diagonal entries\nof which are the ordinary sample variances of the m parameter estimates.\n\nafter running aregimpute (or mice) you can run the hmisc packages\u2019s\nfit.mult.impute function to fit the chosen model separately for each artificially\ncompleted dataset corresponding to each imputation. after fit.mult.impute\nfits all of the models, it averages the sets of regression coefficients and com-\nputes variance and covariance estimates that are adjusted for imputation\n(using eq. 3.2).\n\nwhite and royston661 provide a method for multiply imputing missing\ncovariate values using censored survival time data in the context of the cox\nproportional hazards model.\n\nwhite et al.662 recommend choosing the number of imputations m so\nthat the key inferential statistics are very reproducible should the imputation\nanalysis be repeated. they suggest the use of 100f imputations when f is\nthe fraction of cases that are incomplete. see also [85, section 2.7] and232.\nextreme amount of missing data does not prevent one from using multiple\nimputation, because alternatives are worse321. horton and lipsitz302 also\nhave a good overview of multiple imputation and a review of several software\npackages that implement pmm.\n\ncaution: multiple imputation methods can generate imputations hav-\ning very reasonable distributions but still not having the property that final\n\nresampling procedure174, 566 (see section 5.2). still, the bootstrap can estimate the\nright variance for the wrong parameter estimates if the imputations are not done\ncorrectly.\n\n "}, {"Page_number": 80, "text": "3.8 multiple imputation\n\n55\n\nresponse model regression coefficients have nominal confidence interval cov-\nerage. among other things, it is worth checking that imputations generate\nthe correct collinearities among covariates.\n\n3.8.1 the aregimpute and other chained equations\n\napproaches\n\na flexible approach to multiple imputation that handles a wide variety of\ntarget variables to be imputed and allows for multiple variables to be miss-\ning on the same subject is the chained equation method. with a chained\nequations approach, each target variable is predicted by a regression model\nconditional on all other variables in the model, plus other variables. an it-\nerative process cycles through all target variables to impute all missing val-\nues627. this approach is used in the mice algorithm (multiple imputation using\nchained equations) implemented in r and other systems. the chained equa-\ntion method does not attempt to use the full bayesian multivariate model for\nall target variables, which makes it more flexible and easy to use but leaves it\nopen to creating improper imputations, e.g., imputing conflicting values for\ndifferent target variables. however, simulation studies627 so far have demon-\nstrated very good performance of imputation based on chained equations in\nnon-complex situations.\n\nthe aregimpute algorithm463 takes all aspects of uncertainty into account\nusing the bootstrap while using the same estimation procedures as transcan\n(section 4.7). different bootstrap resamples used for each imputation by fit-\nting a flexible additive model on a sample with replacement from the original\ndata. this model is used to predict all of the original missing and non-missing\nvalues for the target variable for the current imputation. aregimpute uses flex-\nible parametric additive regression spline models to predict target variables.\nthere is an option to allow target variables to be optimally transformed, even\nnon-monotonically (but this can overfit). the function implements regression\nimputation based on adding random residuals to predicted means, but its\nreal value lies in implementing a wide variety of pmm algorithms.\n\nthe default method used by aregimpute is (weighted) pmm so that\nno residuals or distributional assumptions are required. the default pmm\nmatching used is van buuren\u2019s \u201ctype 1\u201d matching [85, section 3.4.2] to cap-\nture the right amount of uncertainty. here one computes predicted values\nfor missing values using a regression fit on the bootstrap sample, and finds\ndonor observations by matching those predictions to predictions from poten-\ntial donors using the regression fit from the original sample of complete obser-\nvations. when a predictor of the target variable is missing, it is first imputed\nfrom its last imputation when it was a target variable. the first 3 iterations\n\n "}, {"Page_number": 81, "text": "56\n\n3 missing data\n\ntable 3.1 summary of methods for dealing with missing values\n\nmethod\nallows nonrandom missing\nreduces sample size\napparent s.e. of \u02c6\u03b2 too low\nincreases real s.e. of \u02c6\u03b2\n\u02c6\u03b2 biased\n\ndeletion\n\nsingle multiple\n\n\u2013\nx\n\u2013\nx\n\nx\n\u2013\nx\n\u2013\nif not mcar x\n\nx\n\u2013\n\u2013\n\u2013\n\u2013\n\n11\n\nof the process are ignored (\u201cburn-in\u201d). aregimpute seems to perform as well as\nmice but runs significantly faster and allows for nonlinear relationships.\n\nhere is an example using the r hmisc and rms packages.\n\na \u2190 aregimpute (\u223c age + sex + bp + death +\n\nf \u2190 fit.mult.impu te ( death \u223c rcs ( age ,3) + sex +\n\nheart.attack.befo re .d eat h ,\ndata = mydata , n.impute =5)\n\nrcs ( bp ,5) , lrm , a , data = mydata )\n\n3.9 diagnostics\n\none diagnostic that can be helpful in assessing the mcar assumption is to\ncompare the distribution of non-missing y for those subjects having com-\nplete x with those having incomplete x. on the other hand, yucel and\nzaslavsky681 developed a diagnostic that is useful for checking the imputa-\ntions themselves. in solving a problem related to imputing binary variables\nusing continuous data models, they proposed a simple approach. suppose\nwe were interested in the reasonableness of imputed values for a sometimes-\nmissing predictor xj. duplicate the entire dataset, but in the duplicated\nobservations set all values of xj to missing. develop imputed values for the\nmissing values of xj, and in the observations of the duplicated portion of the\ndataset corresponding to originally non-missing values of xj, compare the\ndistribution of imputed xj with the original values of xj.\n\n12\n\n3.10 summary and rough guidelines\n\ntable 3.1 summarizes the advantages and disadvantages of three methods of\ndealing with missing data. here \u201csingle\u201d refers to single conditional mean im-\nputation (which cannot utilize y ) and \u201cmultiple\u201d refers to multiple random-\ndraw imputation (which can incorporate y ).\n\n "}, {"Page_number": 82, "text": "3.10 summary and rough guidelines\n\n57\n\nthe following contains crude guidelines. simulation studies are needed to\nrefine the recommendations. here f refers to the proportion of observations\nhaving any variables missing.\n\nf < 0.03:\n\nit doesn\u2019t matter very much how you impute missings or whether\nyou adjust variance of regression coefficient estimates for having im-\nputed data in this case. for continuous variables imputing missings with\nthe median non-missing value is adequate; for categorical predictors the\nmost frequent category can be used. complete case analysis is also an\noption here. multiple imputation may be needed to check that the simple\napproach \u201cworked.\u201d\nf \u2265 0.03: use multiple imputation with number of imputations equal to\nmax(5, 100f ). fewer imputations may be possible with very large sample\nsizes. type 1 predictive mean matching is usually preferred, with weighted\nselection of donors. account for imputation in estimating the covariance\nmatrix for final parameter estimates. use the t distribution instead of the\ngaussian distribution for tests and confidence intervals, if possible, using\nthe estimated d.f. for the parameter estimates.\n\nmultiple predictors frequently missing: more imputations may be required.\nperform a \u201csensitivity to order\u201d analysis by creating multiple imputations\nusing different orderings of sometimes missing variables. it may be ben-\neficial to place the variable with the highest number of nas first so that\ninitialization of other missing variables to medians will have less impact.\n\nit is important to note that the reasons for missing data are more important\ndeterminants of how missing values should be handled than is the quantity\nof missing values.\n\nif the main interest is prediction and not interpretation or inference about\nindividual effects, it is worth trying a simple imputation (e.g., median or nor-\nmal value substitution) to see if the resulting model predicts the response\nalmost as well as one developed after using customized imputation. but it\nis not appropriate to use the dummy variable or extra category method,\nbecause these methods steal information from y and bias all \u02c6\u03b2s. clark and\naltman110 presented a nice example of the use of multiple imputation for\ndeveloping a prognostic model. marshall et al.442 developed a useful method\nfor obtaining predictions on future observations when some of the needed\npredictors are unavailable. their method uses an approximate re-fit of the\noriginal model for available predictors only, utilizing only the coefficient esti-\nmates and covariance matrix from the original fit. little and an418 also have\nan excellent review of imputation methods and developed several approxi-\nmate formulas for understanding properties of various estimators. they also\ndeveloped a method combining imputation of missing values with propensity\nscore modeling of the probability of missingness.\n\n13\n\n "}, {"Page_number": 83, "text": "58\n\n3 missing data\n\n3.11 further reading\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\nthese types of missing data are well described in an excellent review article\non missing data by schafer and graham542. a good introductory article on\nmissing data and imputation is by donders et al.161 and a good overview of\nmultiple imputation is by white et al.662 and harel and zhou256. paul allison\u2019s\nbooklet12 and van buuren\u2019s book85 are also excellent practical treatments.\ncrawford et al.138 give an example where responses are not mcar for which\ndeleting subjects with missing responses resulted in a biased estimate of the\nresponse distribution. they found that multiple imputation of the response re-\nsulted in much improved estimates. wood et al.673 have a good review of how\nmissing response data are typically handled in randomized trial reports, with\nrecommendations for improvements. barnes et al.42 have a good overview of\nimputation methods and a comparison of bias and confidence interval cover-\nage for the methods when applied to longitudinal data with a small number\nof subjects. twist et al.617 found instability in using multiple imputation of\nlongitudinal data, and advantages of using instead full likelihood models.\nsee van buuren et al.626 for an example in which subjects having missing base-\nline blood pressure had shorter survival time. joseph et al.327 provide examples\ndemonstrating difficulties with casewise deletion and single imputation, and\ncomment on the robustness of multiple imputation methods to violations of\nassumptions.\nanother problem with the missingness indicator approach arises when more\nthan one predictor is missing and these predictors are missing on almost the\nsame subjects. the missingness indicator variables will be collinear; that is\nimpossible to disentangle.326\nsee [623, pp. 2645\u20132646] for several problems with the \u201cmissing category\u201d ap-\nproach. a clear example is in161 where covariates x1, x2 have true \u03b21 = 1, \u03b22 =\n0 and x1 is mcar. adding a missingness indicator for x1 as a covariate re-\nsulted in \u02c6\u03b21 = 0.55, \u02c6\u03b22 = 0.51 because in the missing observations the constant\nx1 was uncorrelated with x2. d\u2019agostino and rubin146 developed methods for\npropensity score modeling that allow for missing data. they mentioned that ex-\ntra categories may be added to allow for missing data in propensity models and\nthat adding indicator variables describing patterns of missingness will also allow\nthe analyst to match on missingness patterns when comparing non-randomly\nassigned treatments.\nharel and zhou256 and siddique569 discuss the approximate bayesian bootstrap\nfurther.\nkalton and kasprzyk332 proposed a hybrid approach to imputation in which\nmissing values are imputed with the predicted value for the subject plus the\nresidual from the subject having the closest predicted value to the subject being\nimputed.\nmiller et al.458 studied the effect of ignoring imputation when conditional mean\nfill-in methods are used, and showed how to formalize such methods using linear\nmodels.\nmeng455 argues against always separating imputation from final analysis, and\nin favor of sometimes incorporating weights into the process.\nvan buuren et al.626 presented an excellent case study in multiple imputation\nin the context of survival analysis. barzi and woodward43 present a nice review\nof multiple imputation with detailed comparison of results (point estimates and\nconfidence limits for the effect of the sometimes-missing predictor) for various\nimputation methods. barnard and rubin41 derived an estimate of the d.f. asso-\nciated with the imputation-adjusted variance matrix for use in a t-distribution\n\n "}, {"Page_number": 84, "text": "3.12 problems\n\n59\n\n11\n\napproximation for hypothesis tests about imputation-averaged coefficient es-\ntimates. when d.f. is not very large, the t approximation will result in more\naccurate p -values than using a normal approximation that we use with wald\nstatistics after inserting equation 3.2 as the variance matrix.\nlittle and an418 present imputation methods based on flexible additive regres-\nsion models using penalized cubic splines. horton and kleinman301 compare\nseveral software packages for handling missing data and have comparisons of\nresults with that of aregimpute. moons et al.463 compared aregimpute with\nmice.\n\n12 he and zaslavsky280 formalized the duplication approach to imputation\n\ndiagnostics.\n\n13 a good general reference on missing data is little and rubin,422 and volume 16,\nnos. 1 to 3 of statistics in medicine, a large issue devoted to incomplete covari-\nable data. vach620 is an excellent text describing properties of various methods\nof dealing with missing data in binary logistic regression (see also [621,622,624]).\nthese references show how to use maximum likelihood to explicitly model the\nmissing data process. little and rubin show how imputation can be avoided\nif the analyst is willing to assume a multivariate distribution for the joint dis-\ntribution of x and y . since x usually contains a strange mixture of binary,\npolytomous, and continuous but highly skewed predictors, it is unlikely that this\napproach will work optimally in many problems. that\u2019s the reason the imputa-\ntion approach is emphasized. see rubin536 for a comprehensive source on mul-\ntiple imputation. see little,419 vach and blettner,623 rubin and schenker,535\nzhou et al.,688 greenland and finkle,242 and hunsberger et al.313 for excellent\nreviews of missing data problems and approaches to solving them. reilly and\npepe have a nice comparison of the \u201chot-deck\u201d imputation method with a maxi-\nmum likelihood-based method.523 white and carlin660 studied bias of multiple\nimputation vs. complete case analysis.\n\n3.12 problems\n\nthe support study (study to understand prognoses preferences out-\ncomes and risks of treatments) was a five-hospital study of 10,000 critically\nill hospitalized adultsf352. patients were followed for in-hospital outcomes and\nfor long-term survival. we analyze 35 variables and a random sample of 1000\npatients from the study.\n\n1. explore the variables and patterns of missing data in the support\n\ndataset.\n\na. print univariable summaries of all variables. make a plot (showing all\nvariables on one page) that describes especially the continuous variables.\nb. make a plot showing the extent of missing data and tendencies for some\nvariables to be missing on the same patients. functions in the hmisc\npackage may be useful.\n\nf the dataset is on the book\u2019s dataset wiki and may be automatically fetched over\nthe internet and loaded using the hmisc package\u2019s command gethdata(support).\n\n "}, {"Page_number": 85, "text": "60\n\n3 missing data\n\nc. total hospital costs (variable totcst) were estimated from hospital-\nspecific medicare cost-to-charge ratios. characterize what kind of pa-\ntients have missing totcst. for this characterization use the follow-\ning patient descriptors: age, sex, dzgroup, num.co, edu, income, scoma,\nmeanbp, hrt, resp, temp.\n\n2. prepare for later development of a model to predict costs by developing\nreliable imputations for missing costs. remove the observation having zero\ntotcst.g\n\na. the cost estimates are not available on 105 patients. total hospital\ncharges (bills) are available on all but 25 patients. relate these two\nvariables to each other with an eye toward using charges to predict\ntotcst when totcst is missing. make graphs that will tell whether lin-\near regression or linear regression after taking logs of both variables is\nbetter.\n\nb. impute missing total hospital costs in support based on a regression\nmodel relating charges to costs, when charges are available. you may\nwant to use a statement like the following in r:\nsupport \u2190 transform ( support ,\n\ntotcst = ifelse ( is.na ( totcst ) ,\n\n( e x p r e s s i o n _ i n _ c h a r g e s ) , totcst ))\n\nif in the previous problem you felt that the relationship between costs\nand charges should be based on taking logs of both variables, the \u201cex-\npression in charges\u201d above may look something like exp(intercept +\nslope * log(charges)), where constants are inserted for intercept and\nslope.\n\nc. compute the likely error in approximating total cost using charges by\ncomputing the median absolute difference between predicted and ob-\nserved total costs in the patients having both variables available. if you\nused a log transformation, also compute the median absolute percent\nerror in imputing total costs by anti-logging the absolute difference in\npredicted logs.\n\n3. state briefly why single conditional medianh imputation is ok here.\n4. use transcan to develop single imputations for total cost, commenting on\nthe strength of the model fitted by transcan as well as how strongly each\nvariable can be predicted from all the others.\n\n5. use predictive mean matching to multiply impute cost 10 times per missing\nobservation. describe graphically the distributions of imputed values and\nbriefly compare these to distributions of non-imputed values. state in a\n\ng you can use the r command subset(support, is.na(totcst) | totcst > 0). the\nis.na condition tells r that it is permissible to include observations having missing\ntotcst without setting all columns of such observations to na.\nh we are anti-logging predicted log costs and we assume log cost has a symmetric\ndistribution\n\n "}, {"Page_number": 86, "text": "3.12 problems\n\n61\n\nsimple way what the sample variance of multiple imputations for a single\nobservation of a continuous predictor is approximating.\n\n6. using the multiple imputed values, develop an overall least squares model\nfor total cost (using the log transformation) making optimal use of partial\ninformation, with variances computed so as to take imputation (except for\ncost) into account. the model should use the predictors in problem 1 and\nshould not assume linearity in any predictor but should assume additivity.\ninterpret one of the resulting ratios of imputation-corrected variance to\napparent variance and explain why ratios greater than one do not mean\nthat imputation is inefficient.\n\n "}, {"Page_number": 87, "text": "chapter 4\nmultivariable modeling strategies\n\nchapter 2 dealt with aspects of modeling such as transformations of pre-\ndictors, relaxing linearity assumptions, modeling interactions, and examining\nlack of fit. chapter 3 dealt with missing data, focusing on utilization of in-\ncomplete predictor information. all of these areas are important in the overall\nscheme of model development, and they cannot be separated from what is to\nfollow. in this chapter we concern ourselves with issues related to the whole\nmodel, with emphasis on deciding on the amount of complexity to allow in\nthe model and on dealing with large numbers of predictors. the chapter con-\ncludes with three default modeling strategies depending on whether the goal\nis prediction, estimation, or hypothesis testing.\n\nthere are many choices to be made when deciding upon a global modeling\n\n1\n\nstrategy, including choice between\n\u2022 parametric and nonparametric procedures\n\u2022 parsimony and complexity\n\u2022 parsimony and good discrimination ability\n\u2022 interpretable models and black boxes.\n\nthis chapter addresses some of these issues. one general theme of what fol-\nlows is the idea that in statistical inference when a method is capable of\nworsening performance of an estimator or inferential quantity (i.e., when the\nmethod is not systematically biased in one\u2019s favor), the analyst is allowed to\nbenefit from the method. variable selection is an example where the analysis\nis systematically tilted in one\u2019s favor by directly selecting variables on the\nbasis of p -values of interest, and all elements of the final result (including\nregression coefficients and p -values) are biased. on the other hand, the next\nsection is an example of the \u201ccapitalize on the benefit when it works, and\nthe method may hurt\u201d approach because one may reduce the complexity of\nan apparently weak predictor by removing its most important component\u2014\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 4\n\n63\n\n "}, {"Page_number": 88, "text": "64\n\n4 multivariable modeling strategies\n\nnonlinear effects\u2014from how the predictor is expressed in the model. the\nmethod hides tests of nonlinearity that would systematically bias the final\nresult.\n\nthe book\u2019s web site contains a number of simulation studies and references\n\nto others that support the advocated approaches.\n\n4.1 prespecification of predictor complexity without\n\nlater simplification\n\nthere are rare occasions in which one actually expects a relationship to be\nlinear. for example, one might predict mean arterial blood pressure at two\nmonths after beginning drug administration using as baseline variables the\npretreatment mean blood pressure and other variables. in this case one ex-\npects the pretreatment blood pressure to linearly relate to follow-up blood\npressure, and modeling is simplea. in the vast majority of studies, however,\nthere is every reason to suppose that all relationships involving nonbinary\npredictors are nonlinear. in these cases, the only reason to represent pre-\ndictors linearly in the model is that there is insufficient information in the\nsample to allow us to reliably fit nonlinear relationships.b\n\nsupposing that nonlinearities are entertained, analysts often use scatter\ndiagrams or descriptive statistics to decide how to represent variables in a\nmodel. the result will often be an adequately fitting model, but confidence\nlimits will be too narrow, p -values too small, r2 too large, and calibration\ntoo good to be true. the reason is that the \u201cphantom d.f.\u201d that represented\npotential complexities in the model that were dismissed during the subjective\nassessments are forgotten in computing standard errors, p -values, and r2\nadj.\n\u221a\nthe same problem is created when one entertains several transformations\n, etc.) and uses the data to see which one fits best, or when one tries\n(log,\nto simplify a spline fit to a simple transformation.\n\nan approach that solves this problem is to prespecify the complexity with\nwhich each predictor is represented in the model, without later simplification\nof the model. the amount of complexity (e.g., number of knots in spline func-\ntions or order of ordinary polynomials) one can afford to fit is roughly related\nto the \u201ceffective sample size.\u201d it is also very reasonable to allow for greater\ncomplexity for predictors that are thought to be more powerfully related to\ny . for example, errors in estimating the curvature of a regression function are\nconsequential in predicting y only when the regression is somewhere steep.\nonce the analyst decides to include a predictor in every model, it is fair to\n\na even then, the two blood pressures may need to be transformed to meet distribu-\ntional assumptions.\nb shrinkage (penalized estimation) is a general solution (see section 4.5). one can\nalways use complex models that are \u201cpenalized towards simplicity,\u201d with the amount\nof penalization being greater for smaller sample sizes.\n\n "}, {"Page_number": 89, "text": "4.1 prespecification of predictor complexity\n\n65\n\nuse general measures of association to quantify the predictive potential for\na variable. for example, if a predictor has a low rank correlation with the\nresponse, it will not \u201cpay\u201d to devote many degrees of freedom to that pre-\ndictor in a spline function having many knots. on the other hand, a potent\npredictor (with a high rank correlation) not known to act linearly might be\nassigned five knots if the sample size allows.\n\nwhen the effective sample size available is sufficiently large so that a satu-\nrated main effects model may be fitted, a good approach to gauging predictive\npotential is the following.\n\u2022 let all continuous predictors be represented as restricted cubic splines with\nk knots, where k is the maximum number of knots the analyst entertains\nfor the current problem.\n\n\u2022 let all categorical predictors retain their original categories except for\npooling of very low prevalence categories (e.g., ones containing < 6 obser-\nvations).\n\n\u2022 fit this general main effects model.\n\u2022 compute the partial \u03c72 statistic for testing the association of each pre-\ndictor with the response, adjusted for all other predictors. in the case of\nordinary regression, convert partial f statistics to \u03c72 statistics or partial\nr2 values.\n\n\u2022 make corrections for chance associations to \u201clevel the playing field\u201d for pre-\ndictors having greatly varying d.f., e.g., subtract the d.f. from the partial\n\u03c72 (the expected value of \u03c72\n\n\u2022 make certain that tests of nonlinearity are not revealed as this would bias\n\np is p under h0).\n\nthe analyst.\n\n\u2022 sort the partial association statistics in descending order.\n\ncommands in the rms package can be used to plot only what is needed.\n\nhere is an example for a logistic model.\nf \u2190 lrm ( y \u223c sex + race + rcs ( age ,5) + rcs ( weight ,5) +\n\nrcs ( height ,5) + rcs ( blood.pressure ,5))\n\nplot ( anova ( f ))\n\nthis approach, and the rank correlation approach about to be discussed,\ndo not require the analyst to really prespecify predictor complexity, so how\nare they not biased in our favor? there are two reasons: the analyst has al-\nready agreed to retain the variable in the model even if the strength of the\nassociation is very low, and the assessment of association does not reveal\nthe degree of nonlinearity of the predictor to allow the analyst to \u201ctweak\u201d\nthe number of knots or to discard nonlinear terms. any predictive ability a\nvariable might have may be concentrated in its nonlinear effects, so using\nthe total association measure for a predictor to save degrees of freedom by\nrestricting the variable to be linear may result in no predictive ability. like-\nwise, a low association measure between a categorical variable and y might\nlead the analyst to collapse some of the categories based on their frequencies.\nthis often helps, but sometimes the categories that are so combined are the\n\n "}, {"Page_number": 90, "text": "2\n\n3\n\n66\n\n4 multivariable modeling strategies\n\nones that are most different from one another. so if using partial tests or\nrank correlation to reduce degrees of freedom can harm the model, one might\nargue that it is fair to allow this strategy to also benefit the analysis.\n\nwhen collinearities or confounding are not problematic, a quicker approach\nbased on pairwise measures of association can be useful. this approach will\nnot have numerical problems (e.g., singular covariance matrix). when y is\nbinary or continuous (but not censored), a good general-purpose measure of\nassociation that is useful in making decisions about the number of parameters\nto devote to a predictor is an extension of spearman\u2019s \u03c1 rank correlation.\nthis is the ordinary r2 from predicting the rank of y based on the rank of\nx and the square of the rank of x. this \u03c12 will detect not only nonlinear\nrelationships (as will ordinary spearman \u03c1) but some non-monotonic ones\nas well. it is important that the ordinary spearman \u03c1 not be computed, as\nthis would tempt the analyst to simplify the regression function (towards\nmonotonicity) if the generalized \u03c12 does not significantly exceed the square\nof the ordinary spearman \u03c1. for categorical predictors, ranks are not squared\nbut instead the predictor is represented by a series of dummy variables. the\nresulting \u03c12 is related to the kruskal\u2013wallis test. see p. 460 for an example.\nnote that bivariable correlations can be misleading if marginal relationships\nvary greatly from ones obtained after adjusting for other predictors.\n\nonce one expands a predictor into linear and nonlinear terms and esti-\nmates the coefficients, the best way to understand the relationship between\npredictors and response is to graph this estimated relationshipc. if the plot\nappears almost linear or the test of nonlinearity is very insignificant there\nis a temptation to simplify the model. the grambsch and o\u2019brien result\ndescribed in section 2.6 demonstrates why this is a bad idea.\n\nfrom the above discussion a general principle emerges. whenever the re-\nsponse variable is informally or formally linked, in an unmasked fashion, to\nparticular parameters that may be deleted from the model, special adjust-\nments must be made in p -values, standard errors, test statistics, and confi-\ndence limits, in order for these statistics to have the correct interpretation.\nexamples of strategies that are improper without special adjustments (e.g.,\nusing the bootstrap) include examining a frequency table or scatterplot to\ndecide that an association is too weak for the predictor to be included in\nthe model at all or to decide that the relationship appears so linear that all\nnonlinear terms should be omitted. it is also valuable to consider the reverse\nsituation; that is, one posits a simple model and then additional analysis or\noutside subject matter information makes the analyst want to generalize the\nmodel. once the model is generalized (e.g., nonlinear terms are added), the\ntest of association can be recomputed using multiple d.f. so another general\nprinciple is that when one makes the model more complex, the d.f. prop-\nerly increases and the new test statistics for association have the claimed\n\nc one can also perform a joint test of all parameters associated with nonlinear effects.\nthis can be useful in demonstrating to the reader that some complexity was actually\nneeded.\n\n "}, {"Page_number": 91, "text": "4.3 variable selection\n\n67\n\ndistribution. thus moving from simple to more complex models presents no\nproblems other than conservatism if the new complex components are truly\nunnecessary.\n\n4.2 checking assumptions of multiple predictors\n\nsimultaneously\n\nbefore developing a multivariable model one must decide whether the as-\nsumptions of each continuous predictor can be verified by ignoring the effects\nof all other potential predictors. in some cases, the shape of the relation-\nship between a predictor and the property of response will be different if an\nadjustment is made for other correlated factors when deriving regression esti-\nmates. also, failure to adjust for an important factor can frequently alter the\nnature of the distribution of y . occasionally, however, it is unwieldy to deal\nsimultaneously with all predictors at each stage in the analysis, and instead\nthe regression function shapes are assessed separately for each continuous\npredictor.\n\n4.3 variable selection\n\nthe material covered to this point dealt with a prespecified list of variables\nto be included in the regression model. for reasons of developing a concise\nmodel or because of a fear of collinearity or of a false belief that it is not\nlegitimate to include \u201cinsignificant\u201d regression coefficients when presenting\nresults to the intended audience, stepwise variable selection is very commonly\nemployed. variable selection is used when the analyst is faced with a series of\npotential predictors but does not have (or use) the necessary subject matter\nknowledge to enable her to prespecify the \u201cimportant\u201d variables to include\nin the model. but using y to compute p -values to decide which variables\nto include is similar to using y to decide how to pool treatments in a five\u2013\ntreatment randomized trial, and then testing for global treatment differences\nusing fewer than four degrees of freedom.\n\nstepwise variable selection has been a very popular technique for many\nyears, but if this procedure had just been proposed as a statistical method, it\nwould most likely be rejected because it violates every principle of statistical\nestimation and hypothesis testing. here is a summary of the problems with\nthis method.\n\n "}, {"Page_number": 92, "text": "68\n\n4 multivariable modeling strategies\n\n1. it yields r2 values that are biased high.\n2. the ordinary f and \u03c72 test statistics do not have the claimed distribu-\ntiond.234 variable selection is based on methods (e.g., f tests for nested\nmodels) that were intended to be used to test only prespecified hypotheses.\n3. the method yields standard errors of regression coefficient estimates that\nare biased low and confidence intervals for effects and predicted values that\nare falsely narrow.16\n\n4. it yields p -values that are too small (i.e., there are severe multiple compar-\nison problems) and that do not have the proper meaning, and the proper\ncorrection for them is a very difficult problem.\n\n5. it provides regression coefficients that are biased high in absolute value\nand need shrinkage. even if only a single predictor were being analyzed\nand one only reported the regression coefficient for that predictor if its\nassociation with y were \u201cstatistically significant,\u201d the estimate of the re-\ngression coefficient \u02c6\u03b2 is biased (too large in absolute value). to put this\nin symbols for the case where we obtain a positive association ( \u02c6\u03b2 > 0),\ne( \u02c6\u03b2|p < 0.05, \u02c6\u03b2 > 0) > \u03b2.100\n\n6. in observational studies, variable selection to determine confounders for\n\nadjustment results in residual confounding241.\n\n7. rather than solving problems caused by collinearity, variable selection is\n\nmade arbitrary by collinearity.\n\n8. it allows us to not think about the problem.\n\nthe problems of p -value-based variable selection are exacerbated when the\nanalyst (as she so often does) interprets the final model as if it were pre-\nspecified. copas and long125 stated one of the most serious problems with\nstepwise modeling eloquently when they said, \u201cthe choice of the variables\nto be included depends on estimated regression coefficients rather than their\ntrue values, and so xj is more likely to be included if its regression coefficient\nis over-estimated than if its regression coefficient is underestimated.\u201d derksen\nand keselman155 studied stepwise variable selection, backward elimination,\nand forward selection, with these conclusions:\n\n1. \u201cthe degree of correlation between the predictor variables affected the fre-\nquency with which authentic predictor variables found their way into the\nfinal model.\n\n2. the number of candidate predictor variables affected the number of noise\n\nvariables that gained entry to the model.\n\n3. the size of the sample was of little practical importance in determining the\n\nnumber of authentic variables contained in the final model.\n\nd lockhart et al.425 provide an example with n = 100 and 10 orthogonal predictors\nwhere all true \u03b2s are zero. the test statistic for the first variable to enter has type i\nerror of 0.39 when the nominal \u03b1 is set to 0.05, in line with what one would expect\nwith multiple testing using 1 \u2212 0.9510 = 0.40.\n\n "}, {"Page_number": 93, "text": "4.3 variable selection\n\n69\n\n4. the population multiple coefficient of determination could be faithfully es-\ntimated by adopting a statistic that is adjusted by the total number of\ncandidate predictor variables rather than the number of variables in the\nfinal model.\u201d\n\nthey found that variables selected for the final model represented noise 0.20\nto 0.74 of the time and that the final model usually contained less than half\nof the actual number of authentic predictors. hence there are many reasons\nfor using methods such as full-model fits or data reduction, instead of using\nany stepwise variable selection algorithm.\n\nif stepwise selection must be used, a global test of no regression should\nbe made before proceeding, simultaneously testing all candidate predictors\nand having degrees of freedom equal to the number of candidate variables\n(plus any nonlinear or interaction terms). if this global test is not significant,\nselection of individually significant predictors is usually not warranted.\n\nthe method generally used for such variable selection is forward selection\nof the most significant candidate or backward elimination of the least sig-\nnificant predictor in the model. one of the recommended stopping rules is\nbased on the \u201cresidual \u03c72\u201d with degrees of freedom equal to the number of\ncandidate variables remaining at the current step. the residual \u03c72 can be\ntested for significance (if one is able to forget that because of variable selec-\ntion this statistic does not have a \u03c72 distribution), or the stopping rule can\nbe based on akaike\u2019s information criterion (aic33), here residual \u03c72 \u2212 2\u00d7\nd.f.257 of course, use of more insight from knowledge of the subject matter\nwill generally improve the modeling process substantially. it must be remem-\nbered that no currently available stopping rule was developed for data-driven\nvariable selection. stopping rules such as aic or mallows\u2019 cp are intended\nfor comparing a limited number of prespecified models [66, section 1.3]347e.\nif the analyst insists on basing the stopping rule on p -values, the optimum\n(in terms of predictive accuracy) \u03b1 to use in deciding which variables to\ninclude in the model is \u03b1 = 1.0 unless there are a few powerful variables\nand several completely irrelevant variables. a reasonable \u03b1 that does allow\nfor deletion of some variables is \u03b1 = 0.5.589 these values are far from the\ntraditional choices of \u03b1 = 0.05 or 0.10.\n\ne aic works successfully when the models being entertained are on a progression\ndefined by a single parameter, e.g. a common shrinkage coefficient or the single num-\nber of knots to be used by all continuous predictors. aic can also work when the\nmodel that is best by aic is much better than the runner-up so that if the process\nwere bootstrapped the same model would almost always be found. when used for\none variable at a time variable selection. aic is just a restatement of the p -value,\nand as such, doesn\u2019t solve the severe problems with stepwise variable selection other\nthan forcing us to use slightly more sensible \u03b1 values. burnham and anderson84 rec-\nommend selection based on aic for a limited number of theoretically well-founded\nmodels. some statisticians try to deal with multiplicity problems caused by stepwise\nvariable selection by making \u03b1 smaller than 0.05. this increases bias by giving vari-\nables whose effects are estimated with error a greater relative chance of being selected.\nvariable selection does not compete well with shrinkage methods that simultaneously\nmodel all potential predictors.\n\n4\n\n5\n\n "}, {"Page_number": 94, "text": "70\n\n4 multivariable modeling strategies\n\neven though forward stepwise variable selection is the most commonly\n\n6\n\nused method, the step-down method is preferred for the following reasons.\n\n1. it usually performs better than forward stepwise methods, especially when\n\ncollinearity is present.437\n\n2. it makes one examine a full model fit, which is the only fit providing\n\naccurate standard errors, error mean square, and p -values.\n\n3. the method of lawless and singhal385 allows extremely efficient step-down\nmodeling using wald statistics, in the context of any fit from least squares\nor maximum likelihood. this method requires passing through the data\nmatrix only to get the initial full fit.\n\nfor a given dataset, bootstrapping (efron et al.150, 172, 177, 178) can help\ndecide between using full and reduced models. bootstrapping can be done\non the whole model and compared with bootstrapped estimates of predictive\naccuracy based on stepwise variable selection for each resample. unless most\npredictors are either very significant or clearly unimportant, the full model\nusually outperforms the reduced model.\n\nfull model fits have the advantage of providing meaningful confidence\nintervals using standard formulas. altman and andersen16 gave an example\nin which the lengths of confidence intervals of predicted survival probabilities\nwere 60% longer when bootstrapping was used to estimate the simultaneous\neffects of variability caused by variable selection and coefficient estimation, as\ncompared with confidence intervals computed ignoring how a \u201cfinal\u201d model\ncame to be. on the other hand, models developed on full fits after data\nreduction will be optimum in many cases.\n\nin some cases you may want to use the full model for prediction and vari-\nable selection for a \u201cbest bet\u201d parsimonious list of independently important\npredictors. this could be accompanied by a list of variables selected in 50\nbootstrap samples to demonstrate the imprecision in the \u201cbest bet.\u201d\n\nsauerbrei and schumacher541 present a method to use bootstrapping to\nactually select the set of variables. however, there are a number of drawbacks\nto this approach35:\n\n1. the choice of an \u03b1 cutoff for determining whether a variable is retained in\n\na given bootstrap sample is arbitrary.\n\n2. the choice of a cutoff for the proportion of bootstrap samples for which a\nvariable is retained, in order to include that variable in the final model, is\nsomewhat arbitrary.\n\n3. selection from among a set of correlated predictors is arbitrary, and all\nhighly correlated predictors may have a low bootstrap selection frequency.\nit may be the case that none of them will be selected for the final model\neven though when considered individually each of them may be highly\nsignificant.\n\n7\n\n8\n\n "}, {"Page_number": 95, "text": "4.3 variable selection\n\n71\n\n4. by using the bootstrap to choose variables, one must use the double boot-\nstrap to resample the entire modeling process in order to validate the model\nand to derive reliable confidence intervals. this may be computationally\nprohibitive.\n\n5. the bootstrap did not improve upon traditional backward stepdown vari-\n\nable selection. both methods fail at identifying the \u201ccorrect\u201d variables.\n\nfor some applications the list of variables selected may be stabilized by\ngrouping variables according to subject matter considerations or empirical\ncorrelations and testing each related group with a multiple degree of freedom\ntest. then the entire group may be kept or deleted and, if desired, groups that\nare retained can be summarized into a single variable or the most accurately\nmeasured variable within the group can replace the group. see section 4.7\nfor more on this.\n\nkass and raftery337 showed that bayes factors have several advantages in\nvariable selection, including the selection of less complex models that may\nagree better with subject matter knowledge. however, as in the case with\nmore traditional stopping rules, the final model may still have regression\ncoefficients that are too large. this problem is solved by tibshirani\u2019s lasso\nmethod,608, 609 which is a penalized estimation technique in which the esti-\nmated regression coefficients are constrained so that the sum of their scaled\nabsolute values falls below some constant k chosen by cross-validation. this\nkind of constraint forces some regression coefficient estimates to be exactly\nzero, thus achieving variable selection while shrinking the remaining coef-\nficients toward zero to reflect the overfitting caused by data-based model\nselection.\n\na final problem with variable selection is illustrated by comparing this\napproach with the sensible way many economists develop regression mod-\nels. economists frequently use the strategy of deleting only those variables\nthat are \u201cinsignificant\u201d and whose regression coefficients have a nonsensible\ndirection. standard variable selection on the other hand yields biologically\nimplausible findings in many cases by setting certain regression coefficients\nexactly to zero. in a study of survival time for patients with heart failure,\nfor example, it would be implausible that patients having a specific symptom\nlive exactly as long as those without the symptom just because the symp-\ntom\u2019s regression coefficient was \u201cinsignificant.\u201d the lasso method shares this\ndifficulty with ordinary variable selection methods and with any method that\nin the bayesian context places nonzero prior probability on \u03b2 being exactly\nzero.\n\nmany papers claim that there were insufficient data to allow for multivari-\nable modeling, so they did \u201cunivariable screening\u201d wherein only \u201csignificant\u201d\nvariables (i.e., those that are separately significantly associated with y ) were\nentered into the model.f this is just a forward stepwise variable selection in\n\nf this is akin to doing a t-test to compare the two treatments (out of 10, say) that\nare apparently most different from each other.\n\n9\n\n "}, {"Page_number": 96, "text": "72\n\n4 multivariable modeling strategies\n\nwhich insignificant variables from the first step are not reanalyzed in later\nsteps. univariable screening is thus even worse than stepwise modeling as\nit can miss important variables that are only important after adjusting for\nother variables.598 overall, neither univariable screening nor stepwise vari-\nable selection in any way solves the problem of \u201ctoo many variables, too few\nsubjects,\u201d and they cause severe biases in the resulting multivariable model\nfits while losing valuable predictive information from deleting marginally sig-\nnificant variables.\n\nthe online course notes contain a simple simulation study of stepwise\n\nselection using r.\n\n4.4 sample size, overfitting, and limits on\n\nnumber of predictors\n\nwhen a model is fitted that is too complex, that it, has too many free pa-\nrameters to estimate for the amount of information in the data, the worth\nof the model (e.g., r2) will be exaggerated and future observed values will\nnot agree with predicted values. in this situation, overfitting is said to be\npresent, and some of the findings of the analysis come from fitting noise and\nnot just signal, or finding spurious associations between x and y . in this sec-\ntion general guidelines for preventing overfitting are given. here we concern\nourselves with the reliability or calibration of a model, meaning the ability of\nthe model to predict future observations as well as it appeared to predict the\nresponses at hand. for now we avoid judging whether the model is adequate\nfor the task, but restrict our attention to the likelihood that the model has\nsignificantly overfitted the data.\n\nin typical low signal\u2013to\u2013noise ratio situationsg, model validations on in-\ndependent datasets have found the minimum training sample size for which\nthe fitted model has an independently validated predictive discrimination\nthat equals the apparent discrimination seen with in training sample. similar\nvalidation experiments have considered the margin of error in estimating an\nabsolute quantity such as event probability. studies such as268, 270, 577 have\nshown that in many situations a fitted regression model is likely to be reli-\nable when the number of predictors (or candidate predictors if using variable\nselection) p is less than m/10 or m/20, where m is the \u201climiting sample size\u201d\ngiven in table 4.1. a good average requirement is p < m\n15 . for example,\nsmith et al.577 found in one series of simulations that the expected error in\ncox model predicted five\u2013year survival probabilities was below 0.05 when\np < m/20 for \u201caverage\u201d subjects and below 0.10 when p < m/20 for \u201csick\u201d\n\ng these are situations where the true r2 is low, unlike tightly controlled experiments\nand mechanistic models where signal:noise ratios can be quite high. in those situ-\nations, many parameters can be estimated from small samples, and the m\n15 rule of\nthumb can be significantly relaxed.\n\n10\n\n11\n\n12\n\n "}, {"Page_number": 97, "text": "4.4 sample size, overfitting, and limits on number of predictors\n\n73\n\ntable 4.1 limiting sample sizes for various response variables\n\ntype of response variable limiting sample size m\ncontinuous\nbinary\nordinal (k categories)\nfailure (survival) time\n\nn (total sample size)\nmin(n1, n2) h\nn \u2212 1\nnumber of failures j\n\n(cid:2)k\n\ni=1 n3\ni\n\nn2\n\ni\n\nsubjects, where m is the number of deaths. for \u201caverage\u201d subjects, m/10 was\nadequate for preventing expected errors > 0.1. note: the number of non-\nintercept parameters in the model (p) is usually greater than the number of\npredictors. narrowly distributed predictor variables (e.g., if all subjects\u2019 ages\nare between 30 and 45 or only 5% of subjects are female) will require even\nhigher sample sizes. note that the number of candidate variables must include\nall variables screened for association with the response, including nonlinear\nterms and interactions. instead of relying on the rules of thumb in the table,\nthe shrinkage factor estimate presented in the next section can be used to\nguide the analyst in determining how many d.f. to model (see p. 87).\n\nrules of thumb such as the 15:1 rule do not consider that a certain min-\nimum sample size is needed just to estimate basic parameters such as an\nintercept or residual variance. this is dealt with in upcoming topics about\nspecific models. for the case of ordinary linear regression, estimation of the\nresidual variance is central. all standard errors, p -values, confidence inter-\nvals, and r2 depend on having a precise estimate of \u03c32. the one-sample\nproblem of estimating a mean, which is equivalent to a linear model contain-\ning only an intercept, is the easiest case when estimating \u03c32. when a sample\nof size n is drawn from a normal distribution, a 1 \u2212 \u03b1 two-sided confidence\ninterval for the unknown population variance \u03c32 is given by\n\nn \u2212 1\n\u03c72\n1\u2212\u03b1/2,n\u22121\n\ns2 < \u03c32 <\n\nn \u2212 1\n\u03c72\n\u03b1/2,n\u22121\n\ns2,\n\n(4.1)\n\nh see [487]. if one considers the power of a two-sample binomial test compared\nwith a wilcoxon test if the response could be made continuous and the propor-\ntional odds assumption holds, the effective sample size for a binary response is\n3n1n2/n \u2248 3 min(n1, n2) if n1/n is near 0 or 1 [664, eq. 10, 15]. here n1 and n2\nare the marginal frequencies of the two response levels.\ni based on the power of a proportional odds model two-sample test when the marginal\ncell sizes for the response are n1, . . . , nk, compared with all cell sizes equal to unity\n(response is continuous) [664, eq, 3]. if all cell sizes are equal, the relative efficiency\nof having k response categories compared with a continuous response is 1\u2212 1/k2 [664,\neq. 14]; for example, a five-level response is almost as efficient as a continuous one if\nproportional odds holds across category cutoffs.\nj this is approximate, as the effective sample size may sometimes be boosted some-\nwhat by censored observations, especially for non-proportional hazards methods such\nas wilcoxon-type tests.49\n\n "}, {"Page_number": 98, "text": "74\n\n4 multivariable modeling strategies\n\n\u03b1,n\u22121 is the \u03b1 critical value of the\nwhere s2 is the sample variance and \u03c72\n\u03c72 distribution with n \u2212 1 degrees of freedom. we take the fold-change or\nmultiplicative margin of error (mmoe) for estimating \u03c3 to be\n\n(cid:4)(cid:5)(cid:5)(cid:6)\n\nmax(\n\n\u03c72\n1\u2212\u03b1/2,n\u22121\nn \u2212 1\n\n,\n\nn \u2212 1\n\u03c72\n\u03b1/2,n\u22121\n\n)\n\n(4.2)\n\nto achieve a mmoe of no worse than 1.2 with 0.95 confidence when\n\nestimating \u03c3 requires a sample size of 70 subjects.\n\nthe linear model case is useful for examining n : p ratio another way. as\ndiscussed in the next section, r2\nadj is a nearly unbiased estimate of r2, i.e.,\nis not inflated by overfitting if the value used for p is \u201chonest\u201d, i.e., includes\nall variables screened. we can ask the question \u201cfor a given r2, what ratio of\nn : p is required so that r2\nadj does not drop by more than a certain relative or\nabsolute amount from the value of r2?\u201d this assessment takes into account\nthat higher signal:noise ratios allow fitting more variables. for example, with\n\n100\n\n0.975\n\n0.01\n\n100\n\n0.95\n\n0.9\n\np\n\n \nf\n\no\n\n \n\ne\np\n\nl\n\ni\nt\nl\n\nu\nm\n\n80\n\n60\n\n40\n\n20\n\n0\n\np\n\n \nf\n\no\n\n \n\ne\np\n\nl\n\ni\nt\nl\n\nu\nm\n\n80\n\n60\n\n40\n\n20\n\n0\n\n0.02\n\n0.025\n\n0.04\n\n0.05\n0.075\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nr2\n\nr2\n\nfig. 4.1 multiple of p that n must be to achieve a relative drop from r2 to r2\nadj by\nthe indicated relative factor (left panel, 3 factors) or absolute difference (right panel,\n6 decrements)\n\nlow r2 a 100:1 ratio of n : p may be required to prevent r2 from dropping\nby more 1\n10 or by an absolute amount of 0.01. a 15:1 rule would prevent r2\nfrom dropping by more than 0.075 for low r2 (figure 4.1).\n\n "}, {"Page_number": 99, "text": "4.5 shrinkage\n\n4.5 shrinkage\n\n75\n\nthe term shrinkage is used in regression modeling to denote two ideas. the\nfirst meaning relates to the slope of a calibration plot, which is a plot of\nobserved responses against predicted responsesk. when a dataset is used to\nfit the model parameters as well as to obtain the calibration plot, the usual\nestimation process will force the slope of observed versus predicted values to\nbe one. when, however, parameter estimates are derived from one dataset\nand then applied to predict outcomes on an independent dataset, overfitting\nwill cause the slope of the calibration plot (i.e., the shrinkage factor ) to be less\nthan one, a result of regression to the mean. typically, low predictions will be\ntoo low and high predictions too high. predictions near the mean predicted\nvalue will usually be quite accurate. the second meaning of shrinkage is a\nstatistical estimation method that preshrinks regression coefficients towards\nzero so that the calibration plot for new data will not need shrinkage as its\ncalibration slope will be one.\n\nwe turn first to shrinkage as an adverse result of traditional modeling.\nin ordinary linear regression, we know that all of the coefficient estimates\nare exactly unbiased estimates of the true effect when the model fits. isn\u2019t\nthe existence of shrinkage and overfitting implying that there is some kind\nof bias in the parameter estimates? the answer is no because each separate\ncoefficient has the desired expectation. the problem lies in how we use the\ncoefficients. we tend not to pick out coefficients at random for interpretation\nbut we tend to highlight very small and very large coefficients.\n\na simple example may suffice. consider a clinical trial with 10 randomly\nassigned treatments such that the patient responses for each treatment are\nnormally distributed. we can do an anova by fitting a multiple regres-\nsion model with an intercept and nine dummy variables. the intercept is an\nunbiased estimate of the mean response for patients on the first treatment,\nand each of the other coefficients is an unbiased estimate of the difference\nin mean response between the treatment in question and the first treatment.\n\u02c6\u03b20 + \u02c6\u03b21 is an unbiased estimate of the mean response for patients on the\nsecond treatment. but if we plotted the predicted mean response for patients\nagainst the observed responses from new data, the slope of this calibration\nplot would typically be smaller than one. this is because in making this plot\nwe are not picking coefficients at random but we are sorting the coefficients\ninto ascending order. the treatment group having the lowest sample mean\nresponse will usually have a higher mean in the future, and the treatment\ngroup having the highest sample mean response will typically have a lower\nmean in the future. the sample mean of the group having the highest sample\nmean is not an unbiased estimate of its population mean.\n\nk an even more stringent assessment is obtained by stratifying calibration curves by\npredictor settings.\n\n "}, {"Page_number": 100, "text": "76\n\n4 multivariable modeling strategies\n\nas an illustration, let us draw 20 samples of size n = 50 from a uniform\ndistribution for which the true mean is 0.5. figure 4.2 displays the 20 means\nsorted into ascending order, similar to plotting y versus \u02c6y = x \u02c6\u03b2 based\non least squares after sorting by x \u02c6\u03b2. bias in the very lowest and highest\nestimates is evident.\nn \u2190 50\ny \u2190 runif (20 * n )\ngroup \u2190 rep (1:20 , each = n )\nybar \u2190 tapply (y , group , mean )\nybar \u2190 sort ( ybar )\nplot (1:20 , ybar , type = ' n ' , axes = false , ylim = c ( .3 , .7 ),\n\nset.seed (123)\n\nxlab = ' group ' , ylab = ' group mean ' )\n\nlines (1:20 , ybar )\npoints (1:20 , ybar , pch =20 , cex = .5 )\naxis (2)\naxis (1 , at =1:20 , labels = false )\nfor ( j in 1:20) axis (1 , at =j , labels = names ( ybar )[ j ])\nabline ( h = .5 , col = gray ( .85 ))\n\n \n\nn\na\ne\nm\np\nu\no\nr\ng\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\nl l l l l l l\n\nl\n\nl l l l l\n\nl\n\nl\n\nl l l l l\n\n16 6 17 2 10 14 20 9 8 7 11 18 5 4 3 1 15 13 19 12\n\ngroup\n\nfig. 4.2 sorted means from 20 samples of size 50 from a uniform [0, 1] distribution.\nthe reference line at 0.5 depicts the true population value of all of the means.\n\nwhen we want to highlight a treatment that is not chosen at random (or a\npriori), the data-based selection of that treatment needs to be compensated\nfor in the estimation process.l it is well known that the use of shrinkage\n\nl it is interesting that researchers are quite comfortable with adjusting p -values for\npost hoc selection of comparisons using, for example, the bonferroni inequality, but\nthey do not realize that post hoc selection of comparisons also biases point estimates.\n\n "}, {"Page_number": 101, "text": "4.5 shrinkage\n\n77\n\nmethods such as the james\u2013stein estimator to pull treatment means toward\nthe grand mean over all treatments results in estimates of treatment-specific\nmeans that are far superior to ordinary stratified means.176\n\nturning from a cell means model to the general case where predicted values\nare general linear combinations x \u02c6\u03b2, the slope \u03b3 of properly transformed\nresponses y against x \u02c6\u03b2 (sorted into ascending order) will be less than one\non new data. estimation of the shrinkage coefficient \u03b3 allows quantification of\nthe amount of overfitting present, and it allows one to estimate the likelihood\nthat the model will reliably predict new observations. van houwelingen and le\ncessie [633, eq. 77] provided a heuristic shrinkage estimate that has worked\nwell in several examples:\n\nmodel \u03c72 \u2212 p\nmodel \u03c72\n\n,\n\n\u02c6\u03b3 =\n\n(4.3)\n\nwhere p is the total degrees of freedom for the predictors and model \u03c72 is\nthe likelihood ratio \u03c72 statistic for testing the joint influence of all predictors\nsimultaneously (see section 9.3.1). for ordinary linear models, van houwelin-\ngen and le cessie proposed a shrinkage factor \u02c6\u03b3 that can be shown to equal\nn\u2212p\u22121\nn\u22121\n\nr2\nr2 , where the adjusted r2 is given by\n\nadj\n\nadj = 1 \u2212 (1 \u2212 r2)\nr2\n\nn \u2212 1\nn \u2212 p \u2212 1\n\n.\n\n(4.4)\n\nfor such linear models with an intercept \u03b20, the shrunken estimate of \u03b2 is\n\n0 = (1 \u2212 \u02c6\u03b3)y + \u02c6\u03b3 \u02c6\u03b20\n\u02c6\u03b2s\n\u02c6\u03b2s\nj = \u02c6\u03b3 \u02c6\u03b2j, j = 1, . . . , p,\n\n(4.5)\n\nwhere y is the mean of the response vector. again, when stepwise fitting is\nused, the p in these equations is much closer to the number of candidate de-\ngrees of freedom rather than the number in the \u201cfinal\u201d model. see section 5.3\nfor methods of estimating \u03b3 using the bootstrap (p. 115) or cross-validation.\nnow turn to the second usage of the term shrinkage. just as clothing is\nsometimes preshrunk so that it will not shrink further once it is purchased,\nbetter calibrated predictions result when shrinkage is built into the estima-\ntion process in the first place. the object of shrinking regression coefficient\nestimates is to obtain a shrinkage coefficient of \u03b3 = 1 on new data. thus by\nsomewhat discounting \u02c6\u03b2 we make the model underfitted on the data at hand\n(i.e., apparent \u03b3 < 1) so that on new data extremely low or high predictions\nare correct.\n\nridge regression388, 633 is one technique for placing restrictions on the pa-\nrameter estimates that results in shrinkage. a ridge parameter must be chosen\nto control the amount of shrinkage. penalized maximum likelihood estima-\ntion,237, 272, 388, 639 a generalization of ridge regression, is a general shrinkage\n\n13\n\n14\n\n15\n\n "}, {"Page_number": 102, "text": "78\n\n4 multivariable modeling strategies\n\nprocedure. a method such as cross-validation or optimization of a modified\naic must be used to choose an optimal penalty factor. an advantage of pe-\nnalized estimation is that one can differentially penalize the more complex\ncomponents of the model such as nonlinear or interaction effects. a drawback\nof ridge regression and penalized maximum likelihood is that the final model\nis difficult to validate unbiasedly since the optimal amount of shrinkage is\nusually determined by examining the entire dataset. penalization is one of\nthe best ways to approach the \u201ctoo many variables, too little data\u201d problem.\nsee section 9.10 for details.\n\n4.6 collinearity\n\nwhen at least one of the predictors can be predicted well from the other\npredictors, the standard errors of the regression coefficient estimates can be\ninflated and corresponding tests have reduced power.217 in stepwise variable\nselection, collinearity can cause predictors to compete and make the selection\nof \u201cimportant\u201d variables arbitrary. collinearity makes it difficult to estimate\nand interpret a particular regression coefficient because the data have little\ninformation about the effect of changing one variable while holding another\n(highly correlated) variable constant [101, chap. 9]. however, collinearity\ndoes not affect the joint influence of highly correlated variables when tested\nsimultaneously. therefore, once groups of highly correlated predictors are\nidentified, the problem can be rectified by testing the contribution of an\nentire set with a multiple d.f. test rather than attempting to interpret the\ncoefficient or one d.f. test for a single predictor.\n\ncollinearity does not affect predictions made on the same dataset used to\nestimate the model parameters or on new data that have the same degree\nof collinearity as the original data [470, pp. 379\u2013381] as long as extreme\nextrapolation is not attempted. consider as two predictors the total and ldl\ncholesterols that are highly correlated. if predictions are made at the same\ncombinations of total and ldl cholesterol that occurred in the training data,\nno problem will arise. however, if one makes a prediction at an inconsistent\ncombination of these two variables, the predictions may be inaccurate and\nhave high standard errors.\n\nwhen the ordinary truncated power basis is used to derive component\nvariables for fitting linear and cubic splines, as was described earlier, the\ncomponent variables can be very collinear. it is very unlikely that this will\nresult in any problems, however, as the component variables are connected\nalgebraically. thus it is not possible for a combination of, for example, x and\nmax(x \u2212 10, 0) to be inconsistent with each other. collinearity problems are\nthen more likely to result from partially redundant subsets of predictors as\nin the cholesterol example above.\n\n "}, {"Page_number": 103, "text": "16\n\n17\n\n4.7 data reduction\n\n79\n\n(cid:2)\n\ni ) where r2\n\none way to quantify collinearity is with variance inflation factors or vif ,\nx matrix\nwhich in ordinary least squares are diagonals of the inverse of the x\nscaled to have unit variance (except that a column of 1s is retained corre-\nsponding to the intercept). note that some authors compute vif from the\ncorrelation matrix form of the design matrix, omitting the intercept. v ifi is\n1/(1 \u2212 r2\ni is the squared multiple correlation coefficient between\ncolumn i and the remaining columns of the design matrix. for models that are\nfitted with maximum likelihood estimation, the information matrix is scaled\nto correlation form, and vif is the diagonal of the inverse of this scaled ma-\ntrix.147, 654 then the vif are similar to those from a weighted correlation\nmatrix of the original columns in the design matrix. note that indexes such\nas vif are not very informative as some variables are algebraically connected\nto each other.\n\nthe sas varclus procedure539 and r varclus function can identify collinear\npredictors. summarizing collinear variables using a summary score is more\npowerful and stable than arbitrary selection of one variable in a group of\ncollinear variables (see the next section).\n\n4.7 data reduction\n\nthe sample size need not be as large as shown in table 4.1 if the model\nis to be validated independently and if you don\u2019t care that the model may\nfail to validate. however, it is likely that the model will be overfitted and\nwill not validate if the sample size does not meet the guidelines. use of data\nreduction methods before model development is strongly recommended if the\nconditions in table 4.1 are not satisfied, and if shrinkage is not incorporated\ninto parameter estimation. methods such as shrinkage and data reduction\nreduce the effective d.f. of the model, making it more likely for the model\nto validate on future data. data reduction is aimed at reducing the number\nof parameters to estimate in the model, without distorting statistical infer-\nence for the parameters. this is accomplished by ignoring y during data\nreduction. manipulations of x in unsupervised learning may result in a loss\nof information for predicting y , but when the information loss is small, the\ngain in power and reduction of overfitting more than offset the loss.\n\nsome available data reduction methods are given below.\n\n1. use the literature to eliminate unimportant variables.\n2. eliminate variables whose distributions are too narrow.\n3. eliminate candidate predictors that are missing in a large number of sub-\njects, especially if those same predictors are likely to be missing for future\napplications of the model.\n\n4. use a statistical data reduction method such as incomplete principal com-\nponent regression, nonlinear generalizations of principal components such\n\n "}, {"Page_number": 104, "text": "80\n\n4 multivariable modeling strategies\n\n18\n\nas principal surfaces, sliced inverse regression, variable clustering, or ordi-\nnary cluster analysis on a measure of similarity between variables.\n\nsee chapters 8 and 14 for detailed case studies in data reduction.\n\n4.7.1 redundancy analysis\n\nthere are many approaches to data reduction. one rigorous approach involves\nremoving predictors that are easily predicted from other predictors, using\nflexible parametric additive regression models. this approach is unlikely to\nresult in a major reduction in the number of regression coefficients to estimate\nagainst y , but will usually provide insights useful for later data reduction\nover and above the insights given by methods based on pairwise correlations\ninstead of multiple r2.\n\nthe hmisc redun function implements the following redundancy checking\n\nalgorithm.\n\u2022 expand each continuous predictor into restricted cubic spline basis func-\n\ntions. expand categorical predictors into dummy variables.\n\n\u2022 use ols to predict each predictor with all component terms of all remain-\ning predictors (similar to what the hmisc transcan function does). when the\npredictor is expanded into multiple terms, use the first canonical variatem.\n\u2022 remove the predictor that can be predicted from the remaining set with\n\nthe highest adjusted or regular r2.\n\n\u2022 predict all remaining predictors from their complement.\n\u2022 continue in like fashion until no variable still in the list of predictors can\nbe predicted with an r2 or adjusted r2 greater than a specified threshold\nor until dropping the variable with the highest r2 (adjusted or ordinary)\nwould cause a variable that was dropped earlier to no longer be predicted\nat the threshold from the now smaller list of predictors.\n\nspecial consideration must be given to categorical predictors. one way to\nconsider a categorical variable redundant is if a linear combination of dummy\nvariables representing it can be predicted from a linear combination of other\nvariables. for example, if there were 4 cities in the data and each city\u2019s rainfall\nwas also present as a variable, with virtually the same rainfall reported for\nall observations for a city, city would be redundant given rainfall (or vice-\nversa). if two cities had the same rainfall, \u2018city\u2019 might be declared redundant\neven though tied cities might be deemed non-redundant in another setting. a\nsecond, more stringent way to check for redundancy of a categorical predictor\nis to ascertain whether all dummy variables created from the predictor are\nindividually redundant. the redun function implements both approaches.\n\n19\n\nexamples of use of redun are given in two case studies.\n\nm there is an option to force continuous variables to be linear when they are being\npredicted.\n\n "}, {"Page_number": 105, "text": "4.7 data reduction\n\n81\n\n4.7.2 variable clustering\n\nalthough the use of subject matter knowledge is usually preferred, statistical\nclustering techniques can be useful in determining independent dimensions\nthat are described by the entire list of candidate predictors. once each di-\nmension is scored (see below), the task of regression modeling is simplified,\nand one quits trying to separate the effects of factors that are measuring the\nsame phenomenon. one type of variable clustering539 is based on a type of\noblique-rotation principal component (pc) analysis that attempts to separate\nvariables so that the first pc of each group is representative of that group\n(the first pc is the linear combination of variables having maximum vari-\nance subject to normalization constraints on the coefficients142, 144). another\napproach, that of doing a hierarchical cluster analysis on an appropriate sim-\nilarity matrix (such as squared correlations) will often yield the same results.\nfor either approach, it is often advisable to use robust (e.g., rank-based)\nmeasures for continuous variables if they are skewed, as skewed variables can\ngreatly affect ordinary correlation coefficients. pairwise deletion of missing\nvalues is also advisable for this procedure\u2014casewise deletion can result in a\nsmall biased sample.\n\nwhen variables are not monotonically related to each other, pearson or\nspearman squared correlations can miss important associations and thus are\nnot always good similarity measures. a general and robust similarity mea-\nsure is hoeffding\u2019s d,295 which for two variables x and y is a measure of\nthe agreement between f (x, y) and g(x)h(y), where g, h are marginal cu-\nmulative distribution functions and f is the joint cdf. the d statistic will\ndetect a wide variety of dependencies between two variables.\n\nsee pp. 330 and 458 for examples of variable clustering.\n\n4.7.3 transformation and scaling variables without\n\nusing y\n\nscaling techniques often allow the analyst to reduce the number of parameters\nto fit by estimating transformations for each predictor using only information\nabout associations with other predictors. it may be advisable to cluster vari-\nables before scaling so that patterns are derived only from variables that are\nrelated. for purely categorical predictors, methods such as correspondence\nanalysis (see, for example, [108, 139, 239, 391, 456]) can be useful for data reduc-\ntion. often one can use these techniques to scale multiple dummy variables\ninto a few dimensions. for mixtures of categorical and continuous predictors,\nqualitative principal component analysis such as the maximum total variance\n(mtv) method of young et al.456, 680 is useful. for the special case of repre-\nsenting a series of variables with one pc, the mtv method is quite easy to\nimplement.\n\n20\n\n21\n\n "}, {"Page_number": 106, "text": "82\n\n4 multivariable modeling strategies\n\n1. compute p c1, the first pc of the variables to reduce x1, . . . , xq using\n\nthe correlation matrix of xs.\n\n2. use ordinary linear regression to predict p c1 on the basis of functions of\nthe xs, such as restricted cubic spline functions for continuous xs or a\nseries of dummy variables for polytomous xs. the expansion of each xj\nis regressed separately on p c1.\n\n3. these separately fitted regressions specify the working transformations of\n\neach x.\n\n4. recompute p c1 by doing a pc analysis on the transformed xs (predicted\n\nvalues from the fits).\n\n5. repeat steps 2 to 4 until the proportion of variation explained by p c1\n\nreaches a plateau. this typically requires three to four iterations.\n\na transformation procedure that is similar to mtv is the maximum gen-\neralized variance (mgv) method due to sarle [368, pp. 1267\u20131268]. mgv\ninvolves predicting each variable from (the current transformations of) all\nthe other variables. when predicting variable i, that variable is represented\nas a set of linear and nonlinear terms (e.g., spline components). analysis of\ncanonical variates279 can be used to find the linear combination of terms for\nxi (i.e., find a new transformation for xi) and the linear combination of the\ncurrent transformations of all other variables (representing each variable as\na single, transformed, variable) such that these two linear combinations have\nmaximum correlation. (for example, if there are only two variables x1 and x2\nrepresented as quadratic polynomials, solve for a, b, c, d such that ax1 + bx 2\n1\nhas maximum correlation with cx2 + dx 2\n2 .) the process is repeated until the\ntransformations converge. the goal of mgv is to transform each variable so\nthat it is most similar to predictions from the other transformed variables.\nmgv does not use pcs (so one need not precede the analysis by variable\nclustering), but once all variables have been transformed, you may want to\nsummarize them with the first pc.\n\nthe sas prinqual procedure of kuhfeld368 implements the mtv and mgv\nmethods, and allows for very flexible transformations of the predictors, in-\ncluding monotonic splines and ordinary cubic splines.\n\na very flexible automatic procedure for transforming each predictor in\nturn, based on all remaining predictors, is the ace (alternating conditional\nexpectation) procedure of breiman and friedman.68 like sas proc prin-\nqual, ace handles monotonically restricted transformations and categorical\nvariables. it fits transformations by maximizing r2 between one variable and\na set of variables. it automatically transforms all variables, using the \u201csuper\nsmoother\u201d207 for continuous variables. unfortunately, ace does not handle\nmissing values. see chapter 16 for more about ace.\n\nit must be noted that at best these automatic transformation procedures\ngenerally find only marginal transformations, not transformations of each pre-\ndictor adjusted for the effects of all other predictors. when adjusted transfor-\nmations differ markedly from marginal transformations, only joint modeling\nof all predictors (and the response) will find the correct transformations.\n\n "}, {"Page_number": 107, "text": "4.7 data reduction\n\n83\n\nonce transformations are estimated using only predictor information, the\nadequacy of each predictor\u2019s transformation can be checked by graphical\nmethods, by nonparametric smooths of transformed xj versus y , or by ex-\npanding the transformed xj using a spline function. this approach of check-\ning that transformations are optimal with respect to y uses the response\ndata, but it accepts the initial transformations unless they are significantly\ninadequate. if the sample size is low, or if p c1 for the group of variables used\nin deriving the transformations is deemed an adequate summary of those\nvariables, that p c1 can be used in modeling. in that way, data reduction is\naccomplished two ways: by not using y to estimate multiple coefficients for\na single predictor, and by reducing related variables into a single score, after\ntransforming them. see chapter 8 for a detailed example of these scaling\ntechniques.\n\n4.7.4 simultaneous transformation and imputation\n\nas mentioned in chapter 3 (p. 52) if transformations are complex or non-\nmonotonic, ordinary imputation models may not work. sas proc prinqual\nimplemented a method for simultaneously imputing missing values while solv-\ning for transformations. unfortunately, the imputation procedure frequently\nconverges to imputed values that are outside the allowable range of the data.\nthis problem is more likely when multiple variables are missing on the same\nsubjects, since the transformation algorithm may simply separate missings\nand nonmissings into clusters.\n\na simple modification of the mgv algorithm of prinqual that simulta-\nneously imputes missing values without these problems is implemented in\nthe r function transcan. imputed values are initialized to medians of contin-\nuous variables and the most frequent category of categorical variables. for\ncontinuous variables, transformations are initialized to linear functions. for\ncategorical ones, transformations may be initialized to the identify function,\nto dummy variables indicating whether the observation has the most preva-\nlent categorical value, or to random numbers. then when using canonical\nvariates to transform each variable in turn, observations that are missing on\nthe current \u201cdependent\u201d variable are excluded from consideration, although\nmissing values for the current set of \u201cpredictors\u201d are imputed. transformed\nvariables are normalized to have mean 0 and standard deviation 1. although\ncategorical variables are scored using the first canonical variate, transcan has\nan option to use recursive partitioning to obtain imputed values on the origi-\nnal scale (section 2.5) for these variables. it defaults to imputing categorical\nvariables using the category whose predicted canonical score is closest to the\npredicted score.\n\ntranscan uses restricted cubic splines to model continuous variables. it does\nnot implement monotonicity constraints. transcan automatically constrains\n\n "}, {"Page_number": 108, "text": "84\n\n4 multivariable modeling strategies\n\nimputed values (both on transformed and original scales) to be in the same\nrange as non-imputed ones. this adds much stability to the resulting esti-\nmates although it can result in a boundary effect. also, imputed values can\noptionally be shrunken using eq. 4.5 to avoid overfitting when developing\nthe imputation models. optionally, missing values can be set to specified\nconstants rather than estimating them. these constants are ignored during\nthe transformation-estimation phasen. this technique has proved to be help-\nful when, for example, a laboratory test is not ordered because a physician\nthinks the patient has returned to normal with respect to the lab parameter\nmeasured by the test. in that case, it\u2019s better to use a normal lab value for\nmissings.\n\nthe transformation and imputation information created by transcan may\nbe used to transform/impute variables in datasets not used to develop the\ntransformation and imputation formulas. there is also an r function to create\nr functions that compute the final transformed values of each predictor given\ninput values on the original scale.\n\nas an example of non-monotonic transformation and imputation, consider\na sample of 1000 hospitalized patients from the supporto study.352 two\nmean arterial blood pressure measurements were set to missing.\n\nrequire ( hmisc )\ngethdata ( support )\nheart.rate\n\nblood.pressur e \u2190 support $ meanbp\n\n\u2190 support $ hrt\n\n# get data f r a m e from web site\n\nblood.pressur e [400:401]\n\nmean arterial blood pressure day 3\n[1] 151 136\n\nb l o o d . p r e s s u r e [400:401] \u2190 na\nd \u2190 data.fram e ( heart.rate , b l o o d . p r e s s u r e )\nw \u2190 transcan (\u223c heart.rate + blood.pressure , transform e d = true ,\n\n# create two missings\n\n# figure 4.3\n\npar ( pch =46)\n\nimputed = true , show.na = true , data = d )\n\nc o n v e r g e n c e c r i t e r i o n :2.901 0.035\n\n0.007\nc o n v e r g e n c e in 4 i t e r a t i o n s\nr2 achieved in p r e d i c t i n g each variable :\n\nheart . rate blood . pressure\n0.259\n\n0.259\n\nadjusted r2:\n\nheart . rate blood . pressure\n0.253\n\n0.254\n\nn if one were to estimate transformations without removing observations that had\nthese constants inserted for the current y -variable, the resulting transformations\nwould likely have a spike at y = imputation constant.\no study to understand prognoses preferences outcomes and risks of treatments\n\n "}, {"Page_number": 109, "text": "4.7 data reduction\n\n85\n\nw $ imputed $ blood.pressure\n\n400\n\n401\n132.4057 109.7741\n\nt \u2190 w $ transformed\nspe \u2190 round ( c ( spearman ( heart.rate , blood.pressure ),\n\nspearman ( t [, ' heart.rate ' ],\n\nt [, ' blood.pressur e ' ])) , 2)\n\n8\n\n6\n\n4\n\n2\n\n0\n\ne\n\nt\n\na\nr\n.\nt\nr\na\ne\nh\n\n \n\nd\ne\nm\nr\no\n\nf\ns\nn\na\nr\nt\n\n0\n\n\u22122\n\n\u22124\n\n\u22126\n\n\u22128\n\ne\nr\nu\ns\ns\ne\nr\np\n\n.\n\nd\no\no\nb\n\nl\n\n \n\nd\ne\nm\nr\no\n\nf\ns\nn\na\nr\nt\n\n0\n\n50 100 150 200 250 300\n\n0\n\nheart.rate\n\n100\n\n50\nblood.pressure\n\n150\n\nfig. 4.3 transformations fitted using transcan. tick marks indicate the two imputed\nvalues for blood pressure.\n\nplot ( heart.rate , blood.pressure )\nplot ( t [, ' heart.rate ' ], t [, ' blood.pressure ' ],\n\n# f i g u r e 4.4\n\nxlab = ' transformed hr ' , ylab = ' transformed bp ' )\n\nspearman\u2019s rank correlation \u03c1 between pairs of heart rate and blood pressure\nwas -0.02, because these variables each require u -shaped transformations. us-\ning restricted cubic splines with five knots placed at default quantiles, tran-\nscan provided the transformations shown in figure 4.3. correlation between\ntransformed variables is \u03c1 = \u22120.13. the fitted transformations are similar to\nthose obtained from relating these two variables to time until death.\n\n4.7.5 simple scoring of variable clusters\n\nif a subset of the predictors is a series of related dichotomous variables, a\nsimpler data reduction strategy is sometimes employed. first, construct two\n\n "}, {"Page_number": 110, "text": "86\n\ne\nr\nu\ns\ns\ne\nr\np\n.\nd\no\no\nb\n\nl\n\n150\n\n100\n\n50\n\n0\n\n4 multivariable modeling strategies\n\n0\n\n\u22122\n\n\u22124\n\n\u22126\n\n\u22128\n\np\nb\n \nd\ne\nm\nr\no\nf\ns\nn\na\nr\nt\n\n0\n\n50 100 150 200 250 300\n\n0\n\n2\n\n4\n\n6\n\n8\n\nheart.rate\n\ntransformed hr\n\nfig. 4.4 the lower left plot contains raw data (spearman \u03c1 = \u22120.02); the lower right\nis a scatterplot of the corresponding transformed values (\u03c1 = \u22120.13). data courtesy\nof the support study352.\n\nnew predictors representing whether any of the factors is positive and a count\nof the number of positive factors. for the ordinal count of the number of\npositive factors, score the summary variable to satisfy linearity assumptions\nas discussed previously. for the more powerful predictor of the two summary\nmeasures, test for adequacy of scoring by using all dichotomous variables as\ncandidate predictors after adjusting for the new summary variable. a residual\n\u03c72 statistic can be used to test whether the summary variable adequately\ncaptures the predictive information of the series of binary predictors.p this\nstatistic will have degrees of freedom equal to one less than the number of\nbinary predictors when testing for adequacy of the summary count (and hence\nwill have low power when there are many predictors). stratification by the\nsummary score and examination of responses over cells can be used to suggest\na transformation on the score.\n\nanother approach to scoring a series of related dichotomous predictors is to\nhave \u201cexperts\u201d assign severity points to each condition and then to either sum\nthese points or use a hierarchical rule that scores according to the condition\nwith the highest points (see section 14.3 for an example). the latter has the\nadvantage of being easy to implement for field use. the adequacy of either\ntype of scoring can be checked using tests of linearity in a regression modelq.\n\np whether this statistic should be used to change the model is problematic in view\nof model uncertainty.\nq the r function score.binary in the hmisc package (see section 6.2) assists in\ncomputing a summary variable from the series of binary conditions.\n\n "}, {"Page_number": 111, "text": "22\n\n23\n\n4.7 data reduction\n\n87\n\n4.7.6 simplifying cluster scores\n\nif a variable cluster contains many individual predictors, parsimony may\nsometimes be achieved by predicting the cluster score from a subset of its\ncomponents (using linear regression or cart (section 2.5), for example).\nthen a new cluster score is created and the response model is rerun with the\nnew score in the place of the original one. if one constituent variable has a\nvery high r2 in predicting the original cluster score, the single variable may\nsometimes be substituted for the cluster score in refitting the model without\nloss of predictive discrimination.\n\nsometimes it may be desired to simplify a variable cluster by asking the\nquestion \u201cwhich variables in the cluster are really the predictive ones?,\u201d even\nthough this approach will usually cause true predictive discrimination to suf-\nfer. for clusters that are retained after limited step-down modeling, the entire\nlist of variables can be used as candidate predictors and the step-down process\nrepeated. all variables contained in clusters that were not selected initially are\nignored. a fair way to validate such two-stage models is to use a resampling\nmethod (section 5.3) with scores for deleted clusters as candidate variables\nfor each resample, along with all the individual variables in the clusters the\nanalyst really wants to retain. a method called battery reduction can be used\nto delete variables from clusters by determining if a subset of the variables\ncan explain most of the variance explained by p c1 (see [142, chapter 12]\nand445). this approach does not require examination of associations with y .\nbattery reduction can also be used to find a set of individual variables that\ncapture much of the information in the first k principal components.\n\n4.7.7 how much data reduction is necessary?\n\nin addition to using the sample size to degrees of freedom ratio as a rough\nguide to how much data reduction to do before model fitting, the heuristic\nshrinkage estimate in equation 4.3 can also be informative. first, fit a full\nmodel with all candidate variables, nonlinear terms, and hypothesized inter-\nactions. let p denote the number of parameters in this model, aside from any\nintercepts. let lr denote the log likelihood ratio \u03c72 for this full model. the\nestimated shrinkage is (lr \u2212 p)/lr. if this falls below 0.9, for example, we\nmay be concerned with the lack of calibration the model may experience on\nnew data. either a shrunken estimator or data reduction is needed. a reduced\nmodel may have acceptable calibration if associations with y are not used to\nreduce the predictors.\n\na simple method, with an assumption, can be used to estimate the target\nnumber of total regression degrees of freedom q in the model. in a \u201cbest\ncase,\u201d the variables removed to arrive at the reduced model would have no\nassociation with y . the expected value of the \u03c72 statistic for testing those\n\n "}, {"Page_number": 112, "text": "88\n\n4 multivariable modeling strategies\n\nvariables would then be p \u2212 q. the shrinkage for the reduced model is then\non average [lr \u2212 (p \u2212 q) \u2212 q]/[lr \u2212 (p \u2212 q)]. setting this ratio to be \u2265 0.9\nand solving for q gives q \u2264 (lr\u2212 p)/9. therefore, reduction of dimensionality\ndown to q degrees of freedom would be expected to achieve < 10% shrinkage.\nwith these assumptions, there is no hope that a reduced model would have\nacceptable calibration unless lr > p + 9. if the information explained by the\nomitted variables is less than one would expect by chance (e.g., their total\n\u03c72 is extremely small), a reduced model could still be beneficial, as long as\nthe conservative bound (lr\u2212 q)/lr \u2265 0.9 or q \u2264 lr/10 were achieved. this\nconservative bound assumes that no \u03c72 is lost by the reduction, that is that\nthe final model \u03c72 \u2248 lr. this is unlikely in practice. had the p \u2212 q omitted\nvariables had a larger \u03c72 of 2(p \u2212 q) (the break-even point for aic), q must\nbe \u2264 (lr \u2212 2p)/8.\n\nas an example, suppose that a binary logistic model is being developed\nfrom a sample containing 45 events on 150 subjects. the 10:1 rule suggests\nwe can analyze 4.5 degrees of freedom. the analyst wishes to analyze age,\nsex, and 10 other variables. it is not known whether interaction between age\nand sex exists, and whether age is linear. a restricted cubic spline is fitted\nwith four knots, and a linear interaction is allowed between age and sex.\nthese two variables then need 3 + 1 + 1 = 5 degrees of freedom. the other\n10 variables are assumed to be linear and to not interact with themselves\nor age and sex. there is a total of 15 d.f. the full model with 15 d.f. has\nlr = 50. expected shrinkage from this model is (50 \u2212 15)/50 = 0.7. since\nlr > 15 + 9 = 24, some reduction might yield a better validating model.\nreduction to q = (50 \u2212 15)/9 \u2248 4 d.f. would be necessary, assuming the\nreduced lr is about 50 \u2212 (15 \u2212 4) = 39. in this case the 10:1 rule yields\nabout the same value for q. the analyst may be forced to assume that age is\nlinear, modeling 3 d.f. for age and sex. the other 10 variables would have to\nbe reduced to a single variable using principal components or another scaling\ntechnique. the aic-based calculation yields a maximum of 2.5 d.f.\n\nif the goal of the analysis is to make a series of hypothesis tests (adjusting\np -values for multiple comparisons) instead of to predict future responses, the\nfull model would have to be used.\n\na summary of the various data reduction methods is given in figure 4.5.\nwhen principal component analysis or related methods are used for data\nreduction, the model may be harder to describe since internal coefficients are\n\u201chidden.\u201d r code on p. 141 shows how an ordinary linear model fit can be\nused in conjunction with a logistic model fit based on principal components\nto draw a nomogram with axes for all predictors.\n\n24\n\n "}, {"Page_number": 113, "text": "4.8 other approaches to predictive modeling\n\n89\n\nfig. 4.5 summary of some data reduction methods\n\ngoals\n\nreasons\n\nmethods\n\ngroup predictors so that\neach group represents a\nsingle dimension that can\nbe summarized with a sin-\ngle score\n\ntransform predictors\n\n\u2022 \u2193 d.f. arising from mul-\n\u2022 make p c1 more reason-\n\ntiple predictors\n\nable summary\n\n\u2022 \u2193 d.f. due to nonlin-\near and dummy variable\ncomponents\n\u2022 allows predictors to be\n\u2022 make p c1 more reason-\n\u2022 use\n\noptimally combined\n\ncustomized\nmodel\nimputing\nmissing values on each\npredictor\n\nable summary\n\nfor\n\nin\n\nvariable clustering\n\u2022 subject matter knowl-\nedge\n\u2022 group\n\nto\nmaximize proportion of\nvariance explained by\np c1 of each group\n\npredictors\n\n\u2022 hierarchical\n\nclustering\nusing a matrix of simi-\nlarity measures between\npredictors\n\n\u2022 maximum total vari-\nance on a group of re-\nlated predictors\n\u2022 canonical variates on\nthe total set of predic-\ntors\n\nscore a group of predic-\ntors\n\n\u2193 d.f. for group to unity\n\n\u2022 p c1\n\u2022 simple point scores\n\nmultiple\nscoring of all predictors\n\ndimensional\n\n\u2193 d.f.\ncombined\n\nfor all predictors\n\nprincipal\ncomponents\n1, 2, . . . , k, k < p com-\nputed from all\ntrans-\nformed predictors\n\n4.8 other approaches to predictive modeling\n\nthe approaches recommended in this text are\n\u2022 fitting fully pre-specified models without deletion of \u201cinsignificant\u201d predic-\n\ntors\n\n\u2022 using data reduction methods (masked to y ) to reduce the dimensionality\nof the predictors and then fitting the number of parameters the data\u2019s\ninformation content can support\n\n "}, {"Page_number": 114, "text": "90\n\n4 multivariable modeling strategies\n\n\u2022 using shrinkage (penalized estimation) to fit a large model without worry-\n\ning about the sample size.\n\ndata reduction approaches covered in the last section can yield very inter-\npretable, stable models, but there are many decisions to be made when using a\ntwo-stage (reduction/model fitting) approach. newer single stage approaches\nare evolving. these new approaches, listed on the text\u2019s web site, handle\ncontinuous predictors well, unlike recursive partitioning.\n\nwhen data reduction is not required, generalized additive models277, 674\n\nshould also be considered.\n\n4.9 overly influential observations\n\nevery observation should influence the fit of a regression model. it can be\ndisheartening, however, if a significant treatment effect or the shape of a\nregression effect rests on one or two observations. overly influential obser-\nvations also lead to increased variance of predicted values, especially when\nvariances are estimated by bootstrapping after taking variable selection into\naccount. in some cases, overly influential observations can cause one to aban-\ndon a model, \u201cchange\u201d the data, or get more data. observations can be overly\ninfluential for several major reasons.\n\n1. the most common reason is having too few observations for the complex-\nity of the model being fitted. remedies for this have been discussed in\nsections 4.7 and 4.3.\n\n2. data transcription or data entry errors can ruin a model fit.\n3. extreme values of the predictor variables can have a great impact, even\nwhen these values are validated for accuracy. sometimes the analyst may\ndeem a subject so atypical of other subjects in the study that deletion\nof the case is warranted. on other occasions, it is beneficial to truncate\nmeasurements where the data density ends. in one dataset of 4000 patients\nand 2000 deaths, white blood count (wbc) ranged from 500 to 100,000\nwith .05 and .95 quantiles of 2755 and 26,700, respectively. predictions\nfrom a linear spline function of wbc were sensitive to wbc > 60,000, for\nwhich there were 16 patients. there were 46 patients with wbc > 40,000.\npredictions were found to be more stable when wbc was truncated at\n40,000, that is, setting wbc to 40,000 if wbc > 40,000.\n\n4. observations containing disagreements between the predictors and the re-\nsponse can influence the fit. such disagreements should not lead to discard-\ning the observations unless the predictor or response values are erroneous\nas in reason 3, or the analysis is made conditional on observations being\nunlike the influential ones. in one example a single extreme predictor value\nin a sample of size 8000 that was not on a straight line relationship with\n\n "}, {"Page_number": 115, "text": "4.9 overly influential observations\n\n91\n\nthe other (x, y ) pairs caused a \u03c72 of 36 for testing nonlinearity of the pre-\ndictor. remember that an imperfectly fitting model is a fact of life, and\ndiscarding the observations can inflate the model\u2019s predictive accuracy. on\nrare occasions, such lack of fit may lead the analyst to make changes in\nthe model\u2019s structure, but ordinarily this is best done from the \u201cground\nup\u201d using formal tests of lack of fit (e.g., a test of linearity or interaction).\n\ninfluential observations of the second and third kinds can often be detected\nby careful quality control of the data. statistical measures can also be helpful.\nthe most common measures that apply to a variety of regression models are\nleverage, dfbetas, dffit, and dffits.\n\nleverage measures the capacity of an observation to be influential due\nto having extreme predictor values. such an observation is not necessarily\ninfluential. to compute leverage in ordinary least squares, we define the hat\nmatrix h given by\n\nh = x(x\n\nx)\n\n.\n\n(4.6)\n\n(cid:2)\n\n\u22121x\n\n(cid:2)\n\nh is the matrix that when multiplied by the response vector gives the pre-\ndicted values, so it measures how an observation estimates its own predicted\nresponse. the diagonals hii of h are the leverage measures and they are not\ninfluenced by y . it has been suggested47 that hii > 2(p + 1)/n signal a high\nleverage point, where p is the number of columns in the design matrix x\naside from the intercept and n is the number of observations. some believe\nthat the distribution of hii should be examined for values that are higher\nthan typical.\n\ndfbetas is the change in the vector of regression coefficient estimates\nupon deletion of each observation in turn, scaled by their standard errors.47\nsince dfbetas encompasses an effect for each predictor\u2019s coefficient, df-\nbetas allows the analyst to isolate the problem better than some of the\nother measures. dffit is the change in the predicted x\u03b2 when the observa-\ntion is dropped, and dffits is dffit standardized by the standard error\n(cid:7)\nof the estimate of x\u03b2. in both cases, the standard error used for normal-\nization is recomputed each time an observation is omitted. some classify an\n(p + 1)/(n \u2212 p \u2212 1),\nobservation as overly influential when |dffits| > 2\nwhile others prefer to examine the entire distribution of dffits to identify\n\u201coutliers\u201d.47\n\nsection 10.7 discusses influence measures for the logistic model, which\nrequires maximum likelihood estimation. these measures require the use of\nspecial residuals and information matrices (in place of x\n\nx).\n\n(cid:2)\n\nif truly influential observations are identified using these indexes, careful\nthought is needed to decide how (or whether) to deal with them. most im-\nportant, there is no substitute for careful examination of the dataset before\ndoing any analyses.99 spence and garrison [581, p. 16] feel that\n\nalthough the identification of aberrations receives considerable attention in\nmost modern statistical courses, the emphasis sometimes seems to be on dis-\nposing of embarrassing data by searching for sources of technical error or\n\n "}, {"Page_number": 116, "text": "92\n\n4 multivariable modeling strategies\n\nminimizing the influence of inconvenient data by the application of resistant\nmethods. working scientists often find the most interesting aspect of the anal-\nysis inheres in the lack of fit rather than the fit itself.\n\n4.10 comparing two models\n\nfrequently one wants to choose between two competing models on the ba-\nsis of a common set of observations. the methods that follow assume that\nthe performance of the models is evaluated on a sample not used to develop\neither one. in this case, predicted values from the model can usually be con-\nsidered as a single new variable for comparison with responses in the new\ndataset. these methods listed below will also work if the models are com-\npared using the same set of data used to fit each one, as long as both models\nhave the same effective number of (candidate or actual) parameters. this\nrequirement prevents us from rewarding a model just because it overfits the\ntraining sample (see section 9.8.1 for a method comparing two models of dif-\nfering complexity). the methods can also be enhanced using bootstrapping\nor cross-validation on a single sample to get a fair comparison when the play-\ning field is not level, for example, when one model had more opportunity for\nfitting or overfitting the responses.\n\nsome of the criteria for choosing one model over the other are\n\n1. calibration (e.g., one model is well-calibrated and the other is not),\n2. discrimination,\n3. face validity,\n4. measurement errors in required predictors,\n5. use of continuous predictors (which are usually better defined than cate-\n\ngorical ones),\n\n6. omission of \u201cinsignificant\u201d variables that nonetheless make sense as risk\n\nfactors,\n\n7. simplicity (although this is less important with the availability of comput-\n\ners), and\n\n8. lack of fit for specific types of subjects.\n\nitems 3 through 7 require subjective judgment, so we focus on the other as-\npects. if the purpose of the models is only to rank-order subjects, calibration\nis not an issue. otherwise, a model having poor calibration can be dismissed\noutright. given that the two models have similar calibration, discrimination\nshould be examined critically. various statistical indexes can quantify dis-\ncrimination ability (e.g., r2, model \u03c72, somers\u2019 dxy, spearman\u2019s \u03c1, area un-\nder roc curve\u2014see section 10.8). rank measures (dxy, \u03c1, roc area) only\nmeasure how well predicted values can rank-order responses. for example,\npredicted probabilities of 0.01 and 0.99 for a pair of subjects are no better\nthan probabilities of 0.2 and 0.8 using rank measures, if the first subject had\n\n "}, {"Page_number": 117, "text": "4.10 comparing two models\n\n93\n\na lower response value than the second. therefore, rank measures such as\nroc area (c index), although fine for describing a given model, may not be\nvery sensitive in choosing between two models118, 488, 493. this is especially\ntrue when the models are strong, as it is easier to move a rank correlation\nfrom 0.6 to 0.7 than it is to move it from 0.9 to 1.0. measures such as r2 and\nthe model \u03c72 statistic (calculated from the predicted and observed responses)\nare more sensitive. still, one may not know how to interpret the added utility\nof a model that boosts the r2 from 0.80 to 0.81.\n\nagain given that both models are equally well calibrated, discrimination\ncan be studied more simply by examining the distribution of predicted values\n\u02c6y . suppose that the predicted value is the probability that a subject dies.\nthen high-resolution histograms of the predicted risk distributions for the\ntwo models can be very revealing. if one model assigns 0.02 of the sample to\na risk of dying above 0.9 while the other model assigns 0.08 of the sample to\nthe high risk group, the second model is more discriminating. the worth of a\nmodel can be judged by how far it goes out on a limb while still maintaining\ngood calibration.\n\nfrequently, one model will have a similar discrimination index to another\nmodel, but the likelihood ratio \u03c72 statistic is meaningfully greater for one. as-\nsuming corrections have been made for complexity, the model with the higher\n\u03c72 usually has a better fit for some subjects, although not necessarily for the\naverage subject. a crude plot of predictions from the first model against\npredictions from the second, possibly stratified by y , can help describe the\ndifferences in the models. more specific analyses will determine the charac-\nteristics of subjects where the differences are greatest. large differences may\nbe caused by an omitted, underweighted, or improperly transformed predic-\ntor, among other reasons. in one example, two models for predicting hospital\nmortality in critically ill patients had the same discrimination index (to two\ndecimal places). for the relatively small subset of patients with extremely low\nwhite blood counts or serum albumin, the model that treated these factors\nas continuous variables provided predictions that were very much different\nfrom a model that did not.\n\nwhen comparing predictions for two models that may not be calibrated\n(from overfitting, e.g.), the two sets of predictions may be shrunk so as to\nnot give credit for overfitting (see equation 4.3).\n\nsometimes one wishes to compare two models that used the response vari-\nable differently, a much more difficult problem. for example, an investigator\nmay want to choose between a survival model that used time as a continuous\nvariable, and a binary logistic model for dead/alive at six months. here, other\nconsiderations are also important (see section 17.1). a model that predicts\ndead/alive at six months does not use the response variable effectively, and\nit provides no information on the chance of dying within three months.\n\nwhen one or both of the models is fitted using least squares, it is useful\nto compare them using an error measure that was not used as the optimiza-\ntion criterion, such as mean absolute error or median absolute error. mean\n\n25\n\n "}, {"Page_number": 118, "text": "94\n\n4 multivariable modeling strategies\n\nand median absolute errors are excellent measures for judging the value of a\nmodel developed without transforming the response to a model fitted after\ntransforming y , then back-transforming to get predictions.\n\n26\n\n4.11 improving the practice of multivariable prediction\n\nstandards for published predictive modeling and feature selection in high-\ndimensional problems are not very high. there are several things that a good\nanalyst can do to improve the situation.\n\n1. insist on validation of predictive models and discoveries, using rigorous\n\ninternal validation based on resampling or using external validation.\n\n2. show collaborators that split-sample validation is not appropriate unless\n\nthe number of subjects is huge\n\u2022 this can be demonstrated by spliting the data more than once and\nseeing volatile results, and by calculating a confidence interval for the\npredictive accuracy in the test dataset and showing that it is very wide.\n\n3. run a simulation study with no real associations and show that asso-\nciations are easy to find if a dangerous data mining procedure is used.\nalternately, analyze the collaborator\u2019s data after randomly permuting the\ny vector and show some \u201cpositive\u201d findings.\n\n4. show that alternative explanations are easy to posit. for example:\n\n\u2022 the importance of a risk factor may disappear if 5 \u201cunimportant\u201d risk\n\nfactors are added back to the model\n\n\u2022 omitted main effects can explain away apparent interactions.\n\u2022 perform a uniqueness analysis: attempt to predict the predicted val-\nues from a model derived by data torture from all of the features not\nused in the model. if one can obtain r2 = 0.85 in predicting the \u201cwin-\nning\u201d feature signature (predicted values) from the \u201closing\u201d features, the\n\u201cwinning\u201d pattern is not unique and may be unreliable.\n\n4.12 summary: possible modeling strategies\n\nsome possible global modeling strategies are to\n\u2022 use a method known not to work well (e.g., stepwise variable selection\nwithout penalization; recursive partitioning resulting in a single tree), doc-\nument how poorly the model performs (e.g. using the bootstrap), and use\nthe model anyway\n\n\u2022 develop a black box model that performs poorly and is difficult to interpret\n\n(e.g., does not incorporate penalization)\n\n "}, {"Page_number": 119, "text": "4.12 summary: possible modeling strategies\n\n95\n\n\u2022 develop a black box model that performs well and is difficult to interpret\n\u2022 develop interpretable approximations to the black box\n\u2022 develop an interpretable model (e.g. give priority to additive effects) that\nperforms well and is likely to perform equally well on future data from the\nsame stream.\n\nas stated in the preface, the strategy emphasized in this text, stemming\nfrom the last philosophy, is to decide how many degrees of freedom can be\n\u201cspent,\u201d where they should be spent, and then to spend them. if statistical\ntests or confidence limits are required, later reconsideration of how d.f. are\nspent is not usually recommended. in what follows some default strategies\nare elaborated. these strategies are far from failsafe, but they should allow\nthe reader to develop a strategy that is tailored to a particular problem. at\nthe least these default strategies are concrete enough to be criticized so that\nstatisticians can devise better ones.\n\n4.12.1 developing predictive models\n\nthe following strategy is generic although it is aimed principally at the de-\nvelopment of accurate predictive models.\n\n1. assemble as much accurate pertinent data as possible, with wide distri-\nbutions for predictor values. for survival time data, follow-up must be\nsufficient to capture enough events as well as the clinically meaningful\nphases if dealing with a chronic process.\n\n2. formulate good hypotheses that lead to specification of relevant candi-\ndate predictors and possible interactions. don\u2019t use y (either informally\nusing graphs, descriptive statistics, or tables, or formally using hypothe-\nsis tests or estimates of effects such as odds ratios) in devising the list of\ncandidate predictors.\n\n3. if there are missing y values on a small fraction of the subjects but y\ncan be reliably substituted by a surrogate response, use the surrogate to\nreplace the missing values. characterize tendencies for y to be missing\nusing, for example, recursive partitioning or binary logistic regression.\ndepending on the model used, even the information on x for observa-\ntions with missing y can be used to improve precision of \u02c6\u03b2, so multiple\nimputation of y can sometimes be effective. otherwise, discard observa-\ntions having missing y .\n\n4. impute missing xs if the fraction of observations with any missing xs is\nnot tiny. characterize observations that had to be discarded. special im-\nputation models may be needed if a continuous x needs a non-monotonic\ntransformation (p. 52). these models can simultaneously impute missing\nvalues while determining transformations. in most cases, multiply impute\nmissing xs based on other xs and y , and other available information\nabout the missing data mechanism.\n\n "}, {"Page_number": 120, "text": "96\n\n4 multivariable modeling strategies\n\n5. for each predictor specify the complexity or degree of nonlinearity that\nshould be allowed (see section 4.1). when prior knowledge does not in-\ndicate that a predictor has a linear effect on the property c(y |x) (the\nproperty of the response that can be linearly related to x), specify the\nnumber of degrees of freedom that should be devoted to the predictor.\nthe d.f. (or number of knots) can be larger when the predictor is thought\nto be more important in predicting y or when the sample size is large.\n6. if the number of terms fitted or tested in the modeling process (counting\nnonlinear and cross-product terms) is too large in comparison with the\nnumber of outcomes in the sample, use data reduction (ignoring y ) until\nthe number of remaining free variables needing regression coefficients is\ntolerable. use the m/10 or m/15 rule or an estimate of likely shrinkage\nor overfitting (section 4.7) as a guide. transformations determined from\nthe previous step may be used to reduce each predictor into 1 d.f., or the\ntransformed variables may be clustered into highly correlated groups if\nmore data reduction is required. alternatively, use penalized estimation\nwith the entire set of variables. this will also effectively reduce the total\ndegrees of freedom.272\n\n7. use the entire sample in the model development as data are too precious\nto waste. if steps listed below are too difficult to repeat for each bootstrap\nor cross-validation sample, hold out test data from all model development\nsteps that follow.\n\n8. when you can test for model complexity in a very structured way, you\nmay be able to simplify the model without a great need to penalize the\nfinal model for having made this initial look. for example, it can be\nadvisable to test an entire group of variables (e.g., those more expensive\nto collect) and to either delete or retain the entire group for further\nmodeling, based on a single p -value (especially if the p value is not\nbetween 0.05 and 0.2). another example of structured testing to simplify\nthe \u201cinitial\u201d model is making all continuous predictors have the same\nnumber of knots k, varying k from 0 (linear), 3, 4, 5, . . . , and choosing\nthe value of k that optimizes aic. a composite test of all nonlinear effects\nin a model can also be used, and statistical inferences are not invalidated\nif the global test of nonlinearity yields p > 0.2 or so and the analyst\ndeletes all nonlinear terms.\n\n9. make tests of linearity of effects in the model only to demonstrate to\nothers that such effects are often statistically significant. don\u2019t remove\ninsignificant effects from the model when tested separately by predictor.\nany examination of the response that might result in simplifying the\nmodel needs to be accounted for in computing confidence limits and other\nstatistics. it is preferable to retain the complexity that was prespecified\nin step 5 regardless of the results of assessments of nonlinearity.\n\n "}, {"Page_number": 121, "text": "4.12 summary: possible modeling strategies\n\n97\n\n10. check additivity assumptions by testing prespecified interaction terms.\nif the global test for additivity is significant or equivocal, all prespecified\ninteractions should be retained in the model. if the test is decisive (e.g.,\np > 0.3), all interaction terms can be omitted, and in all likelihood there\nis no need to repeat this pooled test for each resample during model\nvalidation. in other words, one can assume that had the global interaction\ntest been carried out for each bootstrap resample it would have been\ninsignificant at the 0.05 level more than, say, 0.9 of the time. in this large\np -value case the pooled interaction test did not induce an uncertainty in\nmodel selection that needed accounting.\n\n11. check to see if there are overly influential observations.\n12. check distributional assumptions and choose a different model if needed.\n13. do limited backwards step-down variable selection if parsimony is more\nimportant than accuracy.582 the cost of doing any aggressive variable\nselection is that the variable selection algorithm must also be included\nin a resampling procedure to properly validate the model or to compute\nconfidence limits and the like.\n\n14. this is the \u201cfinal\u201d model.\n15. interpret the model graphically (section 5.1) and by examining predicted\nvalues and using appropriate significance tests without trying to interpret\nsome of the individual model parameters. for collinear predictors obtain\npooled tests of association so that competition among variables will not\ngive misleading impressions of their total significance.\n\n16. validate the final model for calibration and discrimination ability, prefer-\nably using bootstrapping (see section 5.3). steps 9 to 13 must be repeated\nfor each bootstrap sample, at least approximately. for example, if age was\ntransformed when building the final model, and the transformation was\nsuggested by the data using a fit involving age and age2, each bootstrap\nrepetition should include both age variables with a possible step-down\nfrom the quadratic to the linear model based on automatic significance\ntesting at each step.\n\n17. shrink parameter estimates if there is overfitting but no further data\nreduction is desired, if shrinkage was not built into the estimation process.\n18. when missing values were imputed, adjust final variance\u2013covariance ma-\ntrix for imputation wherever possible (e.g., using bootstrap or multiple\nimputation). this may affect some of the other results.\n\n19. when all steps of the modeling strategy can be automated, consider\nusing faraway\u2019s method186 to penalize for the randomness inherent in\nthe multiple steps.\n\n20. develop simplifications to the full model by approximating it to any\n\ndesired degrees of accuracy (section 5.5).\n\n27\n\n "}, {"Page_number": 122, "text": "98\n\n4 multivariable modeling strategies\n\n4.12.2 developing models for effect estimation\n\nby effect estimation is meant point and interval estimation of differences in\nproperties of the responses between two or more settings of some predictors, or\nestimating some function of these differences such as the antilog. in ordinary\nmultiple regression with no transformation of y such differences are absolute\nestimates. in regression involving log(y ) or in logistic or proportional hazards\nmodels, effect estimation is, at least initially, concerned with estimation of\nrelative effects. as discussed on pp. 4 and 224, estimation of absolute effects\nfor these models must involve accurate prediction of overall response values,\nso the strategy in the previous section applies.\n\nwhen estimating differences or relative effects, the bias in the effect es-\ntimate, besides being influenced by the study design, is related to how well\nsubject heterogeneity and confounding are taken into account. the variance\nof the effect estimate is related to the distribution of the variable whose levels\nare being compared, and, in least squares estimates, to the amount of vari-\nation \u201cexplained\u201d by the entire set of predictors. variance of the estimated\ndifference can increase if there is overfitting. so for estimation, the previous\nstrategy largely applies.\n\nthe following are differences in the modeling strategy when effect estima-\n\ntion is the goal.\n\n1. there is even less gain from having a parsimonious model than when de-\nveloping overall predictive models, as estimation is usually done at the\ntime of analysis. leaving insignificant predictors in the model increases\nthe likelihood that the confidence interval for the effect of interest has the\nstated coverage. by contrast, overall predictions are conditional on the\nvalues of all predictors in the model. the variance of such predictions is\nincreased by the presence of unimportant variables, as predictions are still\nconditional on the particular values of these variables (section 5.5.1) and\ncancellation of terms (which occurs when differences are of interest) does\nnot occur.\n\n2. careful consideration of inclusion of interactions is still a major consid-\neration for estimation. if a predictor whose effects are of major interest\nis allowed to interact with one or more other predictors, effect estimates\nmust be conditional on the values of the other predictors and hence have\nhigher variance.\n\n3. a major goal of imputation is to avoid lowering the sample size because\nof missing values in adjustment variables. if the predictor of interest is the\nonly variable having a substantial number of missing values, multiple im-\nputation is less worthwhile, unless it corrects for a substantial bias caused\nby deletion of nonrandomly missing data.\n\n "}, {"Page_number": 123, "text": "4.12 summary: possible modeling strategies\n\n99\n\n4. the analyst need not be very concerned about conserving degrees of free-\ndom devoted to the predictor of interest. the complexity allowed for this\nvariable is usually determined by prior beliefs, with compromises that con-\nsider the bias-variance trade-off.\n\n5. if penalized estimation is used, the analyst may wish to not shrink param-\n\neter estimates for the predictor of interest.\n\n6. model validation is not necessary unless the analyst wishes to use it to\n\nquantify the degree of overfitting.\n\n4.12.3 developing models for hypothesis testing\n\na default strategy for developing a multivariable model that is to be used\nas a basis for hypothesis testing is almost the same as the strategy used for\nestimation.\n\n1. there is little concern for parsimony. a full model fit, including insignifi-\ncant variables, will result in more accurate p -values for tests for the vari-\nables of interest.\n\n2. careful consideration of inclusion of interactions is still a major consid-\neration for hypothesis testing. if one or more predictors interacts with a\nvariable of interest, either separate hypothesis tests are carried out over\nthe levels of the interacting factors, or a combined \u201cmain effect + interac-\ntion\u201d test is performed. for example, a very well\u2013defined test is whether\ntreatment is effective for any race group.\n\n3. if the predictor of interest is the only variable having a substantial number\nof missing values, multiple imputation is less worthwhile. in some cases,\nmultiple imputation may increase power (e.g., in ordinary multiple regres-\nsion one can obtain larger degrees of freedom for error) but in others there\nwill be little net gain. however, the test can be biased due to exclusion of\nnonrandomly missing observations if imputation is not done.\n\n4. as before, the analyst need not be very concerned about conserving degrees\nof freedom devoted to the predictor of interest. the degrees of freedom\nallowed for this variable is usually determined by prior beliefs, with careful\nconsideration of the trade-off between bias and power.\n\n5. if penalized estimation is used, the analyst should not shrink parameter\n\nestimates for the predictors being tested.\n\n6. model validation is not necessary unless the analyst wishes to use it to\nquantify the degree of overfitting. this may shed light on whether there is\noveradjustment for confounders.\n\n "}, {"Page_number": 124, "text": "100\n\n4 multivariable modeling strategies\n\n4.13 further reading\n\n1\n\n2\n\n3\n\n4\n\n5\n\nsome good general references that address modeling strategies are [216,269,476,\n590].\neven though they used a generalized correlation index for screening variables\nand not for transforming them, hall and miller249 present a related idea, com-\nputing the ordinary r2 against a cubic spline transformation of each potential\npredictor.\nsimulation studies are needed to determine the effects of modifying the model\nbased on assessments of \u201cpredictor promise.\u201d although it is unlikely that this\nstrategy will result in regression coefficients that are biased high in absolute\nvalue, it may on some occasions result in somewhat optimistic standard errors\nand a slight elevation in type i error probability. some simulation results may\nbe found on the web site. initial promising findings for least squares models\nfor two uncorrelated predictors indicate that the procedure is conservative in\nits estimation of \u03c32 and in preserving type i error.\nverweij and van houwelingen640 and shao565 describe how cross-validation can\nbe used in formulating a stopping rule. luo et al.430 developed an approach to\ntuning forward selection by adding noise to y .\nroecker528 compared forward variable selection (fs) and all possible subsets\nselection (aps) with full model fits in ordinary least squares. aps had a greater\ntendency to select smaller, less accurate models than fs. neither selection tech-\nnique was as accurate as the full model fit unless more than half of the candidate\nvariables was redundant or unnecessary.\n\n8\n\n7\n\n6 wiegand668 showed that it is not very fruitful to try different stepwise algo-\nrithms and then to be comforted by agreements in some of the variables selected.\nit is easy for different stepwise methods to agree on the wrong set of variables.\nother results on how variable selection affects inference may be found in hurvich\nand tsai316 and breiman [66, section 8.1].\ngoring et al.227 presented an interesting analysis of the huge bias caused by\nconditioning analyses on statistical significance in a high-dimensional genetics\ncontext.\nsteyerberg et al.589 have comparisons of smoothly penalized estimators with\nthe lasso and with several stepwise variable selection algorithms.\nsee weiss,656 faraway,186 and chatfield100 for more discussions of the effect of\nnot prespecifying models, for example, dependence of point estimates of effects\non the variables used for adjustment.\n\n10\n\n9\n\n11 greenland241 provides an example in which overfitting a logistic model resulted\n\n12\n\nin far too many predictors with p < 0.05.\nsee peduzzi et al.486, 487 for studies of the relationship between \u201cevents per\nvariable\u201d and types i and ii error, accuracy of variance estimates, and accuracy\nof normal approximations for regression coefficient estimators. their findings\nare consistent with those given in the text (but644 has a slightly different take).\nvan der ploeg et al.629 did extensive simulations to determine the events per\nvariable ratio needed to avoid a drop-off (in an independent test sample) in more\nthan 0.01 in the c-index, for a variety of predictive methods. they concluded\nthat support vector machines, neural networks, and random forests needed far\nmore events per variable to achieve freedom from overfitting than does logistic\nregression, and that recursive partitioning was not competitive. logistic regres-\nsion required between 20 and 50 events per variable to avoid overfitting. differ-\nent results might have been obtained had the authors used a proper accuracy\nscore.\n\n13 copas [122, eq. 8.5] adds 2 to the numerator of equation 4.3 (see also [504,631]).\n\n "}, {"Page_number": 125, "text": "4.13 further reading\n\n101\n\np\n\n16\n17\n\n14 an excellent discussion about such indexes may be found in http://r.789695.\nn4.nabble.com/adjusted-r-squared-formula-in-lm-td4656857.html where\nj. lucke points out that r2 tends to\nn\u22121 when the population r2 is zero,\nbut r2\n\nadj converges to zero.\n\n15 efron [173, eq. 4.23] and van houwelingen and le cessie633 showed that the av-\nerage expected optimism in a mean logarithmic quality score for a p-predictor\nbinary logistic model is p/n. taylor et al.600 showed that the ratio of variances\nfor certain quantities is proportional to the ratio of the number of parameters\nin two models. copas stated that \u201cshrinkage can be particularly marked when\nstepwise fitting is used: the shrinkage is then closer to that expected of the\nfull regression rather than of the subset regression actually fitted.\u201d122, 504, 631\nspiegelhalter,582 in arguing against variable selection, states that better predic-\ntion will often be obtained by fitting all candidate variables in the final model,\nshrinking the vector of regression coefficient estimates towards zero.\nsee belsley [46, pp. 28\u201330] for some reservations about using vif.\nfriedman and wall208 discuss and provide graphical devices for explaining sup-\npression by a predictor not correlated with the response but that is correlated\nwith another predictor. adjusting for a suppressor variable will increase the\npredictive discrimination of the model. meinshausen453 developed a novel hier-\narchical approach to gauging the importance of collinear predictors.\nfor incomplete principal component regression see [101, 119, 120, 142, 144, 320,\n325]. see396, 686 for sparse principal component analysis methods in which con-\nstraints are applied to loadings so that some of them are set to zero. the latter\nreference provides a principal component method for binary data. see246 for\na type of sparse principal component analysis that also encourages loadings\nto be similar for a group of highly correlated variables and allows for a type\nof variable clustering.see [390] for principal surfaces. sliced inverse regression\nis described in [104, 119, 120, 189, 403, 404]. for material on variable cluster-\ning see [142, 144, 268, 441, 539]. a good general reference on cluster analysis\nis [634, chapter 11]. de leeuw and mair in their r homals package [153] have\none of the most general approaches to data reduction related to optimal scaling.\ntheir approach includes nonlinear principal component analysis among several\nother multivariate analyses.\n\n19 the redundancy analysis described here is related to principal variables 448 but\n\n18\n\nis faster.\n\n20 meinshausen453 developed a method of testing the importance of competing\n\n(collinear) variables using an interesting automatic clustering procedure.\n\n21 the r clustofvar package by marie chavent, vanessa kuentz, benoit liquet,\nand jerome saracco generalizes variable clustering and explicitly handles a mix-\nture of quantitative and categorical predictors. it also implements bootstrap\ncluster stability analysis.\n\n23\n\n22 principal components are commonly used to summarize a cluster of variables.\nvines643 developed a method to constrain the principal component coefficients\nto be integers without much loss of explained variability.\njolliffe324 presented a way to discard some of the variables making up principal\ncomponents. wang and gehan649 presented a new method for finding subsets of\npredictors that approximate a set of principal components, and surveyed other\nmethods for simplifying principal components.\nsee d\u2019agostino et al.144 for excellent examples of variable clustering (including\na two-stage approach) and other data reduction techniques using both statistical\nmethods and subject-matter expertise.\n\n25 cook118 and pencina et al.490, 492, 493 present an approach for judging the\nadded value of new variables that is based on evaluating the extent to which\nthe new information moves predicted probabilities higher for subjects having\nevents and lower for subjects not having events. but see292, 592.\n\n24\n\n "}, {"Page_number": 126, "text": "102\n\n4 multivariable modeling strategies\n\n26 the hmisc abs.error.pred function computes a variety of accuracy measures\n\n27\n\nbased on absolute errors.\nshen et al.567 developed an \u201coptimal approximation\u201d method to make correct\ninferences after model selection.\n\n4.14 problems\n\nanalyze the support dataset (gethdata(support)) as directed below to re-\nlate selected variables to total cost of the hospitalization. make sure this\nresponse variable is utilized in a way that approximately satisfies the assump-\ntions of normality-based multiple regression so that statistical inferences will\nbe accurate. see problems at the end of chapters 3 and 7 of the text for more\ninformation. consider as predictors mean arterial blood pressure, heart rate,\nage, disease group, and coma score.\n\n1. do an analysis to understand interrelationships among predictors, and find\noptimal scaling (transformations) that make the predictors better relate\nto each other (e.g., optimize the variation explained by the first principal\ncomponent).\n\n2. do a redundancy analysis of the predictors, using both a less stringent and\na more stringent approach to assessing the redundancy of the multiple-level\nvariable disease group.\n\n3. do an analysis that helps one determine how many d.f. to devote to each\n\npredictor.\n\n4. fit a model, assuming the above predictors act additively, but do not as-\nsume linearity for the age and blood pressure effects. use the truncated\npower basis for fitting restricted cubic spline functions with 5 knots. esti-\nmate the shrinkage coefficient \u02c6\u03b3.\n\n5. make appropriate graphical diagnostics for this model.\n6. test linearity in age, linearity in blood pressure, and linearity in heart rate,\nand also do a joint test of linearity simultaneously in all three predictors.\n7. expand the model to not assume additivity of age and blood pressure.\nuse a tensor natural spline or an appropriate restricted tensor spline. if\nyou run into any numerical difficulties, use 4 knots instead of 5. plot in an\ninterpretable fashion the estimated 3-d relationship between age, blood\npressure, and cost for a fixed disease group.\n\n8. test for additivity of age and blood pressure. make a joint test for the\noverall absence of complexity in the model (linearity and additivity simul-\ntaneously).\n\n "}, {"Page_number": 127, "text": "chapter 5\ndescribing, resampling, validating,\nand simplifying the model\n\n5.1 describing the fitted model\n\n5.1.1 interpreting effects\n\nbefore addressing issues related to describing and interpreting the model\nand its coefficients, one can never apply too much caution in attempting to\ninterpret results in a causal manner. regression models are excellent tools\nfor estimating and inferring associations between an x and y given that the\n\u201cright\u201d variables are in the model. any ability of a model to provide causal\ninference rests entirely on the faith of the analyst in the experimental design,\ncompleteness of the set of variables that are thought to measure confounding\nand are used for adjustment when the experiment is not randomized, lack of\nimportant measurement error, and lastly the goodness of fit of the model.\n\nthe first line of attack in interpreting the results of a multivariable analysis\nis to interpret the model\u2019s parameter estimates. for simple linear, additive\nmodels, regression coefficients may be readily interpreted. if there are in-\nteractions or nonlinear terms in the model, however, simple interpretations\nare usually impossible. many programs ignore this problem, routinely print-\ning such meaningless quantities as the effect of increasing age2 by one day\nwhile holding age constant. a meaningful age change needs to be chosen, and\nconnections between mathematically related variables must be taken into\naccount. these problems can be solved by relying on predicted values and\ndifferences between predicted values.\n\neven when the model contains no nonlinear effects, it is difficult to com-\npare regression coefficients across predictors having varying scales. some an-\nalysts like to gauge the relative contributions of different predictors on a\ncommon scale by multiplying regression coefficients by the standard devia-\ntions of the predictors that pertain to them. this does not make sense for\nnonnormally distributed predictors (and regression models should not need\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 5\n\n103\n\n "}, {"Page_number": 128, "text": "1\n\n2\n\n3\n\n4\n\n104\n\n5 describing, resampling, validating, and simplifying the model\n\nto make assumptions about the distributions of predictors). when a predic-\ntor is binary (e.g., sex), the standard deviation makes no sense as a scaling\nfactor as the scale would depend on the prevalence of the predictor.a\n\nit is more sensible to estimate the change in y when xj is changed by\nan amount that is subject-matter relevant. for binary predictors this is a\nchange from 0 to 1. for many continuous predictors the interquartile range\nis a reasonable default choice. if the 0.25 and 0.75 quantiles of xj are g and\nh, linearity holds, and the estimated coefficient of xj is b; b \u00d7 (h \u2212 g) is the\neffect of increasing xj by h \u2212 g units, which is a span that contains half of\nthe sample values of xj.\n\nfor the more general case of continuous predictors that are monotonically\nbut not linearly related to y , a useful point summary is the change in x\u03b2\nwhen the variable changes from its 0.25 quantile to its 0.75 quantile. for\nmodels for which exp(x\u03b2) is meaningful, antilogging the predicted change in\nx\u03b2 results in quantities such as interquartile-range odds and hazards ratios.\nwhen the variable is involved in interactions, these ratios are estimated sep-\narately for various levels of the interacting factors. for categorical predictors,\nordinary effects are computed by comparing each level of the predictor with\na reference level. see section 10.10 and chapter 11 for tabular and graphical\nexamples of this approach.\n\nthe model can be described using partial effect plots by plotting each x\nagainst x \u02c6\u03b2 holding other predictors constant. modified versions of such plots,\nby nonlinearly rank-transforming the predictor axis, can show the relative\nimportance of a predictor336.\n\nfor an x that interacts with other factors, separate curves are drawn on\n\nthe same graph, one for each level of the interacting factor.\n\nnomograms40, 254, 339, 427 provide excellent graphical depictions of all the\nvariables in the model, in addition to enabling the user to obtain predicted\nvalues manually. nomograms are especially good at helping the user envision\ninteractions. see section 10.10 and chapter 11 for examples.\n\n5.1.2 indexes of model performance\n\n5.1.2.1 error measures\n\ncare must be taken in the choice of accuracy scores to be used in validation.\nindexes can be broken down into three main areas.\n\ncentral tendency of prediction errors: these measures include mean abso-\nlute differences, mean squared differences, and logarithmic scores. an ab-\nsolute measure is mean |y \u2212 \u02c6y |. the mean squared error is a commonly\n(cid:7)\nused and sensitive measure if there are no outliers. for the special case\na(1 \u2212 a),\n\na the s.d. of a binary variable is, aside from a multiplier of n\nwhere a is the proportion of ones.\n\nn\u22121 , equal to\n\n "}, {"Page_number": 129, "text": "5.1 describing the fitted model\n\n105\n\nwhere y is binary, such a measure is the brier score, which is a quadratic\nproper scoring rule that combines calibration and discriminationb. the\nlogarithmic proper scoring rules (related to average log-likelihood) is even\nmore sensitive but can be harder to interpret and can be destroyed by a\nsingle predicted probability of 0 or 1 that was incorrect.\n\ndiscrimination measures: a measure of pure discrimination is a rank corre-\nlation of \u02c6y and y , including spearman\u2019s \u03c1, kendall\u2019s \u03c4 , and somers\u2019 dxy.\nwhen y is binary, dxy = 2 \u00d7 (c \u2212 1\n2 ) where c is the concordance prob-\nability or area under the receiver operating characteristic curve, a linear\ntranslation of the wilcoxon-mann-whitney statistic. r2 is mostly a mea-\nsure of discrimination, and r2\nadj is is a good overfitting-corrected measure,\nif the model is pre-specified. see section 10.8 for more information about\nrank-based measures.\n\ndiscrimination measures based on variation in \u02c6y : these include the regres-\n\nsion sum of squares and the g\u2013index (see below).\n\ncalibration measures: these\n\nassess\n\nabsolute\n\nprediction\n\naccuracy.\ncalibration\u2013in\u2013the\u2013large compares the average \u02c6y with the average y .\na high-resolution calibration curve or calibration\u2013in\u2013the\u2013small assesses the\nabsolute forecast accuracy of predictions at individual levels of \u02c6y . when\nthe calibration curve is linear, this can be summarized by the calibration\nslope and intercept. a more general approach uses the loess nonparametric\nsmoother to estimate the calibration curve37. for any shape of calibration\ncurve, errors can be summarized by quantities such as the maximum ab-\nsolute calibration error, mean absolute calibration error, and 0.9 quantile\nof calibration error.\n\nthe g-index is a new measure of a model\u2019s predictive discrimination based\nonly on x \u02c6\u03b2 = \u02c6y that applies quite generally. it is based on gini\u2019s mean\ndifference for a variable z, which is the mean over all possible i (cid:5)= j of |zi \u2212\nzj|. the g-index is an interpretable, robust, and highly efficient measure of\nvariation. for example, when predicting systolic blood pressure, g = 11mmhg\nrepresents a typical difference in \u02c6y . g is independent of censoring and other\ncomplexities. for models in which the anti-log of a difference in \u02c6y represents\nmeaningful ratios (e.g., odds ratios, hazard ratios, ratio of medians), gr can\nbe defined as exp(g). for models in which \u02c6y can be turned into a probability\nestimate (e.g., logistic regression), gp is defined as gini\u2019s mean difference of\n\u02c6p . these g\u2013indexes represent e.g. \u201ctypical\u201d odds ratios, and \u201ctypical\u201d risk\ndifferences. partial g indexes can also be defined. more details may be found\nin the documentation for the r rms package\u2019s gindex function.\n\n5\n\nb there are decompositions of the brier score into discrimination and calibration\ncomponents.\n\n "}, {"Page_number": 130, "text": "106\n\n5 describing, resampling, validating, and simplifying the model\n\n5.2 the bootstrap\n\nwhen one assumes that a random variable y has a certain population dis-\ntribution, one can use simulation or analytic derivations to study how a sta-\ntistical estimator computed from samples from this distribution behaves. for\nexample, when y has a log-normal distribution, the variance of the sample\nmedian for a sample of size n from that distribution can be derived analyt-\nically. alternatively, one can simulate 500 samples of size n from the log-\nnormal distribution, compute the sample median for each sample, and then\ncompute the sample variance of the 500 sample medians. either case requires\nknowledge of the population distribution function.\n\nefron\u2019s bootstrap150, 177, 178 is a general-purpose technique for obtaining es-\ntimates of the properties of statistical estimators without making assumptions\nabout the distribution giving rise to the data. suppose that a random variable\ny comes from a cumulative distribution function f (y) = prob{y \u2264 y} and\nthat we have a sample of size n from this unknown distribution, y1, y2, . . . , yn.\nthe basic idea is to repeatedly simulate a sample of size n from f , computing\nthe statistic of interest, and assessing how the statistic behaves over b rep-\netitions. not having f at our disposal, we can estimate f by the empirical\ncumulative distribution function\n\nn(cid:3)\n\ni=1\n\nfn(y) =\n\n1\nn\n\n[yi \u2264 y].\n\n(5.1)\n\nfn corresponds to a density function that places probability 1/n at each\nobserved datapoint (k/n if that point were duplicated k times and its value\nlisted only once).\n\nas an example, consider a random sample of size n = 30 from a normal\ndistribution with mean 100 and standard deviation 10. figure 5.1 shows the\npopulation and empirical cumulative distribution functions.\n\nnow pretend that fn(y) is the original population distribution f (y). sam-\npling from fn is equivalent to sampling with replacement from the observed\ndata y1, . . . , yn. for large n, the expected fraction of original datapoints that\nare selected for each bootstrap sample is 1 \u2212 e\n\u22121 = 0.632. some points are\nselected twice, some three times, a few four times, and so on. we take b sam-\nples of size n with replacement, with b chosen so that the summary measure\nof the individual statistics is nearly as good as taking b = \u221e. the bootstrap\nis based on the fact that the distribution of the observed differences between a\nresampled estimate of a parameter of interest and the original estimate of the\nparameter from the whole sample tells us about the distribution of unobserv-\nable differences between the original estimate and the unknown population\nvalue of the parameter.\n\nas an example, consider the data (1, 5, 6, 7, 8, 9) and suppose that we would\nlike to obtain a 0.80 confidence interval for the population median, as well as\nan estimate of the population expected value of the sample median (the latter\n\n6\n\n "}, {"Page_number": 131, "text": "5.2 the bootstrap\n\n107\n\n]\nx\n\u2264\nx\nb\no\nr\np\n\n[\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n60\n\n80\n\n100\nx\n\n120\n\n140\n\nfig. 5.1 empirical and population cumulative distribution function\n\nis only used to estimate bias in the sample median). the first 20 bootstrap\nsamples (after sorting data values) and the corresponding sample medians\nare shown in table 5.1.\n\nfor a given number b of bootstrap samples, our estimates are simply\nthe sample 0.1 and 0.9 quantiles of the sample medians, and the mean of\nthe sample medians. not knowing how large b should be, we could let b\nrange from, say, 50 to 1000, stopping when we are sure the estimates have\nconverged. in the left plot of figure 5.2, b varies from 1 to 400 for the mean\n(10 to 400 for the quantiles). it can be seen that the bootstrap estimate of the\npopulation mean of the sample median can be estimated satisfactorily when\nb > 50. for the lower and upper limits of the 0.8 confidence interval for the\npopulation median y , b must be at least 200. for more extreme confidence\nlimits, b must be higher still.\n\nfor the final set of 400 sample medians, a histogram (right plot in fig-\nure 5.2) can be used to assess the form of the sampling distribution of the\nsample median. here, the distribution is almost normal, although there is a\nslightly heavy left tail that comes from the data themselves having a heavy left\ntail. for large samples, sample medians are normally distributed for a wide\nvariety of population distributions. therefore we could use bootstrapping to\nestimate the variance of the sample median and then take \u00b11.28 standard\nerrors as a 0.80 confidence interval. in other cases (e.g., regression coefficient\nestimates for certain models), estimates are asymmetrically distributed, and\nthe bootstrap quantiles are better estimates than confidence intervals that\nare based on a normality assumption. note that because sample quantiles\nare more or less restricted to equal one of the values in the sample, the boot-\n\n "}, {"Page_number": 132, "text": "108\n\n5 describing, resampling, validating, and simplifying the model\n\ns\ne\n\nl\ni\nt\nn\na\nu\nq\n \n9\n.\n0\n \n,\n1\n.\n0\n \nd\nn\na\n \nn\na\ne\nm\n\n9\n\n8\n\n7\n\n6\n\n5\n\n4\n\n3\n\ny\nc\nn\ne\nu\nq\ne\nr\nf\n\n60\n\n40\n\n20\n\n0\n\n0\n\n100\n\n200\n\n300\n\n400\n\nbootstrap samples used\n\n2\n\n4\n\n6\n\n8\n\nfig. 5.2 estimating properties of sample median using the bootstrap\n\ntable 5.1 first 20 bootstrap samples\n\nbootstrap sample\n\nsample median\n\n1 6 6 7 8 9\n1 5 5 5 6 8\n5 7 8 9 9 9\n7 7 7 8 8 9\n1 5 7 7 9 9\n1 5 6 6 7 8\n7 8 8 8 8 8\n5 5 5 7 9 9\n1 5 5 7 7 9\n1 5 5 7 7 8\n1 1 5 5 7 7\n1 1 5 5 7 8\n1 5 5 7 7 8\n1 5 6 7 8 8\n1 5 6 7 9 9\n6 6 7 7 8 9\n1 5 7 8 8 9\n6 6 8 9 9 9\n1 1 5 5 6 9\n1 6 8 9 9 9\n\n6.5\n5.0\n8.5\n7.5\n7.0\n6.0\n8.0\n6.0\n6.0\n6.0\n5.0\n5.0\n6.0\n6.5\n6.5\n7.0\n7.5\n8.5\n5.0\n8.5\n\n "}, {"Page_number": 133, "text": "5.3 model validation\n\n109\n\nstrap distribution is discrete and can be dependent on a small number of\noutliers. for this reason, bootstrapping quantiles does not work particularly\nwell for small samples [150, pp. 41\u201343].\n\nthe method just presented for obtaining a nonparametric confidence in-\nterval for the population median is called the bootstrap percentile method. it\nis the simplest but not necessarily the best performing bootstrap method.\n\nin this text we use the bootstrap primarily for computing statistical esti-\nmates that are much different from standard errors and confidence intervals,\nnamely, estimates of model performance.\n\n5.3 model validation\n\n5.3.1 introduction\n\nthe surest method to have a model fit the data at hand is to discard much\nof the data. a p-variable fit to p + 1 observations will perfectly predict y as\nlong as no two observations have the same y . such a model will, however,\nyield predictions that appear almost random with respect to responses on\na different dataset. therefore, unbiased estimates of predictive accuracy are\nessential.\n\nmodel validation is done to ascertain whether predicted values from the\nmodel are likely to accurately predict responses on future subjects or sub-\njects not used to develop our model. three major causes of failure of the\nmodel to validate are overfitting, changes in measurement methods/changes\nin definition of categorical variables, and major changes in subject inclusion\ncriteria.\n\nthere are two major modes of model validation, external and internal. the\nmost stringent external validation involves testing a final model developed in\none country or setting on subjects in another country or setting at another\ntime. this validation would test whether the data collection instrument was\ntranslated into another language properly, whether cultural differences make\nearlier findings nonapplicable, and whether secular trends have changed as-\nsociations or base rates. testing a finished model on new subjects from the\nsame geographic area but from a different institution as subjects used to fit\nthe model is a less stringent form of external validation. the least stringent\nform of external validation involves using the first m of n observations for\nmodel training and using the remaining n\u2212 m observations as a test sample.\nthis is very similar to data-splitting (section 5.3.3). for details about meth-\nods for external validation see the r val.prob and val.surv functions in the\nrms package.\n\neven though external validation is frequently favored by non-statisticians,\nit is often problematic. holding back data from the model-fitting phase re-\n\n7\n\n8\n\n9\n\n "}, {"Page_number": 134, "text": "110\n\n5 describing, resampling, validating, and simplifying the model\n\nsults in lower precision and power, and one can increase precision and learn\nmore about geographic or time differences by fitting a unified model to the\nentire subject series including, for example, country or calendar time as a\nmain effect and/or as an interacting effect. indeed one could use the follow-\ning working definition of external validation: validation of a prediction tool\nusing data that were not available when the tool needed to be completed. an\nalternate definition could be taken as the validation of a prediction tool by\nan independent research team.\n\none suggested hierarchy of the quality of various validation methods is as\n\nfollows, ordered from worst to best.\n\n1. attempting several validations (internal or external) and reporting only\n\nthe one that \u201cworked\u201d\n\n2. reporting apparent performance on the training dataset (no validation)\n3. reporting predictive accuracy on an undersized independent test sample\n4. internal validation using data-splitting where at least one of the training\nand test samples is not huge and the investigator is not aware of the\narbitrariness of variable selection done on a single sample\n\n5. strong internal validation using 100 repeats of 10-fold cross-validation or\nseveral hundred bootstrap resamples, repeating all analysis steps involving\ny afresh at each re-sample and the arbitrariness of selected \u201cimportant\nvariables\u201d is reported (if variable selection is used)\n\n6. external validation on a large test sample, done by the original research\n\nteam\n\n7. re-analysis by an independent research team using strong internal valida-\n\ntion of the original dataset\n\n8. external validation using new test data, done by an independent research\n\nteam\n\n9. external validation using new test data generated using different instru-\n\nments/technology, done by an independent research team\n\ninternal validation involves fitting and validating the model by carefully\nusing one series of subjects. one uses the combined dataset in this way to\nestimate the likely performance of the final model on new subjects, which\nafter all is often of most interest. most of the remainder of section 5.3 deals\nwith internal validation.\n\n5.3.2 which quantities should be used\n\nin validation?\n\nfor ordinary multiple regression models, the r2 index is a good measure\nof the model\u2019s predictive ability, especially for the purpose of quantifying\ndrop-off in predictive ability when applying the model to other datasets.\nr2 is biased, however. for example, if one used nine predictors to predict\noutcomes of 10 subjects, r2 = 1.0 but the r2 that will be achieved on future\n\n "}, {"Page_number": 135, "text": "5.3 model validation\n\n111\n\nsubjects will be close to zero. in this case, dramatic overfitting has occurred.\nthe adjusted r2 (equation 4.4) solves this problem, at least when the model\nhas been completely prespecified and no variables or parameters have been\n\u201cscreened\u201d out of the final model fit. that is, r2\nadj is only valid when p in its\nformula is honest\u2014 when it includes all parameters ever examined (formally\nor informally, e.g., using graphs or tables) whether these parameters are in\nthe final model or not.\n\nquite often we need to validate indexes other than r2 for which adjust-\nments for p have not been created.c we also need to validate models contain-\ning \u201cphantom degrees of freedom\u201d that were screened out earlier, formally\nor informally. for these purposes, we obtain nearly unbiased estimates of r2\nor other indexes using data splitting, cross-validation, or the bootstrap. the\nbootstrap provides the most precise estimates.\n\nthe g\u2013index is another discrimination measure to validate. but g and r2\nmeasures only one aspect of predictive ability. in general, there are two major\naspects of predictive accuracy that need to be assessed. as discussed in sec-\ntion 4.5, calibration or reliability is the ability of the model to make unbiased\nestimates of outcome. discrimination is the model\u2019s ability to separate sub-\njects\u2019 outcomes. validation of the model is recommended even when a data\nreduction technique is used. this is a way to ensure that the model was not\noverfitted or is otherwise inaccurate.\n\n5.3.3 data-splitting\n\nthe simplest validation method is one-time data-splitting. here a dataset is\nsplit into training (model development) and test (model validation) samples\nby a random process with or without balancing distributions of the response\nand predictor variables in the two samples. in some cases, a chronological\nsplit is used so that the validation is prospective. the model\u2019s calibration\nand discrimination are validated in the test set.\n\nin ordinary least squares, calibration may be assessed by, for example,\nplotting y against \u02c6y . discrimination here is assessed by r2 and it is of\ninterest in comparing r2 in the training sample with that achieved in the\ntest sample. a drop in r2 indicates overfitting, and the absolute r2 in the\ntest sample is an unbiased estimate of predictive discrimination. note that\nin extremely overfitted models, r2 in the test set can be negative, since it is\ncomputed on \u201cfrozen\u201d intercept and regression coefficients using the formula\n1\u2212 sse/sst , where sse is the error sum of squares, sst is the total sum\n\nc for example, in the binary logistic model, there is a generalization of r2 available,\nbut no adjusted version. for logistic models we often validate other indexes such\nas the roc area or rank correlation between predicted probabilities and observed\noutcomes. we also validate the calibration accuracy of \u02c6y in predicting y .\n\n "}, {"Page_number": 136, "text": "10\n\n112\n\n5 describing, resampling, validating, and simplifying the model\n\nof squares, and sse can be greater than sst (when predictions are worse\nthan the constant predictor y ).\n\nto be able to validate predictions from the model over an entire test sam-\nple (without validating it separately in particular subsets such as in males\nand females), the test sample must be large enough to precisely fit a model\ncontaining one predictor. for a study with a continuous uncensored response\nvariable, the test sample size should ordinarily be \u2265 100 at a bare minimum.\nfor survival time studies, the test sample should at least be large enough\nto contain a minimum of 100 outcome events. for binary outcomes, the test\nsample should contain a bare minimum of 100 subjects in the least frequent\noutcome category. once the size of the test sample is determined, the remain-\ning portion of the original sample can be used as a training sample. even with\nthese test sample sizes, validation of extreme predictions is difficult.\n\ndata-splitting has the advantage of allowing hypothesis tests to be con-\n\nfirmed in the test sample. however, it has the following disadvantages.\n\n1. data-splitting greatly reduces the sample size for both model development\nand model testing. because of this, roecker528 found this method \u201cappears\nto be a costly approach, both in terms of predictive accuracy of the fitted\nmodel and the precision of our estimate of the accuracy.\u201d breiman [66,\nsection 1.3] found that bootstrap validation on the original sample was as\nefficient as having a separate test sample twice as large36.\n\n2. it requires a larger sample to be held out than cross-validation (see be-\nlow) to be able to obtain the same precision of the estimate of predictive\naccuracy.\n\n3. the split may be fortuitous; if the process were repeated with a different\n\nsplit, different assessments of predictive accuracy may be obtained.\n\n4. data-splitting does not validate the final model, but rather a model devel-\noped on only a subset of the data. the training and test sets are recombined\nfor fitting the final model, which is not validated.\n\n5. data-splitting requires the split before the first analysis of the data. with\nother methods, analyses can proceed in the usual way on the complete\ndataset. then, after a \u201cfinal\u201d model is specified, the modeling process is\nrerun on multiple resamples from the original data to mimic the process\nthat produced the \u201cfinal\u201d model.\n\n5.3.4 improvements on data-splitting: resampling\n\nbootstrapping, jackknifing, and other resampling plans can be used to obtain\nnearly unbiased estimates of model performance without sacrificing sample\nsize. these methods work when either the model is completely specified ex-\ncept for the regression coefficients, or all important steps of the modeling\nprocess, especially variable selection, are automated. only then can each\n\n "}, {"Page_number": 137, "text": "5.3 model validation\n\n113\n\nbootstrap replication be a reflection of all sources of variability in model-\ning. note that most analyses involve examination of graphs and testing for\nlack of model fit, with many intermediate decisions by the analyst such as\nsimplification of interactions. these processes are difficult to automate. but\nvariable selection alone is often the greatest source of variability because of\nmultiple comparison problems, so the analyst must go to great lengths to\nbootstrap or jackknife variable selection.\n\nthe ability to study the arbitrariness of how a stepwise variable selection\nalgorithm selects \u201cimportant\u201d factors is a major benefit of bootstrapping. a\nuseful display is a matrix of blanks and asterisks, where an asterisk is placed\nin column x of row i if variable x is selected in bootstrap sample i (see p.\n263 for an example). if many variables appear to be selected at random,\nthe analyst may want to turn to a data reduction method rather than using\nstepwise selection (see also [541]).\n\ncross-validation is a generalization of data-splitting that solves some of the\nproblems of data-splitting. leave-out-one cross-validation,565, 633 the limit of\ncross-validation, is similar to jackknifing.675 here one observation is omitted\nfrom the analytical process and the response for that observation is predicted\nusing a model derived from the remaining n \u2212 1 observations. the process\nis repeated n times to obtain an average accuracy. efron172 reports that\ngrouped cross-validation is more accurate; here groups of k observations are\nomitted at a time. suppose, for example, that 10 groups are used. the orig-\ninal dataset is divided into 10 equal subsets at random. the first 9 subsets\nare used to develop a model (transformation selection, interaction testing,\nstepwise variable selection, etc. are all done). the resulting model is assessed\nfor accuracy on the remaining 1/10th of the sample. this process is repeated\nat least 10 times to get an average of 10 indexes such as r2.\n\na drawback of cross-validation is the choice of the number of observations\nto hold out from each fit. another is that the number of repetitions needed to\nachieve accurate estimates of accuracy often exceeds 200. for example, one\nmay have to omit 1\n10 th of the sample 500 times to accurately estimate the\nindex of interest thus the sample would need to be split into tenths 50 times.\nanother possible problem is that cross-validation may not fully represent the\nvariability of variable selection. if 20 subjects are omitted each time from a\nsample of size 1000, the lists of variables selected from each training sample\nof size 980 are likely to be much more similar than lists obtained from fitting\nindependent samples of 1000 subjects. finally, as with data-splitting, cross-\nvalidation does not validate the full 1000-subject model.\n\nan interesting way to study overfitting could be called the randomization\nmethod. here we ask the question \u201chow well can the response be predicted\nwhen we use our best procedure on random responses when the predictive\naccuracy should be near zero?\u201d the better the fit on random y , the worse the\noverfitting. the method takes a random permutation of the response variable\nand develops a model with optional variable selection based on the original x\nand permuted y . suppose this yields r2 = .2 for the fitted sample. apply the\n\n11\n\n12\n\n "}, {"Page_number": 138, "text": "114\n\n5 describing, resampling, validating, and simplifying the model\n\n13\n\nfit to the original data to estimate optimism. if overfitting is not a problem,\nr2 would be the same for both fits and it will ordinarily be very near zero.\n\n5.3.5 validation using the bootstrap\n\nefron,172, 173 efron and gong,175 gong,224 efron and tibshirani,177, 178 lin-\nnet,416 and breiman66 describe several bootstrapping procedures for obtain-\ning nearly unbiased estimates of future model performance without holding\nback data when making the final estimates of model parameters. with the\n\u201csimple bootstrap\u201d [178, p. 247], one repeatedly fits the model in a bootstrap\nsample and evaluates the performance of the model on the original sample.\nthe estimate of the likely performance of the final model on future data\nis estimated by the average of all of the indexes computed on the original\nsample.\n\nefron showed that an enhanced bootstrap estimates future model per-\nformance more accurately than the simple bootstrap. instead of estimating\nan accuracy index directly from averaging indexes computed on the original\nsample, the enhanced bootstrap uses a slightly more indirect approach by\nestimating the bias due to overfitting or the \u201coptimism\u201d in the final model\nfit. after the optimism is estimated, it can be subtracted from the index\nof accuracy derived from the original sample to obtain a bias-corrected or\noverfitting-corrected estimate of predictive accuracy. the bootstrap method\nis as follows. from the original x and y in the sample of size n, draw a\nsample with replacement also of size n. derive a model in the bootstrap sam-\nple and apply it without change to the original sample. the accuracy index\nfrom the bootstrap sample minus the index computed on the original sample\nis an estimate of optimism. this process is repeated for 100 or so bootstrap\nreplications to obtain an average optimism, which is subtracted from the final\nmodel fit\u2019s apparent accuracy to obtain the overfitting-corrected estimate.\n\nnote that bootstrapping validates the process that was used to fit the orig-\ninal model (as does cross-validation). it provides an estimate of the expected\nvalue of the optimism, which when subtracted from the original index, pro-\nvides an estimate of the expected bias-corrected index. if stepwise variable\nselection is part of the bootstrap process (as it must be if the final model\nis developed that way), and not all resamples (samples with replacement or\ntraining samples in cross-validation) resulted in the same model (which is\nalmost always the case), this internal validation process actually provides an\nunbiased estimate of the future performance of the process used to identify\nmarkers and scoring systems; it does not validate a single final model. but\nresampling does tend to provide good estimates of the future performance of\nthe final model that was selected using the same procedure repeated in the\nresamples.\n\n14\n\n15\n\n "}, {"Page_number": 139, "text": "5.3 model validation\n\n115\n\nnote that by drawing samples from x and y , we are estimating aspects\nof the unconditional distribution of statistical quantities. one could instead\ndraw samples from quantities such as residuals from the model to obtain a\ndistribution that is conditional on x. however, this approach requires that\nthe model be specified correctly, whereas the unconditional bootstrap does\nnot. also, the unconditional estimators are similar to conditional estimators\nexcept for very skewed or very small samples [186, p. 217].\n\nbootstrapping can be used to estimate the optimism in virtually any index.\nbesides discrimination indexes such as r2, slope and intercept calibration fac-\ntors can be estimated. when one fits the model c(y |x) = x\u03b2, and then refits\nthe model c(y |x) = \u03b30 + \u03b31x \u02c6\u03b2 on the same data, where \u02c6\u03b2 is an estimate of\n\u03b2, \u02c6\u03b30 and \u02c6\u03b31 will necessarily be 0 and 1, respectively. however, when \u02c6\u03b2 is used\nto predict responses on another dataset, \u02c6\u03b31 may be < 1 if there is overfitting,\nand \u02c6\u03b30 will be different from zero to compensate. thus a bootstrap estimate\nof \u03b31 will not only quantify overfitting nicely, but can also be used to shrink\npredicted values to make them more calibrated (similar to [582]). efron\u2019s op-\ntimism bootstrap is used to estimate the optimism in (0, 1) and then (\u03b30, \u03b31)\nare estimated by subtracting the optimism in the constant estimator (0, 1).\nnote that in cross-validation one estimates \u03b2 with \u02c6\u03b2 from the training sample\nand fits c(y |x) = \u03b3x \u02c6\u03b2 on the test sample directly. then the \u03b3 estimates are\naveraged over all test samples. this approach does not require the choice of a\nparameter that determines the amount of shrinkage as does ridge regression\nor penalized maximum likelihood estimation; instead one estimates how to\nmake the initial fit well calibrated.123, 633 however, this approach is not as\nreliable as building shrinkage into the original estimation process. the latter\nallows different parameters to be shrunk by different factors.\n\nordinary bootstrapping can sometimes yield overly optimistic estimates\nof optimism, that is, may underestimate the amount of overfitting. this is\nespecially true when the ratio of the number of observations to the number\nof parameters estimated is not large.205 a variation on the bootstrap that\nimproves precision of the assessment is the \u201c.632\u201d method, which efron found\nto be optimal in several examples.172 this method provides a bias-corrected\nestimate of predictive accuracy by substituting 0.632\u00d7 [apparent accuracy\n\u2212\u02c6\u00010] for the estimate of optimism, where \u02c6\u00010 is a weighted average of accuracies\n\nevaluated on observations omitted from bootstrap samples [178, eq. 17.25,\np. 253].\n\nfor ordinary least squares, where the genuine per-observation .632 estima-\ntor can be used, several simulations revealed close agreement with the mod-\nified .632 estimator, even in small, highly overfitted samples. in these over-\nfitted cases, the ordinary bootstrap bias-corrected accuracy estimates were\nsignificantly higher than the .632 estimates. simulations259, 591 have shown,\nhowever, that for most types of indexes of accuracy of binary logistic regres-\nsion models, efron\u2019s original bootstrap has lower mean squared error than\nthe .632 bootstrap when n = 200, p = 30. bootstrap overfitting-corrected es-\ntimates of model performance can be biased in favor of the model. although\n\n16\n\n17\n\n18\n\n "}, {"Page_number": 140, "text": "116\n\n5 describing, resampling, validating, and simplifying the model\n\ntable 5.2 example validation with and without variable selection\n\nmethod\n\napparent rank over- bias-corrected\ncorrelation of optimism correlation\npredicted vs.\n\nfull model\nstepwise model\n\nobserved\n\n0.50\n0.47\n\n0.06\n0.05\n\n0.44\n0.42\n\ncross-validation is less biased than the bootstrap, efron172 showed that it has\nmuch higher variance in estimating overfitting-corrected predictive accuracy\nthan bootstrapping. in other words, cross-validation, like data-splitting, can\nyield significantly different estimates when the entire validation process is\nrepeated.\n\nit is frequently very informative to estimate a measure of predictive accu-\nracy forcing all candidate factors into the fit and then to separately estimate\naccuracy allowing stepwise variable selection, possibly with different stop-\nping rules. consistent with spiegelhalter\u2019s proposal to use all factors and\nthen to shrink the coefficients to adjust for overfitting,582 the full model fit\nwill outperform the stepwise model more often than not. even though step-\nwise modeling has slightly less optimism in predictive discrimination, this\nimprovement is not enough to offset the loss of information from deleting\neven marginally important variables. table 5.2 shows a typical scenario. in\nthis example, stepwise modeling lost a possible 0.50 \u2212 0.47 = 0.03 predictive\ndiscrimination. the full model fit will especially be an improvement when\n\n1. the stepwise selection deletes several variables that are almost significant;\n2. these marginal variables have some real predictive value, even if it\u2019s slight;\n\nand\n\n3. there is no small set of extremely dominant variables that would be easily\n\nfound by stepwise selection.\n\nfaraway186 has a fascinating study showing how resampling methods can\nbe used to estimate the distributions of predicted values and of effects of a\npredictor, adjusting for an automated multistep modeling process. bootstrap-\nping can be used, for example, to penalize the variance in predicted values for\nchoosing a transformation for y and for outlier and influential observation\ndeletion, in addition to variable selection. estimation of the transformation of\ny greatly increased the variance in faraway\u2019s examples. brownstone [77, p.\n74] states that \u201cin spite of considerable efforts, theoretical statisticians have\nbeen unable to analyze the sampling properties of [usual multistep modeling\nstrategies] under realistic conditions\u201d and concludes that the modeling strat-\negy must be completely specified and then bootstrapped to get consistent\nestimates of variances and other sampling properties.\n\n19\n\n20\n\n "}, {"Page_number": 141, "text": "5.4 bootstrapping ranks of predictors\n\n117\n\n5.4 bootstrapping ranks of predictors\n\nwhen the order of importance of predictors is not pre-specified but the re-\nsearcher attempts to determine that order by assessing multiple associations\nwith y , the process of selecting \u201cwinners\u201d and \u201closers\u201d is unreliable. the\nbootstrap can be used to demonstrate the difficulty of this task, by estimat-\ning confidence intervals for the ranks of all the predictors. even though the\nbootstrap intervals are wide, they actually underestimate the true widths250.\nthe following exampling uses simulated data with known ranks of impor-\ntance of 12 predictors, using an ordinary linear model. the importance metric\nis the partial \u03c72 minus its degrees of freedom, while the true metric is the\npartial \u03b2, as all covariates have u (0, 1) distributions.\n\nrank the negative of the adjusted chi-squares\n\n# use the plot method for anova , with pl= false to suppress\n# actual plotting of chi-square - d.f. for each bootstrap\n# repetition.\n# so that a rank of 1 is assigned to the highest.\n# important to tell plot.anova.rms not to sort the results ,\n# or every bootstrap replication would have ranks of 1,2,3,\n# ... for the partial test statistics.\nrequire ( rms )\nn \u2190 300\nd \u2190 data.fram e ( x1 = runif ( n ) , x2 = runif ( n ) ,\n\nset.seed (1)\n\nit is\n\nx4 = runif ( n ) , x5 = runif ( n ) , x6 = runif ( n ) ,\nx8 = runif ( n ) , x9 = runif ( n ) , x10 = runif (n ) , x11 = runif ( n ) ,\nx12 = runif ( n ))\n\nd $ y \u2190 with ( d , 1 * x1 + 2 * x2 + 3 * x3 +\n\n4 * x4\n\n+ 5 * x5 + 6 * x6 +\n\nx3 = runif ( n ) ,\nx7 = runif ( n ) ,\n\n7 * x7 + 8 * x8 + 9 * x9 + 10 * x10 + 11 * x11 +\n\n12 * x12 + 9 * rnorm ( n ))\n\nf \u2190 ols ( y \u223c x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 + x11 + x12 , data = d )\nb \u2190 1000\nranks \u2190 matrix ( na , nrow =b , ncol =12)\nrankvars \u2190 function ( fit )\nrank \u2190 rankvars ( f )\n\nrank ( plot ( anova ( fit ) , sort = ' none ' , pl = false ))\n\nfor ( i in 1: b ) {\n\nj \u2190 sample (1: n , n , true )\nbootfit \u2190 update (f , data =d , subset = j )\nranks [i ,] \u2190 rankvars ( bootfit )\n\n}\n\nlim \u2190 t ( apply ( ranks , 2 , quantile , probs = c ( .025 , .975 )))\npredictor \u2190 factor ( names ( rank ) , names ( rank ))\nw \u2190 data.fram e ( predictor , rank , lower = lim [ ,1] , upper = lim [ ,2])\n\nrequire ( ggplot2 )\nggplot (w , aes ( x = predictor , y = rank )) + geom_point () +\n\ncoord_fli p () + s c a l e _ y _ c o n t i n u o u s ( breaks =1:12) +\ng e o m _ e r r o r b a r ( aes ( ymin = lim [ ,1] , ymax = lim [ ,2]) , width =0)\n\nwith a sample size of n = 300 the observed ranks of predictor importance do\nnot coincide with population \u03b2s, even when there are no collinearities among\n\n "}, {"Page_number": 142, "text": "118\n\n5 describing, resampling, validating, and simplifying the model\n\ni\n\nr\no\nt\nc\nd\ne\nr\np\n\nx12\nx11\nx10\nx9\nx8\nx7\nx6\nx5\nx4\nx3\nx2\nx1\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n7\nrank\n\n8\n\n9\n\n10\n\n11\n\n12\n\nfig. 5.3 bootstrap percentile 0.95 confidence limits for ranks of predictors in an ols\nmodel. ranking is on the basis of partial \u03c72 minus d.f. point estimates are original\nranks\n\nthe predictors. confidence intervals are wide; for example the 0.95 confidence\ninterval for the rank of x7 (which has a true rank of 7) is [1, 8], so we are\nonly confident that x7 is not one of the 4 most influential predictors. the\nconfidence intervals do include the true ranks in each case (figure 5.3).\n\n5.5 simplifying the final model by approximating it\n\n5.5.1 difficulties using full models\n\na model that contains all prespecified terms will usually be the one that pre-\ndicts the most accurately on new data. it is also a model for which confidence\nlimits and statistical tests have the claimed properties. often, however, this\nmodel will not be very parsimonious. the full model may require more pre-\ndictors than the researchers care to collect in future samples. it also requires\npredicted values to be conditional on all of the predictors, which can increase\nthe variance of the predictions.\n\nas an example suppose that least squares has been used to fit a model\ncontaining several variables including race (with four categories). race may\nbe an insignificant predictor and may explain a tiny fraction of the observed\nvariation in y . yet when predictions are requested, a value for race must be\ninserted. if the subject is of the majority race, and this race has a majority of,\n\n "}, {"Page_number": 143, "text": "5.5 simplifying the final model by approximating it\n\n119\n\nsay 0.75, the variance of the predicted value will not be significantly greater\nthan the variance for a predicted value from a model that excluded race\nfor its list of predictors. if, however, the subject is of a minority race (say\n\u201cother\u201d with a prevalence of 0.01), the predicted value will have much higher\nvariance. one approach to this problem, that does not require development\nof a second model, is to ignore the subject\u2019s race and to get a weighted\naverage prediction. that is, we obtain predictions for each of the four races\nand weight these predictions by the relative frequencies of the four races.d\nthis weighted average estimates the expected value of y unconditional on\nrace. it has the advantage of having exactly correct confidence limits when\nmodel assumptions are satisfied, because the correct \u201cerror term\u201d is being\nused (one that deducts 3 d.f. for having ever estimated the race effect). in\nregression models having nonlinear link functions, this process does not yield\nsuch a simple interpretation.\n\nwhen predictors are collinear, their competition results in larger p -values\nwhen predictors are (often inappropriately) tested individually. likewise, con-\nfidence intervals for individual effects will be wide and uninterpretable (can\nother variables really be held constant when one is changed?).\n\n5.5.2 approximating the full model\n\nwhen the full model contains several predictors that do not appreciably af-\nfect the predictions, the above process of \u201cunconditioning\u201d is unwieldy. in the\nsearch for a simple solution, the most commonly used procedure for making\nthe model parsimonious is to remove variables on the basis of p -values, but\nthis results in a variety of problems as we have seen. our approach instead\nis to consider the full model fit as the \u201cgold standard\u201d model, especially the\nmodel from which formal inferences are made. we then proceed to approxi-\nmate this full model to any desired degree of accuracy. for any approximate\nmodel we calculate the accuracy with which it approximates the best model.\none goal this process accomplishes is that it provides different degrees of\nparsimony to different audiences, based on their needs. one investigator may\nbe able to collect only three variables, another one seven. each investigator\nwill know how much she is giving up by using a subset of the predictors.\nin approximating the gold standard model it is very important to note that\nthere is nothing gained in removing certain nonlinear terms; gains in parsi-\nmony come only from removing entire predictors. another accomplishment\nof model approximation is that when the full model has been fitted using\n\nd using the rms package described in chapter 6, such estimates and their\nconfidence limits can easily be obtained, using for example contrast(fit,\nlist(age=50, disease=\u2019hypertension\u2019, race=levels(race)), type=\u2019average\u2019,\nweights=table(race)).\n\n "}, {"Page_number": 144, "text": "120\n\n5 describing, resampling, validating, and simplifying the model\n\nshrinkage (penalized estimation, section 9.10), the approximate models will\ninherit the shrinkage (see section 14.10 for an example).\n\napproximating complex models with simpler ones has been used to de-\ncode \u201cblack boxes\u201d such as artificial neural networks. recursive partitioning\ntrees (section 2.5) may sometimes be used in this context. one develops a\nregression tree to predict the predicted value x \u02c6\u03b2 on the basis of the unique\nvariables in x, using r2, the average absolute prediction error, or the max-\nimum absolute prediction error as a stopping rule, for example184. the user\ndesiring simplicity may use the tree to obtain predicted values, using the first\nk nodes, with k just large enough to yield a low enough absolute error in pre-\ndicting the more comprehensive prediction. overfitting is not a problem as it\nis when the tree procedure is used to predict the outcome, because (1) given\nthe predictor values the predictions are deterministic and (2) the variable be-\ning predicted is a continuous, completely observed variable. hence the best\ncross-validating tree approximation will be one with one subject per node.\none advantage of the tree-approximation procedure is that data collection\non an individual subject whose outcome is being predicted may be abbrevi-\nated by measuring only those xs that are used in the top nodes, until the\nprediction is resolved to within a tolerable error.\n\nwhen principal component regression is being used, trees can also be used\n\nto approximate the components or to make them more interpretable.\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n\u22121x\n(cid:2)\n\ny , \u02c6y = x(x\n\nfull models may also be approximated using least squares as long as the\nlinear predictor x \u02c6\u03b2 is the target, and not some nonlinear transformation of\nit such as a logistic model probability. when the original model was fitted\nusing unpenalized least squares, submodels fitted against \u02c6y will have the same\ncoefficients as if least squares had been used to fit the subset of predictors\ndirectly against y . to see this, note that if x denotes the entire design matrix\nand t denotes a subset of the columns of x, the coefficient estimates for the\ny , estimates for a reduced\nfull model are (x\ny , and coefficients fitted against \u02c6y are\nmodel fitted against y are (t\n(t\n\nt )t\nwhen least squares is used for both the full and reduced models, the\nvariance\u2013covariance matrix of the coefficient estimates of the reduced model is\n\u22121\u03c32, where the residual variance \u03c32 is estimated using the full model.\n(t\nwhen \u03c32 is estimated by the unbiased estimator using the d.f. from the\nfull model, which provides the only unbiased estimate of \u03c32, the estimated\nvariance\u2013covariance matrix of the reduced model will be appropriate (unlike\nthat from stepwise variable selection) although the bootstrap may be needed\nto fully take into account the source of variation due to how the approximate\nmodel was selected.\n\ny which can be shown to equal (t\n\nx)\n\u22121x\n\n\u22121x\n\n\u22121t\n\n\u22121t\n\nx(x\n\nx)\n\nx)\n\nt )\n\nt )\n\nt )\n\ny .\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\n(cid:2)\n\nso if in the least squares case the approximate model coefficients are iden-\ntical to coefficients obtained upon fitting the reduced model against y , how\nis model approximation any different from stepwise variable selection? there\nare several differences, in addition to how \u03c32 is estimated.\n\n "}, {"Page_number": 145, "text": "5.6 further reading\n\n121\n\n1. when the full model is approximated by a backward step-down procedure\nagainst \u02c6y , the stopping rule is less arbitrary. one stops deleting variables\nwhen deleting any further variable would make the approximation inad-\nequate (e.g., the r2 for predictions from the reduced model against the\noriginal \u02c6y drops below 0.95).\n\n2. because the stopping rule is different (i.e., is not based on p -values), the\napproximate model will have a different number of predictors than an\nordinary stepwise model.\n\n3. if the original model used penalization, approximate models will inherit\n\nthe amount of shrinkage used in the full fit.\n\ntypically, though, if one performed ordinary backward step-down against y\nusing a large cutoff for \u03b1 (e.g., 0.5), the approximate model would be very\nsimilar to the step-down model. the main difference would be the use of\na larger estimate of \u03c32 and smaller error d.f. than are used for the ordinary\nstep-down approach (an estimate that pretended the final reduced model was\nprespecified).\n\nwhen the full model was not fitted using least squares, least squares can\nstill easily be used to approximate the full model. if the coefficient estimates\nfrom the full model are \u02c6\u03b2, estimates from the approximate model are ma-\ntrix contrasts of \u02c6\u03b2, namely, w \u02c6\u03b2, where w = (t\nx. so the variance\u2013\ncovariance matrix of the reduced coefficient estimates is given by\n\n\u22121t\n\nt )\n\n(cid:2)\n\n(cid:2)\n\nw v w\n\n(cid:2)\n\n,\n\n(5.2)\n\nwhere v is the variance matrix for \u02c6\u03b2. see section 19.5 for an example. ambler\net al.21 studied model simplification using simulation studies based on several\nclinical datasets, and compared it with ordinary backward stepdown variable\nselection and with shrinkage methods such as the lasso (see section 4.3). they\nfound that ordinary backwards variable selection can be competitive when\nthere is a large fraction of truly irrelevant predictors (something that can be\ndifficult to know in advance). paul et al.485 found advantages to modeling\nthe response with a complex but reliable approach, and then developing a\nparsimoneous model using the lasso or stepwise variable selection against \u02c6y .\nsee section 11.7 for a case study in model approximation.\n\n5.6 further reading\n\n1\n\ngelman213 argues that continuous variables should be scaled by two standard\ndeviations to make them comparable to binary predictors. however his approach\nassumes linearity in the predictor effect and assumes the prevalence of the binary\npredictor is near 0.5. john fox [202, p. 95] points out that if two predictors are\non the same scale and have the same impact (e.g., years of employment and\nyears of education), standardizing the coefficients will make them appear to\nhave different impacts.\n\n "}, {"Page_number": 146, "text": "122\n\n5 describing, resampling, validating, and simplifying the model\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n11\n\nlevine et al.401 have a compelling argument for graphing effect ratios on a\nlogarithmic scale.\nhankins254 is a definitive reference on nomograms and has multi-axis examples\nof historical significance. according to hankins, maurice d\u2019ocagne could be\ncalled the inventor of the nomogram, starting with alignment diagrams in 1884\nand declaring a new science of \u201cnomography\u201d in 1899. d\u2019ocagne was at \u00b4ecole\ndes ponts et chauss\u00b4ees, a french civil engineering school. julien and hanley328\nhave a nice example of adding axes to a nomogram to estimate the absolute\neffect of a treatment estimated using a cox proportional hazards model. kattan\nand marasco339 have several clinical examples and explain advantages to the\nuser of nomograms over \u201cblack box\u201d computerized prediction.\ngraham and clavel231 discuss graphical and tabular ways of obtaining risk\nestimates. van gorp et al.630 have a nice example of a score chart for manually\nobtaining estimates.\nlarsen and merlo375 developed a similar measure\u2014the median odds ratio. g\u00a8o-\nnen and heller223 developed a c-index that like g is a function of the covariate\ndistribution.\nbooth and sarkar61 have a nice analysis of the number of bootstrap resamples\nneeded to guarantee with 0.95 confidence that a variance estimate has a suf-\nficiently small relative error. they concentrate on the monte carlo simulation\nerror, showing that small errors in variance estimates can lead to important\ndifferences in p -values. canty et al.91 provide a number of diagnostics to check\nthe reliability of bootstrap calculations.\nthere are many variations on the basic bootstrap for computing confidence\nlimits.150, 178 see booth and sarkar61 for useful information about choosing\nthe number of resamples. they report the number of resamples necessary to\nnot appreciably change p -values, for example. booth and sarkar propose a\nmore conservative number of resamples than others use (e.g., 800 resamples)\nfor estimating variances. carpenter and bithell92 have an excellent overview of\nbootstrap confidence intervals, with practical guidance. they also have a good\ndiscussion of the unconditional nonparametric bootstrap versus the conditional\nsemiparametric bootstrap.\naltman and royston18 have a good general discussion of what it means to\nvalidate a predictive model, including issues related to study design and con-\nsideration of uses to which the model will be put.\nan excellent paper on external validation and generalizability is justice et al.329.\nbleeker et al.58 provide an example where internal validation is misleading when\ncompared with a true external validation done using subjects from different\ncenters in a different time period. vergouwe et al.638 give good guidance about\nthe number of events needed in sample used for external validation of binary\nlogistic models.\nsee picard and berk505 for more about data-splitting.\nin the context of variable selection where one attempts to select the set of vari-\nables with nonzero true regression coefficients in an ordinary regression model,\nshao565 demonstrated that leave-out-one cross-validation selects models that\nare \u201ctoo large.\u201d shao also showed that the number of observations held back for\nvalidation should often be larger than the number used to train the model. this\nis because in this case one is not interested in an accurate model (you fit the\nwhole sample to do that), but an accurate estimate of prediction error is manda-\ntory so as to know which variables to allow into the final model. shao suggests\nusing a cross-validation strategy in which approximately n3/4 observations are\nused in each training sample and the remaining observations are used in the\ntest sample. a repeated balanced or monte carlo splitting approach is used,\nand accuracy estimates are averaged over 2n (for the monte carlo method)\nrepeated splits.\n\n "}, {"Page_number": 147, "text": "5.6 further reading\n\n123\n\n12 picard and cook\u2019s monte carlo cross-validation procedure506 is an improve-\n\nment over ordinary cross-validation.\n\n13 the randomization method is related to kipnis\u2019 \u201cchaotization relevancy princi-\nple\u201d348 in which one chooses between two models by measuring how far each is\nfrom a nonsense model. tibshirani and knight also use a randomization method\nfor estimating the optimism in a model fit.611\n\n14 this method used here is a slight change over that presented in [172], where\nefron wrote predictive accuracy as a sum of per-observation components (such\nas 1 if the observation is classified correctly, 0 otherwise). here we are writing\nm \u00d7 the unitless summary index of predictive accuracy in the place of efron\u2019s\nsum of m per-observation accuracies [416, p. 613].\nsee [633] and [66, section 4] for insight on the meaning of expected optimism.\nsee copas,123 van houwelingen and le cessie [633, p. 1318], verweij and van\nhouwelingen,640 and others631 for other methods of estimating shrinkage coef-\nficients.\n\n15\n16\n\n17 efron172 developed the \u201c.632\u201d estimator only for the case where the index being\nbootstrapped is estimated on a per-observation basis. a natural generalization\nof this method can be derived by assuming that the accuracy evaluated on\nobservation i that is omitted from a bootstrap sample has the same expectation\nas the accuracy of any other observation that would be omitted from the sample.\nthe modified estimate of \u00010 is then given by\n\nb(cid:3)\n\n\u02c6\u00010 =\n\nwiti,\n\ni=1\n\n(5.3)\n\nwhere ti is the accuracy estimate derived from fitting a model on the ith boot-\nstrap sample and evaluating it on the observations omitted from that bootstrap\nsample, and wi are weights derived for the b bootstrap samples:\n\nwi =\n\n1\nn\n\n[bootstrap sample i omits observation j]\n\n#bootstrap samples omitting observation j\n\nj=1\n\n.\n\n(5.4)\n\nnote that \u02c6\u00010 is undefined if any observation is included in every bootstrap\nsample. increasing b will avoid this problem. this modified \u201c.632\u201d estimator\nis easy to compute if one assembles the bootstrap sample assignments and\ncomputes the wi before computing the accuracy indexes ti. for large n, the wi\napproach 1/b and so \u02c6\u00010 becomes equivalent to the accuracy computed on the\nobservations not contained in the bootstrap sample and then averaged over the\nb repetitions.\n\n19\n\n18 efron and tibshirani179 have reduced the bias of the \u201c.632\u201d estimator further\nwith only a modest increase in its variance. simulation has, however, shown no\nadvantage of this \u201c.632+\u201d method over the basic optimism bootstrap for most\naccuracy indexes used in logistic models.\nvan houwelingen and le cessie633 have several interesting developments in\nmodel validation. see breiman66 for a discussion of the choice of x for which\nto validate predictions. steyerberg et al.587 present simulations showing the\nnumber of bootstrap samples needed to obtain stable estimates of optimism of\nvarious accuracy measures. they demonstrate that bootstrap estimates of op-\ntimism are nearly unbiased when compared with simulated external estimates.\nthey also discuss problems with precision of estimates of accuracy, especially\nwhen using external validation on small samples.\n\n20 blettner and sauerbrei also demonstrate the variability caused by data-driven\nanalytic decisions.59 chatfield100 has more results on the effects of using the\ndata to select the model.\n\nn(cid:3)\n\n "}, {"Page_number": 148, "text": "124\n\n5 describing, resampling, validating, and simplifying the model\n\n5.7 problem\n\nperform a simulation study to understand the performance of various internal\nvalidation methods for binary logistic models. modify the r code below in at\nleast two meaningful ways with regard to covariate distribution or number,\nsample size, true regression coefficients, number of resamples, or number of\ntimes certain strategies are averaged. interpret your findings and give recom-\nmendations for best practice for the type of configuration you studied. the\nr code from this assignment may be downloaded from the rms course wiki\npage.\n\nfor each of 200 simulations, the code below generates a training sample\nof 200 observations with p predictors (p = 15 or 30) and a binary response.\nthe predictors are independently u (\u22120.5, 0.5). the response is sampled so\nas to follow a logistic model where the intercept is zero and all regression\ncoefficients equal 0.5. the \u201cgold standard\u201d is the predictive ability of the\nfitted model on a test sample containing 50,000 observations generated from\nthe same population model. for each of the 200 simulations, several validation\nmethods are employed to estimate how the training sample model predicts\nresponses in the 50,000 observations. these validation methods involve fitting\n40 or 200 models in resamples.\n\ng-fold cross-validation is done using the command validate(f, method=\n\u2019cross\u2019, b=g) using the rms package. this was repeated and averaged using\nan extra loop, shown below.\n\nfor bootstrap methods, validate(f, method=\u2019boot\u2019 or \u2019.632\u2019, b=40 or\nb=200) was used. method=\u2019.632\u2019 does efron\u2019s \u201c.632\u201d method179, labeled 632a in\nthe output. an ad-hoc modification of the .632 method, 632b was also done.\nhere a \u201cbias-corrected\u201d index of accuracy is simply the index evaluated in the\nobservation omitted from the bootstrap resample. the \u201cgold standard\u201d exter-\nnal validations were obtained from the val.prob function in the rms package.\nthe following indexes of predictive accuracy are used:\n\ndxy:\n\nsomers\u2019 rank correlation between predicted probability that y = 1 vs.\nthe binary y values. this equals 2(c \u2212 0.5) where c is the \u201croc area\u201d\nor concordance probability.\n\nd: discrimination index \u2014 likelihood ratio \u03c72 divided by the sample size\nu : unreliability index \u2014 unitless index of how far the logit calibration\n\ncurve intercept and slope are from (0, 1)\n\nq: logarithmic accuracy score \u2014 a scaled version of the log-likelihood\n\nachieved by the predictive model\n\nintercept: calibration intercept on logit scale\nslope: calibration slope (slope of predicted log odds vs. true log odds)\n\naccuracy of the various resampling procedures may be estimated by com-\nputing the mean absolute errors and the root mean squared errors of esti-\nmates (e.g., of dxy from the bootstrap on the 200 observations) against the\n\u201cgold standard\u201d (e.g., dxy for the fitted 200-observation model achieved in\nthe 50,000 observations).\n\n "}, {"Page_number": 149, "text": "5.7 problem\n\n125\n\nrequire ( rms )\nset.seed (1)\n\n# so can reproduce results\n\nn\n\n\u2190 200\nreps \u2190 200\nnpop \u2190 50000\nmethods \u2190 c ( ' boot 40 ' , ' boot 200 ' , ' 632 a 40 ' , ' 632 a 200 ' ,\n\n# size of training sample\n# simulations\n\n# size of validation gold standard sample\n\n' 632 b 40 ' , ' 632 b 200 ' , ' 10 -fold x 4 ' , ' 4 -fold x 10 ' ,\n' 10 -fold x 20 ' , ' 4 -fold x 50 ' )\n\nr \u2190 expand.gr i d ( sim\n\n= 1: reps ,\n= c (15 ,30) ,\n\np\nmethod = methods )\n\nr $ dxy \u2190 r $ intercept \u2190 r $ slope \u2190 r $ d \u2190 r $ u \u2190 r $ q \u2190\nr $ n \u2190 n\n\nr $ repmeth \u2190 r $ b \u2190 na\n\n## function to do r overall reps of b resamples , averaging to\n## get estimates similar to as if r *b resamples were done\nval \u2190 function ( fit , method , b , r ) {\n\ncontains \u2190 function ( m ) length ( grep (m , method )) > 0\nmeth \u2190 if ( contains ( ' boot ' )) ' boot ' else\n\nif ( contains ( ' fold ' )) ' c r o s s v a l i d a t i o n ' else\nif ( contains ( ' 632 ' )) ' .632 '\n\nz \u2190 0\nfor ( i in 1: r ) z \u2190 z + validate ( fit , method = meth , b = b )[\n\nc ( \" dxy \" ,\" intercept \" , \" slope \" ,\" d \" ,\" u \" ,\" q \" ) ,\n' i n d e x . c o r r e c t e d ' ]\n\nz / r\n\n}\n\nfor ( p in c (15 , 30)) {\n\n# # for each p c r e a t e the true betas , the d e s i g n matrix ,\n# # and r e a l i z a t i o n s of b i n a r y y in the gold s t a n d a r d\n# # l a r g e s a m p l e\n\nx\n\nbeta \u2190 rep ( .5 , p )\nlx \u2190 matxv (x , beta )\n\n\u2190 matrix ( runif ( npop *p ), nrow = npop ) - 0 .5\n\u2190 ifelse ( runif ( npop ) \u2264 plogis ( lx ), 1, 0)\n\n# true b e t a s\n\ny\n\n# # for each s i m u l a t i o n c r e a t e the data m a t r i x and\n# # r e a l i z a t i o n s of y\nfor ( j in 1: reps ) {\n\n# # make t r a i n i n g s a m p l e\n\nx \u2190 matrix ( runif (n * p), nrow = n ) - 0 .5\nl \u2190 matxv (x , beta )\ny \u2190 ifelse ( runif (n ) \u2264 plogis ( l ), 1, 0)\nf \u2190 lrm ( y \u223c x , x = true , y = true )\nbeta \u2190 f $ coef\nforecast \u2190 matxv (x , beta )\n\n# # v a l i d a t e in p o p u l a t i o n\n\n "}, {"Page_number": 150, "text": "126\n\n5 describing, resampling, validating, and simplifying the model\n\nv \u2190 val.prob ( logit = forecast , y =y , pl = false )[\n\nc (\" dxy \" ,\" intercept \" ,\" slope \" ,\" d\" ,\" u \" ,\" q \" )]\n\nfor ( method in methods ) {\n\nrepmeth \u2190 1\nif ( method % in % c ( ' boot 40 ' , ' 632 a 40 ' , ' 632 b 40 ' ))\n\nif ( method % in % c ( ' boot 200 ' , ' 632 a 200 ' , ' 632 b 200 ' ))\n\nif ( method == ' 10 -fold x 4 ' ) {\n\nb \u2190 40\nb \u2190 200\nb \u2190 10\nrepmeth \u2190 4\n\n}\nif ( method == ' 4 -fold x 10 ' ) {\n\nb \u2190 4\nrepmeth \u2190 10\n\n}\nif ( method == ' 10 -fold x 20 ' ) {\n\nb \u2190 10\nrepmeth \u2190 20\n\n}\nif ( method == ' 4 -fold x 50 ' ) {\n\nb \u2190 4\nrepmeth \u2190 50\n\n}\n\nz \u2190 val (f , method , b , repmeth )\nk \u2190 which ( r $ sim == j & r $ p == p & r $ method == method )\nif ( length ( k ) ! = 1) stop ( ' program logic error ' )\nr [k , names ( z )] \u2190 z - v\nr [k , c ( ' b ' , ' repmeth ' )] \u2190 c ( b =b , repmeth = repmeth )\n\n} # end over m e t h o d s\n\n} # end over reps\n\n} # end over p\n\nresults are best summarized in a multi-way dot chart. bootstrap nonpara-\n\nrequire ( lattice )\n\nmetric percentile 0.95 confidence limits are included.\nstatnames \u2190 names ( r )[6:11]\nw \u2190 reshape (r , direction = ' long ' , varying = list ( statnames ),\nv.names = ' x ' , timevar = ' stat ' , times = statnames )\nw $ p \u2190 paste ( ' p ' , w $p , sep = ' = ' )\ns \u2190 with (w , summarize ( abs (x ), llist (p , method , stat ),\nsmean.cl.boot , stat.name = ' mae ' ))\ndotplot ( method \u223c cbind ( mae , lower , upper ) | stat *p , data =s ,\ns \u2190 with (w , summarize ( x\ndotplot ( method \u223c cbind ( sqrt ( mse ), sqrt ( lower ), sqrt ( upper )) |\n\n\u2227\nsmean.cl.boot , stat.name = ' mse ' ))\n\nxlab = ' mean | error | ' )\n\n2, llist (p , method , stat ),\n\nstat *p , data =s ,\nxlab = expression ( sqrt ( mse )))\n\n "}, {"Page_number": 151, "text": "chapter 6\nr software\n\nthe methods described in this book are useful in any regression model that\ninvolves a linear combination of regression parameters. the software that is\ndescribed below is useful in the same situations. functions in r520 allow inter-\naction spline functions as well as a wide variety of predictor parameterizations\nfor any regression function, and facilitate model validation by resampling.\n\nr is the most comprehensive tool for general regression models for the\n\n1\n\nfollowing reasons.\n\n1. it is very easy to write r functions for new models, so r has implemented\n\na wide variety of modern regression models.\n\n2. designs can be generated for any model. there is no need to find out\nwhether the particular modeling function handles what sas calls \u201cclass\u201d\nvariables\u2014dummy variables are generated automatically when an r cate-\ngory, factor, ordered, or character variable is analyzed.\n\n3. a single r object can contain all information needed to test hypotheses\n\nand to obtain predicted values for new data.\n\n4. r has superior graphics.\n5. classes in r make possible the use of generic function names (e.g., predict,\nsummary, anova) to examine fits from a large set of specific model\u2013fitting\nfunctions.\n\nr44, 601, 635 is a high-level object-oriented language for statistical anal-\nysis with over six thousand packages and tens of thousands of functions\navailable. the r system318, 520 is the basis for r software used in this\ntext, centered around the regression modeling strategies (rms) package261.\nsee the appendix and the web site for more information about software\nimplementations.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 6\n\n127\n\n "}, {"Page_number": 152, "text": "128\n\n6 r software\n\n6.1 the r modeling language\n\n2\n\nr has a battery of functions that make up a statistical modeling language.96\nat the heart of the modeling functions is an r formula of the form\nresponse \u223c terms\n\nthe terms represent additive components of a general linear model. although\nvariables and functions of variables make up the terms, the formula refers\nto additive combinations; for example, when terms is age + blood.pressure,\n\nit refers to \u03b21 \u00d7 age + \u03b22 \u00d7 blood.pressure. some examples of formulas are\n\nbelow.\ny \u223c age + sex\ny \u223c age + sex + age : sex\ny \u223c age * sex\ny \u223c ( age + sex + pressure )\ny \u223c ( age + sex + pressure )\n\n2\n\n\u2227\n\n# age + sex main e f f e c t s\n# add s e c o n d - o r d e r i n t e r a c t i o n\n# s e c o n d - o r d e r i n t e r a c t i o n +\n# all main e f f e c t s\n\u2227\n\n# age + sex + p r e s s u r e + age : sex + age : p r e s s u r e . . .\n\n2 - sex : pressure\n\n# all main e f f e c t s and all 2 nd o r d e r\n# i n t e r a c t i o n s e x c e p t sex : p r e s s u r e\n\n# age + race + sex + age : sex + race : sex\n\n# no i n t e r a c t . with race , sex\n\ny \u223c ( age + race ) * sex\ny \u223c treatment * ( age * race + age * sex )\nsqrt ( y ) \u223c sex * sqrt ( age ) + race\n\n# f u n c t i o n s , with d u m m y v a r i a b l e s g e n e r a t e d if\n# race is an r f a c t o r ( c l a s s i f i c a t i o n ) v a r i a b l e\n\ny \u223c sex + poly ( age ,2) # poly m a k e s o r t h o g o n a l p o l y n o m i a l s\nrace.sex \u2190 interaction ( race , sex )\ny \u223c age + race.sex\n\n# if d e s i r e d u m m y v a r i a b l e s for all\n# c o m b i n a t i o n s of the f a c t o r s\n\nthe formula for a regression model is given to a modeling function; for\nexample,\nlrm ( y \u223c rcs (x ,4))\n\nis read \u201cuse a logistic regression model to model y as a function of x, repre-\nsenting x by a restricted cubic spline with four default knots.\u201da you can use\nthe r function update to refit a model with changes to the model terms or the\ndata used to fit it:\nf \u2190 lrm ( y \u223c rcs (x ,4) + x2 + x3 )\nf2 \u2190 update (f , subset = sex == \" male \" )\nf3 \u2190 update (f , .\u223c.-x2 )\nf4 \u2190 update (f , .\u223c. + rcs ( x5 ,5)) # add rcs ( x5 ,5) to m o d e l\nf5 \u2190 update (f , y2 \u223c . )\n\n# same terms , new r e s p o n s e var.\n\n# r e m o v e x2 from m o d e l\n\na lrm and rcs are in the rms package.\n\n "}, {"Page_number": 153, "text": "6.2 user-contributed functions\n\n129\n\n6.2 user-contributed functions\n\nin addition to the many functions that are packaged with r, a wide variety\nof user-contributed functions is available on the internet (see the appendix\nor web site for addresses). two packages of functions used extensively in\nthis text are hmisc20 and rms written by the author. the hmisc package con-\ntains miscellaneous functions such as varclus, spearman2, transcan, hoeffd,\nrcspline.eval, impute, cut2, describe, sas.get, latex, and several power and\nsample size calculation functions. the varclus function uses the r hclust hi-\nerarchical clustering function to do variable clustering, and the r plclust\nfunction to draw dendrograms depicting the clusters. varclus offers a choice\nof three similarity measures (pearson r2, spearman \u03c12, and hoeffding d)\nand uses pairwise deletion of missing values. varclus automatically generates\na series of dummy variables for categorical factors. the hmisc hoeffd function\ncomputes a matrix of hoeffding ds for a series of variables. the spearman2\nfunction will do wilcoxon, spearman, and kruskal\u2013wallis tests and general-\nizes spearman\u2019s \u03c1 to detect non-monotonic relationships.\n\nhmisc\u2019s transcan function (see section 4.7) performs a similar function to\nproc prinqual in sas\u2014it uses restricted splines, dummy variables, and canon-\nical variates to transform each of a series of variables while imputing missing\nvalues. an option to shrink regression coefficients for the imputation models\navoids overfitting for small samples or a large number of predictors. transcan\ncan also do multiple imputation and adjust variance\u2013covariance matrices for\nimputation. see chapter 8 for an example of using these functions for data\nreduction.\n\nsee the web site for a list of r functions for correspondence analysis,\nprincipal component analysis, and missing data imputation available from\nother users. venables and ripley [635, chapter 11] provide a nice description\nof the multivariate methods that are available in r, and they provide several\nnew multivariate analysis functions.\n\na basic function in hmisc is the rcspline.eval function, which creates a\ndesign matrix for a restricted (natural) cubic spline using the truncated power\nbasis. knot locations are optionally estimated using methods described in\nsection 2.4.6, and two types of normalizations to reduce numerical problems\nare supported. you can optionally obtain the design matrix for the anti-\nderivative of the spline function. the rcspline.restate function computes\nthe coefficients (after un-normalizing if needed) that translate the restricted\ncubic spline function to unrestricted form (equation 2.27). rcspline.restate\nalso outputs latex and r representations of spline functions in simplified\nform.\n\n "}, {"Page_number": 154, "text": "130\n\n6.3 the rms package\n\n6 r software\n\na package of r functions called rms contains several functions that extend\nr to make the analyses described in this book easy to do. a central func-\ntion in rms is datadist, which computes statistical summaries of predictors to\nautomate estimation and plotting of effects. datadist exists as a separate func-\ntion so that the candidate predictors may be summarized once, thus saving\ntime when fitting several models using subsets or different transformations of\npredictors. if datadist is called before model fitting, the distributional sum-\nmaries are stored with the fit so that the fit is self-contained with respect\nto later estimation. alternatively, datadist may be called after the fit to cre-\nate temporary summaries to use as plot ranges and effect intervals, or these\nranges may be specified explicitly to predict and summary (see below), without\never calling datadist. the input to datadist may be a data frame, a list of\nindividual predictors, or a combination of the two.\n\nthe characteristics saved by datadist include the overall range and certain\nquantiles for continuous variables, and the distinct values for discrete vari-\nables (i.e., r factor variables or variables with 10 or fewer unique values). the\nquantiles and set of distinct values facilitate estimation and plotting, as de-\nscribed later. when a function of a predictor is used (e.g., pol(pmin(x,50),2)),\nthe limits saved apply to the innermost variable (here, x). when a plot is re-\nquested for how x relates to the response, the plot will have x on the x-axis,\nnot pmin(x,50). the way that defaults are computed can be controlled by\nthe q.effect and q.display parameters to datadist. by default, continuous\nvariables are plotted with ranges determined by the tenth smallest and tenth\nlargest values occurring in the data (if n < 200, the 0.05 and 0.95 quantiles\nare used). the default range for estimating effects such as odds and hazard\nratios is the lower and upper quartiles. when a predictor is adjusted to a\nconstant so that the effects of changes in other predictors can be studied, the\ndefault constant used is the median for continuous predictors and the most\nfrequent category for factor variables. the r system option datadist is used\nto point to the result returned by the datadist function. see the help files for\ndatadist for more information.\n\nrms fitting functions save detailed information for later prediction, plotting,\nand testing. rms also allows for special restricted interactions and sets the\ndefault method of generating contrasts for categorical variables to \"contr.-\ntreatment\", the traditional dummy-variable approach.\n\nrms has a special operator %ia% in the terms of a formula that allows for\nrestricted interactions. for example, one may specify a model that contains\nsex and a five-knot linear spline for age, but restrict the age \u00d7 sex interaction\nto be linear in age. to be able to connect this incomplete interaction with the\nmain effects for later hypothesis testing and estimation, the following formula\nwould be given:\ny \u223c sex + lsp ( age , c (20 ,30 ,40 ,50 ,60)) +\n\nsex % ia % lsp ( age , c (20 ,30 ,40 ,50 ,60))\n\n "}, {"Page_number": 155, "text": "6.3 the rms package\n\n131\n\ntable 6.1 rms fitting functions\n\nfunction\n\npurpose\n\nrelated r\nfunctions\nlm\n\nols\n\nlrm\n\norm\n\npsm\n\ncph\n\nbj\n\nglm\n\ngls\n\nrq\n\nglm\n\nordinary least squares linear model\nbinary and ordinal logistic regression model\nhas options for penalized mle\nordinal semi-parametric regression model with polr,lrm\nseveral link functions\naccelerated failure time parametric survival\nmodels\ncox proportional hazards regression\nbuckley\u2013james censored least squares model\ngeneral linear models\ngeneralized least squares\nquantile regression\n\nsurvreg\n\ngls\n\ncoxph\nsurvreg,lm\nglm\n\nrq\n\nthe following expression would restrict the age \u00d7 cholesterol interaction to\nbe of the form af (b) + bg(a) by removing doubly nonlinear terms.\ny \u223c lsp ( age ,30) + rcs ( cholesterol ,4) +\n\nlsp ( age ,30) % ia % rcs ( cholesterol ,4)\n\nrms has special fitting functions that facilitate many of the procedures de-\nscribed in this book, shown in table 6.1.\n\nglm is a slight modification of the built-in r glm function so that rms meth-\nods can be run on the resulting fit object. glm fits general linear models under\na wide variety of distributions of y . gls is a modification of the gls function\nfrom the nlme package of pinheiro and bates509, for repeated measures (longi-\ntudinal) and spatially correlated data. the rq function is a modification of the\nquantreg package\u2019s rq function356, 357. functions related to survival analysis\nmake heavy use of therneau\u2019s survival package482.\n\nyou may want to specify to the fitting functions an option for how missing\nvalues (nas) are handled. the method for handling missing data in r is to\nspecify an na.action function. some possible na.actions are given in table 6.2.\nthe default na.action is na.delete when you use rms\u2019s fitting functions. an\neasy way to specify a new default na.action is, for example,\noptions ( na.action = \" na.omit \" ) # don ' t r e p o r t f r e q u e n c y of nas\n\nbefore using a fitting function. if you use na.delete you can also use the system\noption na.detail.response that makes model fits store information about y\nstratified by whether each x is missing. the default descriptive statistics for\ny are the sample size and mean. for a survival time response object the\nsample size and proportion of events are used. other summary functions can\nbe specified using the na.fun.response option.\n\n "}, {"Page_number": 156, "text": "132\n\n6 r software\n\ntable 6.2 some na.actions used in rms\n\nfunction name\nna.fail\n\nna.omit\n\nna.delete\n\nmethod used\n\nstop with error message if any missing\nvalues present\nfunction to remove observations with\nany predictors or responses missing\nmodified version of na.omit to also\nreport on frequency of nas for each\nvariable\n\noptions ( na.action = \" na.delete \" , na.detail.r es po n se = true ,\n\nna.fun.respon se = \" mystats \" )\n\n# just use n a . f u n . r e s p o n s e =\" q u a n t i l e \" if don ' t care a b o u t n\nmystats \u2190 function (y ) {\n\nz \u2190 quantile (y , na.rm = t )\nn \u2190 sum ( ! is.na ( y ))\n\nc ( n =n , z )\n\n# e l e m e n t s n a m e d n , 0% , 25% , etc.\n\n}\n\nwhen r deletes missing values during the model\u2013fitting procedure, residuals,\nfitted values, and other quantities stored with the fit will not correspond row-\nfor-row with observations in the original data frame (which retained nas). this\nis problematic when, for example, age in the dataset is plotted against the\nresidual from the fitted model. fortunately, for many na.actions including\nna.delete and a modified version of na.omit, a class of r functions called\nnaresid written by therneau works behind the scenes to put nas back into\nresiduals, predicted values, and other quantities when the predict or residuals\nfunctions (see below) are used. thus for some of the na.actions, predicted\nvalues and residuals will automatically be arranged to match the original\ndata.\n\nany r function can be used in the terms for formulas given to the fit-\nting function, but if the function represents a transformation that has data-\ndependent parameters (such as the standard r functions poly or ns), r will\nnot in general be able to compute predicted values correctly for new obser-\nvations. for example, the function ns that automatically selects knots for a\nb-spline fit will not be conducive to obtaining predicted values if the knots\nare kept \u201csecret.\u201d for this reason, a set of functions that keep track of trans-\nformation parameters, exists in rms for use with the functions highlighted\nin this book. these are shown in table 6.3. of these functions, asis, catg,\nscored, and matrx are almost always called implicitly and are not mentioned\nby the user. catg is usually called explicitly when the variable is a numeric\nvariable to be used as a polytomous factor, and it has not been converted to\nan r categorical variable using the factor function.\n\n "}, {"Page_number": 157, "text": "6.3 the rms package\n\n133\n\ntable 6.3 rms transformation functions\n\nfunction\n\npurpose\n\nrelated r\nfunctions\n\nasis\n\nrcs\n\npol\n\nlsp\n\nstrat\n\nno post-transformation (seldom used explicitly) i\nrestricted cubic spline\nns\npolynomial using standard notation\nlinear spline\ncategorical predictor (seldom)\n\npoly\n\ncatg\nscored ordinal categorical variables\nmatrx\n\nkeep variables as group for anova and fastbw\nnonmodeled stratification factors\n(used for cph only)\n\nfactor\n\nordered\n\nmatrix\n\nstrata\n\nthese functions can be used with any function of a predictor. for example,\nto obtain a four-knot cubic spline expansion of the cube root of x, specify\nrcs(x\n\n(1/3),4).\n\n\u2227\n\nwhen the transformation functions are called, they are usually given one\nor two arguments, such as rcs(x,5). the first argument is the predictor vari-\nable or some function of it. the second argument is an optional vector of\nparameters describing a transformation, for example location or number of\nknots. other arguments may be provided.\n\nthe hmisc package\u2019s cut2 function is sometimes used to create a categorical\nvariable from a continuous variable x. you can specify the actual interval\nendpoints (cuts), the number of observations to have in each interval on\nthe average (m), or the number of quantile groups (g). use, for example,\ncuts=c(0,1,2) to cut into the intervals [0, 1), [1, 2].\n\na key concept in fitting models in r is that the fitting function returns an\nobject that is an r list. this object contains basic information about the fit\n(e.g., regression coefficient estimates and covariance matrix, model \u03c72) as well\nas information about how each parameter of the model relates to each factor\nin the model. components of the fit object are addressed by, for example,\nfit$coef, fit$var, fit$loglik. rms causes the following information to also\nbe retained in the fit object: the limits for plotting and estimating effects\nfor each factor (if options(datadist=\"name\") was in effect), the label for each\nfactor, and a vector of values indicating which parameters associated with a\nfactor are nonlinear (if any). thus the \u201cfit object\u201d contains all the information\nneeded to get predicted values, plots, odds or hazard ratios, and hypothesis\ntests, and to do \u201csmart\u201d variable selection that keeps parameters together\nwhen they are all associated with the same predictor.\n\nr uses the notion of the class of an object. the object-oriented class idea\nallows one to write a few generic functions that decide which specific func-\ntions to call based on the class of the object passed to the generic function.\nan example is the function for printing the main results of a logistic model.\n\n "}, {"Page_number": 158, "text": "134\n\n6 r software\n\nthe lrm function returns a fit object of class \"lrm\". if you specify the r com-\nmand print(fit) (or just fit if using r interactively\u2014this invokes print), the\nprint function invokes the print.lrm function to do the actual printing specific\nto logistic models. to find out which particular methods are implemented for\na given generic function, type methods(generic.name).\n\ngeneric functions that are used in this book include those in table 6.4.\n\ntable 6.4 rms package and r generic functions\n\nfunction\nprint\ncoef\nformula\nspecs\nvcov\nloglik\naic\nlrtest\nunivarlr\nrobcov\nbootcov\n\npentrace\n\neffective.df\n\nsummary\nplot.summary\n\nanova\nplot.anova\ncontrast\npredict\n\nplot.predict\nggplot\nbplot\n\ngendata\npredict\nfastbw\nresiduals\nsensuc\n\npurpose\n\nrelated functions\n\nprint parameters and statistics of fit\nfitted regression coefficients\nformula used in the fit\ndetailed specifications of fit\nfetch covariance matrix\nfetch maximized log-likelihood\nfetch aic\nlikelihood ratio test for two nested models\ncompute all univariable lr \u03c72\nrobust covariance matrix estimates\nbootstrap covariance matrix estimates\nand bootstrap distributions of estimates\nfind optimum penalty factors by tracing\neffective aic for a grid of penalties\nprint effective d.f. for each type of variable\nin model, for penalized fit or pentrace result\nsummary of effects of predictors\nplot continuously shaded confidence bars\nfor results of summary\nwald tests of most meaningful hypotheses\ngraphical depiction of anova\ngeneral contrasts, c.l., tests\npredicted values and confidence limits easily\nvarying a subset of predictors and leaving the\nrest set at default values\nplot the result of predict using lattice\nplot the result of predict using ggplot2\n3-dimensional plot when predict varied\ntwo continuous predictors over a fine grid\neasily generate predictor combinations\nobtain predicted values or design matrix\nfast backward step-down variable selection\n(or resid) residuals, influence stats from fit\nsensitivity analysis for unmeasured\nconfounder\n\nstep\n\nwhich.influence which observations are overly influential\nlatex\n\nlatex representation of fitted model\n\nresiduals\nfunction\n\ncontinued on next page\n\n "}, {"Page_number": 159, "text": "6.3 the rms package\n\n135\n\nfunction\nfunction r function analytic representation of x \u02c6\u03b2\n\npurpose\n\nrelated functions\nlatex\n\ncontinued from previous page\n\nfrom a fitted regression model\nr function analytic representation of a fitted\nhazard function (for psm)\n\nsurvival r function analytic representation of fitted\n\nsurvival function (for psm, cph)\nr function analytic representation of\nexceedance probabilities for orm\n\nhazard\n\nexprob\n\nquantile r function analytic representation of fitted\n\nmean\n\nfunction for quantiles of survival time\n(for psm, cph)\nr function analytic representation of fitted\nfunction for mean survival time or for ordinal logistic\n\nestimate survival probabilities (psm, cph)\n\nnomogram draws a nomogram for the fitted model\nsurvest\nsurvplot plot survival curves (psm, cph)\nvalidate validate indexes of model fit using resampling\ncalibrate estimate calibration curve using resampling\nvif\nnaresid bring elements corresponding to missing data\n\nvariance inflation factors for fitted model\n\nnaprint\nimpute\n\nback into predictions and residuals\nprint summary of missing values\nimpute missing values\n\nlatex, plot\nsurvfit\nplot.survfit\n\nval.prob\n\ntranscan\n\nthe first argument of the majority of functions is the object returned from\nthe model fitting function. when used with ols, lrm, orm, psm, cph, glm, gls, rq,\nbj, these functions do the following. specs prints the design specifications, for\nexample, number of parameters for each factor, levels of categorical factors,\nknot locations in splines, and so on. vcov returns the variance-covariance\nmatrix for the model. loglik retrieves the maximized log-likelihood, whereas\naic computes the akaike information criterion for the model on the minus\ntwice log-likelihood scale (with an option to compute it on the \u03c72 scale if you\nspecify type=\u2019chisq\u2019). lrtest, when given two fit objects from nested models,\ncomputes the likelihood ratio test for the extra variables. univarlr computes\nall univariable likelihood ratio \u03c72 statistics, one predictor at a time.\n\nthe robcov function computes the huber robust covariance matrix esti-\nmate. bootcov uses the bootstrap to estimate the covariance matrix of pa-\nrameter estimates. both robcov and bootcov assume that the design matrix\nand response variable were stored with the fit. they have options to adjust\nfor cluster sampling. both replace the original variance\u2013covariance matrix\nwith robust estimates and return a new fit object that can be passed to any\nof the other functions. in that way, robust wald tests, variable selection, con-\nfidence limits, and many other quantities may be computed automatically.\nthe functions do save the old covariance estimates in component orig.var\nof the new fit object. bootcov also optionally returns the matrix of param-\neter estimates over the bootstrap simulations. these estimates can be used\nto derive bootstrap confidence intervals that don\u2019t assume normality or sym-\nmetry. associated with bootcov are plotting functions for drawing histogram\n\n "}, {"Page_number": 160, "text": "136\n\n6 r software\n\nand smooth density estimates for bootstrap distributions. bootcov also has\na feature for deriving approximate nonparametric simultaneous confidence\nsets. for example, the function can get a simultaneous 0.90 confidence region\nfor the regression effect of age over its entire range.\n\nthe pentrace function assists in selection of penalty factors for fitting re-\ngression models using penalized maximum likelihood estimation (see sec-\ntion 9.10). different types of model terms can be penalized by different\namounts. for example, one can penalize interaction terms more than main\neffects. the effective.df function prints details about the effective degrees\nof freedom devoted to each type of model term in a penalized fit.\n\nsummary prints a summary of the effects of each factor. when summary is\nused to estimate effects (e.g., odds or hazard ratios) for continuous variables,\nit allows the levels of interacting factors to be easily set, as well as allowing\nthe user to choose the interval for the effect. this method of estimating effects\nallows for nonlinearity in the predictor. by default, interquartile range effects\n(differences in x \u02c6\u03b2, odds ratios, hazards ratios, etc.) are printed for continuous\nfactors, and all comparisons with the reference level are made for categorical\nfactors. see the example at the end of the summary documentation for a method\nof quickly computing pairwise treatment effects and confidence intervals for\na large series of values of factors that interact with the treatment variable.\nsaying plot(summary(fit)) will depict the effects graphically, with bars for a\nlist of confidence levels.\n\nthe anova function automatically tests most meaningful hypotheses in a\ndesign. for example, suppose that age and cholesterol are predictors, and\nthat a general interaction is modeled using a restricted spline surface. anova\nprints wald statistics for testing linearity of age, linearity of cholesterol, age\neffect (age + age \u00d7 cholesterol interaction), cholesterol effect (cholesterol +\nage \u00d7 cholesterol interaction), linearity of the age \u00d7 cholesterol interaction\n(i.e., adequacy of the simple age \u00d7 cholesterol 1 d.f. product), linearity of the\ninteraction in age alone, and linearity of the interaction in cholesterol alone.\njoint tests of all interaction terms in the model and all nonlinear terms in the\nmodel are also performed. the plot.anova function draws a dot chart showing\nthe relative contribution (\u03c72, \u03c72 minus d.f., aic, partial r2, p -value, etc.)\nof each factor in the model.\n\nthe contrast function is used to obtain general contrasts and correspond-\ning confidence limits and test statistics. this is most useful for testing effects\nin the presence of interactions (e.g., type ii and type iii contrasts). see the\nhelp file for contrast for several examples of how to obtain joint tests of mul-\ntiple contrasts (see section 9.3.2) as well as double differences (interaction\ncontrasts).\n\nthe predict function is used to obtain a variety of values or predicted\nvalues from either the data used to fit the model or a new dataset. the\npredict function is easier to use for most purposes, and has a special plot\nmethod. the gendata function makes it easy to obtain a data frame containing\npredictor combinations for obtaining selected predicted values.\n\n "}, {"Page_number": 161, "text": "6.3 the rms package\n\n137\n\nthe fastbw function performs a slightly inefficient but numerically stable\nversion of fast backward elimination on factors, using a method based on\nlawless and singhal.385 this method uses the fitted complete model and\ncomputes approximate wald statistics by computing conditional (restricted)\nmaximum likelihood estimates assuming multivariate normality of estimates.\nit can be used in simulations since it returns indexes of factors retained and\ndropped:\nfit \u2190 ols ( y \u223c x1 * x2 * x3 )\n\n# run , and p r i n t r e s u l t s :\nfastbw ( fit , optional_arg u me nt s )\n# t y p i c a l l y used in s i m u l a t i o n s :\n\nz \u2190 fastbw ( fit , optional_args )\n\n# l e a s t s q u a r e s fit of r e d u c e d m o d e l :\nlm.fit ( x [, z $ parms.kept ], y )\n\nfastbw deletes factors, not columns of the design matrix. factors requiring\nmultiple d.f. will be retained or dropped as a group. the function prints the\ndeletion statistics for each variable in turn, and prints approximate parameter\nestimates for the model after deleting variables. the approximation is better\nwhen the number of factors deleted is not large. for ols, the approximation\nis exact.\n\nthe which.influence function creates a list with a component for each\nfactor in the model. the names of the components are the factor names.\neach component contains the observation identifiers of all observations that\nare \u201coverly influential\u201d with respect to that factor, meaning that |dfbetas| > u\nfor at least one \u03b2i associated with that factor, for a given u. the default u\nis .2. you must have specified x=true, y=true in the fitting function to use\nwhich.influence. the first argument is the fit object, and the second argument\nis the cutoff u.\n\nthe following r program will print the set of predictor values that were\nvery influential for each factor. it assumes that the data frame containing the\ndata used in the fit is called df.\nf \u2190 lrm ( y \u223c x1 + x2 + ... , data = df , x = true , y = true )\nw \u2190 which.influen ce (f , .4 )\nnam \u2190 names ( w )\n\nfor ( i in 1: length ( nam )) {\n\ncat ( \" influential observations for effect of \" ,\n\nnam [ i ], \" \\ n \" )\n\nprint ( df [ w [[ i ]] ,])\n\n}\n\nthe latex function is a generic function available in the hmisc package. it\ninvokes a specific latex function for most of the fit objects created by rms to\ncreate a latex algebraic representation of the fitted model for inclusion in a\nreport or viewing on the screen. this representation documents all parameters\nin the model and the functional form being assumed for y , and is especially\nuseful for getting a simplified version of restricted cubic spline functions. on\n\n "}, {"Page_number": 162, "text": "138\n\n6 r software\n\nthe other hand, the print method with optional argument latex=true is used\nto output latex code representing the model results in tabular form to the\nconsole. this is intended for use with knitr677 or sweave399.\n\nthe function function composes an r function that you can use to evaluate\nx \u02c6\u03b2 analytically from a fitted regression model. the documentation for func-\ntion also shows how to use a subsidiary function sascode that will (almost)\ntranslate such an r function into sas code for evaluating predicted values in\nnew subjects. neither function nor latex handles third-order interactions.\n\nthe nomogram function draws a partial nomogram for obtaining predictions\nfrom the fitted model manually. it constructs different scales when interac-\ntions (up to third-order) are present. the constructed nomogram is not com-\nplete, in that point scores are obtained for each predictor and the user must\nadd the point scores manually before reading predicted values on the final\naxis of the nomogram. the constructed nomogram is useful for interpreting\nthe model fit, especially for non-monotonically transformed predictors (their\nscales wrap around an axis automatically).\n\nthe vif function computes variance inflation factors from the covariance\n\nmatrix of a fitted model, using [147, 654].\n\nthe impute function is another generic function. it does simple imputation\nby default. it can also work with the transcan function to multiply or singly\nimpute missing values using a flexible additive model.\n\nas an example of using many of the functions, suppose that a categorical\nvariable treat has values \"a\", \"b\", and \"c\", an ordinal variable num.diseases\nhas values 0,1,2,3,4, and that there are two continuous variables, age and\ncholesterol. age is fitted with a restricted cubic spline, while cholesterol\nis transformed using the transformation log(cholesterol+10). cholesterol is\nmissing on three subjects, and we impute these using the overall median\ncholesterol. we wish to allow for interaction between treat and cholesterol.\nthe following r program will fit a logistic model, test all effects in the design,\nestimate effects, and plot estimated transformations. the fit for num.diseases\nreally considers the variable to be a five-level categorical variable. the only\ndifference is that a 3 d.f. test of linearity is done to assess whether the variable\ncan be remodeled \u201casis\u201d. here we also show statements to attach the rms\npackage and store predictor characteristics from datadist.\n\nrequire ( rms )\n\n# make new f u n c t i o n s a v a i l a b l e\n\nddist \u2190 datadist ( cholesterol , treat , num.diseases , age )\n# c o u l d have used d d i s t \u2190 d a t a d i s t ( d a t a . f r a m e . n a m e )\ncholesterol \u2190 impute ( cholesterol )\nfit \u2190 lrm ( y \u223c treat + scored ( num.diseases ) + rcs ( age ) +\n\noptions ( datadist = \" ddist \" )\n\n# d e f i n e s data d i s t . to rms\n\ndescribe ( y \u223c treat + scored ( num.diseases ) + rcs ( age ))\n\nlog ( cholesterol +10) +\ntreat : log ( cholesterol +10))\n\n# or use d e s c r i b e ( f o r m u l a ( fit )) for all v a r i a b l e s used in\n# fit.\n# on v a r i a b l e s\n\nd e s c r i b e f u n c t i o n ( in h m i s c ) gets s i m p l e s t a t i s t i c s\n\n# fit \u2190 r o b c o v ( fit )# w o u l d make all s t a t i s t i c s that f o l l o w\n\n "}, {"Page_number": 163, "text": "6.3 the rms package\n\n139\n\n# use a r o b u s t c o v a r i a n c e m a t r i x\n# w o u l d need x = true , y = true in lrm ()\n# d e s c r i b e the d e s i g n c h a r a c t e r i s t i c s\n\nspecs ( fit )\nanova ( fit )\nanova ( fit , treat , cholesterol ) # test t h e s e 2 by t h e m s e l v e s\nplot ( anova ( fit ))\n# s u m m a r i z e a n o v a g r a p h i c a l l y\nsummary ( fit )\n# est. e f f e c t s ; d e f a u l t r a n g e s\nplot ( summary ( fit )) # g r a p h i c a l d i s p l a y of e f f e c t s with c.i.\n# s p e c i f i c r e f e r e n c e cell and a d j u s t m e n t v a l u e :\nsummary ( fit , treat = \"b \" , age =60)\n# e s t i m a t e e f f e c t of i n c r e a s i n g age : 50 - >70\nsummary ( fit , age = c (50 ,70))\n# i n c r e a s e age 50 - >70 , a d j u s t to 60 when e s t i m a t i n g\n# e f f e c t s of o t h e r f a c t o r s :\nsummary ( fit , age = c (50 ,60 ,70))\n# if had not d e f i n e d datadist , w o u l d have to d e f i n e\n# r a n g e s for all v a r i a b l e s\n\n# e s t i m a t e and test t r e a t m e n t ( b-a ) e f f e c t a v e r a g e d\n# over 3 c h o l e s t e r o l s :\ncontrast ( fit , list ( treat = ' b ' , cholesterol = c (150 ,200 ,250)) ,\nlist ( treat = ' a ' , cholesterol = c (150 ,200 ,250)) ,\n\ntype = ' average ' )\n\np \u2190 predict ( fit , age = seq (20 ,80 , length =100) , treat ,\n\nconf.int = false )\n\nplot ( p )\n# or g g p l o t ( p )\n\nplot (p , \u223c age | treat )\n\n# plot r e l a t i o n s h i p b e t w e e n age and\n# log odds , s e p a r a t e c u r v e for each\n# treat , no c.i.\n\n# same but 2 p a n e l s\n\nggplot (p , groups = false )\nbplot ( predict ( fit , age , cholesterol , np =50))\n\n# 3 - d i m e n s i o n a l p e r s p e c t i v e plot for\n# age , c h o l e s t e r o l , and log odds\n# u s i n g d e f a u l t r a n g e s for both\n\n# plot e s t i m a t e d p r o b a b i l i t i e s i n s t e a d of log odds :\nplot ( predict ( fit , num.diseases ,\n\nfun = function (x ) 1 / (1+ exp ( -x )) ,\nconf.int = .9 ), ylab = \" prob \" )\n\n# again , if no d a t a d i s t were defined , w o u l d have to tell\n# plot all l i m i t s\n\nlogit \u2190 predict ( fit , expand.grid ( treat = \" b \" , num.dis =1:3 ,\n\nage = c (20 ,40 ,60) ,\ncholesterol = seq (100 ,300 , length =10)))\n\n# c o u l d o b t a i n list of p r e d i c t o r s e t t i n g s i n t e r a c t i v e l y\n\nlogit \u2190 predict ( fit , gendata ( fit , nobs =12))\n# an e a s i e r a p p r o a c h is\n# p r e d i c t ( fit , t r e a t = ' b ' , n u m . d i s =1:3 , ... )\n\n# s i n c e age doesn ' t i n t e r a c t with anything , we can q u i c k l y\n# and i n t e r a c t i v e l y try v a r i o u s t r a n s f o r m a t i o n s of age ,\n# t a k i n g the s p l i n e f u n c t i o n of age as the gold s t a n d a r d .\n# we are s e e k i n g a l i n e a r i z i n g t r a n s f o r m a t i o n .\n\n "}, {"Page_number": 164, "text": "140\nag \u2190 10:80\nlogit \u2190 predict ( fit , expand.grid ( treat = \" a \" , num.dis =0 ,\n\n6 r software\n\nage = ag ,\ncholesterol = median ( cholesterol )) ,\ntype = \" terms \" )[ , \" age \" ]\n\n# note : if age i n t e r a c t e d with anything , this w o u l d be the\n# age ` main effect ' i g n o r i n g i n t e r a c t i o n t e r m s\n# c o u l d also use l o g i t \u2190 p r e d i c t ( f , age = ag , ... ) $ yhat ,\n\n# w h i c h a l l o w s e v a l u a t i o n of the s h a p e for any l e v e l of\n# i n t e r a c t i n g f a c t o r s .\nwhen age does not i n t e r a c t with\n# anything , the r e s u l t from p r e d i c t ( f , ... , type =\" t e r m s \")\n# w o u l d e q u a l the r e s u l t from p r e d i c t if all o t h e r t e r m s\n# were i g n o r e d\n\n# c o u l d also s p e c i f y :\n\n# l o g i t \u2190 p r e d i c t ( fit ,\n\n#\n# u n m e n t i o n e d v a r i a b l e s are set to r e f e r e n c e v a l u e s\n\ng e n d a t a ( fit , age = ag , c h o l e s t e r o l = ... ))\n\nplot ( ag\nplot ( ag\n\n\u2227\n\u2227\n\n.5 , logit )\n1 .5 , logit )\n\n# try s q u a r e root vs. s p l i n e t r a n s f o r m .\n# try 1 .5 p o w e r\n\n# p r e t t y p r i n t i n g of t a b l e of e s t i m a t e s and\n# s u m m a r y s t a t i s t i c s :\nprint ( fit , latex = true ) # p r i n t latex code to c o n s o l e\nlatex ( fit )\n# draw a n o m o g r a m for the m o d e l fit\nplot ( nomogram ( fit ))\n\n# i n v o k e s l a t e x . l r m , c r e a t e s f i t . t e x\n\n# c o m p o s e r f u n c t i o n to e v a l u a t e l i n e a r p r e d i c t o r s\n# a n a l y t i c a l l y\n\ng \u2190 function ( fit )\ng ( treat = ' b ' , cholesterol =260 , age =50)\n# l e t t i n g n u m . d i s e a s e s d e f a u l t to r e f e r e n c e v a l u e\n\nto examine interactions in a simpler way, you may want to group age into\ntertiles:\nage.tertile \u2190 cut2 ( age , g =3)\nfit \u2190 lrm ( y \u223c age.tertile * rcs ( cholesterol ))\n\n# for auto r a n g e s later , s p e c i f y a g e . t e r t i l e to d a t a d i s t\n\nexample output from these functions is shown in chapter 10 and later\nchapters.\n\nnote that type=\"terms\" in predict scores each factor in a model with its\nfitted transformation. this may be used to compute, for example, rank cor-\nrelation between the response and each transformed factor, pretending it has\n1 d.f.\n\nwhen regression is done on principal components, one may use an ordi-\nnary linear model to decode \u201cinternal\u201d regression coefficients for helping to\nunderstand the final model. here is an example.\n\n "}, {"Page_number": 165, "text": "6.4 other functions\n\n141\n\nrequire ( rms )\n\ndd \u2190 datadist ( my.data )\noptions ( datadist = ' dd ' )\npcfit \u2190 princomp (\u223c pain.symptom1 + pain.symptom2 + sign1 +\npc2 \u2190 pcfit $ scores [ ,1:2]\nlogistic.fit \u2190 lrm ( death \u223c rcs ( age ,4) + pc2 )\npredicted.log it \u2190 predict ( logistic.fit )\n\nsign2 + sign3 + smoking )\n\n# f i r s t 2 pcs as m a t r i x\n\n\u2190 ols ( predicted.logi t \u223c rcs ( age ,4) +\n\nlinear.mod\n\npain.symptom1 + pain.symptom2 +\nsign1 + sign2 + sign3 + smoking )\n\n# this m o d e l will have r - s q u a r e d =1\n\nnom \u2190 nomogram ( linear.mod , fun = function ( x )1 / (1+ exp ( -x )) ,\n\nfunlabel = \" probability of death \" )\n\n# can use fun = p l o g i s\nplot ( nom )\n# 7 axes s h o w i n g e f f e c t s of all p r e d i c t o r s , plus a r e a d i n g\n# axis c o n v e r t i n g to p r e d i c t e d p r o b a b i l i t y s c a l e\n\nin addition to many of the add-on functions described above, there are\nseveral other r functions that validate models. the first, predab.resample,\nis a general-purpose function that is used by functions for specific models\ndescribed later. predab.resample computes estimates of optimism and bias-\ncorrected estimates of a vector of indexes of predictive accuracy, for a model\nwith a specified design matrix, with or without fast backward step-down of\npredictors. if bw=true, predab.resample prints a matrix of asterisks showing\nwhich factors were selected at each repetition, along with a frequency dis-\ntribution of the number of factors retained across resamples. the function\nhas an optional parameter that may be specified to force the bootstrap al-\ngorithm to do sampling with replacement from clusters rather than from\noriginal records, which is useful when each subject has multiple records in\nthe dataset. it also has a parameter that can be used to validate predictions\nin a subset of the records even though models are refit using all records.\n\nthe generic function validate invokes predab.resample with model-specific\nfits and measures of accuracy. the function calibrate invokes predab.resample\nto estimate bias-corrected model calibration and to plot the calibration curve.\nmodel calibration is estimated at a sequence of predicted values.\n\n6.4 other functions\n\nfor principal component analysis, r has the princomp and prcomp functions.\ncanonical correlations and canonical variates can be easily computed us-\ning the cancor function. there are many other r functions for examining\nassociations and for fitting models. the supsmu function implements fried-\nman\u2019s \u201csuper smoother.\u201d207 the lowess function implements cleveland\u2019s two-\ndimensional smoother.111 the glm function will fit general linear models under\n\n "}, {"Page_number": 166, "text": "142\n\n6 r software\n\na wide variety of distributions of y . there are functions to fit hastie and tib-\nshirani\u2019s275 generalized additive model for a variety of distributions. more is\nsaid about parametric and nonparametric additive multiple regression func-\ntions in chapter 16. the loess function fits a multidimensional scatterplot\nsmoother (the local regression model of cleveland et al.96). loess provides\napproximate test statistics for normal or symmetrically distributed y :\nf \u2190 loess ( y \u223c age * pressure )\nages \u2190 seq (20 ,70 , length =40)\npressures \u2190 seq (80 ,200 , length =40)\npred \u2190 predict (f ,\n\n# c r o s s - s e c t i o n a l p l o t s\n\nplot ( f )\n\npersp ( ages , pressures , pred )\n\n# 3 -d plot\n\nexpand.grid ( age = ages , pressure = pressures ))\n\nloess has a large number of options allowing various restrictions to be placed\non the fitted surface.\n\natkinson and therneau\u2019s rpart recursive partitioning package and related\nfunctions implement classification and regression trees69 algorithms for bi-\nnary, continuous, and right-censored response variables (assuming an expo-\nnential distribution for the latter). rpart deals effectively with missing predic-\ntor values using surrogate splits. the rms package has a validate function for\nrpart objects for obtaining cross-validated mean squared errors and somers\u2019\ndxy rank correlations (brier score and roc areas for probability models).\n\nfor displaying which variables tend to be missing on the same subjects,\nthe hmisc naclus function can be used (e.g., plot(naclus(dataframename)) or\nnaplot(naclus( dataframename))). for characterizing what type of subjects\nhave na\u2019s on a given predictor (or response) variable, a tree model whose\nresponse variable is is.na(varname) can be quite useful.\n\nrequire ( rpart )\n\nf \u2190 rpart ( is.na ( cholesterol ) \u223c age + sex + trig + smoking )\n\nplot ( f )\ntext ( f )\n\n# p l o t s the tree\n# l a b e l s the tree\n\nthe hmisc rcorr.cens function can compute somers\u2019 dxy rank correla-\ntion coefficient and its standard error, for binary or continuous (and possibly\nright-censored) responses. a simple transformation of dxy yields the c index\n(generalized roc area). the hmisc improveprob function is useful for compar-\ning two probability models using the methods of pencina etal490, 492, 493 in an\nexternal validation setting. see also the rcorrp.cens function in this context.\n\n6.5 further reading\n\n1\n\n2\n\nharrell and goldstein263 list components of statistical languages or packages\nand compare several popular packages for survival analysis capabilities.\nimai et al.319 have further generalized r as a statistical modeling language.\n\n "}, {"Page_number": 167, "text": "chapter 7\nmodeling longitudinal responses using\ngeneralized least squares\n\nin this chapter we consider models for a multivariate response variable repre-\nsented by serial measurements over time within subject. this setup induces\ncorrelations between measurements on the same subject that must be taken\ninto account to have optimal model fits and honest inference. full likelihood\nmodel-based approaches have advantages including (1) optimal handling of\nimbalanced data and (2) robustness to missing data (dropouts) that occur\nnot completely at random. the three most popular model-based full like-\nlihood approaches are mixed effects models, generalized least squares, and\nbayesian hierarchical models. for continuous y , generalized least squares\nhas a certain elegance, and a case study will demonstrate its use after sur-\nveying competing approaches. as ols is a special case of generalized least\nsquares, the case study is also helpful in developing and interpreting ols\nmodelsa.\nsome\n\nlongitudinal\n\nanalysis\n\ndata\n\non\n\nreferences\ninclude148, 159, 252, 414, 509, 635, 637.\n\ngood\n\n7.1 notation and data setup\n\nsuppose there are n independent subjects, with subject i (i = 1, 2, . . . , n )\nhaving ni responses measured at times ti1, ti2, . . . , tini . the response at time t\nfor subject i is denoted by yit. suppose that subject i has baseline covariates\nxi. generally the response measured at time ti1 = 0 is a covariate in xi\ninstead of being the first measured response yi0.\n\nfor flexible analysis, longitudinal data are usually arranged in a \u201ctall and\nthin\u201d layout. this allows measurement times to be irregular. in studies com-\n\na a case study in ols\u2014chapter 7 from the first edition\u2014may be found on the text\u2019s\nweb site.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 7\n\n143\n\n "}, {"Page_number": 168, "text": "144\n\n7 modeling longitudinal responses using generalized least squares\n\nparing two or more treatments, a response is often measured at baseline\n(pre-randomization). the analyst has the option to use this measurement as\nyi0 or as part of xi. there are many reasons to put initial measurements of\ny in x, i.e., to use baseline measurements as baseline .\n\n1\n\n7.2 model specification for effects on e(y )\n\nlongitudinal data can be used to estimate overall means or the mean at the\nlast scheduled follow-up, making maximum use of incomplete records. but the\nreal value of longitudinal data comes from modeling the entire time course.\nestimating the time course leads to understanding slopes, shapes, overall\ntrajectories, and periods of treatment effectiveness. with continuous y one\ntypically specifies the time course by a mean time-response profile. common\nrepresentations for such profiles include\n\u2022 k dummy variables for k + 1 unique times (assumes no functional form for\ntime but assumes discrete measurement times and may spend many d.f.)\n\n\u2022 k = 1 for linear time trend, g1(t) = t\n\u2022 k\u2013order polynomial in t\n\u2022 k + 1\u2013knot restricted cubic spline (one linear term, k \u2212 1 nonlinear terms)\nsuppose the time trend is modeled with k parameters so that the time\neffect has k d.f. let the basis functions modeling the time effect be g1(t),\ng2(t), . . . , gk(t) to allow it to be nonlinear. a model for the time profile with-\nout interactions between time and any x is given by\n\ne[yit|xi] = xi\u03b2 + \u03b31g1(t) + \u03b32g2(t) + . . . + \u03b3kgk(t).\n\n(7.1)\n\nto allow the slope or shape of the time-response profile to depend on some\nof the xs we add product terms for desired interaction effects. for example,\nto allow the mean time trend for subjects in group 1 (reference group) to\nbe arbitrarily different from the time trend for subjects in group 2, have a\ndummy variable for group 2, a time \u201cmain effect\u201d curve with k d.f. and all k\nproducts of these time components with the dummy variable for group 2.\n\nonce the right hand side of the model is formulated, predicted values,\ncontrasts, and anovas are obtained just as with a univariate model. for\nthese purposes time is no different than any other covariate except for what\nis described in the next section.\n\n7.3 modeling within-subject dependence\n\nsometimes understanding within-subject correlation patterns is of interest\nin itself. more commonly, accounting for intra-subject correlation is crucial\nfor inferences to be valid. some methods of analysis cover up the correlation\n\n "}, {"Page_number": 169, "text": "7.3 modeling within-subject dependence\n\n145\n\npattern while others assume a restrictive form for the pattern. the following\ntable is an attempt to briefly survey available longitudinal analysis meth-\nods. locf and the summary statistic method are not modeling methods.\nlocf is an ad hoc attempt to account for longitudinal dropouts, and sum-\nmary statistics can convert multivariate responses to univariate ones with few\nassumptions (other than minimal dropouts), with some information loss.\n\n2\n\nwhat methods to use for repeated measurements /\n\nserial data? ab\n\nrepeated gee mixed gls locf summary\nstatisticc\nmeasures\nanova\n\neffects\nmodel\n\n\u00d7\n\n\u00d7\n\n\u00d7\n\n\u00d7\n\n?\n\nassumes normality\nassumes independence of\n\nmeasurements within subject\nassumes a correlation structuref\nrequires same measurement\n\ntimes for all subjects\n\ndoes not allow smooth modeling\n\nof time to save d.f.\n\ndoes not allow adjustment for\n\nbaseline covariates\n\ndoes not easily extend to\n\nnon-continuous y\n\nloses information by not using\n\nintermediate measurements\n\ndoes not allow widely varying #\n\nof observations per subject\n\ndoes not allow for subjects\n\nto have distinct trajectoriesk\nassumes subject-specific effects\n\nare gaussian\n\nbadly biased if non-random\n\ndropouts\n\nbiased in general\nharder to get tests & cls\nrequires large # subjects/clusters\nses are wrong\nassumptions are not verifiable\n\nin small samples\n\ndoes not extend to complex\n\nsettings such as time-dependent\ncovariates and dynamico models\n\n\u00d7\n\u00d7d\n\u00d7\n\u00d7\n\u00d7\n\u00d7\n\u00d7\n\n\u00d7\n\u00d7\n\n?\n\n\u00d7n\n\u00d7\n\u00d7\n\n\u00d7e\n\u00d7g\n\n\u00d7i\n\u00d7\n\n\u00d7\n\n\u00d7\n\n\u00d7l\n\n\u00d7\nn/a \u00d7\n\u00d7\n\n\u00d7\n\n\u00d7\n\n\u00d7\n\u00d7\n\n\u00d7h\n\u00d7\n\u00d7\n\n\u00d7\n\u00d7\n\u00d7m\n\u00d7\n\u00d7\n\u00d7\n\n\u00d7\n\u00d7j\n\n?\n\na thanks to charles berry, brian cade, peter flom, bert gunter, and leena choi\nfor valuable input.\nb gee: generalized estimating equations; gls: generalized least squares; locf: last\nobservation carried forward.\nc e.g., compute within-subject slope, mean, or area under the curve over time. as-\nsumes that the summary measure is an adequate summary of the time profile and\nassesses the relevant treatment effect.\n\n "}, {"Page_number": 170, "text": "146\n\n7 modeling longitudinal responses using generalized least squares\n\nthe most prevalent full modeling approach is mixed effects models in which\nbaseline predictors are fixed effects, and random effects are used to describe\nsubject differences and to induce within-subject correlation. some disadvan-\ntages of mixed effects models are\n\u2022 the induced correlation structure for y may be unrealistic if care is not\n\ntaken in specifying the model.\n\n\u2022 random effects require complex approximations for distributions of test\n\nstatistics.\n\n\u2022 the most commonly used models assume that random effects follow a\n\nnormal distribution. this assumption may not hold.\n\nit could be argued that an extended linear model (with no random effects)\nis a logical extension of the univariate ols model b. this model, called the\ngeneralized least squares or growth curve model221, 509, 510, was developed long\nbefore mixed effect models became popular.\nwe will assume that yit|xi has a multivariate normal distribution with\nmean given above and with variance-covariance matrix vi, an ni \u00d7 ni matrix\nthat is a function of ti1, . . . , tini . we further assume that the diagonals of vi\nare all equalb. this extended linear model has the following assumptions:\n\u2022 all the assumptions of ols at a single time point including correct mod-\neling of predictor effects and univariate normality of responses conditional\non x\n\nd unless one uses the huynh-feldt or greenhouse-geisser correction\ne for full efficiency, if using the working independence model\nf or requires the user to specify one\ng for full efficiency of regression coefficient estimates\nh unless the last observation is missing\ni the cluster sandwich variance estimator used to estimate ses in gee does not\nperform well in this situation, and neither does the working independence model\nbecause it does not weight subjects properly.\nj unless one knows how to properly do a weighted analysis\nk or uses population averages\nl unlike gls, does not use standard maximum likelihood methods yielding simple\nlikelihood ratio \u03c72 statistics. requires high-dimensional integration to marginalize\nrandom effects, using complex approximations, and if using sas, unintuitive d.f. for\nthe various tests.\nm because there is no correct formula for se of effects; ordinary ses are not penalized\nfor imputation and are too small\nn if correction not applied\no e.g., a model with a predictor that is a lagged value of the response variable\nb e.g., few statisticians use subject random effects for univariate y . pinheiro and\nbates [509, section 5.1.2] state that \u201cin some applications, one may wish to avoid\nincorporating random effects in the model to account for dependence among obser-\nvations, choosing to use the within-group component \u03bbi to directly model variance-\ncovariance structure of the response.\u201d\nb this procedure can be generalized to allow for heteroscedasticity over time or with\nrespect to x, e.g., males may be allowed to have a different variance than females.\n\n "}, {"Page_number": 171, "text": "7.5 common correlation structures\n\n147\n\n\u2022 the distribution of two responses at two different times for the same sub-\nject, conditional on x, is bivariate normal with a specified correlation\ncoefficient\n\n\u2022 the joint distribution of all ni responses for the ith subject is multivariate\nnormal with the given correlation pattern (which implies the previous two\ndistributional assumptions)\n\n\u2022 responses from two different subjects are uncorrelated.\n\n7.4 parameter estimation procedure\n\ngeneralized least squares is like weighted least squares but uses a covariance\nmatrix that is not diagonal. each subject can have her own shape of vi due\nto each subject being measured at a different set of times. this is a maximum\nlikelihood procedure. newton-raphson or other trial-and-error methods are\nused for estimating parameters. for a small number of subjects, there are ad-\nvantages in using reml (restricted maximum likelihood) instead of ordinary\nmle [159, section 5.3] [509, chapter 5]221 (especially to get a more unbiased\nestimate of the covariance matrix).\n\nwhen imbalances of measurement times are not severe, ols fitted ignoring\nsubject identifiers may be efficient for estimating \u03b2. but ols standard errors\nwill be too small as they don\u2019t take intra-cluster correlation into account.\nthis may be rectified by substituting a covariance matrix estimated using\nthe huber-white cluster sandwich estimator or from the cluster bootstrap.\nwhen imbalances are severe and intra-subject correlations are strong, ols\n(or gee using a working independence model) is not expected to be efficient\nbecause it gives equal weight to each observation; a subject contributing two\ndistant observations receives 1\n5 the weight of a subject having 10 tightly-\nspaced observations.\n\n7.5 common correlation structures\n\nwe usually restrict ourselves to isotropic correlation structures which assume\nthe correlation between responses within subject at two times depends only on\na measure of the distance between the two times, not the individual times.\n\nwe simplify further and assume it depends on |t1 \u2212 t2|c. assume that the\ncorrelation coefficient for yit1 vs. yit2 conditional on baseline covariates xi\nfor subject i is h(|t1 \u2212 t2|, \u03c1), where \u03c1 is a vector (usually a scalar) set of\n\nfundamental correlation parameters. some commonly used structures when\n\nc we can speak interchangeably of correlations of residuals within subjects or correla-\ntions between responses measured at different times on the same subject, conditional\non covariates x.\n\n "}, {"Page_number": 172, "text": "148\n\n7 modeling longitudinal responses using generalized least squares\n\ntimes are continuous and are not equally spaced [509, section 5.3.3] are shown\nbelow, along with the correlation function names from the r nlme package.\ncompound symmetry:\n\nnlme corcompsymm\n\nh = \u03c1 if t1 (cid:5)= t2, 1 if t1 = t2\n|t1\u2212t2|\n\n= \u03c1s\n\nautoregressive-moving average lag 1:\n\n(essentially what two-way anova assumes)\nwhere s = |t1 \u2212 t2|\n\nh = \u03c1\n\nh = exp(\u2212s/\u03c1)\nh = exp[\u2212(s/\u03c1)2]\nh = (1 \u2212 s/\u03c1)[s < \u03c1]\n\nexponential:\ngaussian:\nlinear:\nrational quadratic:\nspherical:\n\nh = 1 \u2212 (s/\u03c1)2/[1 + (s/\u03c1)2]\nh = [1 \u2212 1.5(s/\u03c1) + 0.5(s/\u03c1)3][s < \u03c1]\n\nlinear exponent ar(1):\n\nh = \u03c1\n\ndmin+\u03b4 s\u2212dmin\n\ndmax\u2212dmin , 1 if t1 = t2\n\ncorcar1\n\ncorexp\ncorgaus\ncorlin\ncorratio\ncorspher\n\n572\n\nthe structures 3\u20137 use \u03c1 as a scaling parameter, not as something re-\n\nstricted to be in [0, 1]\n\n7.6 checking model fit\n\nthe constant variance assumption may be checked using typical residual\nplots. the univariate normality assumption (but not multivariate normal-\nity) may be checked using typical q-q plots on residuals. for checking the\ncorrelation pattern, a variogram is a very helpful device based on estimating\ncorrelations of all possible pairs of residuals at different time pointsd. pairs\nof estimates obtained at the same absolute time difference s are pooled. the\nvariogram is a plot with y = 1\u2212 \u02c6h(s, \u03c1) vs. s on the x-axis, and the theoretical\nvariogram of the correlation model currently being assumed is superimposed.\n\n7.7 sample size considerations\n\nsection 4.4 provided some guidance about sample sizes needed for ols.\na good way to think about sample size adequacy for generalized least squares\nis to determine the effective number of independent observations that a given\nconfiguration of repeated measurements has. for example, if the standard er-\nror of an estimate from three measurements on each of 20 subjects is the same\nas the standard error from 27 subjects measured once, we say that the 20\u00d73\nstudy has an effective sample size of 27, and we equate power from the uni-\nvariate analysis on n subjects measured once to 20n\n27 subjects measured three\ntimes. faes et al.181 have a nice approach to effective sample sizes with a\nvariety of correlation patterns in longitudinal data. for an ar(1) correlation\nstructure with n equally spaced measurement times on each of n subjects,\n\nd variograms can be unstable.\n\n "}, {"Page_number": 173, "text": "7.9 case study\n\n149\n\nwith the correlation between two consecutive times being \u03c1, the effective\n1+\u03c1 n . under compound symmetry, the effective size is\nsample size is\n1+\u03c1(n\u22121) .\n\nn\u2212(n\u22122)\u03c1\n\nnn\n\n7.8 r software\n\nthe nonlinear mixed effects model package nlme of pinheiro & bates in\nrprovides many useful functions. for fitting linear models, fitting functions\nare lme for mixed effects models and gls for generalized least squares without\nrandom effects. the rms package has a front-end function gls so that many\nfeatures of rms can be used:\n\neffect estimates (differences in \u02c6y ) and confidence limits\n\nall partial wald tests, test of linearity, pooled tests\n\nanova:\nsummary:\npredict and plot:\nnomogram:\nfunction:\nlatex: latex representation of the fitted model.\n\nnomogram\ngenerate r function code for the fitted model\n\npartial effect plots\n\nin addition, gls has a cluster bootstrap option (hence you do not use rms\u2019s\nbootcov for gls fits). when b is provided to gls( ), bootstrapped regression\ncoefficients and correlation estimates are saved, the former setting up for\nbootstrap percentile confidence limitse the nlme package has many graphics\nand fit-checking functions. several functions will be demonstrated in the case\nstudy.\n\n7.9 case study\n\nconsider the dataset in table 6.9 of davis [148, pp. 161\u2013163] from a multi-\ncenter, randomized controlled trial of botulinum toxin type b (botb) in pa-\ntients with cervical dystonia from nine u.s. sites. patients were randomized\nto placebo (n = 36), 5000 units of botb (n = 36), or 10,000 units of botb\n(n = 37). the response variable is the total score on the toronto western\nspasmodic torticollis rating scale (twstrs), measuring severity, pain, and\ndisability of cervical dystonia (high scores mean more impairment). twstrs\nis measured at baseline (week 0) and weeks 2, 4, 8, 12, 16 after treatment\nbegan. the dataset name on the dataset wiki page is cdystonia.\n\ne to access regular gls functions named anova (for likelihood ratio tests, aic, etc.)\nor summary use anova.gls or summary.gls.\n\n "}, {"Page_number": 174, "text": "150\n\n7 modeling longitudinal responses using generalized least squares\n\n7.9.1 graphical exploration of data\n\ngraphics which follow display raw data as well as quartiles of twstrs by\ntime, site, and treatment. a table shows the realized measurement schedule.\n\nrequire ( rms )\n\ngethdata ( cdystonia )\nattach ( cdystonia )\n\n# c o n s t r u c t u n i q u e s u b j e c t id\n\nuid \u2190 with ( cdystonia , factor ( paste ( site , id )))\n# t a b u l a t e p a t t e r n s of subjects ' time p o i n t s\ntable ( tapply ( week , uid ,\n\nfunction ( w) paste ( sort ( unique ( w )) , collapse = '\n\n' )))\n\n0\n1\n0 2 4 8 12 16\n94\n\n0 2 4\n1\n0 2 4 8 16\n1\n\n0 2 4 12 16\n3\n0 2 8 12 16\n2\n\n0 2 4 8\n1\n0 4 8 12 16\n4\n\n0 2 4 8 12\n1\n0 4 8 16\n1\n\n# plot raw data , s u p e r p o s i n g s u b j e c t s\n\nxl \u2190 xlab ( ' week ' ); yl \u2190 ylab ( ' twstrs-total score ' )\n\nggplot ( cdystonia , aes ( x = week , y = twstrs , color = factor ( id ))) +\n\ngeom_line () + xl + yl + facet_grid ( treat \u223c site ) +\n\nguides ( color = false ) # fig. 7.1\n\n# show q u a r t i l e s\nggplot ( cdystonia , aes ( x = week , y = twstrs )) + xl + yl +\n\nylim (0 , 70) + stat_summary ( fun.data = \" median_hilow \" ,\n\nfacet_wrap (\u223c treat , nrow =2)\n\n# fig. 7.2\n\nconf.int =0 .5 , geom = ' smooth ' ) +\n\nnext the data are rearranged so that yi0 is a baseline covariate.\n\nbaseline \u2190 subset ( data.frame ( cdystonia , uid ), week == 0,\nbaseline \u2190 updata ( baseline , rename = c ( twstrs = ' twstrs0 ' ),\nfollowup \u2190 subset ( data.frame ( cdystonia , uid ), week > 0,\n\nprint = false )\n\n-week )\n\nc ( uid , week , twstrs ))\n\nrm ( uid )\nboth\n\n\u2190 merge ( baseline , followup , by = ' uid ' )\n\u2190 datadist ( both )\n\ndd\noptions ( datadist = ' dd ' )\n\n "}, {"Page_number": 175, "text": "7.9 case study\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\ne\nr\no\nc\ns\n \nl\n\nt\n\nt\n\na\no\n\u2212\ns\nr\nt\ns\nw\nt\n\n60\n\n40\n\n20\n\n60\n\n40\n\n20\n\n60\n\n40\n\n20\n\n151\n\n1\n0\n0\n0\n0\nu\n\n5\n0\n0\n0\nu\n\nl\n\np\na\nc\ne\nb\no\n\n0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15 0 5 10 15\n\nweek\n\nfig. 7.1 time profiles for individual subjects, stratified by study site and dose\n\n7.9.2 using generalized least squares\n\nwe stay with baseline adjustment and use a variety of correlation structures,\nwith constant variance. time is modeled as a restricted cubic spline with\n3 knots, because there are only 3 unique interior values of week. below, six\ncorrelation patterns are attempted. in general it is better to use scientific\nknowledge to guide the choice of the correlation structure.\n\nrequire ( nlme )\ncp \u2190 list ( corcar1 , corexp , corcompsymm , corlin , corgaus , corspher )\nz \u2190 vector ( ' list ' , length ( cp ))\n\nfor ( k in 1: length ( cp )) {\n\nz [[ k ]] \u2190 gls ( twstrs \u223c treat * rcs ( week , 3) +\n\nrcs ( twstrs0 , 3) + rcs ( age , 4) * sex , data = both ,\n\ncorrelatio n = cp [[ k ]]( form = \u223cweek | uid ))\n\n}\n\nanova ( z [[1]] , z [[2]] , z [[3]] , z [[4]] , z [[5]] , z [[6]])\n\nz [[1]]\nz [[2]]\nz [[3]]\nz [[4]]\nz [[5]]\nz [[6]]\n\nmodel df\n\nbic\n\naic\n\nloglik\n1 20 3553.906 3638.357 -1756.953\n2 20 3553.906 3638.357 -1756.953\n3 20 3587.974 3672.426 -1773.987\n4 20 3575.079 3659.531 -1767.540\n5 20 3621.081 3705.532 -1790.540\n6 20 3570.958 3655.409 -1765.479\n\n "}, {"Page_number": 176, "text": "152\n\n7 modeling longitudinal responses using generalized least squares\n\n10000u\n\n5000u\n\ne\nr\no\nc\ns\n \nl\n\na\n\nt\n\nt\n\no\n\u2212\ns\nr\nt\ns\nw\nt\n\n60\n\n40\n\n20\n\n0\n\n60\n\n40\n\n20\n\n0\n\nplacebo\n\n0\n\n5\n\n10\n\n15\n\nweek\n\nfig. 7.2 quartiles of twstrs stratified by dose\n\n3\n\naic computed above is set up so that smaller values are best. from this\nthe continuous-time ar1 and exponential structures are tied for the best.\nfor the remainder of the analysis we use corcar1, using gls.\na \u2190 gls ( twstrs \u223c treat * rcs ( week , 3) + rcs ( twstrs0 , 3) +\n\nrcs ( age , 4) * sex , data = both ,\n\ncorrelation = corcar1 ( form =\u223cweek | uid ))\n\nprint (a , latex = true )\n\ngeneralized least squares fit by reml\n\ngls(model = twstrs ~ treat * rcs(week, 3) + rcs(twstrs0, 3) +\n\nrcs(age, 4) * sex, data = both, correlation = corcar1\n(form = ~week | uid))\n\nobs\nclusters 108 model d.f.\ng\n\n522 log-restricted-likelihood -1756.95\n17\n8.5917\n504\n\n11.334 \u03c3\n\nd.f.\n\n "}, {"Page_number": 177, "text": "7.9 case study\n\n153\n\nintercept\ntreat=5000u\ntreat=placebo\nweek\nweek\u2019\ntwstrs0\ntwstrs0\u2019\nage\nage\u2019\nage\u201d\nsex=m\ntreat=5000u * week\ntreat=placebo * week\ntreat=5000u * week\u2019\ntreat=placebo * week\u2019\nage * sex=m\nage\u2019 * sex=m\nage\u201d * sex=m\n\ns.e.\n\nt pr(> |t|)\ncoef\n0.9792\n-0.3093 11.8804 -0.03\n0.8672\n2.5962 0.17\n0.4344\n0.0065\n2.6133 2.73\n7.1433\n0.3334\n0.2879\n0.2973 0.97\n0.3078 2.38\n0.7313\n0.0179\n0.1449 5.57 < 0.0001\n0.8071\n0.2360\n0.1795 1.19\n0.2129\n-0.1178\n0.2346 -0.50\n0.6158\n0.2830\n0.6484 1.07\n0.6968\n0.1845\n-3.4018\n2.5599 -1.33\n0.1929\n24.2802 18.6208 1.30\n0.4221 0.18\n0.8599\n0.7674\n0.4243 -0.30\n0.3149\n0.4363 -1.01\n0.1411\n0.4381 -1.47\n0.1892\n0.4447 -1.31\n1.2388 1.18\n0.2375\n0.4023\n4.8123 -0.84\n\n0.0745\n-0.1256\n-0.4389\n-0.6459\n-0.5846\n1.4652\n-4.0338\n\ncorrelation structure: continuous ar(1)\n\nformula: ~week | uid\nparameter estimate(s):\n\nphi\n0.8666689\n\n\u02c6\u03c1 = 0.867, the estimate of the correlation between two measurements\ntaken one week apart on the same subject. the estimated correlation for\nmeasurements 10 weeks apart is 0.86710 = 0.24.\nv \u2190 variogram (a , form =\u223c week | uid )\n\nplot ( v )\n\n# f i g u r e 7.3\n\nthe empirical variogram is largely in agreement with the pattern dictated by\nar(1).\n\nnext check constant variance and normality assumptions.\nboth $ resid \u2190 r \u2190 resid ( a ); both $ fitted \u2190 fitted ( a )\nyl \u2190 ylab ( ' residuals ' )\np1 \u2190 ggplot ( both , aes ( x = fitted , y = resid )) + geom_point () +\np2 \u2190 ggplot ( both , aes ( x = twstrs0 , y = resid )) + geom_point ()+ yl\np3 \u2190 ggplot ( both , aes ( x = week , y = resid )) + yl + ylim ( -20 ,20) +\np4 \u2190 ggplot ( both , aes ( sample = resid )) + stat_qq () +\n\ns t a t _ s u m m a r y ( fun.data = \" mean_sdl \" , geom = ' smooth ' )\n\nfacet_grid (\u223c treat ) + yl\n\ngeom_ablin e ( intercept = mean ( r ) , slope = sd ( r )) + yl\n\ngridextra :: g r i d . a r r a n g e ( p1 , p2 , p3 , p4 , ncol =2)\n\n# figure 7.4\n\n "}, {"Page_number": 178, "text": "154\n\n7 modeling longitudinal responses using generalized least squares\n\n0.6\n\n0.4\n\n0.2\n\nm\na\nr\ng\no\ni\nr\na\nv\nm\ne\ns\n\ni\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\ndistance\n\nfig. 7.3 variogram, with assumed correlation pattern superimposed\n\nthese model assumptions appear to be well satisfied, so inferences are likely\nto be trustworthy if the more subtle multivariate assumptions hold.\n\nnow get hypothesis tests, estimates, and graphically interpret the model.\n\nplot ( anova ( a ))\n\n# f i g u r e 7.5\n\nylm \u2190 ylim (25 , 60)\np1 \u2190 ggplot ( predict (a , week , treat , conf.int = false ),\np2 \u2190 ggplot ( predict (a , twstrs0 ), adj.subtitle = false ) + ylm\np3 \u2190 ggplot ( predict (a , age , sex ), adj.subtitle = false ,\n\nadj.subtitle = false , legend.positi on = ' top ' ) + ylm\n\nlegend.positio n = ' top ' ) + ylm\n\ngridextra :: grid.arrange ( p1 , p2 , p3 , ncol =2)\n\n# f i g u r e 7.6\n\nlatex ( summary (a ) , file = ' ' , table.env = false ) # shows for week 8\n\nweek\ntwstrs0\nage\ntreat \u2014 5000u:10000u\ntreat \u2014 placebo:10000u\nsex \u2014 m:f\n\n4\n39\n46\n1\n1\n1\n\nlow high \u03b4 effect\n\n12 8 6.69100 1.10570\n53 14 13.55100 0.88618\n65 19 2.50270 2.05140\n0.59167 1.99830\n5.49300 2.00430\n-1.08500 1.77860\n\ns.e. lower 0.95 upper 0.95\n8.8582\n15.2880\n6.5234\n4.5083\n9.4212\n2.4011\n\n4.5238\n11.8140\n-1.5179\n-3.3249\n1.5647\n-4.5711\n\n2\n3\n2\n\n# to get r e s u l t s for week 8 for a d i f f e r e n t r e f e r e n c e g r o u p\n# for t r e a t m e n t , use e.g. s u m m a r y ( a , week =4 , t r e a t = ' placebo ' )\n\n# c o m p a r e low dose with placebo , s e p a r a t e l y at each time\n\n "}, {"Page_number": 179, "text": "7.9 case study\n\n155\n\n10000u\n\n5000u\n\nplacebo\n\n20 30 40 50 60 7020 30 40 50 60 7020 30 40 50 60 70\n\nfitted\n\n20\n\n0\n\n\u221220\n\n\u221240\n\n20\n\n10\n\n0\n\n\u221210\n\n\u221220\n\nl\n\ns\na\nu\nd\ns\ne\nr\n\ni\n\nl\n\ns\na\nu\nd\ns\ne\nr\n\ni\n\n20\n\n0\n\n\u221220\n\n\u221240\n\n20\n\n0\n\n\u221220\n\n\u221240\n\n30\n\n40\n\n50\n\n60\n\ntwstrs0\n\nl\n\ns\na\nu\nd\ns\ne\nr\n\ni\n\nl\n\ns\na\nu\nd\ns\ne\nr\n\ni\n\n4\n\n8\n\nweek\n\n12\n\n16\n\n\u22122\n\n0\n\n2\n\ntheoretical\n\nfig. 7.4 three residual plots to check for absence of trends in central tendency\nand in variability. upper right panel shows the baseline score on the x-axis. bottom\nleft panel shows the mean \u00b12\u00d7sd. bottom right panel is the qq plot for checking\nnormality of residuals from the gls fit.\n\nsex\nage * sex\nage\ntreat * week\ntreat\nweek\ntwstrs0\n\n0\n\n50\n\n150\n\n200\n\n100\n\u03c72\u2212 df\n\nfig. 7.5 results of anova from generalized least squares fit with continuous time\nar1 correlation structure. as expected, the baseline version of y dominates.\n\n "}, {"Page_number": 180, "text": "156\n\n7 modeling longitudinal responses using generalized least squares\n\n\u03b2^\nx\n\n70\n\n60\n\n50\n\n40\n\n30\n\n20\n\n10\n\n30\n\n40\n\n50\n\n60\n\ntwstrs\u2212total score\n\ntreatment\n\n10000u\n\n5000u\n\nplacebo\n\n\u03b2^\nx\n\n\u03b2^\nx\n\n48\n\n44\n\n40\n\n36\n\n50\n45\n40\n35\n30\n25\n\n4\n\n8\nweek\n\n12\n\n16\n\nsex\n\nf\n\nm\n\n40\n\n50\n\n60\nage,years\n\n70\n\n80\n\nfig. 7.6 estimated effects of time, baseline twstrs, age, and sex\n\nk1 \u2190 contrast (a , list ( week = c (2 ,4 ,8 ,12 ,16) , treat = ' 5000 u ' ),\n\nlist ( week = c (2 ,4 ,8 ,12 ,16) , treat = ' placebo ' ))\n\noptions ( width =80)\nprint ( k1 , digits =3)\n\nweek twstrs0 age sex contrast s . e .\n\nlower\n\nupper\n\n1\n2\n3\n4*\n5*\n\n2\n4\n8\n12\n16\n\n46\n46\n46\n46\n46\n\n56\n56\n56\n56\n56\n\nf\nf\nf\nf\nf\n\n-6.31 2.10 -10.43 -2.186 -3.00\n-9.47 -2.349 -3.25\n-5.91 1.82\n-8.85 -0.953 -2.43\n-4.90 2.01\n0.361 -1.75\n-6.49\n-3.07 1.75\n-1.02 2.10\n-5.14\n3.092 -0.49\n\nz pr ( >| z |)\n0.0027\n0.0011\n0.0150\n0.0795\n0.6260\n\nr e d u n d a n t c o n t r a s t s are denoted by *\n\nc o n f i d e n c e i n t e r v a l s are 0.95 i n d i v i d u a l i n t e r v a l s\n\n# c o m p a r e high dose with p l a c e b o\n\nk2 \u2190 contrast (a , list ( week = c (2 ,4 ,8 ,12 ,16) , treat = ' 10000 u ' ),\nlist ( week = c (2 ,4 ,8 ,12 ,16) , treat = ' placebo ' ))\n\nprint ( k2 , digits =3)\n\nweek twstrs0 age sex contrast s . e .\n\nlower upper\n\n1\n2\n3\n4*\n5*\n\n2\n4\n8\n12\n16\n\n46\n46\n46\n46\n46\n\n56\n56\n56\n56\n56\n\nf\nf\nf\nf\nf\n\n-6.89 2.07 -10.96 -2.83 -3.32\n-6.64 1.79 -10.15 -3.13 -3.70\n-9.42 -1.56 -2.74\n-5.49 2.00\n1.65 -1.01\n-5.17\n-1.76 1.74\n2.62 2.09\n-1.47\n6.71\n1.25\n\nz pr ( >| z |)\n0.0009\n0.0002\n0.0061\n0.3109\n0.2099\n\nr e d u n d a n t c o n t r a s t s are denoted by *\n\nc o n f i d e n c e i n t e r v a l s are 0.95 i n d i v i d u a l i n t e r v a l s\n\n "}, {"Page_number": 181, "text": "7.9 case study\n\n157\n\nk1 \u2190 as.data.frame ( k1 [ c ( ' week ' , ' contrast ' , ' lower ' ,\np1 \u2190 ggplot ( k1 , aes ( x = week , y = contrast )) + geom_point () +\n\n' upper ' )])\n\ngeom_line () + ylab ( ' low dose - placebo ' ) +\ngeom_errorbar ( aes ( ymin = lower , ymax = upper ), width =0)\n\nk2 \u2190 as.data.frame ( k2 [ c ( ' week ' , ' contrast ' , ' lower ' ,\np2 \u2190 ggplot ( k2 , aes ( x = week , y = contrast )) + geom_point () +\n\n' upper ' )])\n\ngeom_line () + ylab ( ' high dose - placebo ' ) +\ngeom_errorbar ( aes ( ymin = lower , ymax = upper ), width =0)\n\ngridextra :: grid.arrange ( p1 , p2 , ncol =2)\n\n# f i g u r e 7.7\n\nl\n\n \n\no\nb\ne\nc\na\np\n\u2212\ne\ns\no\nd\nw\no\nl\n\n \n\n \n\n0\n\n\u22124\n\n\u22128\n\nl\n\n \n\n \n\no\nb\ne\nc\na\np\n\u2212\ne\ns\no\nd\nh\ng\nh\n\n \n\ni\n\n4\n\n0\n\n\u22124\n\n\u22128\n\n4\n\n8\nweek\n\n12\n\n16\n\n4\n\n8\nweek\n\n12\n\n16\n\nfig. 7.7 contrasts and 0.95 confidence limits from gls fit\n\nalthough multiple d.f. tests such as total treatment effects or treatment\n\u00d7 time interaction tests are comprehensive, their increased degrees of free-\ndom can dilute power. in a treatment comparison, treatment contrasts at\nthe last time point (single d.f. tests) are often of major interest. such con-\ntrasts are informed by all the measurements made by all subjects (up until\ndropout times) when a smooth time trend is assumed. they use appropriate\nextrapolation past dropout times based on observed trajectories of subjects\nfollowed the entire observation period. in agreement with the top left panel\nof figure 7.6, figure 7.7 shows that the treatment, despite causing an early\nimprovement, wears off by 16 weeks at which time no benefit is seen.\n\na nomogram can be used to obtain predicted values, as well as to better\n\nunderstand the model, just as with a univariate y .\nn \u2190 nomogram (a , age = c ( seq (20 , 80 , by =10) , 85))\n\nplot (n , cex.axis = .55 , cex.var = .8 , lmgp = .25 )\n\n# f i g u r e 7.8\n\n "}, {"Page_number": 182, "text": "158\n\npoints\n\n7 modeling longitudinal responses using generalized least squares\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\ntwstrs\u2212total score\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\n50\n\n55\n\n60\n\n65\n\n70\n\n50\n\n60\n\n85\n\n40\n\n70\n\n20\n\n60\n\n70\n\n50\n\n40\n\n85\n\n30\n\n20\n\n5000u\n\n10000u\n\n5000u\n\nplacebo\n\n10000u\n\n5000u\n\nplacebo\n\n10000u\n\nplacebo\n\n10000u\n\n5000u\n\nplacebo\n\n5000u\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n110\n\n120\n\n130\n\n140\n\nage (sex=f)\n\nage (sex=m)\n\ntreat (week=2)\n\ntreat (week=4)\n\ntreat (week=8)\n\ntreat (week=12)\n\ntreat (week=16)\n\ntotal points\n\nlinear predictor\n\nfig. 7.8 nomogram from gls fit. second axis is the baseline score.\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\n50\n\n55\n\n60\n\n65\n\n70\n\n7.10 further reading\n\n1\n\njim rochon (rho, inc., chapel hill nc) has the following comments about\nusing the baseline measurement of y as the first longitudinal response.\n\nfor rcts [randomized clinical trials], i draw a sharp line at the point\nwhen the intervention begins. the lhs [left hand side of the model equa-\ntion] is reserved for something that is a response to treatment. anything\nbefore this point can potentially be included as a covariate in the regres-\nsion model. this includes the \u201cbaseline\u201d value of the outcome variable.\nindeed, the best predictor of the outcome at the end of the study is typ-\nically where the patient began at the beginning. it drinks up a lot of\nvariability in the outcome; and, the effect of other covariates is typically\nmediated through this variable.\n\ni treat anything after the intervention begins as an outcome. in the west-\nern scientific method, an \u201ceffect\u201d must follow the \u201ccause\u201d even if by a split\nsecond.\n\nnote that an rct is different than a cohort study. in a cohort study,\n\u201ctime 0\u201d is not terribly meaningful. if we want to model, say, the trend\nover time, it would be legitimate, in my view, to include the \u201cbaseline\u201d\nvalue on the lhs of that regression model.\n\n "}, {"Page_number": 183, "text": "7.10 further reading\n\n159\n\nnow, even if the intervention, e.g., surgery, has an immediate effect, i\nwould include still reserve the lhs for anything that might legitimately\nbe considered as the response to the intervention. so, if we cleared a\nblocked artery and then measured the mabp, then that would still be\nincluded on the lhs.\n\nnow, it could well be that most of the therapeutic effect occurred by\nthe time that the first repeated measure was taken, and then levels off.\nthen, a plot of the means would essentially be two parallel lines and the\ntreatment effect is the distance between the lines, i.e., the difference in\nthe intercepts.\n\nif the linear trend from baseline to time 1 continues beyond time 1, then\nthe lines will have a common intercept but the slopes will diverge. then,\nthe treatment effect will the difference in slopes.\n\none point to remember is that the estimated intercept is the value at time\n0 that we predict from the set of repeated measures post randomization.\nin the first case above, the model will predict different intercepts even\nthough randomization would suggest that they would start from the same\nplace. this is because we were asleep at the switch and didn\u2019t record the\n\u201caction\u201d from baseline to time 1. in the second case, the model will predict\nthe same intercept values because the linear trend from baseline to time\n1 was continued thereafter.\n\nmore importantly, there are considerable benefits to including it as a co-\nvariate on the rhs. the baseline value tends to be the best predictor of\nthe outcome post-randomization, and this maneuver increases the preci-\nsion of the estimated treatment effect. additionally, any other prognostic\nfactors correlated with the outcome variable will also be correlated with\nthe baseline value of that outcome, and this has two important conse-\nquences. first, this greatly reduces the need to enter a large number of\nprognostic factors as covariates in the linear models. their effect is already\nmediated through the baseline value of the outcome variable. secondly,\nany imbalances across the treatment arms in important prognostic factors\nwill induce an imbalance across the treatment arms in the baseline value\nof the outcome. including the baseline value thereby reduces the need to\nenter these variables as covariates in the linear models.\n\nstephen senn563 states that temporally and logically, a \u201cbaseline cannot be\na response to treatment\u201d, so baseline and response cannot be modeled in an\nintegrated framework.\n\n. . . one should focus clearly on \u2018outcomes\u2019 as being the only values that\ncan be influenced by treatment and examine critically any schemes that\nassume that these are linked in some rigid and deterministic view to\n\u2018baseline\u2019 values. an alternative tradition sees a baseline as being merely\none of a number of measurements capable of improving predictions of\noutcomes and models it in this way.\n\nthe final reason that baseline cannot be modeled as the response at time zero is\nthat many studies have inclusion/exclusion criteria that include cutoffs on the\nbaseline variable yielding a truncated distribution. in general it is not appropri-\nate to model the baseline with the same distributional shape as the follow-up\n\n "}, {"Page_number": 184, "text": "160\n\n7 modeling longitudinal responses using generalized least squares\n\n2\n\n3\n\nmeasurements. thus the approach recommended by liang and zeger405 and\nliu et al.423 are problematicf.\ngardiner et al.211 compared several longitudinal data models, especially with re-\ngard to assumptions and how regression coefficients are estimated. peters et al.500\nhave an empirical study confirming that the \u201cuse all available data\u201d approach of\nlikelihood\u2013based longitudinal models makes imputation of follow-up measure-\nments unnecessary.\nkeselman et al.347 did a simulation study to study the reliability of aic for\nselecting the correct covariance structure in repeated measurement models. in\nchoosing from among 11 structures, aic selected the correct structure 47% of\nthe time. gurka et al.247 demonstrated that fixed effects in a mixed effects\nmodel can be biased, independent of sample size, when the specified covariate\nmatrix is more restricted than the true one.\n\nf in addition to this, one of the paper\u2019s conclusions that analysis of covariance is not\nappropriate if the population means of the baseline variable are not identical in the\ntreatment groups is arguable563. see346 for a discussion of423.\n\n "}, {"Page_number": 185, "text": "chapter 8\ncase study in data reduction\n\nrecall that the aim of data reduction is to reduce (without using the outcome)\nthe number of parameters needed in the outcome model. the following case\nstudy illustrates these techniques:\n\n1. redundancy analysis;\n2. variable clustering;\n3. data reduction using principal component analysis (pca), sparse pca,\n\nand pretransformations;\n\n4. restricted cubic spline fitting using ordinary least squares, in the context\n\nof scaling; and\n\n5. scaling/variable transformations using canonical variates and nonparamet-\n\nric additive regression.\n\n8.1 data\n\nconsider the 506-patient prostate cancer dataset from byar and green.87 the\ndata are listed in [28, table 46] and are available in ascii form from statlib\n(lib.stat.cmu.edu) in the datasets area from this book\u2019s web page. these\ndata were from a randomized trial comparing four treatments for stage 3\nand 4 prostate cancer, with almost equal numbers of patients on placebo and\neach of three doses of estrogen. four patients had missing values on all of the\nfollowing variables: wt, pf, hx, sbp, dbp, ekg, hg, bm; two of these patients\nwere also missing sz. these patients are excluded from consideration. the\nultimate goal of an analysis of the dataset might be to discover patterns in\nsurvival or to do an analysis of covariance to assess the effect of treatment\nwhile adjusting for patient heterogeneity. see chapter 21 for such analyses.\nthe data reductions developed here are general and can be used for a variety\nof dependent variables.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 8\n\n161\n\n "}, {"Page_number": 186, "text": "162\n\n8 case study in data reduction\n\nthe variable names, labels, and a summary of the data are printed below.\n\nrequire ( hmisc )\n\n# d o w n l o a d and make p r o s t a t e a c c e s s i b l e\n\ngethdata ( prostate )\n# c o n v e r t an old date f o r m a t to r f o r m a t\n\nprostate $ sdate \u2190 as.date ( prostate $ sdate )\nd \u2190 describe ( prostate [2:17])\nlatex (d , file = ' ' )\n\nprostate[2:17]\n\n16 variables\n\n502 observations\n\nstage : stage\n\nn missing unique info mean\n2 0.73 3.424\n\n0\n\n502\n\n3 (289, 58%), 4 (213, 42%)\n\nrx\n\nn missing unique\n4\n\n0\n\n502\n\nplacebo (127, 25%), 0.2 mg estrogen (124, 25%)\n1.0 mg estrogen (126, 25%), 5.0 mg estrogen (125, 25%)\n\ndtime : months of follow-up\n\nn missing unique info mean .05 .10\n\n.95\n1 36.13 1.05 5.00 14.25 34.00 57.75 67.00 71.00\n\n.25\n\n.75\n\n.50\n\n.90\n\n502\n\n0\n\n76\n\nlowest :\n\n0 1\n\n2 3 4, highest: 72 73 74 75 76\n\nstatus\n\nn missing unique\n10\n\n0\n\n502\n\nalive (148, 29%), dead - prostatic ca (130, 26%)\ndead - heart or vascular (96, 19%), dead - cerebrovascular (31, 6%)\ndead - pulmonary embolus (14, 3%), dead - other ca (25, 5%)\ndead - respiratory disease (16, 3%)\ndead - other specific non-ca (28, 6%), dead - unspecified non-ca (7, 1%)\ndead - unknown cause (7, 1%)\n\nage : age in years\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 71.46 56 60 70 73 76 78 80\n\n41\n\n1\n\n501\n\nlowest : 48 49 50 51 52, highest: 84 85 87 88 89\n\nwt : weight index = wt(kg)-ht(cm)+200\n\nn missing unique info mean\n\n500\n\n2\n\n67\n\n.95\n1 99.03 77.95 82.90 90.00 98.00 107.00 116.00 123.00\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\nlowest :\n\n69\n\n71\n\n72 73\n\n74, highest: 136 142 145 150 152\n\n "}, {"Page_number": 187, "text": "8.1 data\n\n163\n\npf\n\nn missing unique\n4\n\n0\n\n502\n\nnormal activity (450, 90%), in bed < 50% daytime (37, 7%)\nin bed > 50% daytime (13, 3%), confined to bed (2, 0%)\n\nhx : history of cardiovascular disease\n\nn missing unique info sum mean\n2 0.73 213 0.4243\n\n0\n\n502\n\nsbp : systolic blood pressure/10\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n18 0.98 14.35 11 12 13 14 16 17 18\n\n0\n\n502\n\nfrequency 1 3 14 27 65 74 98 74 72 34 17 12\n%\n\n8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 30\n1 1 1\n0 0 0\n\n5 13 15 20 15 14\n\n2 3\n0 1\n\n3\n2 1\n\n0 1 3\n\n7 3\n\ndbp : diastolic blood pressure/10\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n9 10 10\n\n12 0.95 8.149\n\n0\n\n6\n\n6\n\n7\n\n8\n\n502\n\n4 5 6\n\n7\n\nfrequency 4 5 43 107 165 94 66\n21 33 19 13\n%\n\n1 1 9\n\n8 9 10 11 12 13 14 18\n1\n0\n\n5 2 1\n1 0 0\n\n9\n2\n\nekg\n\nn missing unique\n7\n\n8\n\n494\n\nnormal (168, 34%), benign (23, 5%)\nrhythmic disturb & electrolyte ch (51, 10%)\nheart block or conduction def (26, 5%), heart strain (150, 30%)\nold mi (75, 15%), recent mi (1, 0%)\n\nhg : serum hemoglobin (g/100ml)\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 13.45 10.2 10.7 12.3 13.7 14.7 15.8 16.4\n\n91\n\n0\n\n502\n\nlowest :\n8.199\nhighest: 17.297 17.500 17.598 18.199 21.199\n\n7.000\n\n7.199\n\n7.800\n\n5.899\n\nsz: size of primary tumor (cm2)\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 14.63 2.0 3.0 5.0 11.0 21.0 32.0 39.2\n\n55\n\n5\n\n497\n\nlowest :\n\n0 1\n\n2 3 4, highest: 54 55 61 62 69\n\nsg : combined index of stage and hist. grade\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n9 10 11 13 13\n\n11 0.96 10.31\n\n11\n\n8\n\n8\n\n491\n\n5 6 7 8\n\n9 10\n\nfrequency 3 8 7 67 137 33 114 26 75\n%\n5 15\n\n1 2 1 14\n\n28 7\n\n23\n\n11 12 13 14 15\n5 16\n1 3\n\n "}, {"Page_number": 188, "text": "164\n\n8 case study in data reduction\n\nap : serum prostatic acid phosphatase\n.10\n\nn missing unique info mean\n\n502\n\n0\n\n128\n\n.95\n1 12.18 0.300 0.300 0.500 0.700 2.975 21.689 38.470\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\nlowest :\n0.50000\nhighest: 316.00000 353.50000 367.00000 596.00000 999.87500\n\n0.29999\n\n0.19998\n\n0.39996\n\n0.09999\n\nbm : bone metastases\n\nn missing unique info sum mean\n82 0.1633\n\n2 0.41\n\n0\n\n502\n\nstage is defined by ap as well as x-ray results. of the patients in stage 3,\n0.92 have ap \u2264 0.8. of those in stage 4, 0.93 have ap > 0.8. since stage can\nbe predicted almost certainly from ap, we do not consider stage in some of\nthe analyses.\n\n8.2 how many parameters can be estimated?\n\nthere are 354 deaths among the 502 patients. if predicting survival time were\nof major interest, we could develop a reliable model if no more than about\n354/15 = 24 parameters were examined against y in unpenalized modeling.\nsuppose that a full model with no interactions is fitted and that linearity is\nnot assumed for any continuous predictors. assuming age is almost linear,\nwe could fit a restricted cubic spline function with three knots. for the other\ncontinuous variables, let us use five knots. for categorical predictors, the\nmaximum number of degrees of freedom needed would be one fewer than\nthe number of categories. for pf we could lump the last two categories since\nthe last category has only 2 patients. likewise, we could combine the last\ntwo levels of ekg. table 8.1 lists the candidate predictors with the maximum\nnumber of parameters we consider for each.\n\ntable 8.1 degrees of freedom needed for predictors\n\npredictor:\n# parameters: 3 2 4 2 1 4\n\nrx age wt pf hx sbp dbp ekg hg sz sg ap bm\n5 4 4 4 4 1\n\n4\n\n8.3 redundancy analysis\n\nas described in section 4.7.1, it is occasionally useful to do a rigorous re-\ndundancy analysis on a set of potential predictors. let us run the algorithm\ndiscussed there, on the set of predictors we are considering. we will use a low\nthreshold (0.3) for r2 for demonstration purposes.\n\n "}, {"Page_number": 189, "text": "8.3 redundancy analysis\n\n165\n\n# allow only 1 d.f. for three of the predictors\nprostate \u2190\n\ntransform ( prostate ,\n\nekg.norm = 1 * ( ekg % in % c ( \" normal \" ,\" benign \" )) ,\nrxn = as.numeric ( rx ) ,\npfn = as.numeric ( pf ))\n\n# force pfn , rxn to be linear because of difficulty of placing\n# knots with so many ties in the data\n# note : all incomplete cases are deleted ( inefficient)\nredun (\u223c stage + i ( rxn ) + age + wt + i ( pfn ) + hx +\n\nsbp + dbp + ekg.norm + hg + sz + sg + ap + bm ,\nr2 = .3 , type = ' adjusted ' , data = prostate )\n\nredundancy analysis\n\nredun ( formula = \u223cstage + i ( rxn ) + age + wt + i ( pfn ) + hx +\n\nsbp + dbp + ekg . norm + hg + sz + sg + ap + bm ,\ndata = prostate , r2 = 0.3 , type = \" adjusted \")\n\nn : 483\n\np : 14\n\nnk : 3\n\nnumber of nas :\nfrequencies of missing values due to each variable\n\n19\n\nstage\n\ni ( rxn )\n\nage\n\nwt\n\ni ( pfn )\n\ndbp\n\n0\n\n0\nekg . norm\n0\n\n0\n\nhg\n0\n\n1\n\nsz\n5\n\n2\n\nsg\n11\n\n0\n\nap\n0\n\nsbp\n\n0\n\nhx\n\n0\n\nbm\n0\n\ntransformatio n of target variables forced to be linear\n\nr2 cutoff : 0.3\n\ntype : adjusted\n\nr2 with which each variable can be predicted from all other\n\nvariables :\n\nstage\n\ni ( rxn )\n\nage\n\nwt\n\ni ( pfn )\n\nhx\n\nsbp\n\ndbp\n\n0.658\n\n0.000\n\n0.073\n\n0.111\n\n0.156\n\n0.062\n\n0.452\n\n0.417\nekg . norm\n0.055\n\nhg\n0.146\n\nsz\n0.192\n\nsg\n0.540\n\nap\n0.147\n\nbm\n0.391\n\nrendundant variables :\n\nstage sbp bm sg\n\npredicted from variables :\n\ni ( rxn ) age wt i ( pfn ) hx dbp ekg . norm hg sz ap\n\n "}, {"Page_number": 190, "text": "166\n\n8 case study in data reduction\n\nvariable deleted\n\nr2 r2 after later deletions\n\n1\n2\n3\n4\n\nstage 0.658\nsbp 0.452\nbm 0.374\nsg 0.342\n\n0.658 0.646 0.494\n0.453 0.455\n0.367\n\nby any reasonable criterion on r2, none of the predictors is redundant. stage\ncan be predicted with an r2 = 0.658 from the other 13 variables, but only\nwith r2 = 0.493 after deletion of 3 variables later declared to be \u201credundant.\u201d\n\n8.4 variable clustering\n\n1\n\nfrom table 8.1, the total number of parameters is 42, so some data reduction\nshould be considered. we resist the temptation to take the \u201ceasy way out\u201d us-\ning stepwise variable selection so that we can achieve a more stable modeling\nprocess and obtain unbiased standard errors. before using a variable cluster-\ning procedure, note that ap is extremely skewed. to handle skewness, we use\nspearman rank correlations for continuous variables (later we transform each\nvariable using transcan, which will allow ordinary correlation coefficients to\nbe used). after classifying ekg as \u201cnormal/benign\u201d versus everything else, the\nspearman correlations are plotted below.\nx \u2190 with ( prostate ,\n\ncbind ( stage , rx , age , wt , pf , hx , sbp , dbp ,\n\nekg.norm , hg , sz , sg , ap , bm ))\n\n# if no m i s s i n g data , c o u l d use cor ( a p p l y ( x , 2 , rank ))\n\nr \u2190 rcorr (x , type = \" spearman \" ) $ r\nmaxabsr \u2190 max ( abs ( r[ row (r ) ! = col ( r )]))\n\n# r c o r r in h m i s c\n\np \u2190 nrow ( r )\nplot ( c ( -.35 , p + .5 ), c (.5 , p + .25 ), type = ' n ' , axes = false ,\nxlab = ' ' , ylab = ' ' )\nv \u2190 dimnames ( r )[[1]]\n\n# f i g u r e 8.1\n\ntext ( rep ( .5 , p ), 1: p , v , adj =1)\nfor ( i in 1:( p-1 )) {\n\nfor ( j in ( i +1): p ) {\n\nlines ( c (i , i ), c (j , j + r [i , j ] / maxabsr / 2) ,\n\nlwd =3 , lend = ' butt ' )\n\nlines ( c ( i-.2 , i + .2 ), c (j , j ), lwd =1 , col = gray ( .7 ))\n\n}\ntext (i , i , v [ i ], srt = -45 , adj =0)\n\n}\n\nwe perform a hierarchical cluster analysis based on a similarity matrix\nthat contains pairwise hoeffding d statistics.295 d will detect nonmonotonic\nassociations.\n\n "}, {"Page_number": 191, "text": "8.5 transformation and single imputation using transcan\n\n167\n\nvc \u2190 varclus (\u223c stage + rxn + age + wt + pfn + hx +\n\nsbp + dbp + ekg.norm + hg + sz + sg + ap + bm ,\nsim = ' hoeffding ' , data = prostate )\n\nplot ( vc )\n\n# f i g u r e 8.2\n\nwe combine sbp and dbp, and tentatively combine ap, sg, sz, and bm.\n\n8.5 transformation and single imputation using\n\ntranscan\n\nnow we turn to the scoring of the predictors to potentially reduce the number\nof regression parameters that are needed later by doing away with the need for\n\nbm\nap\nsg\nsz\nhg\nekg.norm\ndbp\nsbp\nhx\npf\nwt\nage\nrx\nstage\n\na\n\np\n\ns\n\ng\n\ns\n\nz\n\nh\n\ng\n\ne\n\nk\n\ng.n\n\nd\n\nb\n\np\n\no\nr\n\nm\n\ns\n\nb\n\np\n\nh\n\nx\n\npf\n\nw\n\nt\n\na\n\ng\n\ne\n\nr\nx\n\nsta\n\ng\n\ne\n\nfig. 8.1 matrix of spearman \u03c1 rank correlation coefficients between predictors. hor-\nizontal gray scale lines correspond to \u03c1 = 0. the tallest bar corresponds to |\u03c1| = 0.78.\n\nnonlinear terms and multiple dummy variables. the r hmisc package transcan\nfunction defaults to using a maximum generalized variance method368 that\nincorporates canonical variates to optimally transform both sides of a mul-\ntiple regression model. each predictor is treated in turn as a variable being\npredicted, and all variables are expanded into restricted cubic splines (for\ncontinuous variables) or dummy variables (for categorical ones).\n\n# c o m b i n e 2 l e v e l s of ekg ( one had f r e q . 1)\nlevels ( prostate $ ekg )[ levels ( prostate $ ekg ) % in %\n\nc ( ' old mi ' , ' recent mi ' )] \u2190 ' mi '\n\nprostate $ pf.coded \u2190 as.integer ( prostate $ pf )\n\n "}, {"Page_number": 192, "text": "168\n\n8 case study in data reduction\n\n \n\nd\ng\nn\nd\n\ni\n\nf\nf\n\ne\no\nh\n \n*\n \n\n0\n3\n\n 0.00\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\n0.10\n\n0.12\n\n0.14\n\ne\ng\na\n\nx\nh\n\nn\nx\nr\n\nm\nr\no\nn\n\n.\n\ng\nk\ne\n\nn\np\n\nf\n\nz\ns\n\nm\nb\n\nt\n\nw\n\ng\nh\n\np\nb\ns\n\np\nb\nd\n\ne\ng\na\n\nt\ns\n\ng\ns\n\np\na\n\nfig. 8.2 hierarchical clustering using hoeffding\u2019s d as a similarity measure. dummy\nvariables were used for the categorical variable ekg. some of the dummy variables\ncluster together since they are by definition negatively correlated.\n\n# make a n u m e r i c v e r s i o n ; c o m b i n e last 2 l e v e l s of o r i g i n a l\n\nlevels ( prostate $ pf ) \u2190 levels ( prostate $ pf )[ c (1 ,2 ,3 ,3)]\nptrans \u2190\n\ntranscan (\u223c sz + sg + ap + sbp + dbp +\n\nage + wt + hg + ekg + pf + bm + hx , imputed = true ,\ntransformed = true , trantab = true , pl = false ,\nshow.na = true , data = prostate , frac = .1 , pr = false )\n\nsummary ( ptrans , digits =4)\n\nt r a n s c a n ( x = \u223cs z + s g + ap + sb p + dbp + age + wt + hg + ekg +\n\np f + bm + hx ,\np r = false , p l = false , show . na = true, d a t a = p r o s t a t e ,\nf r a c = 0 . 1 )\n\ni m p u t ed = true,\n\nt r a n t a b = true,\n\nt r a n s f o r m e d = true,\n\ni t e r a t i o n s : 8\n\nr2 a c h i e v e d i n p r e d i c t i n g e a c h v a r i a b l e :\n\ns z\n\nhx\n0 . 2 0 7 0 . 5 5 6 0 . 5 7 3 0 . 4 9 8 0 . 4 8 5 0 . 0 9 5 0 . 1 2 2 0 . 1 5 8 0 . 0 9 2 0 . 1 1 3 0 . 3 4 9 0 . 1 0 8\n\ndbp\n\nsb p\n\nekg\n\nage\n\nbm\n\nwt\n\nhg\n\nap\n\ns g\n\np f\n\na d j u s t e d r2 :\n\ns z\n\nhx\n0 . 1 8 0 0 . 5 4 1 0 . 5 5 9 0 . 4 8 1 0 . 4 6 8 0 . 0 6 5 0 . 0 9 3 0 . 1 2 9 0 . 0 5 9 0 . 0 8 6 0 . 3 3 1 0 . 0 8 3\n\ndbp\n\nsb p\n\nekg\n\nage\n\nbm\n\nwt\n\nhg\n\nap\n\ns g\n\np f\n\nc o e f f i c i e n t s o f c a n o n i c a l v a r i a t e s\n\nf o r p r e d i c t i n g e a c h ( row ) v a r i a b l e\n\nhg\n\nage\n\nekg\n\nsb p\n\n0 . 6 6\n\ns z\n\ns g\n\nap\n\ns z\ns g\n0 . 2 3\nap\n0 . 0 7\nsb p\n0 . 1 3\ndbp\n0 . 1 3\nage \u22120.02 \u22120.06\nwt \u22120.02\n0 . 1 3 \u22120.02\nhg\n0 . 0 3\n0 . 2 0 \u22120.38\nekg\n0 . 1 0\n0 . 0 8\n0 . 0 4\np f\n0 . 0 2\nbm \u22120.02 \u22120.03 \u22120.13\n\n0 . 2 0\n0 . 8 4\n0 . 8 0\n0 . 1 0 \u22120.14\n0 . 0 9 \u22120.06 \u22120.98\n0 . 5 8\n0 . 0 6 \u22120.08 \u22120.31\n0 . 0 9\n0 . 4 2\n0 . 3 6\n0 . 0 0\n\ndbp\n0 . 3 3 \u22120.01 \u22120.01\n0 . 3 3\n0 . 0 7 \u22120.02\n0 . 0 8\n0 . 0 3 \u22120.02\n\u22120.11 \u22120.05\n\u22120.94\n0 . 1 4 \u22120.09\n0 . 0 7\n0 . 1 4\n0 . 1 4\n\nwt\np f\n0 . 0 3 \u22120.36\n0 . 1 1\n0 . 0 1 \u22120.01 \u22120.07\n0 . 0 2 \u22120.20\n0 . 0 0 \u22120.83\n0 . 0 1\n0 . 0 1\n0 . 1 0 \u22120.03\n0 . 1 0\n0 . 0 3\n0 . 0 4\n0 . 0 3\n0 . 0 3\n0 . 0 5\n0 . 4 3 \u22120.03\n1 . 0 5\n0 . 4 6\n0 . 5 1 \u22120.06\n0 . 2 1 \u22121.09\n0 . 2 4 \u22121.53\n\u22120.02\n0 . 1 5 \u22120.42\n\u22121.75\n\n0 . 5 7\n0 . 2 3\n0 . 1 2\n0 . 1 5\n0 . 3 3\n0 . 4 1 \u22120.04 \u22120.04\n0 . 1 2\n0 . 1 4 \u22120.03\n0 . 2 9\n0 . 0 3 \u22120.04 \u22120.06 \u22120.01 \u22120.06\n0 . 0 0\n\n0 . 1 8\n\n0 . 2 2\n\n0 . 1 3\n\n0 . 1 1\n\n0 . 4 3\n\nbm\n\n "}, {"Page_number": 193, "text": "8.5 transformation and single imputation using transcan\n\n169\n\n0 . 0 5 \u22120.01 \u22120.04\n\n0 . 0 0 \u22120.06\n\n0 . 0 2 \u22120.01 \u22120.09 \u22120.04 \u22120.05\n\nhx\n\n0 . 0 4\n\nhx\n\ns z\n0 . 3 4\ns g\n0 . 1 4\nap \u22120.03\nsb p \u22120.14\ndbp \u22120.01\nage \u22120.76\nwt\n0 . 2 7\nhg \u22120.12\nekg \u22121.23\np f \u22120.46\nbm \u22120.02\nhx\n\nsummary o f\n\ni m p u t ed v a l u e s\n\ns z\n\nn m i s s i n g\n5\n0\n\nu n i q u e\n4\n\ni n f o\n0 . 9 5\n\nmean\n1 2 . 8 6\n\n6 ( 2 , 40%) , 7 . 4 1 6 ( 1 , 20%) , 2 0 . 1 8 ( 1 , 20%) , 2 4 . 6 9 ( 1 , 20%)\ns g\n\n11\n. 7 5\n1 0 . 5 6 0\n\nn m i s s i n g\n0\n. 9 0\n1 5 . 0 0 0\n\nu n i q u e\n10\n. 9 5\n1 5 . 0 0 0\n\ni n f o\n1\n\nmean\n1 0 . 1\n\n. 0 5\n6 . 9 0 0\n\n. 1 0\n7 . 2 8 9\n\n. 2 5\n7 . 6 9 7\n\n. 5 0\n1 0 . 2 7 0\n\nfr equ en cy\n%\nage\n\n6 . 5 1 1 7 . 2 8 9 7 . 3 9 4 8 1 0 . 2 5 1 0 . 2 7 1 0 . 3 2 1 0 . 3 9 1 0 . 7 3 15\n1\n2\n9 18\n\n1 1\n9 9\n\n1\n9\n\n1\n9\n\n1\n9\n\n1\n9\n\n1\n9\n\n1\n9\n\nwt\n\nn m i s s i n g\n1\n0\n\nu n i q u e\n1\n\nn m i s s i n g\n2\n0\n\nu n i q u e\n2\n\ni n f o\n0\n\ni n f o\n1\n\nmean\n7 1 . 6 5\n\nmean\n9 7 . 7 7\n\n9 1 . 2 4 ( 1 , 50%) , 1 0 4 . 3 ( 1 , 50%)\nekg\n\nn m i s s i n g\n8\n0\n\nu n i q u e\n4\n\ni n f o\n0 . 9\n\nmean\n2 . 6 2 5\n\n1 ( 3 , 38%) , 3 ( 3 , 38%) , 4 ( 1 , 12%) , 5 ( 1 , 12%)\n\ns t a r t i n g e s t i m a t e s\n\nf o r\n\ni m p u t ed v a l u e s :\n\ns z\n\ns g\n1 1 . 0 1 0 . 0\n\nap\n\nsb p\n0 . 7 1 4 . 0\n\ndbp\nhg\n8 . 0 7 3 . 0 9 8 . 0 1 3 . 7\n\nage\n\nwt\n\nekg\n1 . 0\n\np f\n1 . 0\n\nbm\n0 . 0\n\nhx\n0 . 0\n\nggplot ( ptrans , scale = true ) +\n\ntheme ( axis.text.x = element_text ( size =6))\n\n# f i g u r e 8.3\n\nthe plotted output is shown in figure 8.3. note that at face value the trans-\nformation of ap was derived in a circular manner, since the combined index\nof stage and histologic grade, sg, uses in its stage component a cutoff on ap.\nhowever, if sg is omitted from consideration, the resulting transformation for\nap does not change appreciably. note that bm and hx are represented as binary\nvariables, so their coefficients in the table of canonical variable coefficients\nare on a different scale. for the variables that were actually transformed, the\ncoefficients are for standardized transformed variables (mean 0, variance 1).\nfrom examining the r2s, age, wt, ekg, pf, and hx are not strongly related\nto other variables. imputations for age, wt, ekg are thus relying more on the\nmedian or modal values from the marginal distributions. from the coefficients\nof first (standardized) canonical variates, sbp is predicted almost solely from\ndbp; bm is predicted mainly from ap, hg, and pf.\n\n2\n\n "}, {"Page_number": 194, "text": "170\n\n8 case study in data reduction\n\nsz\n\nsg\n\nap\n\nsbp\n\nr2 = 0.21   5 missing\n\nr2 = 0.56 11 missing\n\n0\n\n20\n\n40\ndbp\n\n60\n\n5.0\n\n7.5\n\n10.0\nage\n\n12.5\n\n15.0 0\n\n250\n\nr2 = 0.57\n\n500\nwt\n\n750\n\n1000\n\n10\n\n15\n\nr2 = 0.5\n\n20\nhg\n\n25\n\n30\n\n4\n\n8\n\nr2 = 0.49\n\n12\nekg\n\nr2 = 0.1   1 missing\n\n16\n\n50\n\n60\n\n70\npf\n\nr2 = 0.12   2 missing\n\nr2 = 0.16\n\n80\n\n90\n\n80\n\n100\n\n120\n\n140\n\n10\n\n15\n\n20\n\nbm\n\nhx\n\nr2 = 0.09   8 missing\n\nr2 = 0.11\n\nr2 = 0.35\n\nr2 = 0.11\n\nd\ne\nm\nr\no\n\nf\ns\nn\na\nr\nt\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n2\n\n4\n\n6\n\n1.0\n\n1.5\n\n2.0\n\n2.5\n\n3.0 0.00\n\n0.25\n\n0.50\n\n0.75\n\n1.00 0.00\n\n0.25\n\n0.50\n\n0.75\n\n1.00\n\nfig. 8.3 simultaneous transformation and single imputation of all candidate predic-\ntors using transcan. imputed values are shown as red plus signs. transformed values\nare arbitrarily scaled to [0, 1].\n\n8.6 data reduction using principal components\n\nthe first pc, pc1, is the linear combination of standardized variables having\nmaximum variance. pc2 is the linear combination of predictors having the\nsecond largest variance such that pc2 is orthogonal to (uncorrelated with)\npc1. if there are p raw variables, the first k pcs, where k < p, will explain\nonly part of the variation in the whole system of p variables unless one or\nmore of the original variables is exactly a linear combination of the remaining\nvariables. note that it is common to scale and center variables to have mean\nzero and variance 1 before computing pcs.\n\nthe response variable (here, time until death due to any cause) is not\nexamined during data reduction, so that if pcs are selected by variance ex-\nplained in the x-space and not by variation explained in y , one needn\u2019t\ncorrect for model uncertainty or multiple comparisons.\n\npca results in data reduction when the analyst uses only a subset of the\np possible pcs in predicting y . this is called incomplete principal component\nregression. when one sequentially enters pcs into a predictive model in a\nstrict pre-specified order (i.e., by descending amounts of variance explained\n\n "}, {"Page_number": 195, "text": "8.6 data reduction using principal components\n\n171\n\nfor the system of p variables), model uncertainty requiring bootstrap adjust-\nment is minimized. in contrast, model uncertainty associated with stepwise\nregression (driven by associations with y ) is massive.\n\nfor the prostate dataset, consider pcs on raw candidate predictors, ex-\npanding polytomous factors using dummy variables. the r function princomp\nis used, after singly imputing missing raw values using transcan\u2019s optimal\nadditive nonlinear models. in this series of analyses we ignore the treatment\nvariable, rx.\n\n# impute all missing values in all variables given to transcan\nimputed \u2190 impute ( ptrans , data = prostate , list.out = true )\n\nimputed missing values with the following frequencies\n\nand stored them in variables with their original names :\n\nsz\n5\n\nsg age\n11\n1\n\nwt ekg\n8\n\n2\n\nimputed \u2190 as.data.frame ( imputed )\n\n# c o m p u t e p r i n c i p a l c o m p o n e n t s on i m p u t e d d a t a .\n# c r e a t e a d e s i g n m a t r i x from ekg c a t e g o r i e s\n\nekg \u2190 model.matrix (\u223c ekg , data = imputed )[ , -1 ]\npfn \u2190 prostate $ pfn\nprin.raw \u2190 princomp (\u223c sz + sg + ap + sbp + dbp + age +\n\n# use c o r r e l a t i o n m a t r i x\n\nwt + hg + ekg + pfn + bm + hx ,\ncor = true , data = imputed )\n\nplot ( prin.raw , type = ' lines ' , main = ' ' , ylim = c (0 ,3)) # f i g u r e 8.4\n# add c u m u l a t i v e f r a c t i o n of v a r i a n c e e x p l a i n e d\naddscree \u2190 function (x , npcs = min (10 , length ( x $ sdev )) ,\n\nplotv = false ,\ncol =1 , offset = .8 , adj =0 , pr = false ) {\n\n\u2227\n\nvars \u2190 x $ sdev\ncumv \u2190 cumsum ( vars ) / sum ( vars )\nif ( pr ) print ( cumv )\ntext (1: npcs , vars [1: npcs ] + offset * par ( ' cxy ' )[2] ,\n\n2\n\nas.character ( round ( cumv [1: npcs ], 2)) ,\nsrt =45 , adj = adj , cex = .65 , xpd = na , col = col )\n\nif ( plotv ) lines (1: npcs , vars [1: npcs ], type = ' b ' , col = col )\n\n}\naddscree ( prin.raw )\n\nprin.trans \u2190 princomp ( ptrans $ transformed , cor = true )\naddscree ( prin.trans , npcs =10 , plotv = true , col = ' red ' ,\n\noffset = -.8 , adj =1)\n\n "}, {"Page_number": 196, "text": "172\n\n8 case study in data reduction\n\ns\ne\nc\nn\na\ni\nr\na\nv\n\n3.0\n\n2.5\n\n2.0\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n0.15\n\n0.23\n\n0.26\n\n0.35\n\n0.38\n\n0.5\n\n0.42\n\n0.49\n\n0.56\n\n0.63\n\n0.7\n\n0.75\n\n0.8\n\n0.59\n\n0.66\n\n0.73\n\n0.79\n\n0.85\n\n0.91\n\n0.95\ncomp.1 comp.3 comp.5 comp.7 comp.9\n\nfig. 8.4 variance of the system of raw predictors (black) explained by individual\nprincipal components (lines) along with cumulative proportion of variance explained\n(text), and variance explained by components computed on transcan-transformed\nvariables (red)\n\nthe resulting plot shown in figure 8.4 is called a \u201cscree\u201d plot [325, pp. 96\u201399,\n104, 106]. it shows the variation explained by the first k principal components\nas k increases all the way to 16 parameters (no data reduction). it requires\n10 of the 16 possible components to explain > 0.8 of the variance, and the\nfirst 5 components explain 0.49 of the variance of the system. two of the 16\ndimensions are almost totally redundant.\n\nafter repeating this process when transforming all predictors via transcan,\nwe have only 12 degrees of freedom for the 12 predictors. the variance ex-\nplained is depicted in figure 8.4 in red. it requires at least 9 of the 12 possible\ncomponents to explain \u2265 0.9 of the variance, and the first 5 components ex-\nplain 0.66 of the variance as opposed to 0.49 for untransformed variables.\n\nlet us see how the pcs \u201cexplain\u201d the times until death using the cox re-\ngression132 function from rms, cph, described in chapter 20. in what follows\nwe vary the number of components used in the cox models from 1 to all 16,\ncomputing the aic for each model. aic is related to model log likelihood\npenalized for number of parameters estimated, and lower is better. for refer-\nence, the aic of the model using all of the original predictors, and the aic\nof a full additive spline model are shown as horizontal lines.\n\nrequire ( rms )\n\ns \u2190 with ( prostate , surv ( dtime , status ! = \" alive \" ))\n\n# t w o - c o l u m n r e s p o n s e var.\n\npcs \u2190 prin.raw $ scores\naic \u2190 numeric (16)\n\nfor ( i in 1:16) {\n\n# pick off all pcs\n\n "}, {"Page_number": 197, "text": "8.6 data reduction using principal components\n\n173\n\nps \u2190 pcs [ ,1: i ]\naic [ i ] \u2190 aic ( cph (s \u223c ps ))\n\n# f i g u r e 8.5\n\nylab = ' aic ' , type = ' l ' , ylim = c (3950 ,4000))\n\n}\nplot (1:16 , aic , xlab = ' number of components used ' ,\nf \u2190 cph ( s \u223c sz + sg + log ( ap ) + sbp + dbp + age + wt + hg +\nabline ( h = aic ( f ), col = ' blue ' )\nf \u2190 cph ( s \u223c rcs ( sz ,5) + rcs ( sg ,5) + rcs ( log ( ap ) ,5) +\n\nekg + pf + bm + hx , data = imputed )\n\nrcs ( sbp ,5) + rcs ( dbp ,5) + rcs ( age ,3) + rcs ( wt ,5) +\nrcs ( hg ,5) + ekg + pf + bm + hx ,\ntol =1 e-14 , data = imputed )\n\nabline ( h = aic ( f ), col = ' blue ' , lty =2)\n\nfor the money, the first 5 components adequately summarizes all variables,\nif linearly transformed, and the full linear model is no better than this. the\nmodel allowing all continuous predictors to be nonlinear is not worth its\nadded degrees of freedom.\n\nnext check the performance of a model derived from cluster scores of\n\ntransformed variables.\n\n# c o m p u t e pc1 on a s u b s e t of t r a n s c a n - t r a n s f o r m e d p r e d i c t o r s\n\npco \u2190 function ( v ) {\n\nf \u2190 princomp ( ptrans $ transformed [, v ], cor = true )\nvars \u2190 f $ sdev\ncat ( ' fraction of variance explained by pc1 : ' ,\n\n\u2227\n\n2\n\nround ( vars [1] / sum ( vars ) ,2) , ' \\ n ' )\n\nf $ scores [ ,1]\n\n}\ntumor\n\n\u2190 pco ( c ( ' sz ' , ' sg ' , ' ap ' , ' bm ' ))\n\nfraction of variance explained by pc1 : 0.59\n\nbp\n\n\u2190 pco ( c ( ' sbp ' , ' dbp ' ))\n\nfraction of variance explained by pc1 : 0.84\n\ncardiac \u2190 pco ( c ( ' hx ' , ' ekg ' ))\n\nfraction of variance explained by pc1 : 0.61\n\n# get transformed individual variables that are not clustered\nother \u2190 ptrans $ transfor me d [ , c ( ' hg ' , ' age ' , ' pf ' , ' wt ' )]\nf \u2190 cph ( s \u223c tumor + bp + cardiac + other )\n\n# other is matrix\n\naic ( f )\n\n "}, {"Page_number": 198, "text": "174\n\n8 case study in data reduction\n\nc\na\n\ni\n\n4000\n\n3990\n\n3980\n\n3970\n\n3960\n\n3950\n\n5\n\n10\n\n15\n\nnumber of components used\n\nfig. 8.5 aic of cox models fitted with progressively more principal components.\nthe solid blue line depicts the aic of the model with all original covariates. the\ndotted blue line is positioned at the aic of the full spline model.\n\n[1] 3954.393\n\nprint (f , latex = true , long = false , title = ' ' )\n\nmodel tests discrimination\n\nindexes\n\n502 lr \u03c72\n\nobs\nevents 354 d.f.\ncenter\n\n81.11 r2\n7 dxy\n\n0 pr(> \u03c72) 0.0000 g\n86.81 gr\n\nscore \u03c72\npr(> \u03c72) 0.0000\n\n0.149\n0.286\n0.562\n1.755\n\ncoef\n-0.1723 0.0367\ntumor\nbp\n-0.0251 0.0424\ncardiac -0.2513 0.0516\nhg\n-0.1407 0.0554\n-0.1034 0.0579\nage\n-0.0933 0.0487\npf\nwt\n-0.0910 0.0555\n\ns.e. wald z pr(> |z|)\n-4.69 < 0.0001\n-0.59\n0.5528\n-4.87 < 0.0001\n-2.54\n0.0111\n0.0739\n-1.79\n0.0551\n-1.92\n-1.64\n0.1012\n\nthe tumor and cardiac clusters seem to dominate prediction of mortality,\nand the aic of the model built from cluster scores of transformed variables\ncompares favorably with other models (figure 8.5).\n\n "}, {"Page_number": 199, "text": "8.6 data reduction using principal components\n\n175\n\n8.6.1 sparse principal components\n\na disadvantage of principal components is that every predictor receives a\nnonzero weight for every component, so many coefficients are involved even\nthrough the effective degrees of freedom with respect to the response model\nare reduced. sparse principal components 672 uses a penalty function to reduce\nthe magnitude of the loadings variables receive in the components. if an l1\npenalty is used (as with the lasso), some loadings are shrunk to zero, result-\ning in some simplicity. sparse principal components combines some elements\nof variable clustering, scoring of variables within clusters, and redundancy\nanalysis.\n\nfilzmoser, fritz, and kalcher191 have written a nice r package pcapp for\ndoing sparse pc analysis.a the following example uses the prostate data\nagain. to allow for nonlinear transformations and to score the ekg variable\nin the prostate dataset down to a scalar, we use the transcan-transformed\npredictors as inputs.\n\nrequire ( pcapp )\n\ns \u2190 spcagrid ( ptrans $ transformed , k =10 , method = ' sd ' ,\n\ncenter = mean , scale = sd , scores = true ,\nmaxiter =10)\n\nplot (s , type = ' lines ' , main = ' ' , ylim = c (0 ,3))\naddscree ( s )\ns $ loadings\n\n# t h e s e l o a d i n g s are on the o r i g . t r a n s c a n s c a l e\n\n# f i g u r e 8.6\n\nl o a d i n g s :\n\ncomp . 1 comp . 2 comp . 3 comp . 4 comp . 5 comp . 6 comp . 7 comp . 8 comp . 9 comp . 1 0\n\n0 . 2 4 8\n0 . 6 2 0\n0 . 6 3 4\n\ns z\ns g\nap\nsb p\ndbp\nage\nwt\nhg\nekg\np f\nbm \u22120.391\nhx\n\n\u22120.707\n0 . 7 0 7\n\n1 . 0 0 0\n\n0 . 9 5 0\n\u22120.305\n\n0 . 5 2 2\n\n1 . 0 0 0\n\n1 . 0 0 0\n\n1 . 0 0 0\n\n1 . 0 0 0\n\n1 . 0 0 0\n\n0 . 8 5 2\n\nss l o a d i n g s\np r o p o r t i o n var\ncu m u l at i ve var\n\nss l o a d i n g s\np r o p o r t i o n var\ncu m u l at i ve var\n\ncomp . 1 comp . 2 comp . 3 comp . 4 comp . 5 comp . 6 comp . 7 comp . 8\n1 . 0 0 0\n0 . 0 8 3\n0 . 6 6 7\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 0 8 3\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 1 6 7\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 2 5 0\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 3 3 3\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 4 1 7\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 5 0 0\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 5 8 3\n\ncomp . 9 comp . 1 0\n1 . 0 0 0\n0 . 0 8 3\n0 . 8 3 3\n\n1 . 0 0 0\n0 . 0 8 3\n0 . 7 5 0\n\nonly nonzero loadings are shown. the first sparse pc is the tumor cluster\nused above, and the second is the blood pressure cluster. let us see how well\nincomplete sparse principal component regression predicts time until death.\n\na the spca package is a new sparse pc package that should also be considered.\n\n "}, {"Page_number": 200, "text": "176\n\n8 case study in data reduction\n\n0.2\n\n0.35\n\ns\ne\nc\nn\na\ni\nr\na\nv\n\n3.0\n\n2.5\n\n2.0\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n0.44\n\n0.53\n\n0.61\n\n0.7\n\n0.79\n\n0.88\n\n0.95\n\n1\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\nfig. 8.6 variance explained by individual sparse principal components (lines) along\nwith cumulative proportion of variance explained (text)\n\npcs \u2190 s $ scores\naic \u2190 numeric (10)\nps \u2190 pcs [ ,1: i ]\naic [ i ] \u2190 aic ( cph (s \u223c ps ))\n\nfor ( i in 1:10) {\n\n# pick off s p a r s e pcs\n\n# f i g u r e 8.7\n\n}\nplot (1:10 , aic , xlab = ' number of components used ' ,\n\nylab = ' aic ' , type = ' l ' ,\n\nylim = c (3950 ,4000))\n\nmore components are required to optimize aic than were seen in figure 8.5,\nbut a model built from 6\u20138 sparse pcs performed as well as the other models.\n\n8.7 transformation using nonparametric smoothers\n\nthe ace nonparametric additive regression method of breiman and fried-\nman68 transforms both the left-hand-side variable and all the right-hand-side\nvariables so as to optimize r2. ace can be used to transform the predic-\ntors using the r ace function in the acepack package, called by the transace\nfunction in the hmisc package. transace does not impute data but merely\ndoes casewise deletion of missing values. here transace is run after single im-\nputation by transcan. binary is used to tell transace which variables not to\ntry to predict (because they need no transformation). several predictors are\nrestricted to be monotonically transformed.\n\n "}, {"Page_number": 201, "text": "8.8 further reading\n\n177\n\nc\na\n\ni\n\n4000\n\n3990\n\n3980\n\n3970\n\n3960\n\n3950\n\n2\n\n4\n\n8\nnumber of components used\n\n6\n\n10\n\nfig. 8.7 performance of sparse principal components in cox models\n\nx \u2190 with ( imputed ,\n\ncbind ( sz , sg , ap , sbp , dbp , age , wt , hg , ekg , pf ,\n\nmonotonic \u2190 c ( \" sz \" ,\" sg \" ,\" ap \" ,\" sbp \" ,\" dbp \" ,\" age \" ,\" pf \" )\n\nbm , hx ))\n\ntransace (x , monotonic ,\n\n# f i g u r e 8.8\n\ncategorical = \" ekg \" , binary = c ( \" bm \" ,\" hx \" ))\n\nr2 a c h i e v e d i n p r e d i c t i n g e a c h v a r i a b l e :\n\nwt\n0 . 2 2 6 5 8 2 4 0 . 5 7 6 2 7 4 3 0 . 5 7 1 7 7 4 7 0 . 4 8 2 3 8 5 2 0 . 4 5 8 0 9 2 4 0 . 1 5 1 4 5 2 7 0 . 1 7 3 2 2 4 4\n\ndbp\n\nsb p\n\nage\n\nap\n\ns g\n\ns z\n\np f\n0 . 2 0 0 1 0 0 8 0 . 1 1 1 0 7 0 9 0 . 1 7 7 8 7 0 5\n\nekg\n\nhg\n\nbm\nna\n\nhx\nna\n\nexcept for ekg, age, and for arbitrary sign reversals, the transformations in\nfigure 8.8 determined using transace were similar to those in figure 8.3. the\ntranscan transformation for ekg makes more sense.\n\n8.8 further reading\n\n1\n\n2\n\nsauerbrei and schumacher541 used the bootstrap to demonstrate the variability\nof a standard variable selection procedure for the prostate cancer dataset.\nschemper and heinze551 used logistic models to impute dichotomizations of the\npredictors for this dataset.\n\n "}, {"Page_number": 202, "text": "178\n\n8 case study in data reduction\n\n3\n2\n1\n0\n\u22121\n\n8\n6\n4\n2\n0\n\u22122\n\n2\n1\n0\n\u22121\n\u22122\n\u22123\n\n4\n3\n2\n1\n0\n\n3\n2\n1\n0\n\u22121\n\n1\n0\n\u22121\n\u22122\n\u22123\n\n0\n\n200 400 600 800 1000\n\nap\n\n1.5\n1.0\n0.5\n0.0\n\u22120.5\n\u22121.0\n\u22121.5\n\n0\n\n10 20 30 40 50 60 70\n\n6\n\n8\n\nsz\n\n12\n\n14\n\n10\nsg\n\n10\n\n15\n\n20\nsbp\n\n25\n\n30\n\n8\n6\n4\n2\n0\n\u22122\n\n1\n0\n\u22121\n\u22122\n\u22123\n\u22124\n\u22125\n\u22126\n\n4\n\n6\n\n8 10 12 14 16 18\n\n50\n\n60\n\ndbp\n\n80\n\n90\n\n70\nage\n\n1.5\n1.0\n0.5\n0.0\n\u22120.5\n\u22121.0\n\n80\n\n100\n\n120\n\n140\n\n10\n\n15\n\n20\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nhg\n\nekg\n\nwt\n\n2.0\npf\n\n2.5\n\n3.0\n\n1.0\n\n1.5\n\nfig. 8.8 simultaneous transformation of all variables using ace.\n\n8.9 problems\n\nthe mayo clinic conducted a randomized trial in primary biliary cirrhosis\n(pbc) of the liver between january 1974 and may 1984, to compare d-\npenicillamine with placebo. the drug was found to be ineffective [197, p.\n2], and the trial was done before liver transplantation was common, so this\ntrial constitutes a natural history study for pbc. followup continued through\njuly, 1986. for the 19 patients that did undergo transplant, followup time was\ncensored (status=0) at the day of transplant. 312 patients were randomized,\nand another 106 patients were entered into a registry. the nonrandomized\npatients have most of their laboratory values missing, except for bilirubin,\nalbumin, and prothrombin time. 28 randomized patients had both serum\ncholesterol and triglycerides missing. the data, which consist of clinical, bio-\nchemical, serologic, and histologic information, are listed in [197, pp. 359\u2013\n375]. the pbc data are discussed and analyzed in [197, pp. 2\u20137, 102\u2013104,\n153\u2013162], [158], [7] (a tree-based analysis which on its p. 480 mentions some\npossible lack of fit of the earlier analyses), and [361]. the data are stored in\nthe datasets web site so may be accessed using the hmisc gethdata function\nwith argument pbc. use only the data on randomized patients for all analyses.\nfor problems 1\u20136, ignore followup time, status, and drug.\n\n "}, {"Page_number": 203, "text": "8.9 problems\n\n179\n\n1. do an initial variable clustering based on ranks, using pairwise deletion of\nmissing data. comment on the potential for one-dimensional summaries of\nsubsets of variables being adequate summaries of prognostic information.\n2. cholesterol, triglycerides, platelets, and copper are missing on some pa-\ntients. impute them using a method you recommend. use some or all of\nthe remaining predictors and possibly the outcome. provide a correlation\ncoefficient describing the usefulness of each imputation model. provide\nthe actual imputed values, specifying observation numbers. for all later\nanalyses, use imputed values for missing values.\n\n3. perform a scaling/transformation analysis to better measure how the pre-\ndictors interrelate and to possibly pretransform some of them. use transcan\nor ace. repeat the variable clustering using the transformed scores and\npearson correlation or using an oblique rotation principal component anal-\nysis. determine if the correlation structure (or variance explained by the\nfirst principal component) indicates whether it is possible to summarize\nmultiple variables into single scores.\n\n4. do a principal component analysis of all transformed variables simulta-\nneously. make a graph of the number of components versus the cumula-\ntive proportion of explained variation. repeat this for laboratory variables\nalone.\n\n5. repeat the overall pca using sparse principal components. pay atten-\ntion to how best to solve for sparse components, e.g., consider the lambda\nparameter in spcagrid.\n\n6. how well can variables (lab and otherwise) that are routinely collected\n(on nonrandomized patients) capture the information (variation) of the\nvariables that are often missing? it would be helpful to explore the strength\nof interrelationships by\n\na. correlating two pc1s obtained from untransformed variables,\nb. correlating two pc1s obtained from transformed variables,\nc. correlating the best linear combination of one set of variables with the\n\nbest linear combination of the other set, and\n\nd. doing the same on transformed variables.\n\nfor this problem consider only complete cases, and transform the 5 non-\nnumeric categorical predictors to binary 0\u20131 variables.\n\n7. consider the patients having complete data who were randomized to\n\nplacebo. consider only models that are linear in all the covariates.\n\na. fit a survival model to predict time of death using the following covari-\nates: bili, albumin, stage, protime, age, alk.phos, sgot, chol, trig,\nplatelet, copper.\n\nb. perform an ordinary principal component analysis. fit the survival\nmodel using only the first 3 pcs. compare the likelihood ratio \u03c72 and\naic with that of the model using the original variables.\n\n "}, {"Page_number": 204, "text": "180\n\n8 case study in data reduction\n\nc. considering the pcs are fixed, use the bootstrap to estimate the 0.95\nconfidence interval of the inter-quartile-range age effect on the original\nscale, and the same type of confidence interval for the coefficient of pc1.\nd. now accounting for uncertainty in the pcs, compute the same two\nconfidence intervals. compare and interpret the two sets. take into\naccount the fact that pcs are not unique to within a sign change.\n\nr programming hints for this exercise are found on the course web site.\n\n "}, {"Page_number": 205, "text": "chapter 9\noverview of maximum likelihood\nestimation\n\n9.1 general notions\u2014simple cases\n\nin ordinary least squares multiple regression, the objective in fitting a model\nis to find the values of the unknown parameters that minimize the sum of\nsquared errors of prediction. when the response variable is non-normal, poly-\ntomous, or not observed completely, one needs a more general objective func-\ntion to optimize.\n\nmaximum likelihood (ml) estimation is a general technique for estimat-\ning parameters and drawing statistical inferences in a variety of situations,\nespecially nonstandard ones. before laying out the method in general, ml\nestimation is illustrated with a standard situation, the one-sample binomial\nproblem. here, independent binary responses are observed and one wishes to\ndraw inferences about an unknown parameter, the probability of an event in\na population.\n\nsuppose that in a population of individuals, each individual has the same\nprobability p that an event occurs. we could also say that the event has\nalready been observed, so that p is the prevalence of some condition in the\npopulation. for each individual, let y = 1 denote the occurrence of the\nevent and y = 0 denote nonoccurrence. then prob{y = 1} = p for each\nindividual. suppose that a random sample of size 3 from the population is\ndrawn and that the first individual had y = 1, the second had y = 0, and the\nthird had y = 1. the respective probabilities of these outcomes are p , 1\u2212 p ,\nand p . the joint probability of observing the independent events y = 1, 0, 1\nis p (1\u2212 p )p = p 2(1\u2212 p ). now the value of p is unknown, but we can solve\nfor the value of p that makes the observed data (y = 1, 0, 1) most likely\nto have occurred. in this case, the value of p that maximizes p 2(1 \u2212 p ) is\np = 2/3. this value for p is the maximum likelihood estimate (mle ) of the\npopulation probability.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 9\n\n181\n\n "}, {"Page_number": 206, "text": "182\n\n9 overview of maximum likelihood estimation\n\nlet us now study the situation of independent binary trials in general. let\nthe sample size be n and the observed responses be y1, y2, . . . , yn. the joint\nprobability of observing the data is given by\n\np yi(1 \u2212 p )1\u2212yi .\n\n(9.1)\n\nn(cid:8)\n\nl =\n\ni=1\n\nnow let s denote the sum of the y s or the number of times that the event\noccurred (yi = 1), that is the number of \u201csuccesses.\u201d the number of non-\noccurrences (\u201cfailures\u201d) is n \u2212 s. the likelihood of the data can be simplified\nto\n\nl = p s(1 \u2212 p )n\u2212s.\n\n(9.2)\n\nit is easier to work with the log likelihood function, which also has desirable\nstatistical properties. for the one-sample binary response problem, the log\nlikelihood is\n\nlog l = s log(p ) + (n \u2212 s) log(1 \u2212 p ).\n\n(9.3)\n\nthe mle of p is that value of p that maximizes l or log l. since log l\nis a smooth function of p , its maximum value can be found by finding the\npoint at which log l has a slope of 0. the slope or first derivative of log l,\nwith respect to p , is\n\nu (p ) = \u2202 log l/\u2202p = s/p \u2212 (n \u2212 s)/(1 \u2212 p ).\n\n(9.4)\n\nthe first derivative of the log likelihood function with respect to the parame-\nter(s), here u (p ), is called the score function. equating this function to zero\nrequires that s/p = (n \u2212 s)/(1 \u2212 p ). multiplying both sides of the equation\nby p (1 \u2212 p ) yields s(1 \u2212 p ) = (n \u2212 s)p or that s = (n \u2212 s)p + sp = np .\nthus the mle of p is p = s/n.\n\nanother important function is called the fisher information about the\nunknown parameters. the information function is the expected value of the\nnegative of the curvature in log l, which is the negative of the slope of the\nslope as a function of the parameter, or the negative of the second derivative\nof log l. motivation for consideration of the fisher information is as follows.\nif the log likelihood function has a distinct peak, the sample provides infor-\nmation that allows one to readily discriminate between a good parameter\nestimate (the location of the obvious peak) and a bad one. in such a case the\nmle will have good precision or small variance. if on the other hand the like-\nlihood function is relatively flat, almost any estimate will do and the chosen\nestimate will have poor precision or large variance. the degree of peakedness\nof a function at a given point is the speed with which the slope is changing at\nthat point, that is, the slope of the slope or second derivative of the function\nat that point.\n\n "}, {"Page_number": 207, "text": "9.1 general notions\u2014simple cases\n\nhere, the information is\n\ni(p ) = e{\u2212\u22022 log l/\u2202p 2}\n\n= e{s/p 2 + (n \u2212 s)/(1 \u2212 p )2}\n= np/p 2 + n(1 \u2212 p )/(1 \u2212 p )2 = n/[p (1 \u2212 p )].\n\n183\n\n(9.5)\n\nwe estimate the information by substituting the mle of p into i(p ), yielding\ni(p) = n/[p(1 \u2212 p)].\n\nfigures 9.1, 9.2, and 9.3 depict, respectively, log l, u (p ), and i(p ), all\nas a function of p . three combinations of n and s were used in each graph.\nthese combinations correspond to p = .5, .6, and .6, respectively.\n\nd\no\no\nh\n\ni\nl\n\ni\n\ne\nk\nl\ng\no\nl\n\n \n\n\u221220\n\n\u221240\n\n\u221260\n\n\u221280\n\n\u2212100\n\n\u2212120\n\n\u2212140\n\ns=50  n=100\ns=60  n=100\ns=12  n=20\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\np\n\nfig. 9.1 log likelihood functions for three one-sample binomial problems\n\nin each case it can be seen that the value of p that makes the data most\nlikely to have occurred (the value that maximizes l or log l) is p given\nabove. also, the score function (slope of log l) is zero at p = p. note that\nthe information function i(p ) is highest for p approaching 0 or 1 and is\nlowest for p near .5, where there is maximum uncertainty about p . note\nalso that while log l has the same shape for the s = 60 and s = 12 curves\nin figure 9.1, the range of log l is much greater for the larger sample size.\nfigures 9.2 and 9.3 show that the larger sample size produces a sharper\nlikelihood. in other words, with larger n, one can zero in on the true value of\np with more precision.\n\n "}, {"Page_number": 208, "text": "184\n\n9 overview of maximum likelihood estimation\n\n600\n\n400\n\n200\n\n0\n\n\u2212200\n\n\u2212400\n\ne\nr\no\nc\ns\n\ns=50  n=100\ns=60  n=100\ns=12  n=20\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\np\n\nn=100\nn=20\n\nfig. 9.2 score functions (\u2202l/\u2202p )\n\n1200\n\n1000\n\n800\n\n600\n\n400\n\n200\n\nn\no\n\ni\nt\n\na\nm\nr\no\nn\n\nf\n\ni\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\np\nfig. 9.3 information functions (\u2212\u22022 log l/\u2202p 2)\n\nin this binary response one-sample example let us now turn to inference\nabout the parameter p . first, we turn to the estimation of the variance of the\nmle, p. an estimate of this variance is given by the inverse of the information\nat p = p:\n\n "}, {"Page_number": 209, "text": "9.2 hypothesis tests\n\nv ar(p) = i(p)\n\n\u22121 = p(1 \u2212 p)/n.\n\n185\n\n(9.6)\n\nnote that the variance is smallest when the information is greatest (p = 0\nor 1).\n\nthe variance estimate forms a basis for confidence limits on the unknown\nparameter. for large n, the mle p is approximately normally distributed\nwith expected value (mean) p and variance p (1 \u2212 p )/n. since p(1 \u2212 p) is a\nconsistent estimate of p (1 \u2212 p )/n, it follows that p \u00b1 z[p(1 \u2212 p)/n]1/2 is an\napproximate 1 \u2212 \u03b1 confidence interval for p if z is the 1 \u2212 \u03b1/2 critical value\nof the standard normal distribution.\n\n9.2 hypothesis tests\n\nnow let us turn to hypothesis tests about the unknown population parameter\np \u2014 h0 : p = p0. there are three kinds of statistical tests that arise from\nlikelihood theory.\n\n9.2.1 likelihood ratio test\n\nthis test statistic is the ratio of the likelihood at the hypothesized parameter\nvalues to the likelihood of the data at the maximum (i.e., at parameter values\n= mles). it turns out that \u22122\u00d7 the log of this likelihood ratio has desirable\nstatistical properties. the likelihood ratio test statistic is given by\n\nlr = \u22122 log(l at h0/l at mles)\n\n= \u22122(log l at h0) \u2212 [\u22122(log l at mles)].\n\n(9.7)\n\nthe lr statistic, for large enough samples, has approximately a \u03c72 distribu-\ntion with degrees of freedom equal to the number of parameters estimated, if\nthe null hypothesis is \u201csimple,\u201d that is, doesn\u2019t involve any unknown param-\neters. here lr has 1 d.f.\n\nthe value of log l at h0 is\n\nlog l(h0) = s log(p0) + (n \u2212 s) log(1 \u2212 p0).\n\nthe maximum value of log l (at mles) is\n\nlog l(p = p) = s log(p) + (n \u2212 s) log(1 \u2212 p).\n\n(9.8)\n\n(9.9)\n\n "}, {"Page_number": 210, "text": "186\n\n9 overview of maximum likelihood estimation\n\nfor the hypothesis h0 : p = p0, the test statistic is\n\nlr = \u22122{s log(p0/p) + (n \u2212 s) log[(1 \u2212 p0)/(1 \u2212 p)]}.\n\n(9.10)\n\nnote that when p happens to equal p0, lr = 0. when p is far from p0, lr will\nbe large. suppose that p0 = 1/2, so that h0 is p = 1/2. for n = 100, s = 50,\nlr = 0. for n = 100, s = 60,\n\nlr = \u22122{60 log(.5/.6) + 40 log(.5/.4)} = 4.03.\n\nfor n = 20, s = 12,\n\nlr = \u22122{12 log(.5/.6) + 8 log(.5/.4)} = .81 = 4.03/5.\n\n(9.11)\n\n(9.12)\n\ntherefore, even though the best estimate of p is the same for these two cases,\nthe test statistic is more impressive when the sample size is five times larger.\n\n9.2.2 wald test\n\nthe wald test statistic is a generalization of a t- or z-statistic. it is a function\nof the difference in the mle and its hypothesized value, normalized by an\nestimate of the standard deviation of the mle. here the statistic is\n\nw = [p \u2212 p0]2/[p(1 \u2212 p)/n].\n\n(9.13)\n\nfor large enough n, w is distributed as \u03c72 with 1 d.f. for n = 100, s = 50,\nw = 0. for the other samples, w is, respectively, 4.17 and 0.83 (note 0.83 =\n4.17/5).\n\n\u221a\n\nmany statistical packages treat\n\nw as having a t distribution instead of\na normal distribution. as pointed out by gould,228 there is no basis for this\noutside of ordinary linear modelsa.\n\n9.2.3 score test\n\nif the mle happens to equal the hypothesized value p0, p0 maximizes the\nlikelihood and so u (p0) = 0. rao\u2019s score statistic measures how far from zero\nthe score function is when evaluated at the null hypothesis. the score function\n\na in linear regression, a t distribution is used to penalize for the fact that the variance\nof y |x is estimated. in models such as the logistic model, there is no separate vari-\nance parameter to estimate. gould has done simulations that show that the normal\ndistribution provides more accurate p -values than the t for binary logistic regression.\n\n "}, {"Page_number": 211, "text": "9.2 hypothesis tests\n\n187\n\n(slope or first derivative of log l) is normalized by the information (curvature\nor second derivative of \u2212 log l). the test statistic for our example is\n\ns = u (p0)2/i(p0),\n\n(9.14)\n\nwhich formally does not involve the mle, p. the statistic can be simplified\nas follows.\n\nu (p0) = s/p0 \u2212 (n \u2212 s)/(1 \u2212 p0)\n0 + (n \u2212 s)/(1 \u2212 p0)2\ni(p0) = s/p 2\n\ns = (s \u2212 np0)2/[np0(1 \u2212 p0)] = n(p \u2212 p0)2/[p0(1 \u2212 p0)].\n\n(9.15)\n\nnote that the numerator of s involves s \u2212 np0, the difference between the\nobserved number of successes and the number of successes expected under h0.\nas with the other two test statistics, s = 0 for the first sample. for the\n\nlast two samples s is, respectively, 4 and .8 = 4/5.\n\n1\n\n9.2.4 normal distribution\u2014one sample\n\nsuppose that a sample of size n is taken from a population for a random\nvariable y that is known to be normally distributed with unknown mean\n\u03bc and variance \u03c32. denote the observed values of the random variable by\ny1, y2, . . . , yn. now unlike the binary response case (y = 0 or 1), we cannot\nuse the notion of the probability that y equals an observed value. this is\nbecause y is continuous and the probability that it will take on a given value\nis zero. we substitute the density function for the probability. the density\nat a point y is the limit as d approaches zero of\n\nprob{y < y \u2264 y + d}/d = [f (y + d) \u2212 f (y)]/d,\n\n(9.16)\n\nwhere f (y) is the normal cumulative distribution function (for a mean of \u03bc\nand variance of \u03c32). the limit of the right-hand side of the above equation as\nd approaches zero is f (y), the density function of a normal distribution with\nmean \u03bc and variance \u03c32. this density function is\n\nf (y) = (2\u03c0\u03c32)\n\n\u22121/2 exp{\u2212(y \u2212 \u03bc)2/2\u03c32}.\n\n(9.17)\n\nthe likelihood of observing the observed sample values is the joint density\nof the y s. the log likelihood function here is a function of two unknowns, \u03bc\nand \u03c32.\n\nlog l = \u2212.5n log(2\u03c0\u03c32) \u2212 .5\n\n(yi \u2212 \u03bc)2/\u03c32.\n\n(9.18)\n\nn(cid:3)\n\ni=1\n\n "}, {"Page_number": 212, "text": "188\n\n9 overview of maximum likelihood estimation\n\nn(cid:3)\n\nit can be shown that the value of \u03bc that maximizes log l is the value that min-\nimizes the sum of squared deviations about \u03bc, which is the sample mean y .\nthe mle of \u03c32 is\n\n(yi \u2212 y )2/n.\n\ns2 =\n\ni=1\n\n(9.19)\nrecall that the sample variance uses n\u2212 1 instead of n in the denominator. it\ncan be shown that the expected value of the mle of \u03c32, s2, is [(n \u2212 1)/n]\u03c32;\nin other words, s2 is too small by a factor of (n \u2212 1)/n on the average. the\nsample variance is unbiased, but being unbiased does not necessarily make\nit a better estimator. the mle has greater precision (smaller mean squared\nerror) in many cases.\n\n9.3 general case\nsuppose we need to estimate a vector of unknown parameters b = {b1, b2,\n. . . , bp} from a sample of size n based on observations y1, . . . , yn. denote the\n\nprobability or density function of the random variable y for the ith observa-\ntion by fi(y; b). the likelihood for the ith observation is li(b) = fi(yi; b).\nin the one-sample binary response case, recall that li(b) = li(p ) =\np yi [1 \u2212 p ]1\u2212yi. the likelihood function, or joint likelihood of the sample,\nis given by\n\nn(cid:8)\n\nl(b) =\n\nfi(yi; b).\n\n(9.20)\n\nthe log likelihood function is\n\ni=1\n\nn(cid:3)\n\nlog l(b) =\n\nlog li(b).\n\n(9.21)\n\ni=1\n\nthe mle of b is that value of the vector b that maximizes log l(b) as\na function of b. in general, the solution for b requires iterative trial-and-\n\nerror methods as outlined later. denote the mle of b as b = {b1, . . . , bp}.\n\nthe score vector is the vector of first derivatives of log l(b) with respect to\nb1, . . . , bp:\n\nu (b) = {\u2202/\u2202b1 log l(b), . . . , \u2202/\u2202bp log l(b)}\n\n= (\u2202/\u2202b) log l(b).\n\n(9.22)\nthe fisher information matrix is the p \u00d7 p matrix whose elements are the\nnegative of the expectation of all second partial derivatives of log l(b):\n\n\u2217\n\ni\n\n(b) = \u2212{e[(\u22022 log l(b)/\u2202bj\u2202bk)]}p\u00d7p\n\n= \u2212e{(\u22022/\u2202b\u2202b\n\n(cid:2)\n\n) log l(b)}.\n\n(9.23)\n\n "}, {"Page_number": 213, "text": "9.3 general case\n\n189\n\nthe observed information matrix i(b) is i\ntion. in other words, observed values remain in the second derivatives:\n\n(b) without taking the expecta-\n\n\u2217\n\ni(b) = \u2212(\u22022/\u2202b\u2202b\n\n(cid:2)\n\n) log l(b).\n\n(9.24)\n\nthis information matrix is often estimated from the sample using the es-\ntimated observed information i(b), by inserting b, the mle of b, into the\nformula for i(b).\n\nunder suitable conditions, which are satisfied for most situations likely\nto be encountered, the mle b for large samples is an optimal estimator\n(has as great a chance of being close to the true parameter as all other\ntypes of estimators) and has an approximate multivariate normal distribution\n\u22121\nwith mean vector b and variance\u2013covariance matrix i\n\u22121c is\ndenotes the inverse of the matrix c. (c\nthe identity matrix, a matrix with ones on the diagonal and zeros elsewhere.\nif c is a 1 \u00d7 1 matrix, c\n\u22121 = 1/c.) a consistent estimator of the variance\u2013\ncovariance matrix is given by the matrix v , obtained by inserting b for b in\ni(b) : v = i\n\n\u22121 is the matrix such that c\n\n\u2217\u22121(b), where c\n\n\u22121(b) .\n\n9.3.1 global test statistics\n\nsuppose we wish to test the null hypothesis h0 : b = b0. the likelihood\nratio test statistic is\n\nlr = \u22122 log(l at h0/l at mles)\n\n= \u22122[log l(b0) \u2212 log l(b)].\n\n(9.25)\n\nthe corresponding wald test statistic, using the estimated observed informa-\ntion matrix, is\n\nw = (b \u2212 b0)\n(cid:2)\n\ni(b)(b \u2212 b0) = (b \u2212 b0)\n(cid:2)\n\nv\n\n\u22121(b \u2212 b0).\n\n(9.26)\n\n(cid:2)\n\nv a is a matrix generalization of a2v .) note that if the\n(a quadratic form a\nnumber of estimated parameters is p = 1, w reduces to (b \u2212 b0)2/v , which\nis the square of a z- or t-type statistic (estimate \u2212 hypothesized value divided\nby estimated standard deviation of estimate).\n\nthe score statistic for h0 is\n\ns = u\n\n(cid:2)\n\n(b0)i\n\n\u22121(b0)u (b0).\n\n(9.27)\n\nnote that as before, s does not require solving for the mle. for large samples,\nlr, w , and s have a \u03c72 distribution with p d.f. under suitable conditions.\n\n "}, {"Page_number": 214, "text": "190\n\n9 overview of maximum likelihood estimation\n\n9.3.2 testing a subset of the parameters\nlet b = {b1, b2} and suppose that we wish to test h0 : b1 = b0\n1. we\nare treating b2 as a nuisance parameter. for example, we may want to test\nwhether blood pressure and cholesterol are risk factors after adjusting for\nconfounders age and sex. in that case b1 is the pair of regression coefficients\nfor blood pressure and cholesterol and b2 is the pair of coefficients for age\nand sex. b2 must be estimated to allow adjustment for age and sex, although\nb2 is a nuisance parameter and is not of primary interest.\n\nlet the number of parameters of interest be k so that b1 is a vector of\nlength k. let the number of \u201cnuisance\u201d or \u201cadjustment\u201d parameters be q, the\nlength of b2 (note k + q = p).\n\n\u2217\n2 be the mle of b2 under the restriction that b1 = b0\n\n1. then the\n\nlet b\n\nlikelihood ratio statistic is\n\nlr = \u22122[log l at h0 \u2212 log l at mle].\n\n(9.28)\n\nnow log l at h0 is more complex than before because h0 involves an unknown\nnuisance parameter b2 that must be estimated. log l at h0 is the maximum\nof the likelihood function for any value of b2 but subject to the condition\nthat b1 = b0\n\n1. thus\n\nlr = \u22122[log l(b0\n1, b\n\n2) \u2212 log l(b)],\n\u2217\n\n(9.29)\n\nwhere as before b is the overall mle of b. note that lr requires maximiz-\ning two log likelihood functions. the first component of lr is a restricted\nmaximum likelihood and the second component is the overall or unrestricted\nmaximum.\n\nlr is often computed by examining successively more complex models in\na stepwise fashion and calculating the increment in likelihood ratio \u03c72 in the\noverall model. the lr \u03c72 for testing h0 : b2 = 0 when b1 is not in the\nmodel is\n\nlr(h0 : b2 = 0|b1 = 0) = \u22122[log l(0, 0) \u2212 log l(0, b\n\n\u2217\n2)].\n\n(9.30)\n\nhere we are specifying that b1 is not in the model by setting b1 = b0\n1 = 0,\nand we are testing h0 : b2 = 0. (we are also ignoring nuisance parameters\nsuch as an intercept term in the test for b2 = 0.)\n\nthe lr \u03c72 for testing h0 : b1 = b2 = 0 is given by\n\nlr(h0 : b1 = b2 = 0) = \u22122[log l(0, 0) \u2212 log l(b)].\n\n(9.31)\n\nsubtracting lr \u03c72 for the smaller model from that of the larger model yields\n\n\u22122[log l(0, 0) \u2212 log l(b)] \u2212 \u22122[log l(0, 0) \u2212 log l(0, b2\u2217)]\n\n=\n\n(9.32)\n\n\u22122[log l(0, b\n\n2) \u2212 log l(b)],\n\u2217\n1 = 0).\n\nwhich is the same as above (letting b0\n\n "}, {"Page_number": 215, "text": "9.3 general case\n\ntable 9.1 example tests\n\n191\n\nvariables (parameters) lr \u03c72 number of\nparameters\n\nin model\n\nintercept, age\n1000\nintercept, age, age2\n1010\nintercept, age, age2, sex 1013\n\n2\n3\n4\n\nfor example, suppose successively larger models yield the lr \u03c72s in\ntable 9.1. the lr \u03c72 for testing for linearity in age (not adjusting for sex)\nagainst quadratic alternatives is 1010 \u2212 1000 = 10 with 1 d.f. the lr \u03c72\nfor testing the added information provided by sex, adjusting for a quadratic\neffect of age, is 1013\u22121010 = 3 with 1 d.f. the lr \u03c72 for testing the joint im-\nportance of sex and the nonlinear (quadratic) effect of age is 1013\u22121000 = 13\nwith 2 d.f.\n\nto derive the wald statistic for testing h0 : b1 = b0\n\n1 with b2 being a\nnuisance parameter, let the mle b be partitioned into b = {b1, b2}. we can\n\nlikewise partition the estimated variance\u2013covariance matrix v into\n\n(cid:9)\n\n(cid:10)\n\nv11 v12\n(cid:2)\n12 v22\nv\n\nv =\n\nthe wald statistic is\n\n.\n\n(9.33)\n\nw = (b1 \u2212 b0\n(cid:2)\n1)\n\n11 (b1 \u2212 b0\n\u22121\n1),\n\n(9.34)\nwhich when k = 1 reduces to (estimate \u2212 hypothesized value)2/ estimated\nvariance, with the estimates adjusted for the parameters in b2.\n\nv\n\n1, b\n\n1 . this restricted mle is b\n\nthe score statistic for testing h0 : b1 = b0\n\n1 does not require solving for\nthe full set of unknown parameters. only the mles of b2 must be computed,\n\u2217\nunder the restriction that b1 = b0\n2 from above.\n\u2217\nlet u (b0\n2) denote the vector of first derivatives of log l with respect to\nall parameters in b, evaluated at the hypothesized parameter values b0\n1 for\n\u2217\n2 for the last q parameters.\nthe first k parameters and at the restricted mle b\n(since the last q estimates are mles, the last q elements of u are zero, so\n\u2217\nthe formulas that follow simplify.) let i(b0\n2) be the observed information\nmatrix evaluated at the same values of b as is u . the score statistic for\ntesting h0 : b1 = b0\n\n1 , b\n\n1 is\n\ns = u\n\n(cid:2)\n\n(b0\n\n1 , b\n\n\u2217\n2)i\n\n\u22121(b0\n\n1 , b\n\n\u2217\n2)u (b0\n\n1 , b\n\n\u2217\n2).\n\n(9.35)\n\nunder suitable conditions, the distribution of lr, w , and s can be ade-\nquately approximated by a \u03c72 distribution with k d.f.\n\n2\n\n "}, {"Page_number": 216, "text": "192\n\n9 overview of maximum likelihood estimation\n\n9.3.3 tests based on contrasts\n\nwald tests are also done by setting up a general linear contrast. h0 : cb = 0\nis tested by a wald statistic of the form\n\n(cid:2)\nw = (cb)\n\n(cv c\n\n(cid:2)\n\n\u22121(cb),\n)\n\n(9.36)\n\nwhere c is a contrast matrix that \u201cpicks off\u201d the proper elements of b. the\ncontrasts can be much more general by allowing elements of c to be other\nthan zero and one. for the normal linear model, w is converted to an f -\nstatistic by dividing by the rank r of c (normally the number of rows in\nc), yielding a statistic with an f -distribution with r numerator degrees of\nfreedom.\n\nmany interesting contrasts are tested by forming differences in predicted\nvalues. by forming more contrasts than are really needed, one can develop\na surprisingly flexible approach to hypothesis testing using predicted values.\nthis has the major advantage of not requiring the analyst to account for how\nthe predictors are coded. suppose that one wanted to assess the difference\n\nin two vectors of predicted values, x1b \u2212 x2b = (x1 \u2212 x2)b = \u03b4b to test\nh0 : \u03b4b = 0, where \u03b4 = x1 \u2212 x2. the covariance matrix for \u03b4b is given by\n\n(cid:2)\nvar(\u03b4b) = \u03b4v \u03b4\n\n.\n\n(9.37)\n\nlet r be the rank of var(\u03b4b), i.e., the number of non-linearly-dependent\n(non-redundant) differences of predicted values of \u03b4. the value of r and the\nrows of \u03b4 that are not redundant may easily be determined using the qr\ndecomposition as done by the r function qrb. the \u03c72 statistic with r degrees\nof freedom (or f -statistic upon dividing the statistic by r) may be obtained by\n\u2217\nis the subset of elements of \u03b4 corresponding\ncomputing \u03b4\nto non-redundant contrasts and v\n\nis the corresponding sub-matrix of v .\n\n\u2217\nwhere \u03b4\n\n\u2217(cid:2)\n\n\u03b4\n\nv\n\n\u2217\n\n\u2217\n\nthe \u201cdifference in predictions\u201d approach can be used to compare means\nin a 30 year old male with a 40 year old femalec. but the true utility of\nthe approach is most obvious when the contrast involves multiple nonlinear\nterms for a single predictor, e.g., a spline function. to test for a difference\nin two curves, one can compare predictions at one predictor value against\npredictions at a series of values with at least one value that pertains to each\nbasis function. points can be placed between every pair of knots and beyond\nthe outer knots, or just obtain predictions at 100 equally spaced x-values.\n\nb for example, in a 3-treatment comparison one could examine contrasts between\ntreatments a and b, a and c, and b and c by obtaining predicted values for those\ntreatments, even though only two differences are required.\nc the\ncontrast(fit, list(sex=\u2019male\u2019,age=30),\nlist(sex=\u2019female\u2019,age=40)) where all other predictors are set to medians or\nmodes.\n\ncommand\n\ncould\n\nrms\n\nbe\n\n "}, {"Page_number": 217, "text": "9.3 general case\n\n193\n\nsuppose that there are three treatment groups (a, b, c) interacting with a\ncubic spline function of x. if one wants to test the multiple degree of freedom\nhypothesis that the profile for x is the same for treatment a and b vs. the\nalternative hypothesis that there is a difference between a and b for at least\none value of x, one can compare predicted values at treatment a and a vector\nof x values against predicted values at treatment b and the same vector of\nx values. if the x relationship is linear, any two x values will suffice, and\nif x is quadratic, any three points will suffice. it would be difficult to test\ncomplex hypotheses involving only 2 of 3 treatments using other methods.\n\nthe contrast function in rms can estimate a wide variety of contrasts and\nmake joint tests involving them, automatically computing the number of non-\nlinearly-dependent contrasts as the test\u2019s degrees of freedom. see its help file\nfor several examples.\n\n9.3.4 which test statistics to use when\n\nat this point, one may ask why three types of test statistics are needed. the\nanswer lies in the statistical properties of the three tests as well as in com-\nputational expense in different situations. from the standpoint of statistical\nproperties, lr is the best statistic, followed by s and w . the major sta-\ntistical problem with w is that it is sensitive to problems in the estimated\nvariance\u2013covariance matrix in the full model. for some models, most notably\nthe logistic regression model,278 the variance\u2013covariance estimates can be too\nlarge as the effects in the model become very strong, resulting in values of\nw that are too small (or significance levels that are too large). w is also\nsensitive to the way the parameter appears in the model. for example, a test\nof h0 : log odds ratio = 0 will yield a different value of w than will h0 :\nodds ratio = 1.\n\nrelative computational efficiency of the three types of tests is also an issue.\ncomputation of lr and w requires estimating all p unknown parameters,\nand in addition lr requires re-estimating the last q parameters under that\nrestriction that the first k parameters = b0\n1 . therefore, when one is contem-\nplating whether a set of parameters should be added to a model, the score\ntest is the easiest test to carry out. for example, if one were interested in\ntesting all two-way interactions among 4 predictors, the score test statistic\nfor h0 : \u201cno interactions present\u201d could be computed without estimating the\n4\u00d7 3/2 = 6 interaction effects. s would also be appealing for testing linearity\nof effects in a model\u2014the nonlinear spline terms could be tested for signifi-\ncance after adjusting for the linear effects (with estimation of only the linear\neffects). only parameters for linear effects must be estimated to compute\ns, resulting in fewer numerical problems such as lack of convergence of the\nnewton\u2013raphson algorithm.\n\n "}, {"Page_number": 218, "text": "194\n\n9 overview of maximum likelihood estimation\n\ntable 9.2 choice of test statistics\n\ntype of test\nglobal association\npartial association\nlack of fit, 1 d.f.\nlack of fit, > 1 d.f.\ninclusion of additional predictors\n\nrecommended test statistic\nlr (s for large no. parameters)\nw (lr or s if problem with w)\nw or s\ns\ns\n\nthe wald tests are very easy to make after all the parameters in a model\nhave been estimated. wald tests are thus appealing in a multiple regression\nsetup when one wants to test whether a given predictor or set of predic-\ntors is \u201csignificant.\u201d a score test would require re-estimating the regression\ncoefficients under the restriction that the parameters of interest equal zero.\nlikelihood ratio tests are used often for testing the global hypothesis that\nno effects are significant, as the log likelihood evaluated at the mles is al-\nready available from fitting the model and the log likelihood evaluated at\na \u201cnull model\u201d (e.g., a model containing only an intercept) is often easy to\ncompute. likelihood ratio tests should also be used when the validity of a\nwald test is in question as in the example cited above.\n\ntable 9.2 summarizes recommendations for choice of test statistics for\n\nvarious situations.\n\n9.3.5 example: binomial\u2014comparing two\n\nproportions\n\nsuppose that a binary random variable y1 represents responses for population\n1 and y2 represents responses for population 2. let pi = prob{yi = 1}\n\nand assume that a random sample has been drawn from each population\nwith respective sample sizes n1 and n2. the sample values are denoted by\nyi1, . . . , yini , i = 1 or 2. let\n\nn1(cid:3)\n\nn2(cid:3)\n\ns1 =\n\ny1j\n\ns2 =\n\ny2j,\n\nj=1\n\nj=1\n\n(9.38)\n\nthe respective observed number of \u201csuccesses\u201d in the two samples. let us test\nthe null hypothesis h0 : p1 = p2 based on the two samples.\n\nthe likelihood function is\n\n2(cid:8)\n\nni(cid:8)\n\nl =\n\ni=1\n\nj=1\n\nyij\np\ni\n\n(1 \u2212 pi)1\u2212yij\n\n "}, {"Page_number": 219, "text": "9.4 iterative ml estimation\n\n2(cid:8)\n2(cid:3)\n\ni=1\n\n=\n\nlog l =\n\ni=1\n\ni (1 \u2212 pi)ni\u2212si\np si\n\n{si log(pi) + (ni \u2212 si) log(1 \u2212 pi)}.\n\nunder h0, p1 = p2 = p , so\n\nlog l(h0) = s log(p ) + (n \u2212 s) log(1 \u2212 p ),\n\n195\n\n(9.39)\n\n(9.40)\n\n(9.41)\n\nwhere s = s1 + s2, n = n1 + n2. the (restricted) mle of this common p is\np = s/n and log l at this value is s log(p) + (n \u2212 s) log(1 \u2212 p).\n\nsince the original unrestricted log likelihood function contains two terms\nwith separate parameters, the two parts may be maximized separately giving\nmles\n\np1 = s1/n1\n\nand\n\np2 = s2/n2.\n\n(9.42)\n\nlog l evaluated at these (unrestricted) mles is\n\nlog l = s1 log(p1) + (n1 \u2212 s1) log(1 \u2212 p1)\n+ s2 log(p2) + (n2 \u2212 s2) log(1 \u2212 p2).\n\nthe likelihood ratio statistic for testing h0 : p1 = p2 is then\n\nlr = \u22122{s log(p) + (n \u2212 s) log(1 \u2212 p)\n\u2212 [s1 log(p1) + (n1 \u2212 s1) log(1 \u2212 p1)\n+ s2 log(p2) + (n2 \u2212 s2) log(1 \u2212 p2)]}.\n\n(9.43)\n\n(9.44)\n\nthis statistic for large enough n1 and n2 has a \u03c72 distribution with 1 d.f.\nsince the null hypothesis involves the estimation of one fewer parameter than\ndoes the unrestricted case. this lr statistic is the likelihood ratio \u03c72 statistic\nfor a 2 \u00d7 2 contingency table. it can be shown that the corresponding score\nstatistic is equivalent to the pearson \u03c72 statistic. the better lr statistic can\nbe used routinely over the pearson \u03c72 for testing hypotheses in contingency\ntables.\n\n9.4 iterative ml estimation\n\nin most cases, one cannot explicitly solve for mles but must use trial-and-\nerror numerical methods to solve for parameter values b that maximize\nlog l(b) or yield a score vector u (b) = 0. one of the fastest and most ap-\nplicable methods for maximizing a function is the newton\u2013raphson method,\nwhich is based on approximating u (b) by a linear function of b in a small\n\n "}, {"Page_number": 220, "text": "196\n\n9 overview of maximum likelihood estimation\n\nregion. a starting estimate b0 of the mle b is made. the linear approximation\n(a first-order taylor series approximation)\n\nu (b) = u (b0) \u2212 i(b0)(b \u2212 b0)\n\nis equated to 0 and solved by b yielding\n\nb = b0 + i\n\n\u22121(b0)u (b0).\n\n(9.45)\n\n(9.46)\n\nthe process is continued in like fashion. at the ith step the next estimate is\nobtained from the previous estimate using the formula\n\nbi+1 = bi + i\n\n\u22121(bi)u (bi).\n\n(9.47)\n\nif the log likelihood actually worsened at bi+1, \u201cstep halving\u201d is used; bi+1\nis replaced with (bi + bi+1)/2. further step halving is done if the log like-\nlihood still is worse than the log likelihood at bi, after which the original\niterative strategy is resumed. the newton\u2013raphson iterations continue until\nthe \u22122 log likelihood changes by only a small amount over the previous iter-\nation (say .025). the reasoning behind this stopping rule is that estimates of\nb that change the \u22122 log likelihood by less than this amount do not affect\nstatistical inference since \u22122 log likelihood is on the \u03c72 scale.\n\n9.5 robust estimation of the covariance matrix\n\nthe estimator for the covariance matrix of b found in section 9.3 assumes that\nthe model is correctly specified in terms of distribution, regression assump-\ntions, and independence assumptions. the model may be incorrect in a va-\nriety of ways such as non-independence (e.g., repeated measurements within\nsubjects), lack of fit (e.g., omitted covariable, incorrect covariable transfor-\nmation, omitted interaction), and distributional (e.g., y has a \u03b3 distribution\ninstead of a normal distribution). variances and covariances, and hence con-\nfidence intervals and wald tests, will be incorrect when these assumptions\nare violated.\n\n3\n\nfor the case in which the observations are independent and identically\ndistributed but other assumptions are possibly violated, huber312 provided\na covariance matrix estimator that is consistent. his \u201csandwich\u201d estimator is\ngiven by\n\nn(cid:3)\n\nh = i\n\n\u22121(b)[\n\n(cid:2)\ni ]i\n\n\u22121(b),\n\nuiu\n\n(9.48)\n\ni=1\n\nwhere i(b) is the observed information matrix (equation 9.24) and ui is the\nvector of derivatives, with respect to all parameters, of the log likelihood\ncomponent for the ith observation (assuming the log likelihood can be par-\ntitioned into per-observation contributions). for the normal multiple linear\nregression case, h was derived by white:659\n\n "}, {"Page_number": 221, "text": "9.5 robust estimation of the covariance matrix\n\nn(cid:3)\n\n(cid:2)\n\n\u22121[\n\nx)\n\n(x\n\n(yi \u2212 xib)2xix\n\n(cid:2)\n\n(cid:2)\ni](x\n\n\u22121,\n\nx)\n\n197\n\n(9.49)\n\nc(cid:3)\n\nni(cid:3)\n{(\n\nni(cid:3)\n\ni=1\n\nwhere x is the design matrix (including an intercept if appropriate) and xi\nis the vector of predictors (including an intercept) for the ith observation.\nthis covariance estimator allows for any pattern of variances of y |x across\nobservations. note that even though h improves the bias of the covariance\nmatrix of b, it may actually have larger mean squared error than the ordinary\nestimate in some cases due to increased variance.164, 529\n\nwhen observations are dependent within clusters, and the number of ob-\nservations within clusters is very small in comparison to the total sample\nsize, a simple adjustment to equation 9.48 can be used to derive appro-\npriate covariance matrix estimates (see lin [407, p. 2237], rogers,529 and\nlee et al. [393, eq. 5.1, p. 246]). one merely accumulates sums of elements of\nu within clusters before computing cross-product terms:\n\nhc = i\n\n\u22121(b)[\n\nuij)(\n\n(cid:2)}]i\n\nuij)\n\n\u22121(b),\n\n(9.50)\n\ni=1\n\nj=1\n\nj=1\n\nwhere c is the number of clusters, ni is the number of observations in the ith\ncluster, uij is the contribution of the jth observation within the ith cluster to\nthe score vector, and i(b) is computed as before ignoring clusters. for a model\nsuch as the cox model which has no per-observation score contributions,\nspecial score residuals393, 407, 410, 605 are used for u .\n\nbootstrapping can also be used to derive robust covariance matrix esti-\nmates177, 178 in many cases, especially if covariances of b that are not condi-\ntional on x are appropriate. one merely generates approximately 200 samples\nwith replacement from the original dataset, computes 200 sets of parameter\nestimates, and computes the sample covariance matrix of these parameter es-\ntimates. sampling with replacement from entire clusters can be used to derive\nintracluster correlation.188 bootstrap\nvariance estimates in the presence of\nestimates of the conditional variance\u2013covariance matrix given x are harder\nto obtain and depend on the model assumptions being satisfied. the simpler\nunconditional estimates may be more appropriate for many non-experimental\nstudies where one may desire to \u201cpenalize\u201d for the x being random variables.\nit is interesting that these unconditional estimates may be very difficult to ob-\ntain parametrically, since a multivariate distribution may need to be assumed\nfor x.\n\nthe previous discussion addresses the use of a \u201cworking independence\nmodel\u201d with clustered data. here one estimates regression coefficients assum-\ning independence of all records (observations). then a sandwich or bootstrap\nmethod is used to increase standard errors to reflect some redundancy in the\ncorrelated observations. the parameter estimates will often be consistent es-\ntimates of the true parameter values, but they may be inefficient for certain\ncluster or correlation structures.\n\n4\n\n5\n\n6\n\n "}, {"Page_number": 222, "text": "7\n\n198\n\n9 overview of maximum likelihood estimation\n\nthe rms package\u2019s robcov function computes the huber robust covariance\nmatrix estimator, and the bootcov function computes the bootstrap covariance\nestimator. both of these functions allow for clustering.\n\n9.6 wald, score, and likelihood-based confidence\n\nintervals\n\na 1 \u2212 \u03b1 confidence interval for a parameter \u03b2i is the set of all values \u03b20\ni\nthat if hypothesized would be accepted in a test of h0 : \u03b2i = \u03b20\ni at the\n\u03b1 level. what test should form the basis for the confidence interval? the\nwald test is most frequently used because of its simplicity. a two-sided 1\u2212 \u03b1\nconfidence interval is bi\u00b1z1\u2212\u03b1/2s, where z is the critical value from the normal\n\ndistribution and s is the estimated standard error of the parameter estimate\nbi.d the problem with s discussed in section 9.3.4 points out that wald\nstatistics may not always be a good basis. wald-based confidence intervals are\nalso symmetric even though the coverage probability may not be.160 score-\nand lr-based confidence limits have definite advantages. when wald-type\nconfidence intervals are appropriate, the analyst may consider insertion of\nrobust covariance estimates (section 9.5) into the confidence interval formulas\n(note that adjustments for heterogeneity and correlated observations are not\navailable for score and lr statistics).\n\nwald\u2013 (asymptotic normality) based statistics are convenient for deriving\nconfidence intervals for linear or more complex combinations of the model\u2019s\nparameters. as in equation 9.36, the variance\u2013covariance matrix of cb, where\nc is an appropriate matrix and b is the vector of parameter estimates, is\n, where v is the variance matrix of b. in regression models we commonly\ncv c\nsubstitute a vector of predictors (and optional intercept) for c to obtain the\nvariance of the linear predictor xb as\n\n(cid:2)\n\nvar(xb) = xv x\n\n(cid:2)\n\n.\n\n(9.51)\n\nsee section 9.3.3 for related information.\n\nd this is the basis for confidence limits computed by the r rms package\u2019s predict,\nsummary, and contrast functions. when the robcov function has been used to replace\nthe information-matrix-based covariance matrix with a huber robust covariance esti-\nmate with an optional cluster sampling correction, the functions are using a \u201crobust\u201d\nwald statistic basis. when the bootcov function has been used to replace the model\nfit\u2019s covariance matrix with a bootstrap unconditional covariance matrix estimate,\nthe two functions are computing confidence limits based on a normal distribution but\nusing more nonparametric covariance estimates.\n\n "}, {"Page_number": 223, "text": "9.7 bootstrap confidence regions\n\n199\n\n9.6.1 simultaneous wald confidence regions\n\nthe confidence intervals just discussed are pointwise confidence intervals.\nfor ols regression there are methods for computing confidence intervals\nwith exact simultaneous confidence coverage for multiple estimates374. there\nare approximate methods for simultaneous confidence limits for all models\nfor which the vector of estimates b is approximately multivariately normally\ndistributed. the method of hothorn et al.307 is quite general; in their r\npackage multcomp\u2019s glht function, the user can specify any contrast matrix over\nwhich the individual confidence limits will be simultaneous. a special case\nof a contrast matrix is the design matrix x itself, resulting in simultaneous\nconfidence bands for any number of predicted values. an example is shown\nin figure 9.5. see section 9.3.3 for a good use for simultaneous contrasts.\n\n9.7 bootstrap confidence regions\n\na more nonparametric method for computing confidence intervals for func-\ntions of the vector of parameters b can be based on bootstrap percentile\nconfidence limits. for each sample with replacement from the original dataset,\none computes the mle of b, b, and then the quantity of interest g(b). then\nthe gs are sorted and the desired quantiles are computed. at least 1000 boot-\nstrap samples will be needed for accurate assessment of outer confidence\nlimits. this method is suitable for obtaining pointwise confidence bands for\na nonlinear regression function, say, the relationship between age and the log\nodds of disease. at each of 100 age values the predicted logits are computed\nfor each bootstrap sample. then separately for each age point the 0.025 and\n0.975 quantiles of 1000 estimates of the logit are computed to derive a 0.95\nconfidence band. other more complex bootstrap schemes will achieve some-\nwhat greater accuracy of confidence interval coverage,178 and as described\nin section 9.5 one can use variations on the basic bootstrap in which the\npredictors are considered fixed and/or cluster sampling is taken into account.\nthe r function bootcov in the rms package bootstraps model fits to obtain\nunconditional (with respect to predictors) bootstrap distributions with or\nwithout cluster sampling. bootcov stores the matrix of bootstrap regression\ncoefficients so that the bootstrapped quantities of interest can be computed\nin one sweep of the coefficient matrix once bootstrapping is completed.\n\nfor many regression models. the rms package\u2019s predict, summary, and\ncontrast functions make it easy to compute pointwise bootstrap confidence\nintervals in a variety of contexts. as an example, consider 200 simulated\nx values from a log-normal distribution and simulate binary y from a true\npopulation binary logistic model given by\n\n8\n\n9\n\n "}, {"Page_number": 224, "text": "200\n\n9 overview of maximum likelihood estimation\n\nprob(y = 1|x = x) =\n\n1\n\n1 + exp[\u2212(1 + x/2)]\n\n.\n\n(9.52)\n\nnot knowing the true model, a quadratic logistic model is fitted. the r code\nneeded to generate the data and fit the model is given below.\n\nrequire ( rms )\n\nset.seed (15)\n\nn \u2190 200\nx1 \u2190 rnorm ( n )\nlogit \u2190 x1 / 2\ny \u2190 ifelse ( runif ( n ) \u2264 plogis ( logit ), 1, 0)\ndd \u2190 datadist ( x1 );\noptions ( datadist = ' dd ' )\nf \u2190 lrm ( y \u223c pol ( x1 ,2) , x = true , y = true )\n\nprint (f , latex = true )\n\nlogistic regression model\n\nlrm(formula = y ~ pol(x1, 2), x = true, y = true)\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\nmax| \u2202 log l\n\n\u2202\u03b2 | 3\u00d710\n\n16.37 r2\n\n200 lr \u03c72\n97 d.f.\n2 g\n103 pr(> \u03c72) 0.0003 gr\n\u22129\ngp\nbrier\n\n0.105 c\n0.680 dxy\n1.973 \u03b3\n0.156 \u03c4a\n0.231\n\n0.642\n0.285\n0.286\n0.143\n\ncoef\n\nintercept -0.0842 0.1823\n0.5902 0.1580\nx1\nx12\n0.1557 0.1136\n\ns.e. wald z pr(> |z|)\n0.6441\n0.0002\n0.1708\n\n-0.46\n3.74\n1.37\n\nlatex ( anova ( f ), file = ' ' , table.env = false )\n\n\u03c72 d.f.\n\np\n\nx1\n\n13.99\nnonlinear 1.88\n13.99\n\ntotal\n\n2 0.0009\n1 0.1708\n2 0.0009\n\nthe bootcov function is used to draw 1000 resamples to obtain bootstrap\nestimates of the covariance matrix of the regression coefficients as well as\nto save the 1000 \u00d7 3 matrix of regression coefficients. then, because indi-\nvidual regression coefficients for x do not tell us much, we summarize the\n\n "}, {"Page_number": 225, "text": "9.7 bootstrap confidence regions\n\n201\n\nx-effect by computing the effect (on the logit scale) of increasing x from 1\nto 5. we first compute bootstrap nonparametric percentile confidence inter-\nvals the long way. the 1000 bootstrap estimates of the log odds ratio are\ncomputed easily using a single matrix multiplication with the difference in\npredictions approach, multiplying the difference in two design matrices, and\nwe obtain the bootstrap estimate of the standard error of the log odds ratio\nby computing the sample standard deviation of the 1000 valuese. bootstrap\npercentile confidence limits are just sample quantiles from the bootstrapped\nlog odds ratios.\n\n# get 2 -row d e s i g n m a t r i x for o b t a i n i n g p r e d i c t e d v a l u e s\n# for x = 1 and 5\n\nx \u2190 cbind ( intercept =1 ,\nxdif \u2190 x [2 , , drop = false ] - x [1 , , drop = false ]\n\npredict (f , data.frame ( x1 = c (1 ,5)) , type = ' x ' ))\n\nxdif\n\ni n t e r c e p t pol ( x1 , 2) x1 pol ( x1 , 2) x1\n\n2\n\n0\n\n4\n\n\u2227\n\n2\n24\n\nb \u2190 bootcov (f , b =1000)\nboot.log.od d s. ra t io \u2190 b $ boot.coef % * % t ( xdif )\n\nsd ( boot.log.od d s. ra ti o )\n\n[1] 2.752103\n\n# this is the same as from s u m m a r y ( b , x = c (1 ,5)) as s u m m a r y\n# uses the b o o t s t r a p c o v a r i a n c e m a t r i x\nsummary (b , x1 = c (1 ,5))[1 , ' s.e. ' ]\n\n[1] 2.752103\n\n# c o m p a r e this s.d. with one from i n f o r m a t i o n m a t r i x\nsummary (f , x1 = c (1 ,5))[1 , ' s.e. ' ]\n\n[1] 2.988373\n\n# c o m p u t e p e r c e n t i l e s of b o o t s t r a p odds r a t i o\nexp ( quantile ( boot.log.odds.ratio , c ( .025 , .975 )))\n\n97.5%\n2.795032 e +00 2.067146 e +05\n\n2.5%\n\n# a u t o m a t i c :\nsummary (b , x1 = c (1 ,5))[ ' odds ratio ' ,]\n\ne as indicated below, this standard deviation can also be obtained by using the\nsummary function on the object returned by bootcov, as bootcov returns a fit object\nlike one from lrm except with the bootstrap covariance matrix substituted for the\ninformation-based one.\n\n "}, {"Page_number": 226, "text": "202\n\n9 overview of maximum likelihood estimation\n\neffect\n1.000000 e +00 5.000000 e +00 4.000000 e +00 4.443932 e +02\n\ndiff .\n\nhigh\n\nlow\n\ns . e .\nna\n\nlower 0.95\n\ntype\n2.795032 e +00 2.067146 e +05 2.000000 e +00\n\nupper 0.95\n\nprint ( contrast (b , list ( x1 =5) , list ( x1 =1) , fun = exp ))\n\ncontrast\n\ns . e .\n\nlower\n\nupper\n\n11\n\n6.09671 2.752103 1.027843 12.23909 2.22\n\nz pr ( >| z |)\n0.0267\n\nc o n f i d e n c e i n t e r v a l s are 0.95 b o o t s t r a p n o n p a r a m e t r i c p e r c e n t i l e i n t e r v a l s\n\n# f i g u r e 9.4\nhist ( boot.log.odds.ratio , nclass =100 , xlab = ' log ( or ) ' ,\n\nmain = ' ' )\n\n40\n\n30\n\n20\n\n10\n\n0\n\ny\nc\nn\ne\nu\nq\ne\nr\nf\n\n0\n\n5\n\n10\n\n15\n\nlog(or)\n\nfig. 9.4 distribution of 1000 bootstrap x=1:5 log odds ratios\n\nfigure 9.4 shows the distribution of log odds ratios.\n\nnow consider confidence bands for the true log odds that y = 1, across\na sequence of x values. the predict function automatically calculates point-\nby-point bootstrap percentiles, basic bootstrap, or bca203 confidence limits\nwhen the fit has passed through bootcov. simultaneous wald-based confi-\ndence intervals307 and wald intervals substituting the bootstrap covariance\nmatrix estimator are added to the plot when predict calls the multcomp pack-\nage (figure 9.5).\nx1s \u2190 seq (0 , 5, length =100)\n\npwald\npsand\n\n\u2190 predict (f , x1 = x1s )\n\u2190 predict ( robcov ( f ), x1 = x1s )\n\npbootcov \u2190 predict (b , x1 = x1s , usebootcoef = false )\npbootnp \u2190 predict (b , x1 = x1s )\npbootbca \u2190 predict (b , x1 = x1s , boot.type = ' bca ' )\npbootbas \u2190 predict (b , x1 = x1s , boot.type = ' basic ' )\npsimult \u2190 predict (b , x1 = x1s , conf.type = ' simultaneous ' )\n\n "}, {"Page_number": 227, "text": "9.8 further use of the log likelihood\n\n203\n\nz \u2190 rbind ( ' boot percentile '\n= pbootnp ,\n' robust sandwich '\n= psand ,\n' boot bca '\n= pbootbca ,\n' boot covariance + wald ' = pbootcov ,\nwald\n' boot basic '\nsimultaneous\n\n= pwald ,\n= pbootbas ,\n= psimult )\n\nz $ class \u2190 ifelse ( z $ .set. % in % c ( ' boot percentile ' , ' boot bca ' ,\nggplot (z , groups = c ( ' .set. ' , ' class ' ),\n\n' boot basic ' ), ' other ' , ' wald ' )\n\nconf = ' line ' , ylim = c (-1 , 9) , legend.label = false )\n\nsee problems at chapter\u2019s end for a worrisome investigation of bootstrap con-\nfidence interval coverage using simulation. it appears that when the model\u2019s\nlog odds distribution is not symmetric and includes very high or very low\nprobabilities, neither the bootstrap percentile nor the bootstrap bca inter-\nvals have good coverage, while the basic bootstrap and ordinary wald in-\ntervals are fairly accuratef. it is difficult in general to know when to trust\nthe bootstrap for logistic and perhaps other models when computing confi-\ndence intervals, and the simulation problem suggests that the basic bootstrap\nshould be used more frequently. similarly, the distribution of bootstrap effect\nestimates can be suspect. asymmetry in this distribution does not imply that\nthe true sampling distribution is asymmetric or that the percentile intervals\nare preferred.\n\n9.8 further use of the log likelihood\n\n9.8.1 rating two models, penalizing for complexity\n\nsuppose that from a single sample two competing models were developed. let\n\nthe respective \u22122 log likelihoods for these models be denoted by l1 and l2,\nand let p1 and p2 denote the number of parameters estimated in each model.\nsuppose that l1 < l2. it may be tempting to rate model one as the \u201cbest\u201d\nfitting or \u201cbest\u201d predicting model. that model may provide a better fit for\nthe data at hand, but if it required many more parameters to be estimated,\nit may not be better \u201cfor the money.\u201d if both models were applied to a new\nsample, model one\u2019s overfitting of the original dataset may actually result in\na worse fit on the new dataset.\n\nf limited simulations using the conditional bootstrap and firth\u2019s penalized likeli-\nhood281 did not show significant improvement in confidence interval coverage.\n\n "}, {"Page_number": 228, "text": "204\n\n9 overview of maximum likelihood estimation\n\ns\nd\nd\no\n\n \n\ng\no\n\nl\n\n7.5\n\n5.0\n\n2.5\n\n0.0\n\n.set.\n\nboot percentile\n\nrobust sandwich\n\nboot bca\n\nboot covariance+wald\n\nwald\n\nboot basic\n\nsimultaneous\n\nother\n\nwald\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nx1\n\nfig. 9.5 predicted log odds and confidence bands for seven types of confidence in-\ntervals. seven categories are ordered top to bottom corresponding to order of lower\nconfidence bands at x1=5. dotted lines are for wald\u2013type methods that yield sym-\nmetric confidence intervals and assume normality of point estimators.\n\nakaike\u2019s information criterion (aic33, 359, 633) provides a method for pe-\nnalizing the log likelihood achieved by a given model for its complexity to\nobtain a more unbiased assessment of the model\u2019s worth. the penalty is\nto subtract the number of parameters estimated from the log likelihood, or\nequivalently to add twice the number of parameters to the \u22122 log likelihood.\nthe penalized log likelihood is analogous to mallows\u2019 cp in ordinary multiple\nregression. aic would choose the model by comparing l1 + 2p1 to l2 + 2p2\nand picking the model with the lower value. we often use aic in \u201cadjusted\n\u03c72\u201d form:\n\naic = lr \u03c72 \u2212 2p.\n\n(9.53)\n\nbreiman [66, section 1.3] and chatfield [100, section 4] discuss the fallacy of\naic and cp for selecting from a series of non-prespecified models.\n\n9.8.2 testing whether one model is better\n\nthan another\n\none way to test whether one model (a) is better than another (b) is to\nembed both models in a more general model (a + b). then a lr \u03c72 test\n\n10\n\n11\n\n "}, {"Page_number": 229, "text": "9.8 further use of the log likelihood\n\n205\n\ncan be done to test whether a is better than b by changing the hypothesis\nto test whether a adds predictive information to b (h0 : a + b > b) and\nwhether b adds information to a (h0 : a + b > a). the approach of testing\na > b via testing a + b > b and a + b > a is especially useful for selecting\nfrom competing predictors such as a multivariable model and a subjective\nassessor.131, 264, 395, 669\n\nnote that lr \u03c72 for h0 : a + b > b minus lr \u03c72 for h0 : a + b > a\nequals lr \u03c72 for h0 : a has no predictive information minus lr \u03c72 for\nh0 : b has no predictive information,665 the difference in lr \u03c72 for testing\neach model (set of variables) separately. this gives further support to the use\nof two separately computed akaike\u2019s information criteria for rating the two\nsets of variables.\n\nsee section 9.8.4 for an example.\n\n9.8.3 unitless index of predictive ability\n\nthe global likelihood ratio test for regression is useful for determining whether\nany predictor is associated with the response. if the sample is large enough,\neven weak associations can be \u201cstatistically significant.\u201d even though a like-\nlihood ratio test does not shed light on a model\u2019s predictive strength, the log\nlikelihood (l.l.) can still be useful here. consider the following l.l.s:\nbest (lowest) possible \u22122 l.l.:\n\n= \u22122 l.l. for a hypothetical model that perfectly predicts the outcome.\n\nl\n\n\u2217\n\n\u22122 l.l. achieved:\n\nl = \u22122 l.l. for the fitted model.\n\nworst \u22122 l.l.:\n\nl0 = \u22122 l.l. for a model that has no predictive information.\n\nthe last \u22122 l.l., for a \u201cno information\u201d model, is the \u22122 l.l. under the null\nhypothesis that all regression coefficients except for intercepts are zero. a \u201cno\ninformation\u201d model often contains only an intercept and some distributional\nparameters (a variance, for example).\nthe quantity l0 \u2212 l is lr, the log likelihood ratio statistic for testing\nthe global null hypothesis that no predictors are related to the response. it\nis also the \u22122 log likelihood \u201cexplained\u201d by the model. the best (lowest) \u22122\n, so the amount of l.l. that is capable of being explained by the\nl.l. is l\nmodel is l0\u2212 l\n. the fraction of \u22122 l.l. explained that was capable of being\nexplained is\n(l0 \u2212 l)/(l0 \u2212 l\n\n) = lr/(l0 \u2212 l\n\n(9.54)\n\n).\n\n\u2217\n\n\u2217\n\n\u2217\n\n\u2217\n\n12\n\n13\n\n "}, {"Page_number": 230, "text": "206\n\n9 overview of maximum likelihood estimation\n\nthe fraction of log likelihood explained is analogous to r2 in an ordinary\nlinear model, although korn and simon365, 366 provide a much more precise\nnotion.\n\nakaike\u2019s information criterion can be used to penalize this measure of\nassociation for the number of parameters estimated (p, say) to transform\nthis unitless measure of association into a quantity that is analogous to the\nadjusted r2 or mallows\u2019 cp in ordinary linear regression. we let r denote\nthe square root of such a penalized fraction of log likelihood explained. r is\ndefined by\n\nr2 = (lr \u2212 2p)/(l0 \u2212 l\n\n\u2217\n\n).\n\n(9.55)\n\n\u2217\n\nlimit will be near one if the sample size is large.\n\nthe r index can be used to assess how well the model compares with a\n\u201cperfect\u201d model, as well as to judge whether a more complex model has pre-\ndictive strength that justifies its additional parameters. had p been used in\nequation 9.55 rather than 2p, r2 is negative if the log likelihood explained\nis less than what one would expect by chance. r will be the square root of\n1 \u2212 2p/(l0 \u2212 l\n) if the model perfectly predicts the response. this upper\npartial r indexes can also be defined by substituting the \u22122 l.l. explained\nfor a given factor in place of that for the entire model, lr. the \u201cpenalty\nfactor\u201d p becomes one. this index rpartial is defined by\npartial = (lrpartial \u2212 2)/(l0 \u2212 l\n\u2217\nr2\n\n(9.56)\nwhich is the (penalized) fraction of \u22122 log likelihood explained by the pre-\ndictor. here lrpartial is the log likelihood ratio statistic for testing whether\nthe predictor is associated with the response, after adjustment for the other\npredictors. since such likelihood ratio statistics are tedious to compute, the\n1 d.f. wald \u03c72 can be substituted for the lr statistic (keeping in mind that\ndifficulties with the wald statistic can arise).\n\n),\n\nliu and dyer424 and cox and wermuth136 point out difficulties with the\nr2 measure for binary logistic models. cox and snell135 and magee432 used\nother analogies to derive other r2 measures that may have better properties.\nfor a sample of size n and a wald statistic for testing overall association,\nthey defined\n\nw\n\nr2\nw =\nlr = 1 \u2212 exp(\u2212lr/n)\nr2\n\nn + w\n\n= 1 \u2212 \u03bb2/n,\n\n(9.57)\n\nwhere \u03bb is the null model likelihood divided by the fitted model likelihood. in\nthe case of ordinary least squares with normality both of the above indexes\nare equal to the traditional r2. r2\nlr is equivalent to maddala\u2019s index [431,\neq. 2.44]. cragg and uhler137 and nagelkerke471 suggested dividing r2\nlr by\n\n "}, {"Page_number": 231, "text": "9.8 further use of the log likelihood\n\nits maximum attainable value\n\nmax = 1 \u2212 exp(\u2212l0/n)\nr2\n\n207\n\n(9.58)\n\nto derive r2\nuse throughout.\n\nn which ranges from 0 to 1. this is the form of the r2 index we\n\nfor penalizing for overfitting, see verweij and van houwelingen640 for an\n\noverfitting-corrected r2 that uses a cross-validated likelihood.\n\n14\n\n9.8.4 unitless index of adequacy of a subset\n\nof predictors\n\nlog likelihoods are also useful for quantifying the predictive information con-\ntained in a subset of the predictors compared with the information contained\nin the entire set of predictors.264 let lr again denote the \u22122 log likelihood\nratio statistic for testing the joint significance of the full set of predictors. let\nlrs denote the \u22122 log likelihood ratio statistic for testing the importance of\nthe subset of predictors of interest, excluding the other predictors from the\nmodel. a measure of adequacy of the subset for predicting the response is\ngiven by\n\na = lrs/lr.\n\n(9.59)\n\na is then the proportion of log likelihood explained by the subset with refer-\nence to the log likelihood explained by the entire set. when a = 1, the subset\ncontains all the predictive information found in the whole set of predictors;\nthat is, the subset is adequate by itself and the additional predictors contain\nno independent information. when a = 0, the subset contains no predictive\ninformation by itself.\n\ncaliff et al.89 used the a index to quantify the adequacy (with respect to\nprognosis) of two competing sets of predictors that each describe the extent of\ncoronary artery disease. the response variable was time until cardiovascular\ndeath and the statistical model used was the cox132 proportional hazards\nmodel. some of their results are reproduced in table 9.3. a chance-corrected\nadequacy measure could be derived by squaring the ratio of the r-index for\nthe subset to the r-index for the whole set. a formal test of superiority of\nx1 = maximum % stenosis over x2 = jeopardy score can be obtained by\ntesting whether x1 adds to x2 (lr \u03c72 = 57.5 \u2212 42.6 = 14.9) and whether\nx2 adds to x1 (lr \u03c72 = 57.5\u2212 51.8 = 5.7). x1 adds more to x2 (14.9) than\nx2 adds to x1 (5.7). the difference 14.9 \u2212 5.7 = 9.2 equals the difference in\nsingle factor \u03c72 (51.8 \u2212 42.6)665.\n\n15\n\n "}, {"Page_number": 232, "text": "208\n\n9 overview of maximum likelihood estimation\n\ntable 9.3 completing prognostic markers\n\nlr \u03c72 adequacy\npredictors used\ncoronary jeopardy score\n42.6\nmaximum % stenosis in each artery 51.8\ncombined\n57.5\n\n0.74\n0.90\n1.00\n\n9.9 weighted maximum likelihood estimation\n\nn(cid:8)\n\nl =\n\ni=1\n\nit is commonly the case that data elements represent combinations of values\nthat pertain to a set of individuals. this occurs, for example, when unique\ncombinations of x and y are determined from a massive dataset, along with\nthe frequency of occurrence of each combination, for the purpose of reducing\nthe size of the dataset to analyze. for the ith combination we have a case\nweight wi that is a positive integer representing a frequency. assuming that\nobservations represented by combination i are independent, the likelihood\nneeded to represent all wi observations is computed simply by multiplying\nall of the likelihood elements (each having value li), yielding a total likeli-\nhood contribution for combination i of lwi\nor a log likelihood contribution\ni\nof wi log li. to obtain a likelihood for the entire dataset one computes the\nwi log li. as an\nproduct over all combinations. the total log likelihood is\nexample, the weighted likelihood that would be used to fit a weighted logistic\nregression model is given by\n\n(cid:2)\n\np wiyi\ni\n\n(1 \u2212 pi)wi(1\u2212yi),\n(cid:2)n\ni=1 wi > n, and pi is prob[yi = 1|xi] as\n\n(9.60)\n\nwhere there are n combinations,\ndictated by the model. note that in general the correct likelihood function\ncannot be obtained by weighting the data and using an unweighted likelihood.\nby a small leap one can obtain weighted maximum likelihood estimates\nfrom the above method even if the weights do not represent frequencies or\neven integers, as long as the weights are non-negative. non-frequency weights\nare commonly used in sample surveys to adjust estimates back to better\nrepresent a target population when some types of subjects have been over-\nsampled from that population. analysts should beware of possible losses in\nefficiency when obtaining weighted estimates in sample surveys.363, 364 mak-\ning the regression estimates conditional on sampling strata by including strata\nas covariables may be preferable to re-weighting the strata. if weighted esti-\nmates must be obtained, the weighted likelihood function is generally valid\nfor obtaining properly weighted parameter estimates. however, the variance\u2013\ncovariance matrix obtained by inverting the information matrix from the\nweighted likelihood will not be correct in general. for one thing, the sum of\nthe weights may be far from the number of subjects in the sample. a rough\n\n "}, {"Page_number": 233, "text": "9.10 penalized maximum likelihood estimation\n\n209\n\napproximation to the variance\u2013covariance matrix may be obtained by first\nwi and then computing the weighted in-\nmultiplying each weight by n/\nformation matrix, where n is the number of actual subjects in the sample.\n\n(cid:2)\n\n9.10 penalized maximum likelihood estimation\n\nmaximizing the log likelihood provides the best fit to the dataset at hand,\nbut this can also result in fitting noise in the data. for example, a categor-\nical predictor with 20 levels can produce extreme estimates for some of the\n19 regression parameters, especially for the small cells (see section 4.5). a\nshrinkage approach will often result in regression coefficient estimates that\nwhile biased are lower in mean squared error and hence are more likely to be\nclose to the true unknown parameter values. ridge regression is one approach\nto shrinkage, but a more general and better developed approach is penalized\nmaximum likelihood estimation,237, 388, 639, 641 which is really a special case\nof bayesian modeling with a gaussian prior. letting l denote the usual like-\nlihood function and \u03bb be a penalty factor, we maximize the penalized log\nlikelihood given by\n\n(si\u03b2i)2,\n\n(9.61)\n\np(cid:3)\n\ni=1\n\nlog l \u2212 1\n2\n\n\u03bb\n\nwhere s1, s2, . . . , sp are scale factors chosen to make si\u03b2i unitless. most au-\nthors standardize the data first and do not have scale factors in the equation,\nbut equation 9.61 has the advantage of allowing estimation of \u03b2 on the orig-\ninal scale of the data. the usual methods (e.g., newton\u2013raphson) are used\nto maximize 9.61.\n\nthe choice of the scaling constants has received far too little attention in\nthe ridge regression and penalized mle literature. it is common to use the\nstandard deviation of each column of the design matrix to scale the corre-\nsponding parameter. for models containing nothing but continuous variables\nthat enter the regression linearly, this is usually a reasonable approach. for\ncontinuous variables represented with multiple terms (one of which is lin-\n(cid:7)\near), it is not always reasonable to scale each nonlinear term with its own\nstandard deviation. for dummy variables, scaling using the standard devia-\nd(1 \u2212 d), where d is the mean of the dummy variable, i.e., the frac-\ntion (\ntion of observations in that cell) is problematic since this will result in high\nprevalance cells getting more shrinkage than low prevalence ones because the\nhigh prevalence cells will dominate the penalty function.\n\nan advantage of the formulation in equation 9.61 is that one can assign\nscale constants of zero for parameters for which no shrinkage is desired.237, 639\nfor example, one may have prior beliefs that a linear additive model will fit\nthe data. in that case, nonlinear and non-additive terms may be penalized.\n\n16\n\n17\n\n18\n\n "}, {"Page_number": 234, "text": "210\n\n9 overview of maximum likelihood estimation\n\n2 + \u03b22\n\nfor a categorical predictor having c levels, users of ridge regression often do\nnot recognize that the amount of shrinkage and the predicted values from the\nfitted model depend on how the design matrix is coded. for example, one will\nget different predictions depending on which cell is chosen as the reference\ncell when constructing dummy variables. the setup in equation 9.61 has the\nsame problem. for example, if for a three-category factor we use category 1\nas the reference cell and have parameters \u03b22 and \u03b23, the unscaled penalty\n(cid:2)c\nfunction is \u03b22\n3. if category 3 were used as the reference cell instead, the\n3 + (\u03b22 \u2212 \u03b23)2. to get around this problem, verweij and\npenalty would be \u03b22\ni (\u03b2i \u2212 \u03b2)2, where\nvan houwelingen639 proposed using the penalty function\n\u03b2 is the mean of all c \u03b2s. this causes shrinkage of all parameters toward\nthe mean parameter value. letting the first category be the reference cell,\n\n\u2212 \u03b22\u03b23]/3. for c = 2 the penalty is \u03b22\n\nwe use c \u2212 1 dummy variables and define \u03b21 \u2261 0. for the case c = 3 the\n\u221a\nsum of squares is 2[\u03b22\n2 /2. if no\n2 \u00d7 the standard\nscale constant is used, this is the same as scaling \u03b22 with\ndeviation of a binary dummy variable with prevalance of 0.5.\n(cid:2)\nthe sum of squares can be written in matrix form as [\u03b22, . . . , \u03b2c]\n(a \u2212 b)[\u03b22, . . . , \u03b2c], where a is a c \u2212 1 \u00d7 c \u2212 1 identity matrix and b is\na c \u2212 1 \u00d7 c \u2212 1 matrix all of whose elements are 1\nc .\n\n2 + \u03b22\n3\n\nfor general penalty functions such as that just described, the penalized\n\nlog likelihood can be generalized to\n\nlog l \u2212 1\n2\n\n(cid:2)\n\n\u03bb\u03b2\n\np \u03b2.\n\n(9.62)\n\nfor purposes of using the newton\u2013raphson procedure, the first derivative\nof the penalty function with respect to \u03b2 is \u2212\u03bbp \u03b2, and the negative of the\nsecond derivative is \u03bbp .\n\nanother problem in penalized estimation is how the choice of \u03bb is made.\nmany authors use cross-validation. a limited number of simulation stud-\nies in binary logistic regression modeling has shown that for each \u03bb being\nconsidered, at least 10-fold cross-validation must be done so as to obtain a\nreasonable estimate of predictive accuracy. even then, a smoother207 (\u201csu-\nper smoother\u201d) must be used on the (\u03bb, accuracy) pairs to allow location of\nthe optimum value unless one is careful in choosing the initial sub-samples\nand uses these same splits throughout. simulation studies have shown that a\nmodified aic is not only much quicker to compute (since it requires no cross-\nvalidation) but performs better at finding a good value of \u03bb (see below).\n\nfor a given \u03bb, the effective number of parameters being estimated is re-\nduced because of shrinkage. gray [237, eq. 2.9] and others estimate the ef-\nfective degrees of freedom by computing the expected value of a global wald\nstatistic for testing association, when the null hypothesis of no association is\ntrue. the d.f. is equal to\n\ntrace[i( \u02c6\u03b2p )v ( \u02c6\u03b2p )],\n\n(9.63)\n\n19\n\n20\n\n21\n\n "}, {"Page_number": 235, "text": "9.10 penalized maximum likelihood estimation\n\n211\n\nwhere \u02c6\u03b2p is the penalized mle (the parameters that maximize equa-\ntion 9.61), i is the information matrix computed from ignoring the penalty\nfunction, and v is the covariance matrix computed by inverting the infor-\nmation matrix that included the second derivatives with respect to \u03b2 in the\npenalty function.\n\ngray [237, eq. 2.6] states that a better estimate of the variance\u2013covariance\n\n22\n\nmatrix for \u02c6\u03b2p than v ( \u02c6\u03b2p ) is\n\u2217\n\nv\n\n= v ( \u02c6\u03b2p )i( \u02c6\u03b2p )v ( \u02c6\u03b2p ).\n\n(9.64)\n\n\u2217\n\ntherneau (personal communication, 2000) has found in a limited number\nof simulation studies that v\nunderestimates the true variances, and that a\nbetter estimate of the variance\u2013covariance matrix is simply v ( \u02c6\u03b2p ), assuming\nthat the model is correctly specified. this is the covariance matrix used by\ndefault in the rms package (the user can request that the sandwich estimator\nbe used instead) and is in fact the one gray used for wald tests.\n\npenalization will bias estimates of \u03b2, so hypothesis tests and confidence\nintervals using \u02c6\u03b2p may not have a simple interpretation. the same prob-\nlem arises in score and likelihood ratio tests. so far, penalization is better\nunderstood in pure prediction mode unless bayesian methods are used.\n\nequation 9.63 can be used to derive a modified aic (see [639, eq. 6]\n\nand [641, eq. 7]) on the model \u03c72 scale:\n\nlr \u03c72 \u2212 2 \u00d7 effective d.f.,\n\n(9.65)\n\nwhere lr \u03c72 is the likelihood ratio \u03c72 for the penalized model, but ignoring\nthe penalty function. if a variety of \u03bb are tried and one plots the (\u03bb, aic)\npairs, the \u03bb that maximizes aic will often be a good choice, that is, it is\nlikely to be near the value of \u03bb that maximizes predictive accuracy on a\nfuture datasetg.\nnote that if one does penalized maximum likelihood estimation where a set\nof variables being penalized has a negative value for the unpenalized \u03c72\u22122 \u00d7\nd.f., the value of \u03bb that will optimize the overall model aic will be \u221e.\n\nas an example, consider some simulated data (n = 100) with one predictor\nin which the true model is y = x1 + \u0001, where \u0001 has a standard normal\ndistribution and so does x1. we use a series of penalties (found by trial and\nerror) that give rise to sensible effective d.f., and fit penalized restricted cubic\nspline functions with five knots. we penalize two ways: all terms in the model\nincluding the coefficient of x1, which in reality needs no penalty; and only\nthe nonlinear terms. the following r program, in conjunction with the rms\npackage, does the job.\n\ng several examples from simulated datasets have shown that using bic to choose a\npenalty results in far too much shrinkage.\n\n "}, {"Page_number": 236, "text": "212\n\n9 overview of maximum likelihood estimation\n\nset.seed (191)\n\nx1 \u2190 rnorm (100)\ny \u2190 x1 + rnorm (100)\npens \u2190 df \u2190 aic \u2190 c (0 , .07 , .5 ,2 ,6 ,15 ,60)\nall \u2190 nl \u2190 list ()\n\nfor ( penalize in 1:2) {\n\nfor ( i in 1: length ( pens )) {\n\nf \u2190 ols ( y \u223c rcs ( x1 ,5) , penalty =\n\nlist ( simple = if ( penalize ==1) pens [ i ] else 0,\n\nnonlinear = pens [ i ]))\n\ndf [ i ] \u2190 f $ stats [ ' d.f. ' ]\naic [ i ] \u2190 aic ( f )\nnam \u2190 paste ( if ( penalize == 1) ' all ' else ' nl ' ,\nnam \u2190 as.character ( pens [ i ])\np \u2190 predict (f , x1 = seq ( -2.5 , 2 .5 , length =100) ,\nif ( penalize == 1) all [[ nam ]] \u2190 p else nl [[ nam ]] \u2190 p\n\n' penalty : ' , pens [ i ], sep = ' ' )\n\nconf.int = false )\n\n}\nprint ( rbind ( df = df , aic = aic ))\n\n}\n\n[ ,6]\ndf\n1.822758\naic 270.6653 2 6 9 . 1 5 4 0 4 5 2 6 8 . 2 2 2 8 5 5 2 6 7 . 5 6 5 9 4 2 6 7 . 2 8 8 9 8 8 2 6 7 . 5 5 2 9 1 5\n\n[ ,2]\n3.213591\n\n[ ,3]\n2.706069\n\n[ ,5]\n2.029282\n\n[ ,4]\n2.30273\n\n[ ,1]\n4.0000\n\n[ ,7]\ndf\n1.513609\naic 2 7 0 . 8 0 5 0 3 3\n\n[ ,6]\ndf\n1.960863\naic 270.6653 2 6 9 . 1 6 7 1 0 8 2 6 8 . 2 8 7 9 3 3 2 6 7 . 7 1 8 6 8 1 2 6 7 . 4 4 1 1 9 7 2 6 7 . 3 4 7 4 7 5\n\n[ ,2]\n3.219149\n\n[ ,3]\n2.728126\n\n[ ,4]\n2.344807\n\n[ ,5]\n2.109741\n\n[ ,1]\n4.0000\n\n[ ,7]\ndf\n1.684421\naic 2 6 7 . 8 9 2 0 7 3\n\nall \u2190 do.call ( ' rbind ' , all ); all $ type \u2190 ' penalize all '\nnl \u2190 do.call ( ' rbind ' , nl ) ; nl $ type \u2190 ' penalize nonlinear '\nboth \u2190 a s . d a t a . f r a m e ( r b i n d . d a t a . f r a m e ( all , nl ))\nboth $ penalty \u2190 both $ .set.\n\nggplot ( both , aes ( x = x1 , y = yhat , color = penalty )) + geom_line () +\n\ngeom_ablin e ( col = gray ( .7 )) + facet_gri d (\u223c type )\n\n# figure 9.6\n\nthe left panel in figure 9.6 corresponds to penalty = list(simple=a, nonlin-\near=a) in the r program, meaning that all parameters except the intercept are\nshrunk by the same amount a (this would be more appropriate had there been\nmultiple predictors). as effective d.f. get smaller (penalty factor gets larger),\nthe regression fits get flatter (too flat for the largest penalties) and confidence\nbands get narrower. the right graph corresponds to penalty=list(simple=0,\nnonlinear=a), causing only the cubic spline terms that are nonlinear in x1\nto be shrunk. as the amount of shrinkage increases (d.f. lowered), the fits\nbecome more linear and closer to the true regression line (longer dotted line).\nagain, confidence intervals become smaller.\n\n23\n\n "}, {"Page_number": 237, "text": "9.11 further reading\n\npenalize all\n\npenalize nonlinear\n\n4\n\n2\n\n0\n\n\u22122\n\nt\n\na\nh\ny\n\n213\n\npenalty\n\n0\n\n0.07\n\n0.5\n\n2\n\n6\n\n15\n\n60\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2\n\nx1\n\nfig. 9.6 penalized least squares estimates for an unnecessary five-knot restricted\ncubic spline function. in the left graph all parameters (except the intercept) are\npenalized. the effective d.f. are 4, 3.21, 2.71, 2.30, 2.03, 1.82, and 1.51. in the right\ngraph, only parameters associated with nonlinear functions of x1 are penalized. the\neffective d.f. are 4, 3.22, 2.73, 2.34, 2.11, 1.96, and 1.68.\n\n9.11 further reading\n\n1\n\n2\n\n3\n4\n\n5\n\nboos60 has some nice generalizations of the score test. morgan et al.464 show\nhow score test \u03c72 statistics may negative unless the expected information matrix\nis used.\nsee marubini and valsecchi [444, pp. 164\u2013169] for an excellent description of\nthe relationship between the three types of test statistics.\nreferences [115,507] have good descriptions of methods used to maximize log l.\nas long and ervin426 argue, for small sample sizes, the usual huber\u2013white co-\nvariance estimator should not be used because there the residuals do not have\nconstant variance even under homoscedasticity. they showed that a simple cor-\nrection due to efron and others can result in substantially better estimates.\nlin and wei,410 binder,55 and lin407 have applied the huber estimator to the\ncox132 survival model. freedman206 questioned the use of sandwich estima-\ntors because they are often used to obtain the right variances on the wrong\nparameters when the model doesn\u2019t fit. he also has some excellent background\ninformation.\nfeng et al.188 showed that in the case of cluster correlations arising from re-\npeated measurement data with gaussian errors, the cluster bootstrap performs\nexcellently even when the number of observations per cluster is large and the\nnumber of subjects is small. xiao and abrahamowicz676 compared the cluster\nbootstrap with a two-stage cluster bootstrap in the context of the cox model.\n\n "}, {"Page_number": 238, "text": "214\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n9 overview of maximum likelihood estimation\n\ngraubard and korn235 and fitzmaurice195 describe the kinds of situations in\nwhich the working independence model can be trusted.\nminkin,460 alho,11 doganaksoy and schmee,160 and meeker and escobar452\ndiscuss the need for lr and score-based confidence intervals. alho found that\nscore-based intervals are usually more tedious to compute, and provided use-\nful algorithms for the computation of either type of interval (see also [452]\nand [444, p. 167]). score and lr intervals require iterative computations and\nhave to deal with the fact that when one parameter is changed (e.g., bi is re-\nstricted to be zero), all other parameter estimates change. diciccio and efron157\nprovide a method for very accurate confidence intervals for exponential families\nthat requires a modest amount of additional computation. venzon and mool-\ngavkar provide an efficient general method for computing lr-based intervals.636\nbrazzale and davison65 developed some promising and feasible ways to make\nunconditional likelihood-based inferences more accurate in small samples.\ncarpenter and bithell92 have an excellent overview of several variations on the\nbootstrap for obtaining confidence limits.\ntibshirani and knight610 developed an easy to program approach for deriving\nsimultaneous confidence sets that is likely to be useful for getting simultaneous\nconfidence regions for the entire vector of model parameters, for population val-\nues for an entire sequence of predictor values, and for a set of regression effects\n(e.g., interquartile-range odds ratios for age for both sexes). the basic idea is\nthat during the, say, 1000 bootstrap repetitions one stores the \u22122 log likelihood\nfor each model fit, being careful to compute the likelihood at the current boot-\nstrap parameter estimates but with respect to the original data matrix, not\nthe bootstrap sample of the data matrix. to obtain an approximate simultane-\nous 0.95 confidence set one computes the 0.95 quantile of the \u22122 log likelihood\nvalues and determines which vectors of parameter estimates correspond to \u22122\nlog likelihoods that are at least as small as the 0.95 quantile of all \u22122 log like-\nlihoods. once the qualifying parameter estimates are found, the quantities of\ninterest are computed from those parameter estimates and an outer envelope\nof those quantities is found. computations are facilitated with the rms package\nconfplot function.\nvan houwelingen and le cessie [633, eq. 52] showed, consistent with aic, that\nthe average optimism in a mean logarithmic (minus log likelihood) quality score\nfor logistic models is p/n.\nschwarz560 derived a different penalty using large-sample bayesian properties\nof competing models. his bayesian information criterion (bic) chooses the\nmodel having the lowest value of l + 1/2p log n or the highest value of lr\n\u03c72 \u2212 p log n. kass and raftery have done several studies of bic.337 smith\nand spiegelhalter576 and laud and ibrahim377 discussed other useful gener-\nalizations of likelihood penalties. zheng and loh685 studied several penalty\nmeasures, and found that aic does not penalize enough for overfitting in the\nordinary regression case. kass and raftery [337, p. 790] provide a nice review\nof this topic, stating that \u201caic picks the correct model asymptotically if the\ncomplexity of the true model grows with sample size\u201d and that \u201caic selects\nmodels that are too big even when the sample size is large.\u201d but they also cite\nother papers that show the existence of cases where aic can work better than\nbic. according to buckland et al.,80 bic \u201cassumes that a true model exists\nand is low-dimensional.\u201d\nhurvich and tsai314, 315 made an improvement in aic that resulted in much\nbetter model selection for small n. they defined the corrected aic as\n\naicc = lr \u03c72 \u2212 2p[1 +\n\np + 1\n\nn \u2212 p \u2212 1\n\n].\n\n(9.66)\n\n "}, {"Page_number": 239, "text": "9.11 further reading\n\n215\n\nin [314] they contrast asymptotically efficient model selection with aic when\nthe true model has infinitely many parameters with improvements using other\nindexes such as aicc when the model is finite.\none difficulty in applying the schwarz, aicc , and related criteria is that with\ncensored or binary responses it is not clear that the actual sample size n should\nbe used in the formula.\n\n13\n\n12 goldstein,222 willan et al.,669 and royston and thompson534 have nice dis-\ncussions on comparing non-nested regression models. schemper\u2019s method549 is\nuseful for testing whether a set of variables provides significantly greater infor-\nmation (using an r2 measure) than another set of variables.\nvan houwelingen and le cessie [633, eq. 22] recommended using l/2 (also called\nthe kullback\u2013leibler error rate) as a quality index.\nschemper549 provides a bootstrap technique for testing for significant differ-\nences between correlated r2 measures. mittlb\u00a8ock and schemper,461 schemper\nand stare,554 korn and simon,365, 366 menard,454 and zheng and agresti684\nhave excellent discussions about the pros and cons of various indexes of the\npredictive value of a model.\n\n14\n\n15 al-radi et al.10 presented another analysis comparing competing predictors\nusing the adequacy index and a receiver operating characteristic curve area\napproach based on a test for whether one predictor has a higher probability of\nbeing \u201cmore concordant\u201d than another.\n[55, 97, 409] provide good variance\u2013covariance estimators from a weighted max-\nimum likelihood analysis.\n\n16\n\n17 huang and harrington310 developed penalized partial likelihood estimates for\ncox models and provided useful background information and theoretical results\nabout improvements in mean squared errors of regression estimates. they used\na bootstrap error estimate for selection of the penalty parameter.\nsardy538 proposes that the square roots of the diagonals of the inverse of the\ncovariance matrix for the predictors be used for scaling rather than the standard\ndeviations.\n\n18\n\n19 park and hastie483 and articles referenced therein describe how quadratic pe-\nnalized logistic regression automatically sets coefficient estimates for empty cells\nto zero and forces the sum of k coefficients for a k-level categorical predictor to\nequal zero.\n\n23\n\n20 greenland241 has a nice discussion of the relationship between penalized max-\nimum likelihood estimation and mixed effects models. he cautions against esti-\nmating the shrinkage parameter.\nsee310 for a bootstrap approach to selection of \u03bb.\n\n21\n22 verweij and van houwelingen [639, eq. 4] derived another expression for d.f., but\nit requires more computation and did not perform any better than equation 9.63\nin choosing \u03bb in several examples tested.\nsee van houwelingen and thorogood631 for an approximate empirical bayes\napproach to shrinkage. see tibshirani608 for the use of a non-smooth penalty\nfunction that results in variable selection as well as shrinkage (see section 4.3).\nverweij and van houwelingen640 used a \u201ccross-validated likelihood\u201d based on\nleave-out-one estimates to penalize for overfitting. wang and taylor652 pre-\nsented some methods for carrying out hypothesis tests and computing con-\nfidence limits under penalization. moons et al.462 presented a case study of\npenalized estimation and discussed the advantages of penalization.\n\n "}, {"Page_number": 240, "text": "216\n\n9 overview of maximum likelihood estimation\n\ntable 9.4 likelihood ratio global test statistics\n\nvariables in model lr \u03c72\nage\nsex\nage, sex\nage2\nage, age2\nage, age2, sex\n\n100\n108\n111\n60\n102\n115\n\n9.12 problems\n\n1. a sample of size 100 from a normal distribution with unknown mean and\nstandard deviation (\u03bc and \u03c3) yielded the following log likelihood values\nwhen computed at two values of \u03bc.\n\nlog l(\u03bc = 10, \u03c3 = 5) = \u2212800\nlog l(\u03bc = 20, \u03c3 = 5) = \u2212820.\n\nwhat do you know about \u03bc? what do you know about y ?\n\n2. several regression models were considered for predicting a response. lr \u03c72\n(corrected for the intercept) for models containing various combinations of\nvariables are found in table 9.4. compute all possible meaningful lr \u03c72.\nfor each, state the d.f. and an approximate p -value. state which lr \u03c72\ninvolving only one variable is not very meaningful.\n\n3. for each problem below, rank wald, score, and lr statistics by overall\n\nstatistical properties and then by computational convenience.\n\na. a forward stepwise variable selection (to be later accounted for with the\nbootstrap) is desired to determine a concise model that contains most\nof the independent information in all potential predictors.\n\nb. a test of independent association of each variable in a given model (each\nvariable adjusted for the effects of all other variables in the given model)\nis to be obtained.\n\nc. a model that contains only additive effects is fitted. a large number\nof potential interaction terms are to be tested using a global (multiple\nd.f.) test.\n\n4. consider a univariate saturated model in 3 treatments (a, b, c) that is\nquadratic in age. write out the model with all the \u03b2s, and write in detail\nthe contrast for comparing treatment b with treatment c for 30 year olds.\nsketch out the same contrast using the \u201cdifference in predictions\u201d approach\nwithout simplification.\n\n "}, {"Page_number": 241, "text": "9.12 problems\n\n217\n\n5. simulate a binary logistic model for n = 300 with an average fraction of\nevents somewhere between 0.15 and 0.3. use 5 continuous covariates and\nassume the model is everywhere linear. fit an unpenalized model, then\nsolve for the optimum quadratic penalty \u03bb. relate the resulting effective\nd.f. to the 15:1 rule of thumb, and compute the heuristic shrinkage coeffi-\ncient \u02c6\u03b3 for the unpenalized model and for the optimally penalized model,\ninserting the effective d.f. for the number of non-intercept parameters in\nthe model.\n\n6. for a similar setup as the binary logistic model simulation in section 9.7,\ndo a monte carlo simulation to determine the coverage probabilities for\nordinary wald and for three types of bootstrap confidence intervals for the\ntrue x=5 to x=1 log odds ratio. in addition, consider the wald-type con-\nfidence interval arising from the sandwich covariance estimator. estimate\nthe non-coverage probabilities in both tails. use a sample size n = 200\nwith the single predictor x1 having a standard log-normal distribution,\nand the true model being logit(y = 1) = 1 + x1/2. determine whether\nincreasing the sample size relieves any problem you observed. some r code\nfor this simulation is on the web site.\n\n "}, {"Page_number": 242, "text": "chapter 10\nbinary logistic regression\n\n1\n\n10.1 model\n\nbinary responses are commonly studied in many fields. examples include\nthe presence or absence of a particular disease, death during surgery, or a\nconsumer purchasing a product. often one wishes to study how a set of\npredictor variables x is related to a dichotomous response variable y . the\npredictors may describe such quantities as treatment assignment, dosage, risk\nfactors, and calendar time.\n\nfor convenience we define the response to be y = 0 or 1, with y = 1\ndenoting the occurrence of the event of interest. often a dichotomous outcome\ncan be studied by calculating certain proportions, for example, the proportion\nof deaths among females and the proportion among males. however, in many\nsituations, there are multiple descriptors, or one or more of the descriptors\nare continuous. without a statistical model, studying patterns such as the\nrelationship between age and occurrence of a disease, for example, would\nrequire the creation of arbitrary age groups to allow estimation of disease\nprevalence as a function of age.\n\nletting x denote the vector of predictors {x1, x2, . . . , xk}, a first attempt\n\nat modeling the response might use the ordinary linear regression model\n\ne{y |x} = x\u03b2,\n\n(10.1)\nsince the expectation of a binary variable y is prob{y = 1}. however, such\na model by definition cannot fit the data over the whole range of the pre-\ndictors since a purely linear model e{y |x} = prob{y = 1|x} = x\u03b2 can\nallow prob{y = 1} to exceed 1 or fall below 0. the statistical model that is\ngenerally preferred for the analysis of binary responses is instead the binary\nlogistic regression model, stated in terms of the probability that y = 1 given\nx, the values of the predictors:\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 10\n\n219\n\n "}, {"Page_number": 243, "text": "220\n\n10 binary logistic regression\n\nprob{y = 1|x} = [1 + exp(\u2212x\u03b2)]\n\n\u22121.\n\n(10.2)\n\nas before, x\u03b2 stands for \u03b20 + \u03b21x1 + \u03b22x2 + . . . + \u03b2kxk. the binary lo-\ngistic regression model was developed primarily by cox129 and walker and\nduncan.647 the regression parameters \u03b2 are estimated by the method of\nmaximum likelihood (see below).\n\nthe function\n\np = [1 + exp(\u2212x)]\n\n\u22121\n\n(10.3)\n\nis called the logistic function. this function is plotted in figure 10.1 for x\nvarying from \u22124 to +4. this function has an unlimited range for x while p\nis restricted to range from 0 to 1.\n\np\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n\u22124\n\n\u22122\n\n2\n\n4\n\n0\n\nx\n\nfig. 10.1 logistic function\n\nfor future derivations it is useful to express x in terms of p . solving the\n\nequation above for x by using\n\n1 \u2212 p = exp(\u2212x)/[1 + exp(\u2212x)]\n\n(10.4)\n\nyields the inverse of the logistic function:\nx = log[p/(1 \u2212 p )] = log[odds that y = 1 occurs] = logit{y = 1}. (10.5)\n\nother methods that have been used to analyze binary response data in-\nclude the probit model, which writes p in terms of the cumulative normal\ndistribution, and discriminant analysis. probit regression, although assuming\na similar shape to the logistic function for the regression relationship be-\ntween x\u03b2 and prob{y = 1}, involves more cumbersome calculations, and\nthere is no natural interpretation of its regression parameters. in the past,\ndiscriminant analysis has been the predominant method since it is the sim-\nplest computationally. however, it makes more assumptions than logistic re-\ngression. the model used in discriminant analysis is stated in terms of the\n\n2\n\n3\n\n "}, {"Page_number": 244, "text": "10.1 model\n\n221\n\ndistribution of x given the outcome group y , even though one is seldom in-\nterested in the distribution of the predictors per se. the discriminant model\nhas to be inverted using bayes\u2019 rule to derive the quantity of primary in-\nterest, prob{y = 1}. by contrast, the logistic model is a direct probability\nmodel since it is stated in terms of prob{y = 1|x}. since the distribution\nof a binary random variable y is completely defined by the true probability\nthat y = 1 and since the model makes no assumption about the distribu-\ntion of the predictors, the logistic model makes no distributional assumptions\nwhatsoever.\n\n10.1.1 model assumptions and interpretation\n\nof parameters\n\nsince the logistic model is a direct probability model, its only assumptions\nrelate to the form of the regression equation. regression assumptions are\nverifiable, unlike the assumption of multivariate normality made by discrimi-\nnant analysis. the logistic model assumptions are most easily understood by\ntransforming prob{y = 1} to make a model that is linear in x\u03b2:\n\nlogit{y = 1|x} = logit(p ) = log[p/(1 \u2212 p )]\n\n= x\u03b2,\n\n(10.6)\nwhere p = prob{y = 1|x}. thus the model is a linear regression model in\nthe log odds that y = 1 since logit(p ) is a weighted sum of the xs. if all\neffects are additive (i.e., no interactions are present), the model assumes that\nfor every predictor xj,\n\nlogit{y = 1|x} = \u03b20 + \u03b21x1 + . . . + \u03b2jxj + . . . + \u03b2kxk\n\n= \u03b2jxj + c,\n\n(10.7)\n\nwhere if all other factors are held constant, c is a constant given by\n\nc = \u03b20 + \u03b21x1 + . . . + \u03b2j\u22121xj\u22121 + \u03b2j+1xj+1 + . . . + \u03b2kxk.\n\n(10.8)\n\nthe parameter \u03b2j is then the change in the log odds per unit change in\nxj if xj represents a single factor that is linear and does not interact with\nother factors and if all other factors are held constant. instead of writing this\nrelationship in terms of log odds, it could just as easily be written in terms\nof the odds that y = 1:\n\nodds{y = 1|x} = exp(x\u03b2),\n\n(10.9)\n\n "}, {"Page_number": 245, "text": "222\n\n10 binary logistic regression\n\nand if all factors other than xj are held constant,\n\nodds{y = 1|x} = exp(\u03b2jxj + c) = exp(\u03b2jxj) exp(c).\n\n(10.10)\n\nthe regression parameters can also be written in terms of odds ratios. the\n\nodds that y = 1 when xj is increased by d, divided by the odds at xj is\n\nodds{y = 1|x1, x2, . . . , xj + d, . . . , xk}\nodds{y = 1|x1, x2, . . . , xj, . . . , xk}\n\nexp[\u03b2j(xj + d)] exp(c)\n= exp[\u03b2jxj + \u03b2jd \u2212 \u03b2jxj] = exp(\u03b2j d).\n\n[exp(\u03b2jxj) exp(c)]\n\n=\n\n(10.11)\n\nthus the effect of increasing xj by d is to increase the odds that y = 1 by\na factor of exp(\u03b2jd), or to increase the log odds that y = 1 by an increment\nof \u03b2jd. in general, the ratio of the odds of response for an individual with\npredictor variable values x\ncompared with an individual with predictors\nx is\n\n\u2217\n\n\u2217\n\nx\n\n: x odds ratio = exp(x\n\n\u2217\n\u03b2)/ exp(x\u03b2)\n\u2217 \u2212 x)\u03b2].\n\n= exp[(x\n\n(10.12)\n\nnow consider some special cases of the logistic multiple regression model.\nif there is only one predictor x and that predictor is binary, the model can\nbe written\n\nlogit{y = 1|x = 0} = \u03b20\nlogit{y = 1|x = 1} = \u03b20 + \u03b21.\n\n(10.13)\n\nhere \u03b20 is the log odds of y = 1 when x = 0. by subtracting the two\nequations above, it can be seen that \u03b21 is the difference in the log odds\nwhen x = 1 as compared with x = 0, which is equivalent to the log of the\nratio of the odds when x = 1 compared with the odds when x = 0. the\nquantity exp(\u03b21) is the odds ratio for x = 1 compared with x = 0. letting\np 0 = prob{y = 1|x = 0} and p 1 = prob{y = 1|x = 1}, the regression\nparameters are interpreted by\n\n\u03b20 = logit(p 0) = log[p 0/(1 \u2212 p 0)]\n\u03b21 = logit(p 1) \u2212 logit(p 0)\n\n= log[p 1/(1 \u2212 p 1)] \u2212 log[p 0/(1 \u2212 p 0)]\n= log{[p 1/(1 \u2212 p 1)]/[p 0/(1 \u2212 p 0)]}.\n\n(10.14)\n\n "}, {"Page_number": 246, "text": "10.1 model\n\n223\n\nsince there are only two quantities to model and two free parameters,\nthere is no way that this two-sample model can\u2019t fit; the model in this case\nis essentially fitting two cell proportions. similarly, if there are g \u2212 1 dummy\nindicator xs representing g groups, the anova-type logistic model must\nalways fit.\n\nif there is one continuous predictor x, the model is\n\nlogit{y = 1|x} = \u03b20 + \u03b21x,\n\n(10.15)\n\nand without further modification (e.g., taking log transformation of the pre-\ndictor), the model assumes a straight line in the log odds, or that an increase\nin x by one unit increases the odds by a factor of exp(\u03b21).\n\nnow consider the simplest analysis of covariance model in which there are\ntwo treatments (indicated by x1 = 0 or 1) and one continuous covariable\n(x2). the simplest logistic model for this setup is\n\nlogit{y = 1|x} = \u03b20 + \u03b21x1 + \u03b22x2,\n\n(10.16)\n\nwhich can be written also as\n\nlogit{y = 1|x1 = 0, x2} = \u03b20 + \u03b22x2\nlogit{y = 1|x1 = 1, x2} = \u03b20 + \u03b21 + \u03b22x2.\n\n(10.17)\n\nthe x1 = 1 : x1 = 0 odds ratio is exp(\u03b21), independent of x2. the odds\nratio for a one-unit increase in x2 is exp(\u03b22), independent of x1.\n\nthis model, with no term for a possible interaction between treatment\nand covariable, assumes that for each treatment the relationship between x2\nand log odds is linear, and that the lines have equal slope; that is, they are\nparallel. assuming linearity in x2, the only way that this model can fail is\nfor the two slopes to differ. thus, the only assumptions that need verification\nare linearity and lack of interaction between x1 and x2.\n\nto adapt the model to allow or test for interaction, we write\n\nlogit{y = 1|x} = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x3,\n\n(10.18)\n\nwhere the derived variable x3 is defined to be x1x2. the test for lack of\ninteraction (equal slopes) is h0 : \u03b23 = 0. the model can be amplified as\n\nlogit{y = 1|x1 = 0, x2} = \u03b20 + \u03b22x2\nlogit{y = 1|x1 = 1, x2} = \u03b20 + \u03b21 + \u03b22x2 + \u03b23x2\n\n(cid:2)\n0 + \u03b2\n\n(cid:2)\n2x2,\n\n= \u03b2\n\n(10.19)\n\n "}, {"Page_number": 247, "text": "224\n\n10 binary logistic regression\n\ntable 10.1 effect of an odds ratio of two on various risks\n\nwithout risk factor with risk factor\nprobability odds odds probability\n\n.2\n.5\n.8\n.9\n.98\n\n.25\n1\n4\n9\n49\n\n.5\n2\n8\n18\n98\n\n.33\n.67\n.89\n.95\n.99\n\n(cid:2)\n0 = \u03b20 + \u03b21 and \u03b2\n\n(cid:2)\nwhere \u03b2\n2 = \u03b22 + \u03b23. the model with interaction is therefore\nequivalent to fitting two separate logistic models with x2 as the only predic-\ntor, one model for each treatment group. here the x1 = 1 : x1 = 0 odds\nratio is exp(\u03b21 + \u03b23x2).\n\n10.1.2 odds ratio, risk ratio, and risk difference\n\nas discussed above, the logistic model quantifies the effect of a predictor in\nterms of an odds ratio or log odds ratio. an odds ratio is a natural descrip-\ntion of an effect in a probability model since an odds ratio can be constant.\nfor example, suppose that a given risk factor doubles the odds of disease.\ntable 10.1 shows the effect of the risk factor for various levels of initial risk.\nsince odds have an unlimited range, any positive odds ratio will still yield\na valid probability. if one attempted to describe an effect by a risk ratio, the\neffect can only occur over a limited range of risk (probability). for example, a\nrisk ratio of 2 can only apply to risks below .5; above that point the risk ratio\nmust diminish. (risk ratios are similar to odds ratios if the risk is small.)\nrisk differences have the same difficulty; the risk difference cannot be con-\nstant and must depend on the initial risk. odds ratios, on the other hand, can\ndescribe an effect over the entire range of risk. an odds ratio can, for example,\ndescribe the effect of a treatment independently of covariables affecting risk.\nfigure 10.2 depicts the relationship between risk of a subject without the risk\nfactor and the increase in risk for a variety of relative increases (odds ratios).\nit demonstrates how absolute risk increase is a function of the baseline risk.\nrisk increase will also be a function of factors that interact with the risk fac-\ntor, that is, factors that modify its relative effect. once a model is developed\nfor estimating prob{y = 1|x}, this model can easily be used to estimate the\nabsolute risk increase as a function of baseline risk factors as well as inter-\nacting factors. let x1 be a binary risk factor and let a = {x2, . . . , xp} be\nthe other factors (which for convenience we assume do not interact with x1).\nthen the estimate of prob{y = 1|x1 = 1, a} \u2212 prob{y = 1|x1 = 0, a} is\n\n "}, {"Page_number": 248, "text": "10.1 model\n\n225\n\ni\n\nk\ns\nr\nn\n\n \n\ni\n \n\ne\ns\na\ne\nr\nc\nn\n\ni\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\n0.2\n\n0.1\n\n0.0\n\n10\n\n5\n4\n\n3\n\n2\n1.75\n1.5\n1.25\n1.1\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nrisk for subject without risk factor\n\nfig. 10.2 absolute benefit as a function of risk of the event in a control subject and\nthe relative effect (odds ratio) of the risk factor. the odds ratios are given for each\ncurve.\n\ntable 10.2 example binary response data\n\nfemales age: 37 39 39 42 47 48 48 52 53 55 56 57 58 58 60 64 65 68 68 70\nresponse: 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 1 1 1 1\nage: 34 38 40 40 41 43 43 43 44 46 47 48 48 50 50 52 55 60 61 61\nresponse: 1 1 0 0 0 1 1 1 0 0 1 1 1 0 1 1 1 1 1 1\n\nmales\n\n1\n\n\u2212\n\n1 + exp\u2212[ \u02c6\u03b20 + \u02c6\u03b21 + \u02c6\u03b22x2 + . . . + \u02c6\u03b2pxp]\n1 + exp\u2212[ \u02c6\u03b20 + \u02c6\u03b22x2 + . . . + \u02c6\u03b2pxp]\n\u2212 \u02c6r,\n\n=\n\n1\n\n1\n\n1 + ( 1\u2212 \u02c6r\n\n\u02c6r ) exp(\u2212 \u02c6\u03b21)\n\n(10.20)\n\nwhere \u02c6r is the estimate of the baseline risk, prob{y = 1|x1 = 0}. the risk\ndifference estimate can be plotted against \u02c6r or against levels of variables in a\nto display absolute risk increase against overall risk (figure 10.2) or against\nspecific subject characteristics.\n\n4\n\n10.1.3 detailed example\n\nconsider the data in table 10.2. a graph of the data, along with a fitted\nlogistic model (described later), appears in figure 10.3. the graph also dis-\nplays proportions of responses obtained by stratifying the data by sex and\n\n "}, {"Page_number": 249, "text": "226\n\n10 binary logistic regression\n\nage group (< 45, 45 \u2212 54,\u2265 55). the age points on the abscissa for these\ngroups are the overall mean ages in the three age intervals (40.2, 49.1, and\n61.1, respectively).\n\nrequire ( rms )\n\ngethdata ( s e x . a g e . r e s p o n s e )\n\nd \u2190 s e x . a g e . r e s p o n s e\ndd \u2190 datadist ( d ); options ( datadist = ' dd ' )\nf \u2190 lrm ( response \u223c sex + age , data = d )\nfasr \u2190 f\nw \u2190 function ( ... )\n\n# save for later\n\nwith (d , {\n\nm \u2190 sex == ' male '\nf \u2190 sex == ' female '\n\nlpoints ( age [ f ] , response [ f ] , pch =1)\nlpoints ( age [ m ] , response [ m ] , pch =2)\n\naf \u2190 cut2 ( age , c (45 ,55) , levels.mea n = true )\nprop \u2190 tapply ( response , list ( af , sex ) , mean ,\nagem \u2190 as.numeric ( row.names ( prop ))\nlpoints ( agem , prop [ , ' female ' ] ,\n\nna.rm = true )\n\npch =4 , cex =1 .3 , col = ' green ' )\n\nlpoints ( agem , prop [ , ' male ' ] ,\nx \u2190 rep (62 , 4); y \u2190 seq ( .25 , .1 , length =4)\n\npch =5 , cex =1 .3 , col = ' green ' )\n\nlpoints ( x , y , pch = c (1 , 2 , 4 , 5) ,\n\ncol = rep ( c ( ' blue ' , ' green ' ) , each =2))\n\nltext ( x +5 , y ,\n\nc ( ' f observed ' , ' m observed ' ,\n\n' f proportion ' , ' m proportio n ' ) , cex = .8 )\n\n} )\n\n# figure 10.3\n\nplot ( predict (f , age = seq (34 , 70 , length =200) , sex , fun = plogis ) ,\n\nylab = ' pr [ response ] ' , ylim = c ( -.02 , 1 .02 ) , addpanel = w )\nltx \u2190 function ( fit ) latex ( fit , inline = true , columns =54 ,\nfile = ' ' , after = ' $ . ' , digits =3 ,\n\nsize = ' ssize ' , before = ' $ x \\\\ hat {\\\\ beta }= ' )\n\nltx ( f )\n\nx \u02c6\u03b2 = \u22129.84 + 3.49[male] + 0.158 age.\n\ndescriptive statistics for assessing the association between sex and re-\nsponse, age group and response, and age group and response stratified by\nsex are found below. corresponding fitted logistic models, with sex coded as\n0 = female, 1 = male are also given. models were fitted first with sex as the\nonly predictor, then with age as the (continuous) predictor, then with sex and\nage simultaneously. first consider the relationship between sex and response,\nignoring the effect of age.\n\n "}, {"Page_number": 250, "text": "10.1 model\n\n227\n\n]\ne\ns\nn\no\np\ns\ne\nr\n[\nr\n\np\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\nmale\n\nfemale\n\n50\n\nage\n\n40\n\nf observed\nm observed\nf proportion\nm proportion\n\n60\n\n70\n\nfig. 10.3 data, subgroup proportions, and fitted logistic model, with 0.95 pointwise\nconfidence bands\n\nsex\nfrequency\nrow pct\n\nresponse\n\n0\n\n1\n\ntotal\n\nodds/log\n\nf\n\nm\n\n14\n70.00\n\n6\n30.00\n\n6\n30.00\n\n14\n70.00\n\ntotal\n\n20\n\n20\n\n6/14=.429\n-.847\n\n14/6=2.33\n.847\n\n20\n\n20\n\n40\n\nm:f odds ratio = (14/6)/(6/14) = 5.44, log=1.695\n\nstatistics for sex \u00d7 response\n\nstatistic\n\nd.f. value\n\np\n\n\u03c72\nlikelihood ratio \u03c72\n\n1 6.400 0.011\n1 6.583 0.010\n\nparameter estimate std err wald \u03c72\n\np\n\n\u03b20\n\u03b21\n\n\u22120.8473 0.4880\n1.6946 0.6901\n\n3.0152\n6.0305 0.0141\n\n "}, {"Page_number": 251, "text": "228\n\n10 binary logistic regression\n\nnote that the estimate of \u03b20, \u02c6\u03b20 is the log odds for females and that \u02c6\u03b21 is the\nlog odds (m:f) ratio. \u02c6\u03b20 + \u02c6\u03b21 = .847, the log odds for males. the likelihood\nratio test for h0 : no effect of sex on probability of response is obtained as\nfollows.\n\nlog likelihood (\u03b21 = 0) : \u221227.727\n: \u221224.435\nlog likelihood (max)\n: \u22122(\u221227.727 \u2212 \u221224.435) = 6.584.\nlr \u03c72(h0 : \u03b21 = 0)\n\n(note the agreement of the lr \u03c72 with the contingency table likelihood ratio\n\u03c72, and compare 6.584 with the wald statistic 6.03.)\n\nnext, consider the relationship between age and response, ignoring sex.\n\nresponse\n\n0\n\n1\n\ntotal\n\nodds/log\n\nage\nfrequency\nrow pct\n\n<45\n\n45-54\n\n55+\n\n8\n61.5\n\n6\n50.0\n\n6\n40.0\n\n5\n38.4\n\n6\n50.0\n\n9\n60.0\n\ntotal\n\n20\n\n20\n\n5/8=.625\n-.47\n\n6/6=1\n0\n\n9/6=1.5\n.405\n\n13\n\n12\n\n15\n\n40\n\n55+ : <45 odds ratio = (9/6)/(5/8) = 2.4, log=.875\n\nparameter estimate std err wald \u03c72\n\np\n\n\u03b20\n\u03b21\n\n\u22122.7338 1.8375\n0.0540 0.0358\n\n2.2134 0.1368\n2.2763 0.1314\n\nthe estimate of \u03b21 is in rough agreement with that obtained from the\nfrequency table. the 55+ : < 45 log odds ratio is .875, and since the respective\nmean ages in the 55+ and <45 age groups are 61.1 and 40.2, an estimate of\nthe log odds ratio increase per year is .875/(61.1 \u2212 40.2) = .875/20.9 = .042.\nthe likelihood ratio test for h0 : no association between age and response\n\nis obtained as follows.\n\nlog likelihood (\u03b21 = 0) : \u221227.727\n: \u221226.511\nlog likelihood (max)\n: \u22122(\u221227.727 \u2212 \u221226.511) = 2.432.\nlr \u03c72(h0 : \u03b21 = 0)\n\n(compare 2.432 with the wald statistic 2.28.)\n\nnext we consider the simultaneous association of age and sex with\n\nresponse.\n\n "}, {"Page_number": 252, "text": "10.1 model\n\n229\n\nsex=f\n\nresponse\n\n0\n\n1\n\ntotal\n\nage\nfrequency\nrow pct\n\n<45\n\n45-54\n\n55+\n\n4\n100.0\n\n4\n80.0\n\n6\n54.6\n\n0\n0.0\n\n1\n20.0\n\n5\n45.4\n\ntotal\n\n14\n\n6\n\n4\n\n5\n\n11\n\n20\n\nsex=m\n\nresponse\n\n0\n\n1\n\ntotal\n\nage\nfrequency\nrow pct\n\n<45\n\n45-54\n\n55+\n\ntotal\n\n4\n44.4\n\n2\n28.6\n\n0\n0.0\n\n6\n\n5\n55.6\n\n5\n71.4\n\n4\n100.0\n\n9\n\n7\n\n4\n\n14\n\n20\n\na logistic model for relating sex and age simultaneously to response is\n\ngiven below.\n\nparameter estimate std err wald \u03c72\n\np\n\n\u03b20\n\u03b21 (sex)\n\u03b22 (age)\n\n\u22129.8429 3.6758\n3.4898 1.1992\n0.1581 0.0616\n\n7.1706 0.0074\n8.4693 0.0036\n6.5756 0.0103\n\nlikelihood ratio tests are obtained from the information below.\n\nlog likelihood (\u03b21 = 0, \u03b22 = 0) : \u221227.727\n: \u221219.458\nlog likelihood (max)\n: \u221226.511\nlog likelihood (\u03b21 = 0)\n: \u221224.435\nlog likelihood (\u03b22 = 0)\n: \u22122(\u221227.727 \u2212 \u221219.458) = 16.538\nlr \u03c72 (h0 : \u03b21 = \u03b22 = 0)\n: \u22122(\u221226.511 \u2212 \u221219.458) = 14.106\nlr \u03c72 (h0 : \u03b21 = 0) sex|age\n: \u22122(\u221224.435 \u2212 \u221219.458) = 9.954.\nlr \u03c72 (h0 : \u03b22 = 0) age|sex\n\nthe 14.1 should be compared with the wald statistic of 8.47, and 9.954\nshould be compared with 6.58. the fitted logistic model is plotted separately\n\n "}, {"Page_number": 253, "text": "230\n\n10 binary logistic regression\n\nfor females and males in figure 10.3. the fitted model is\n\nlogit{response = 1|sex,age} = \u22129.84 + 3.49 \u00d7 sex + .158 \u00d7 age,\n\n(10.21)\n\nwhere as before sex = 0 for females, 1 for males. for example, for a 40-year-\nold female, the predicted logit is \u22129.84 + .158(40) = \u22123.52. the predicted\nprobability of a response is 1/[1 + exp(3.52)] = .029. for a 40-year-old male,\nthe predicted logit is \u22129.84 + 3.49 + .158(40) = \u2212.03, with a probability\nof .492.\n\n10.1.4 design formulations\n\nthe logistic multiple regression model can incorporate the same designs as\ncan ordinary linear regression. an analysis of variance (anova) model for\na treatment with k levels can be formulated with k \u2212 1 dummy variables.\nthis logistic model is equivalent to a 2 \u00d7 k contingency table. an analysis\nof covariance logistic model is simply an anova model augmented with\ncovariables used for adjustment.\n\none unique design that is interesting to consider in the context of logistic\nmodels is a simultaneous comparison of multiple factors between two groups.\nsuppose, for example, that in a randomized trial with two treatments one\nwished to test whether any of 10 baseline characteristics are mal-distributed\nbetween the two groups. if the 10 factors are continuous, one could perform a\ntwo-sample wilcoxon\u2013mann\u2013whitney test or a t-test for each factor (if each\nis normally distributed). however, this procedure would result in multiple\ncomparison problems and would also not be able to detect the combined ef-\nfect of small differences across all the factors. a better procedure would be a\nmultivariate test. the hotelling t 2 test is designed for just this situation. it\nis a k-variable extension of the one-variable unpaired t-test. the t 2 test, like\ndiscriminant analysis, assumes multivariate normality of the k factors. this\nassumption is especially tenuous when some of the factors are polytomous. a\nbetter alternative is the global test of no regression from the logistic model.\nthis test is valid because it can be shown that h0 : mean x is the same for\nboth groups (= h0 : mean x does not depend on group = h0 : mean x|\ngroup = constant) is true if and only if h0 : prob{group|x} = constant. thus\n\nk factors can be tested simultaneously for differences between the two groups\nusing the binary logistic model, which has far fewer assumptions than does the\nhotelling t 2 test. the logistic global test of no regression (with k d.f.) would\nbe expected to have greater power if there is non-normality. since the logistic\nmodel makes no assumption regarding the distribution of the descriptor vari-\nables, it can easily test for simultaneous group differences involving a mixture\nof continuous, binary, and nominal variables. in observational studies, such\n\n "}, {"Page_number": 254, "text": "10.2 estimation\n\n231\n\nmodels for treatment received or exposure (propensity score models) hold\ngreat promise for adjusting for confounding.117, 380, 526, 530, 531\n\no\u2019brien479 has developed a general test for comparing group 1 with\ngroup 2 for a single measurement. his test detects location and scale dif-\nferences by fitting a logistic model for prob{group 2} using x and x 2 as\npredictors.\n\nfor a randomized study where adjustment for confounding is seldom neces-\nsary, adjusting for covariables using a binary logistic model results in increases\nin standard errors of regression coefficients.527 this is the opposite of what\nhappens in linear regression where there is an unknown variance parameter\nthat is estimated using the residual squared error. fortunately, adjusting for\ncovariables using logistic regression, by accounting for subject heterogeneity,\nwill result in larger regression coefficients even for a randomized treatment\nvariable. the increase in estimated regression coefficients more than offsets\nthe increase in standard error284, 285, 527, 588.\n\n5\n\n10.2 estimation\n\n10.2.1 maximum likelihood estimates\n\nthe parameters in the logistic regression model are estimated using the maxi-\nmum likelihood (ml) method. the method is based on the same principles as\nthe one-sample proportion example described in section 9.1. the difference\nis that the general logistic model is not a single sample or a two-sample prob-\nlem. the probability of response for the ith subject depends on a particular\nset of predictors xi, and in fact the list of predictors may not be the same\nfor any two subjects. denoting the response and probability of response of\nthe ith subject by yi and pi, respectively, the model states that\n\npi = prob{yi = 1|xi} = [1 + exp(\u2212xi\u03b2)]\n\n\u22121.\n\n(10.22)\n\nthe likelihood of an observed response yi given predictors xi and the un-\nknown parameters \u03b2 is\n\n[1 \u2212 pi]1\u2212yi.\n\np yi\ni\n\n(10.23)\n\nthe joint likelihood of all responses y1, y2, . . . , yn is the product of these\nlikelihoods for i = 1, . . . , n. the likelihood and log likelihood functions are\nrewritten by using the definition of pi above to allow them to be recognized\nas a function of the unknown parameters \u03b2. except in simple special cases\n(such as the k-sample problem in which all xs are dummy variables), the\nml estimates (mle) of \u03b2 cannot be written explicitly. the newton\u2013raphson\nmethod described in section 9.4 is usually used to solve iteratively for the\nlist of values \u03b2 that maximize the log likelihood. the mles are denoted by\n\n "}, {"Page_number": 255, "text": "232\n\n10 binary logistic regression\n\n\u02c6\u03b2. the inverse of the estimated observed information matrix is taken as the\nestimate of the variance\u2013covariance matrix of \u02c6\u03b2.\n\nunder h0 : \u03b21 = \u03b22 = . . . = \u03b2k = 0, the intercept parameter \u03b20 can be\nestimated explicitly and the log likelihood under this global null hypothesis\ncan be computed explicitly. under the global null hypothesis, pi = p =\n[1 + exp(\u2212\u03b20)]\n\u22121 and the mle of p is \u02c6p = s/n where s is the number of\nresponses and n is the sample size. the mle of \u03b20 is \u02c6\u03b20 = logit( \u02c6p ). the log\nlikelihood under this null hypothesis is\n\ns log( \u02c6p ) + (n \u2212 s) log(1 \u2212 \u02c6p )\n\n= s log(s/n) + (n \u2212 s) log[(n \u2212 s)/n]\n= s log s + (n \u2212 s) log(n \u2212 s) \u2212 n log(n).\n\n(10.24)\n\n6\n\n10.2.2 estimation of odds ratios and probabilities\n\nonce \u03b2 is estimated, one can estimate any log odds, odds, or odds ratios.\nthe mle of the xj + 1 : xj log odds ratio is \u02c6\u03b2j, and the estimate of the\nxj + d : xj log odds ratio is \u02c6\u03b2jd, all other predictors remaining constant\n(assuming the absence of interactions and nonlinearities involving xj). for\nlarge enough samples, the mles are normally distributed with variances that\nare consistently estimated from the estimated variance\u2013covariance matrix.\nletting z denote the 1\u2212\u03b1/2 critical value of the standard normal distribution,\na two-sided 1 \u2212 \u03b1 confidence interval for the log odds ratio for a one-unit\nincrease in xj is [ \u02c6\u03b2j \u2212 zs, \u02c6\u03b2j + zs], where s is the estimated standard error\nof \u02c6\u03b2j. (note that for \u03b1 = .05, i.e., for a 95% confidence interval, z = 1.96.)\n\na theorem in statistics states that the mle of a function of a parameter\nis that same function of the mle of the parameter. thus the mle of the\nxj + 1 : xj odds ratio is exp( \u02c6\u03b2j). also, if a 1 \u2212 \u03b1 confidence interval of a\nparameter \u03b2 is [c, d] and f (u) is a one-to-one function, a 1 \u2212 \u03b1 confidence\ninterval of f (\u03b2) is [f (c), f (d)]. thus a 1\u2212\u03b1 confidence interval for the xj +1 :\nxj odds ratio is exp[ \u02c6\u03b2j \u00b1 zs]. note that while the confidence interval for \u03b2j is\nsymmetric about \u02c6\u03b2j, the confidence interval for exp(\u03b2j) is not. by the same\ntheorem just used, the mle of pi = prob{yi = 1|xi} is\n\n\u02c6pi = [1 + exp(\u2212xi \u02c6\u03b2)]\n\n\u22121.\n\n(10.25)\n\na confidence interval for pi could be derived by computing the standard\nerror of \u02c6pi, yielding a symmetric confidence interval. however, such an in-\nterval would have the disadvantage that its endpoints could fall below zero\nor exceed one. a better approach uses the fact that for large samples x \u02c6\u03b2\nis approximately normally distributed. an estimate of the variance of x \u02c6\u03b2\nwhere v is the estimated variance\u2013covariance\nin matrix notation is xv x\n\n(cid:2)\n\n "}, {"Page_number": 256, "text": "10.2 estimation\n\n233\n\nmatrix of \u02c6\u03b2 (see equation 9.51). this variance is the sum of all variances and\ncovariances of \u02c6\u03b2 weighted by squares and products of the predictors. the es-\ntimated standard error of x \u02c6\u03b2, s, is the square root of this variance estimate.\na 1 \u2212 \u03b1 confidence interval for pi is then\n\n7\n\n{1 + exp[\u2212(xi \u02c6\u03b2 \u00b1 zs)]}\u22121.\n\n(10.26)\n\n10.2.3 minimum sample size requirement\n\nsuppose there were no covariates, so that the only parameter in the model is\nthe intercept. what is the sample size required to allow the estimate of the\nintercept to be precise enough so that the predicted probability is within 0.1\nof the true probability with 0.95 confidence, when the true intercept is in the\nneighborhood of zero? the answer is n=96. what if there were one covariate,\nand it was binary with a prevalence of 1\n2 ? one would need 96 subjects with\nx = 0 and 96 with x = 1 to have an upper bound on the margin of error\nfor estimating prob{y = 1|x = x} not exceed 0.1 for either value of xa.\n\nnow consider a very simple single continuous predictor case in which x\nhas a normal distribution with mean zero and standard deviation \u03c3, with the\ntrue prob{y = 1|x = x} = [1 + exp(\u2212x)]\n\u22121. the expected number of events\nis n\nb. the following simulation answers the question \u201cwhat should n be so\nthat the expected maximum absolute error (over x \u2208 [\u22121.5, 1.5]) in \u02c6p is less\n2\nthan \u0001?\u201d\nsigmas \u2190 c ( .5 , .75 , 1, 1 .25 , 1 .5 , 1 .75 , 2, 2 .5 , 3, 4)\n\nns\nnsim\nxs\n\n\u2190 seq (25 , 300 , by =25)\n\u2190 1000\n\u2190 seq ( -1.5 , 1 .5 , length =200)\n\npactual \u2190 plogis ( xs )\ndn \u2190 list ( sigma = format ( sigmas ), n = format ( ns ))\nmaxerr \u2190 n1 \u2190 array (na , c ( length ( sigmas ), length ( ns )) , dn )\n\nrequire ( rms )\n\ni \u2190 0\n\nfor ( s in sigmas ) {\n\ni \u2190 i + 1\nj \u2190 0\n\nfor ( n in ns ) {\n\n2 (intercept=0) for the worst case.\n\na the general formula for the sample size required to achieve a margin of error of \u03b4 in\n\u03b4 )2\u00d7\u03b8(1\u2212\u03b8).\nestimating a true probability of \u03b8 at the 0.95 confidence level is n = ( 1.96\nset \u03b8 = 1\nb the r code can easily be modified for other event frequencies, or the minimum of\nthe number of events and non-events for a dataset at hand can be compared with n\n2\nin this simulation. an average maximum absolute error of 0.05 corresponds roughly\nto a half-width of the 0.95 confidence interval of 0.1.\n\n "}, {"Page_number": 257, "text": "234\n\n10 binary logistic regression\n\nj \u2190 j + 1\nn1 \u2190 maxe \u2190 0\n\nfor ( k in 1: nsim ) {\n\nx \u2190 rnorm (n , 0, s )\np \u2190 plogis ( x )\ny \u2190 ifelse ( runif (n ) \u2264 p , 1, 0)\nn1 \u2190 n1 + sum (y )\nbeta \u2190 lrm.fit (x , y ) $ coefficients\nphat \u2190 plogis ( beta [1] + beta [2] * xs )\nmaxe \u2190 maxe + max ( abs ( phat - pactual ))\n\n}\n\nn1 \u2190 n1 / nsim\nmaxe \u2190 maxe / nsim\nmaxerr [i , j ] \u2190 maxe\nn1 [i , j ] \u2190 n1\n\n}\n\n}\n\nxrange \u2190 range ( xs )\nsimerr \u2190 llist ( n1 , maxerr , sigmas , ns , nsim , xrange )\nmaxe \u2190 reshape ( maxerr )\nxyplot ( maxerr \u223c n , groups = sigma , data = maxe ,\n\n# f i g u r e 10.4\n\nylab = expression ( paste ( ' average maximum\n\n' ,\n\nabs ( hat ( p) - p ))) ,\n\ntype = ' l ' , lty = rep (1:2 , 5) , label.curve = false ,\nabline = list ( h= c ( .15 , .1 , .05 ), col = gray ( .85 )))\n\nkey ( .8 , .68 , other = list ( cex = .7 ,\n\ntitle = expression (\u223c\u223c\u223c\u223c\u223c\u223c\u223c\u223c\u223c\u223c\u223csigma )))\n\n10.3 test statistics\n\nthe likelihood ratio, score, and wald statistics discussed earlier can be used\nto test any hypothesis in the logistic model. the likelihood ratio test is gen-\nerally preferred. when true parameters are near the null values all three\nstatistics usually agree. the wald test has a significant drawback when the\ntrue parameter value is very far from the null value. in such case the stan-\ndard error estimate becomes too large. as \u02c6\u03b2j increases from 0, the wald test\nstatistic for h0 : \u03b2j = 0 becomes larger, but after a certain point it becomes\nsmaller. the statistic will eventually drop to zero if \u02c6\u03b2j becomes infinite.278\ninfinite estimates can occur in the logistic model especially when there is a\nbinary predictor whose mean is near 0 or 1. wald statistics are especially\nproblematic in this case. for example, if 10 out of 20 males had a disease and\n5 out of 5 females had the disease, the female : male odds ratio is infinite and\nso is the logistic regression coefficient for sex. if such a situation occurs, the\nlikelihood ratio or score statistic should be used instead of the wald statistic.\n\n "}, {"Page_number": 258, "text": "10.4 residuals\n\n235\n\n\u03c3\n0.5\n0.75\n1\n1.25\n1.5\n1.75\n2\n2.5\n3\n4\n\np\n\n\u2212\n\np^\n\n \n\ni\n\nm\nu\nm\nx\na\nm\n \ne\ng\na\nr\ne\nv\na\n\n0.20\n\n0.15\n\n0.10\n\n0.05\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\nfig. 10.4 simulated expected maximum error in estimating probabilities for x \u2208\n[\u22121.5, 1.5] with a single normally distributed x with mean zero\n\nn\n\nfor k-sample (anova-type) logistic models, logistic model statistics are\nequivalent to contingency table \u03c72 statistics. as exemplified in the logistic\nmodel relating sex to response described previously, the global likelihood\nratio statistic for all dummy variables in a k-sample model is identical to the\ncontingency table (k-sample binomial) likelihood ratio \u03c72 statistic. the score\nstatistic for this same situation turns out to be identical to the k \u2212 1 degrees\nof freedom pearson \u03c72 for a k \u00d7 2 table.\n\nas mentioned in section 2.6, it can be dangerous to interpret individual\nparameters, make pairwise treatment comparisons, or test linearity if the\noverall test of association for a factor represented by multiple parameters is\ninsignificant.\n\n10.4 residuals\n\nseveral types of residuals can be computed for binary logistic model fits. many\nof these residuals are used to examine the influence of individual observations\non the fit. the partial residual can be used for directly assessing how each\n\n8\n\n "}, {"Page_number": 259, "text": "236\n\n10 binary logistic regression\n\npredictor should be transformed. for the ith observation, the partial residual\nfor the jth element of x is defined by\n\nrij = \u02c6\u03b2jxij +\n\nyi \u2212 \u02c6pi\n\u02c6pi(1 \u2212 \u02c6pi)\n\n,\n\n(10.27)\n\nwhere xij is the value of the jth variable in the ith observation, yi is the\ncorresponding value of the response, and \u02c6pi is the predicted probability that\nyi = 1. a smooth plot (using, e.g., loess) of xij against rij will provide an\nestimate of how xj should be transformed, adjusting for the other xs (using\ntheir current transformations). typically one tentatively models xj linearly\nand checks the smoothed plot for linearity. a u -shaped relationship in this\nplot, for example, indicates that a squared term or spline function needs to\nbe added for xj. this approach does assume additivity of predictors.\n\n9\n\n10.5 assessment of model fit\n\nas the logistic regression model makes no distributional assumptions, only\nthe assumptions of linearity and additivity need to be verified (in addition\nto the usual assumptions about independence of observations and inclusion\nof important covariables). in ordinary linear regression there is no global\ntest for lack of model fit unless there are replicate observations at various\nsettings of x. this is because ordinary regression entails estimation of a\nseparate variance parameter \u03c32. in logistic regression there are global tests\nfor goodness of fit. unfortunately, some of the most frequently used ones are\ninappropriate. for example, it is common to see a deviance test of goodness\nof fit based on the \u201cresidual\u201d log likelihood, with p -values obtained from a \u03c72\ndistribution with n \u2212 p d.f. this p -value is inappropriate since the deviance\ndoes not have an asymptotic \u03c72 distribution, due to the facts that the number\nof parameters estimated is increasing at the same rate as n and the expected\ncell frequencies are far below five (by definition).\n\nhosmer and lemeshow304 have developed a commonly used test for good-\nness of fit for binary logistic models based on grouping into deciles of pre-\ndicted probability and performing an ordinary \u03c72 test for the mean predicted\nprobability against the observed fraction of events (using 8 d.f. to account\nfor evaluating fit on the model development sample). the hosmer\u2013lemeshow\ntest is dependent on the choice of how predictions are grouped303 and it is\nnot clear that the choice of the number of groups should be independent of n.\nhosmer et al.303 have compared a number of global goodness of fit tests for\nbinary logistic regression. they concluded that the simple unweighted sum of\nsquares test of copas124 as modified by le cessie and van houwelingen387 is as\n\n "}, {"Page_number": 260, "text": "10.5 assessment of model fit\n\n237\n\ngood as any. they used a normal z-test for the sum of squared errors (n\u00d7 b,\nwhere b is the brier index in equation 10.35). this test takes into account the\nfact that one cannot obtain a \u03c72 distribution for the sum of squares. it also\ntakes into account the estimation of \u03b2. it is not yet clear for which types of\nlack of fit this test has reasonable power. returning to the external validation\ncase where uncertainty of \u03b2 does not need to be accounted for, stallard584 has\nfurther documented the lack of power of the original hosmer-lemeshow test\nand found more power with a logarithmic scoring rule (deviance test) and a\n\u03c72 test that, unlike the simple unweighted sum of squares test, weights each\nsquared error by dividing it by \u02c6pi(1\u2212 \u02c6pi). a scaled \u03c72 distribution seemed to\nprovide the best approximation to the null distribution of the test statistics.\nmore power for detecting lack of fit is expected to be obtained from testing\n\nspecific alternatives to the model. in the model\n\nlogit{y = 1|x} = \u03b20 + \u03b21x1 + \u03b22x2,\n\n(10.28)\n\nwhere x1 is binary and x2 is continuous, one needs to verify that the log\nodds is related to x1 and x2 according to figure 10.5.\n\n}\n1\n=\ny\n{\nt\ni\n\ng\no\n\nl\n\nx1= 1\n\nx1= 0\n\nx2\n\nfig. 10.5 logistic regression assumptions for one binary and one continuous predic-\ntor\n\nthe simplest method for validating that the data are consistent with the\nno-interaction linear model involves stratifying the sample by x1 and quan-\ntile groups (e.g., deciles) of x2.265 within each stratum the proportion of\nresponses \u02c6p is computed and the log odds calculated from log[ \u02c6p /(1 \u2212 \u02c6p )].\nthe number of quantile groups should be such that there are at least 20 (and\nperhaps many more) subjects in each x1\u00d7x2 group. otherwise, probabilities\n\ncannot be estimated precisely enough to allow trends to be seen above \u201cnoise\u201d\nin the data. since at least 3 x2 groups must be formed to allow assessment\nof linearity, the total sample size must be at least 2 \u00d7 3 \u00d7 20 = 120 for this\nmethod to work at all.\n\n "}, {"Page_number": 261, "text": "238\n\n10 binary logistic regression\n\nfigure 10.6 demonstrates this method for a large sample size of 3504 sub-\njects stratified by sex and deciles of age. linearity is apparent for males while\nthere is evidence for slight interaction between age and sex since the age trend\nfor females appears curved.\n\ngethdata ( acath )\n\nacath $ sex \u2190 factor ( acath $ sex , 0:1 , c ( ' male ' , ' female ' ))\ndd \u2190 datadist ( acath ); options ( datadist = ' dd ' )\nf \u2190 lrm ( sigdz \u223c rcs ( age , 4) * sex , data = acath )\nw \u2190 function ( ... )\n\nwith ( acath , {\n\nadd = true , grid = true )\n\nplsmo ( age , sigdz , group = sex , fun = qlogis , lty = ' dotted ' ,\naf \u2190 cut2 ( age , g =10 , levels.mean = true )\nprop \u2190 qlogis ( tapply ( sigdz , list ( af , sex ), mean ,\nagem \u2190 as.numeric ( row.names ( prop ))\nlpoints ( agem , prop [, ' female ' ], pch =4 , col = ' green ' )\nlpoints ( agem , prop [, ' male ' ],\npch =2 , col = ' green ' )\n\nna.rm = true ))\n\n} )\n\n# f i g u r e 10.6\n\nplot ( predict (f , age , sex ), ylim = c ( -2 ,4) , addpanel =w ,\n\nlabel.curve = list ( offset = unit (0 .5 , ' cm ' )))\n\nthe subgrouping method requires relatively large sample sizes and does\nnot use continuous factors effectively. the ordering of values is not used at all\nbetween intervals, and the estimate of the relationship for a continuous vari-\nable has little resolution. also, the method of grouping chosen (e.g., deciles\nvs. quintiles vs. rounding) can alter the shape of the plot.\n\nin this dataset with only two variables, it is efficient to use a nonpara-\nmetric smoother for age, separately for males and females. nonparametric\nsmoothers, such as loess111 used here, work well for binary response vari-\nables (see section 2.4.7); the logit transformation is made on the smoothed\nprobability estimates. the smoothed estimates are shown in figure 10.6.\n\n10\n\nwhen there are several predictors, the restricted cubic spline function is\n\ncontinuous variables without assuming linearity. by fitting a model containing\n\nbetter for estimating the true relationship between x2 and logit{y = 1} for\nx2 expanded into k\u2212 1 terms, where k is the number of knots, one can obtain\nan estimate of the transformation of x2 as discussed in section 2.4:\n\nlogit{y = 1|x} = \u02c6\u03b20 + \u02c6\u03b21x1 + \u02c6\u03b22x2 + \u02c6\u03b23x\n\n(cid:2)\n2 + \u02c6\u03b24x\n\n(cid:2)(cid:2)\n2\n\n= \u02c6\u03b20 + \u02c6\u03b21x1 + f (x2),\n\n(10.29)\n\n(cid:2)\n2 and x\n\n(cid:2)(cid:2)\n2 are constructed spline variables (when k = 4). plotting\nwhere x\nthe estimated spline function f (x2) versus x2 will estimate how the effect of\nx2 should be modeled. if the sample is sufficiently large, the spline function\ncan be fitted separately for x1 = 0 and x1 = 1, allowing detection of even\nunusual interaction patterns. a formal test of linearity in x2 is obtained by\ntesting h0 : \u03b23 = \u03b24 = 0.\n\n "}, {"Page_number": 262, "text": "10.5 assessment of model fit\n\n239\n\ns\nd\nd\no\n\n \n\ng\no\n\nl\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\nmale\n\nfemale\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\nage,year\n\nfig. 10.6 logit proportions of significant coronary artery disease by sex and deciles\nof age for n=3504 patients, with spline fits (smooth curves). spline fits are for k = 4\nknots at age= 36, 48, 56, and 68 years, and interaction between age and sex is allowed.\nshaded bands are pointwise 0.95 confidence limits for predicted log odds. smooth\nnonparametric estimates are shown as dotted curves. data courtesy of the duke\ncardiovascular disease databank.\n\nfor testing interaction between x1 and x2, a product term (e.g., x1x2)\ncan be added to the model and its coefficient tested. a more general simul-\ntaneous test of linearity and lack of interaction for a two-variable model in\nwhich one variable is binary (or is assumed linear) is obtained by fitting the\nmodel\n\nlogit{y = 1|x} = \u03b20 + \u03b21x1 + \u03b22x2 + \u03b23x\n\n(cid:2)\n2 + \u03b24x\n\n+ \u03b25x1x2 + \u03b26x1x\n\n(cid:2)\n2 + \u03b27x1x\n\n(cid:2)(cid:2)\n2\n\n(cid:2)(cid:2)\n2\n\n(10.30)\n\nand testing h0 : \u03b23 = . . . = \u03b27 = 0. this formulation allows the shape of the\nx2 effect to be completely different for each level of x1. there is virtually\nno departure from linearity and additivity that cannot be detected from this\nexpanded model formulation. the most computationally efficient test for lack\nof fit is the score test (e.g., x1 and x2 are forced into a tentative model\nand the remaining variables are candidates). figure 10.6 also depicts a fitted\nspline logistic model with k = 4, allowing for general interaction between\nage and sex as parameterized above. the fitted function, after expanding the\nrestricted cubic spline function for simplicity (see equation 2.27), is given\nabove. note the good agreement between the empirical estimates of log odds\nand the spline fits and nonparametric estimates in this large dataset.\n\nan analysis of log likelihood for this model and various sub-models is found\nin table 10.3. the \u03c72 for global tests is corrected for the intercept and the\ndegrees of freedom does not include the intercept.\n\n "}, {"Page_number": 263, "text": "240\n\n10 binary logistic regression\n\ntable 10.3 lr \u03c72 tests for coronary artery disease risk\n\nmodel / hypothesis\n\na: sex, age (linear, no interaction)\nb: sex, age, age \u00d7 sex\nc: sex, spline in age\nd: sex, spline in age, interaction\nh0 : no age \u00d7 sex interaction\nh0 : age linear | no interaction\nh0 : age linear, no interaction\nh0 : age linear, product form\n\ngiven linearity\n\ninteraction\n\nh0 : no interaction, allowing for\n\nnonlinearity in age\n\nlikelihood d.f. p formula\nratio \u03c72\n766.0\n768.2\n769.4\n782.5\n2.2\n\n2\n3\n4\n7\n1 .14\n\n(b \u2212 a)\n(c \u2212 a)\n2 .18\n5 .005 (d \u2212 a)\n4 .006 (d \u2212 b)\n3 .004 (d \u2212 c)\n\n3.4\n16.6\n14.4\n\n13.1\n\ntable 10.4 aic on \u03c72 scale by number of knots\n\nk model \u03c72 aic\n99.23\n0\n97.23\n112.69 108.69\n3\n121.30 115.30\n4\n5\n123.51 115.51\n124.41 114.51\n6\n\nthis analysis confirms the first impression from the graph, namely, that\nage \u00d7 sex interaction is present but it is not of the form of a simple product\nbetween age and sex (change in slope). in the context of a linear age effect,\nthere is no significant product interaction effect (p = .14). without allowing\nfor interaction, there is no significant nonlinear effect of age (p = .18). how-\never, the general test of lack of fit with 5 d.f. indicates a significant departure\nfrom the linear additive model (p = .005).\n\nin figure 10.7, data from 2332 patients who underwent cardiac catheteri-\nzation at duke university medical center and were found to have significant\n(\u2265 75%) diameter narrowing of at least one major coronary artery were ana-\nlyzed (the dataset is available from the web site). the relationship between\nthe time from the onset of symptoms of coronary artery disease (e.g., angina,\nmyocardial infarction) to the probability that the patient has severe (three-\nvessel disease or left main disease\u2014tvdlm) coronary disease was of interest.\nthere were 1129 patients with tvdlm. a logistic model was used with the\nduration of symptoms appearing as a restricted cubic spline function with\nk = 3, 4, 5, and 6 equally spaced knots in terms of quantiles between .05 and\n.95. the best fit for the number of parameters was chosen using akaike\u2019s\ninformation criterion (aic), computed in table 10.4 as the model likelihood\n\n "}, {"Page_number": 264, "text": "10.5 assessment of model fit\n\n241\n\nratio \u03c72 minus twice the number of parameters in the model aside from the\nintercept. the linear model is denoted k = 0.\ndz \u2190 subset ( acath , sigdz ==1)\ndd \u2190 datadist ( dz )\nf \u2190 lrm ( tvdlm \u223c rcs ( cad.dur , 5) , data = dz )\nw \u2190 function ( ... )\n\nwith ( dz , {\n\nplsmo ( cad.dur , tvdlm , fun = qlogis , add = true ,\n\ngrid = true , lty = ' dotted ' )\n\nx \u2190 cut2 ( cad.dur , g =15 , levels.mean = true )\nprop \u2190 qlogis ( tapply ( tvdlm , x , mean , na.rm = true ))\nxm \u2190 as.numeric ( names ( prop ))\nlpoints ( xm , prop , pch =2 , col = ' green ' )\n\n} )\n\n# f i g u r e 10.7\n\nplot ( predict (f , cad.dur ), addpanel = w )\n\ns\nd\nd\no\n\n \n\ng\no\n\nl\n\n2\n\n1\n\n0\n\n\u22121\n\n0\n\n100\n\n200\n\n300\n\nduration of symptoms of coronary artery disease\n\nfig. 10.7 estimated relationship between duration of symptoms and the log odds\nof severe coronary artery disease for k = 5. knots are marked with arrows. solid line\nis spline fit; dotted line is a nonparametric loess estimate.\n\nfigure 10.7 displays the spline fit for k = 5. the triangles represent sub-\ngroup estimates obtained by dividing the sample into groups of 150 patients.\nfor example, the leftmost triangle represents the logit of the proportion\nof tvdlm in the 150 patients with the shortest duration of symptoms, ver-\nsus the mean duration in that group. a wald test of linearity, with 3 d.f.,\nshowed highly significant nonlinearity (\u03c72= 23.92 with 3 d.f.). the plot of the\nspline transformation suggests a log transformation, and when log (duration\nof symptoms in months + 1) was fitted in a logistic model, the log likelihood\nof the model (119.33 with 1 d.f.) was virtually as good as the spline model\n(123.51 with 4 d.f.); the corresponding akaike information criteria (on the \u03c72\nscale) are 117.33 and 115.51. to check for adequacy in the log transformation,\n\n "}, {"Page_number": 265, "text": "242\n\n10 binary logistic regression\n\na five-knot restricted cubic spline function was fitted to log10(months + 1),\nas displayed in figure 10.8. there is some evidence for lack of fit on the right,\nbut the wald \u03c72 for testing linearity yields p = .27.\nf \u2190 lrm ( tvdlm \u223c log10 ( cad.dur + 1) , data = dz )\nw \u2190 function ( ... )\n\nwith ( dz , {\n\nx \u2190 cut2 ( cad.dur , m =150 , levels.mean = true )\nprop \u2190 tapply ( tvdlm , x , mean , na.rm = true )\nxm \u2190 as.numeric ( names ( prop ))\nlpoints ( xm , prop , pch =2 , col = ' green ' )\n\n} )\n\nf i g u r e 10.8\n\n#\nplot ( predict (f , cad.dur , fun = plogis ), ylab = ' p ' ,\n\nylim = c ( .2 , .8 ), addpanel = w )\n\n0.7\n\n0.6\n\np\n\n0.5\n\n0.4\n\n0.3\n\n0\n\n100\n\n200\n\n300\n\nduration of symptoms of coronary artery disease\n\nfig. 10.8 fitted linear logistic model in log10(duration + 1), with subgroup es-\ntimates using groups of 150 patients. fitted equation is logit(tvdlm) = \u2212.9809 +\n.7122 log10(months + 1).\n\nif the model contains two continuous predictors, they may both be ex-\npanded with spline functions in order to test linearity or to describe nonlinear\nrelationships. testing interaction is more difficult here. if x1 is continuous,\none might temporarily group x1 into quantile groups. consider the subset\nof 2258 (1490 with disease) of the 3504 patients used in figure 10.6 who\nhave serum cholesterol measured. a logistic model for predicting significant\ncoronary disease was fitted with age in tertiles (modeled with two dummy\nvariables), sex, age \u00d7 sex interaction, four-knot restricted cubic spline in\ncholesterol, and age tertile \u00d7 cholesterol interaction. except for the sex ad-\njustment this model is equivalent to fitting three separate spline functions in\ncholesterol, one for each age tertile. the fitted model is shown in figure 10.9\nfor cholesterol and age tertile against logit of significant disease. significant\nage \u00d7 cholesterol interaction is apparent from the figure and is suggested by\n\n "}, {"Page_number": 266, "text": "10.5 assessment of model fit\n\n243\n\nthe wald \u03c72 statistic (10.03) that follows. note that the test for linearity of\nthe interaction with respect to cholesterol is very insignificant (\u03c72 = 2.40 on\n4 d.f.), but we retain it for now. the fitted function is\nacath \u2190 transform ( acath ,\n\ncholesterol = choleste ,\nage.tertile = cut2 ( age , g =3) ,\nsx = as.integer ( acath $ sex ) - 1)\n\n# sx for loess , need to code as n u m e r i c\n\ndd \u2190 datadist ( acath ); options ( datadist = ' dd ' )\n\n# f i r s t m o d e l s t r a t i f i e s age into t e r t i l e s to get more\n# e m p i r i c a l e s t i m a t e s of age x c h o l e s t e r o l i n t e r a c t i o n\n\nf \u2190 lrm ( sigdz \u223c age.tertile * ( sex + rcs ( cholesterol ,4)) ,\n\ndata = acath )\nprint (f , latex = true )\n\nlogistic regression model\n\nlrm(formula = sigdz ~ age.tertile * (sex + rcs(cholesterol, 4)),\n\ndata = acath)\n\nfrequencies of missing values due to each variable\n\nsigdz age.tertile\n0\n\n0\n\nsex cholesterol\n1246\n\n0\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\nmax| \u2202 log l\n\n\u2202\u03b2 | 2\u00d710\n\n533.52 r2\n\n2258 lr \u03c72\n768 d.f.\n14 g\n1490 pr(> \u03c72) < 0.0001 gr\ngp\nbrier\n\n\u22128\n\n0.291 c\n1.316 dxy\n3.729 \u03b3\n0.252 \u03c4a\n0.173\n\n0.780\n0.560\n0.562\n0.251\n\ncoef\n-0.4155 1.0987\nintercept\n0.8781 1.7337\nage.tertile=[49,58)\n4.7861 1.8143\nage.tertile=[58,82]\n-1.6123 0.1751\nsex=female\n0.0029 0.0060\ncholesterol\n0.0384 0.0242\ncholesterol\u2019\n-0.1148 0.0768\ncholesterol\u201d\nage.tertile=[49,58) * sex=female -0.7900 0.2537\nage.tertile=[58,82] * sex=female -0.4530 0.2978\nage.tertile=[49,58) * cholesterol\n0.0011 0.0095\n\ns.e. wald z pr(> |z|)\n0.7053\n-0.38\n0.6125\n0.51\n0.0083\n2.64\n-9.21 < 0.0001\n0.6347\n0.48\n0.1126\n1.59\n-1.49\n0.1350\n0.0018\n-3.11\n0.1283\n-1.52\n0.11\n0.9093\n\n "}, {"Page_number": 267, "text": "244\n\n10 binary logistic regression\n\ncoef\n-0.0158 0.0099\nage.tertile=[58,82] * cholesterol\n-0.0183 0.0365\nage.tertile=[49,58) * cholesterol\u2019\nage.tertile=[58,82] * cholesterol\u2019\n0.0127 0.0406\nage.tertile=[49,58) * cholesterol\u201d 0.0582 0.1140\nage.tertile=[58,82] * cholesterol\u201d -0.0092 0.1301\n\ns.e. wald z pr(> |z|)\n0.1111\n0.6162\n0.7550\n0.6095\n0.9436\n\n-1.59\n-0.50\n0.31\n0.51\n-0.07\n\nltx ( f )\n\n+ + 3.44 \u00d7 10\n\n\u22126(cholesterol \u2212 160)3\n\n\u22126(cholesterol \u2212 208)3\n\nx \u02c6\u03b2 = \u22120.415 + 0.878[age.tertile \u2208 [49, 58)] + 4.79[age.tertile \u2208 [58, 82]] \u2212\n1.61[female] + 0.00287cholesterol + 1.52\u00d7 10\n\u2212 4.53\u00d7\n\u2212 4.28 \u00d7 10\n\u22126(cholesterol \u2212 243)3\n\u22127\n10\n++[female][\u22120.79[age.tertile \u2208 [49, 58)]\u22120.453[age.tertile \u2208\n(cholesterol\u2212319)3\n[58, 82]]] + [age.tertile \u2208 [49, 58)][0.00108cholesterol\u2212 7.23\u00d710\n\u22127(cholesterol\u2212\n\u22126(cholesterol \u2212 208)3\n+ + 2.3\u00d7 10\n160)3\n+ +\n2.69\u00d710\n+] + [age.tertile \u2208 [58, 82]][\u22120.0158cholesterol +\n5\u00d710\n\u22127(cholesterol \u2212 160)3\n\u2212 3.64\u00d710\n\u22127\n\u22127(cholesterol \u2212 319)3\n(cholesterol \u2212 243)3\n+].\n\n\u22127(cholesterol\u2212 319)3\n+ + 3.78\u00d710\n\n\u22126(cholesterol \u2212 243)3\n\u2212 5.15\u00d710\n\n\u2212 1.84\u00d7 10\n\u22127(cholesterol \u2212 208)3\n\n+\n\n+\n\n+\n\n+\n\n+\n\n# t a b l e 10.5:\nlatex ( anova ( f ), file = ' ' , size = ' smaller ' ,\n\ncaption = ' crudely categorizing age into tertiles ' ,\nlabel = ' tab : anova-tertiles ' )\n\nyl \u2190 c ( -1 ,5)\n\nplot ( predict (f , cholesterol , age.tertile ),\n\nadj.subtitle = false , ylim = yl )\n\n# f i g u r e 10.9\n\ntable 10.5 crudely categorizing age into tertiles\n\n\u03c72\n\nd.f.\n\np\n\nall interactions\n\nall interactions\n\nsex (factor+higher order factors)\n\nage.tertile (factor+higher order factors)\n\ncholesterol (factor+higher order factors)\n\n120.74 10 < 0.0001\n8\n0.0052\n21.87\n3 < 0.0001\n329.54\n2\n0.0075\n9.78\n9 < 0.0001\n93.75\n0.1235\n6\nall interactions\n10.03\n0.1263\n6\nnonlinear (factor+higher order factors)\n9.96\nage.tertile \u00d7 sex (factor+higher order factors)\n0.0075\n2\n9.78\nage.tertile \u00d7 cholesterol (factor+higher order factors) 10.03\n0.1235\n6\n4\n0.6237\n2.62\nnonlinear\n0.6237\n4\n2.62\nnonlinear interaction : f(a,b) vs. ab\n0.1263\n6\n9.96\n0.0052\n21.87\n8\n29.67 10\n0.0010\n410.75 14 < 0.0001\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\n "}, {"Page_number": 268, "text": "10.5 assessment of model fit\n\n245\n\n[58,82]\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n4\n\n3\n\n2\n\n1\n\n0\n\n[49,58)\n\n[17,49)\n\n100\n\n200\n\n300\n\n400\n\ncholesterol, mg %\n\nfig. 10.9 log odds of significant coronary artery disease modeling age with two\ndummy variables\n\nbefore fitting a parametric model that allows interaction between age and\ncholesterol, let us use the local regression model of cleveland et al.96 dis-\ncussed in section 2.4.7. this nonparametric smoothing method is not meant\nto handle binary y , but it can still provide useful graphical displays in the\nbinary case. figure 10.10 depicts the fit from a local regression model predict-\ning y = 1 = significant coronary artery disease. predictors are sex (modeled\nparametrically with a dummy variable), age, and cholesterol, the last two\nfitted nonparametrically. the effect of not explicitly modeling a probability\nis seen in the figure, as the predicted probabilities exceeded 1. because of this\nwe do not take the logit transformation but leave the predicted values in raw\nform. however, the overall shape is in agreement with figure 10.10.\nf \u2190 loess ( sigdz \u223c age * ( sx + cholesterol ), data = acath ,\nages \u2190 seq (25 ,\nchols \u2190 seq (100 , 400 , length =40)\ng \u2190 expand.grid ( cholesterol = chols , age = ages , sx =0)\np \u2190 drop ( predict (f , g ))\np [ p < 0 .001 ] \u2190 0 .001\np [ p > 0 .999 ] \u2190 0 .999\nzl \u2190 c ( -3 , 6)\nwireframe ( qlogis ( p ) \u223c cholesterol * age ,\n\n# drop sex d i m e n s i o n of grid s i n c e held to 1 v a l u e\n\nparametric = \" sx \" , drop.square = \" sx \" )\n\n# r e - d o m o d e l with c o n t i n u o u s age\n\n75 , length =40)\n\n# f i g u r e 10.10\n\nxlab = list ( rot =30) , ylab = list ( rot = -40 ),\nzlab = list ( label = ' log odds ' , rot =90) , zlim = zl ,\nscales = list ( arrows = false ), data = g )\n\nchapter 2 discussed linear splines, which can be used to construct linear\nspline surfaces by adding all cross-products of the linear variables and spline\nterms in the model. with a sufficient number of knots for each predictor, the\nlinear spline surface can fit a wide variety of patterns. however, it requires\n\n "}, {"Page_number": 269, "text": "246\n\n10 binary logistic regression\n\na large number of parameters to be estimated. for the age\u2013sex\u2013cholesterol\nexample, a linear spline surface is fitted for age and cholesterol, and a sex\n\u00d7 age spline interaction is also allowed. figure 10.11 shows a fit that placed\nknots at quartiles of the two continuous variablesc. the algebraic form of the\nfitted model is shown below.\nf \u2190 lrm ( sigdz \u223c lsp ( age , c (46 ,52 ,59)) *\n\n( sex + lsp ( cholesterol , c (196 ,224 ,259))) ,\ndata = acath )\n\nltx ( f )\n\nx \u02c6\u03b2 = \u22121.83 + 0.0232 age + 0.0759(age \u2212 46)+ \u2212 0.0025(age \u2212 52)+ +\n2.27(age\u221259)++3.02[female]\u22120.0177cholesterol+0.114(cholesterol\u2212196)+\u2212\n0.131(cholesterol\u2212 224)+ + 0.0651(cholesterol\u2212 259)+ + [female][\u22120.112 age+\n0.0852 (age \u2212 46)+ \u2212 0.0302 (age \u2212 52)+ + 0.176 (age \u2212 59)+] + age\n[0.000577 cholesterol \u2212 0.00286 (cholesterol \u2212 196)+ + 0.00382 (cholesterol \u2212\n224)+ \u2212 0.00205 (cholesterol \u2212 259)+] + (age \u2212 46)+[\u22120.000936 cholesterol +\n0.00643(cholesterol\u2212196)+\u22120.0115(cholesterol\u2212224)++0.00756(cholesterol\u2212\n259)+] + (age \u2212 52)+[0.000433 cholesterol \u2212 0.0037 (cholesterol \u2212 196)+ +\n0.00815 (cholesterol \u2212 224)+ \u2212 0.00715 (cholesterol \u2212 259)+] + (age \u2212 59)+\n[\u22120.0124cholesterol+0.015(cholesterol\u2212196)+\u22120.0067(cholesterol\u2212224)+ +\n0.00752 (cholesterol \u2212 259)+].\n\n6\n\n4\n\ns\nd\nd\no\n\n \n\ng\no\n\nl\n\n2\n\n0\n\n\u22122\n\n70\n\n60\n\n50\n\na\n\ng\n\ne\n\n40\n\n30\n\n150\n\n100\n\n400\n\n350\n\n300\n\n250\n\n200\n\nst e r ol\n\nole\n\nh\n\nc\n\nfig. 10.10 local regression fit for the logit of the probability of significant coronary\ndisease vs. age and cholesterol for males, based on the loess function.\n\nc in the wireframe plots that follow, predictions for cholesterol\u2013age combinations for\nwhich fewer than 5 exterior points exist are not shown, so as to not extrapolate to\nregions not supported by at least five points beyond the data perimeter.\n\n "}, {"Page_number": 270, "text": "10.5 assessment of model fit\n\n247\n\nlatex ( anova ( f ), caption = ' linear spline surface ' , file = ' ' ,\n\nsize = ' smaller ' , label = ' tab : anova-lsp ' )\n\n# t a b l e 10.6\n\nperim \u2190 with ( acath ,\nzl \u2190 c ( -2 , 4)\n\n# f i g u r e 10.11\n\nperimeter ( cholesterol , age , xinc =20 , n =5))\n\nbplot ( predict (f , cholesterol , age , np =40) , perim = perim ,\n\nlfun = wireframe , zlim = zl , adj.subtitle = false )\n\ntable 10.6 linear spline surface\n\n\u03c72\n\nd.f.\n\np\n\nage (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nsex (factor+higher order factors)\n\nall interactions\n\ncholesterol (factor+higher order factors)\n\nall interactions\n16.27 16\nnonlinear (factor+higher order factors)\n16.35 15\nage \u00d7 sex (factor+higher order factors)\n4\n23.90\nnonlinear\n3\n12.97\nnonlinear interaction : f(a,b) vs. ab\n12.97\n3\nage \u00d7 cholesterol (factor+higher order factors) 16.27 16\n11.45 15\nnonlinear\n11.45 15\nnonlinear interaction : f(a,b) vs. ab\n9.38\nf(a,b) vs. af(b) + bg(a)\n9\nnonlinear interaction in age vs. af(b)\n9.99 12\n10.75 12\nnonlinear interaction in cholesterol vs. bg(a)\n33.22 24\n42.28 20\n49.03 26\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\n343.80\n23.90\n\n42.28 20\n25.21 18\n\n164.17 24 < 0.0001\n0.0025\n0.1192\n5 < 0.0001\n4\n0.0001\n100.13 20 < 0.0001\n0.4341\n0.3595\n0.0001\n0.0047\n0.0047\n0.4341\n0.7204\n0.7204\n0.4033\n0.6167\n0.5503\n0.0995\n0.0025\n0.0041\n449.26 29 < 0.0001\n\nchapter 2 also discussed a tensor spline extension of the restricted cubic\nspline model to fit a smooth function of two predictors, f (x1, x2). since\nthis function allows for general interaction between x1 and x2, the two-\nvariable cubic spline is a powerful tool for displaying and testing interaction,\nassuming the sample size warrants estimating 2(k \u2212 1) + (k \u2212 1)2 parameters\nfor a rectangular grid of k \u00d7 k knots. unlike the linear spline surface, the\ncubic surface is smooth. it also requires fewer parameters in most situations.\nthe general cubic model with k = 4 (ignoring the sex effect here) is\n\n(cid:2)\n\u03b20 + \u03b21x1 + \u03b22x\n1 + \u03b23x\n(cid:2)\n(cid:2)(cid:2)\n2 + \u03b210x\n2 + \u03b29x1x\n\u03b28x1x\n(cid:2)\n(cid:2)(cid:2)\n(cid:2)(cid:2)\n1x\n2 + \u03b213x\n1 x2 + \u03b214x\n\n(cid:2)(cid:2)\n1 + \u03b24x2 + \u03b25x\n\n(cid:2)\n(cid:2)(cid:2)\n2 + \u03b26x\n2 + \u03b27x1x2\n(cid:2)\n(cid:2)\n(cid:2)\n1x\n1x2 + \u03b211x\n2\n(cid:2)(cid:2)\n(cid:2)(cid:2)\n1 x\n1 x\n\n(cid:2)\n2 + \u03b215x\n\n+\u03b212x\n\n(cid:2)(cid:2)\n2 ,\n\n(10.31)\n\n+\n+\n\n "}, {"Page_number": 271, "text": "248\n\n10 binary logistic regression\n\n(cid:2)\n1, x\n\n(cid:2)(cid:2)\n1 , x\n\n(cid:2)\n2, and x\n\n(cid:2)(cid:2)\nwhere x\n2 are restricted cubic spline component variables\nfor x1 and x2 for k = 4. a general test of interaction with 9 d.f. is h0 : \u03b27 =\n. . . = \u03b215 = 0. a test of adequacy of a simple product form interaction is\nh0 : \u03b28 = . . . = \u03b215 = 0 with 8 d.f. a 13 d.f. test of linearity and additivity\nis h0 : \u03b22 = \u03b23 = \u03b25 = \u03b26 = \u03b27 = \u03b28 = \u03b29 = \u03b210 = \u03b211 = \u03b212 = \u03b213 = \u03b214 =\n\u03b215 = 0 .\n\nfigure 10.12 depicts the fit of this model. there is excellent agreement with\nfigures 10.9 and 10.11, including an increased (but probably insignificant)\nrisk with low cholesterol for age \u2265 57.\nf \u2190 lrm ( sigdz \u223c rcs ( age ,4) *( sex + rcs ( cholesterol ,4)) ,\n\ndata = acath , tol =1 e-11 )\n\nltx ( f )\n\n+\n\n+ + 0.00251(age\u2212 68)3\n\n+ + 0.00543(age \u2212 48)3\n\n\u2212 7.16\u00d7 10\n\u22126(cholesterol\u2212319)3\n\n\u22126(cholesterol \u2212 160)3\n\u22121.16\u00d710\n\u22125(age\u221236)3\n\nx \u02c6\u03b2 = \u22126.41 + 0.166age \u2212 0.00067(age \u2212 36)3\n0.00727(age\u2212 56)3\n1.96\u00d7 10\n10\n7.52\u00d710\n68)3\n10\n(cholesterol \u2212 319)3\n160)3\n10\n\n\u22126(cholesterol\u2212243)3\n+] + age[\u22120.00028cholesterol + 2.68\u00d7 10\n\u22128(cholesterol \u2212 208)3\n++9.71\u00d710\n\u22129(cholesterol\u2212 319)3\n\n++0.00015(age\u221248)3\n\u2212 4.99 \u00d7 10\n(cid:2)\n+] + age\n\u22127(cholesterol\u2212208)3\n\n\u22120.00045(age\u221256)3\n\u22128(cholesterol \u2212 243)3\n[0.00341cholesterol \u2212 4.02 \u00d7 10\n\u22125.79\u00d710\n[\u22120.029cholesterol+ 3.04\u00d710\n(cid:2)(cid:2)\n+] + age\n\n\u2212\n+ + 2.87[female] + 0.00979cholesterol+\n+ + 6.35\u00d7\n++[female][\u22120.109age+\n++0.000225(age\u2212\n+ + 3.03\u00d7\n+ + 1.69 \u00d7 10\n\u22128\n\u22127(cholesterol \u2212\n++8.79\u00d7\n\u22126(cholesterol\u2212\n\n\u22126(cholesterol \u2212 208)3\n\n\u22129(cholesterol \u2212 160)3\n\n\u22127(cholesterol\u2212243)3\n\n+\n\n+\n\n+\n\n+\n\n+\n\n4\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\ns\nd\nd\no\n\n \n\ng\no\n\nl\n\n70\n\n60\n\na\n\ng\n\ne,\n\ny\n\n50\n\ne\nar\n\n40\n\n30\n\n150\n\n100\n\n400\n\n350\ng  %\n\n300\n\n250\n\nh ole sterol,  m\n\n200\n\nc\n\nfig. 10.11 linear spline surface for males, with knots for age at 46, 52, 59 and knots\nfor cholesterol at 196, 224, and 259 (quartiles).\n\n "}, {"Page_number": 272, "text": "10.5 assessment of model fit\n\n249\n\n\u22126(cholesterol \u2212 208)3\n\n\u2212 7.34\u00d710\n\u22128(cholesterol \u2212 319)3\n+].\n\n160)3\n5.82\u00d710\n+\nlatex ( anova ( f ), caption = ' cubic spline surface ' , file = ' ' ,\nsize = ' smaller ' , label = ' tab : anova-rcs ' ) # t a b l e 10.7\n\n+ + 4.36\u00d710\n\n\u22126(cholesterol \u2212 243)3\n\n+\n\n\u2212\n\n# f i g u r e 10.12:\nbplot ( predict (f , cholesterol , age , np =40) , perim = perim ,\n\nlfun = wireframe , zlim = zl , adj.subtitle = false )\n\ntable 10.7 cubic spline surface\n\n\u03c72\n\nd.f.\n\np\n\nall interactions\n\n37.32 12\n21.01 10\n\nsex (factor+higher order factors)\n\nage (factor+higher order factors)\n\ncholesterol (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\n165.23 15 < 0.0001\n0.0002\n0.0210\n4 < 0.0001\n343.67\n23.31\n3 < 0.0001\n97.50 12 < 0.0001\nall interactions\n12.95\n0.1649\n9\nnonlinear (factor+higher order factors)\n8\n13.62\n0.0923\nage \u00d7 sex (factor+higher order factors)\n3 < 0.0001\n23.31\nnonlinear\n13.37\n0.0013\n2\n0.0013\n2\nnonlinear interaction : f(a,b) vs. ab\n13.37\nage \u00d7 cholesterol (factor+higher order factors) 12.95\n9\n0.1649\n0.5078\n8\n7.27\nnonlinear\n0.5078\n8\n7.27\nnonlinear interaction : f(a,b) vs. ab\n0.2480\n4\n5.41\nf(a,b) vs. af(b) + bg(a)\n0.3753\n6\n6.44\nnonlinear interaction in age vs. af(b)\nnonlinear interaction in cholesterol vs. bg(a)\n6.27\n6\n0.3931\n0.0097\n29.22 14\n0.0002\n37.32 12\n45.41 16\n0.0001\n450.88 19 < 0.0001\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\nstatistics for testing age \u00d7 cholesterol components of this fit are above.\nnone of the nonlinear interaction components is significant, but we again\nretain them.\n\nthe general interaction model can be restricted to be of the form\n\nf (x1, x2) = f1(x1) + f2(x2) + x1g2(x2) + x2g1(x1)\n\n(10.32)\n\nby removing the parameters \u03b211, \u03b212, \u03b214, and \u03b215 from the model. the previ-\nous table of wald statistics included a test of adequacy of this reduced form\n(\u03c72 = 5.41 on 4 d.f., p = .248). the resulting fit is in figure 10.13.\nf \u2190 lrm ( sigdz \u223c sex * rcs ( age ,4) + rcs ( cholesterol ,4) +\nlatex ( anova ( f ), file = ' ' , size = ' smaller ' ,\n\nrcs ( age ,4) % ia % rcs ( cholesterol ,4) , data = acath )\n\ncaption = ' singly nonlinear cubic spline surface ' ,\nlabel = ' tab : anova-ria ' ) # t a b l e 10.8\n\n "}, {"Page_number": 273, "text": "250\n\n10 binary logistic regression\n\n4\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\ns\nd\nd\no\n \ng\no\n\nl\n\n70\n\n60\n\n50\n\na\n\ng\n\ne,\n\ny\n\ne\nar\n\n40\n\n30\n\n150\n\n100\n\n400\n\n350\n\n300\n\n250\n\nst e r ol,  m\n\ng   %\n\n200\nole\n\nh\n\nc\n\nfig. 10.12 restricted cubic spline surface in two variables, each with k = 4 knots\n\ntable 10.8 singly nonlinear cubic spline surface\n\n\u03c72\n\nd.f.\n\np\n\n343.42\n24.05\n\nall interactions\n\nsex (factor+higher order factors)\n\nage (factor+higher order factors)\n\ncholesterol (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\n4 < 0.0001\n3 < 0.0001\n169.35 11 < 0.0001\n8 < 0.0001\n34.80\n6\n0.0111\n16.55\n8 < 0.0001\n93.62\n0.0548\n5\nall interactions\n10.83\n0.0281\n4\nnonlinear (factor+higher order factors)\n10.87\nage \u00d7 cholesterol (factor+higher order factors) 10.83\n0.0548\n5\n4\n0.5372\n3.12\nnonlinear\n0.5372\n4\n3.12\nnonlinear interaction : f(a,b) vs. ab\n0.4496\n2\nnonlinear interaction in age vs. af(b)\n1.60\n2\n0.4400\n1.64\nnonlinear interaction in cholesterol vs. bg(a)\nsex \u00d7 age (factor+higher order factors)\n3 < 0.0001\n24.05\n2\n0.0011\nnonlinear\n13.58\n0.0011\n13.58\n2\nnonlinear interaction : f(a,b) vs. ab\n27.89 10\n0.0019\n34.80\n8 < 0.0001\n45.45 12 < 0.0001\n453.10 15 < 0.0001\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\n# f i g u r e 10.13:\nbplot ( predict (f , cholesterol , age , np =40) , perim = perim ,\n\nlfun = wireframe , zlim = zl , adj.subtitle = false )\n\nltx ( f )\n\n "}, {"Page_number": 274, "text": "10.5 assessment of model fit\n\n251\n\ntable 10.9 linear interaction surface\n\nage (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nsex (factor+higher order factors)\n\nall interactions\n\ncholesterol (factor+higher order factors)\n\nall interactions\nnonlinear\nage \u00d7 cholesterol (factor+higher order factors)\nage \u00d7 sex (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\n\u03c72\n\nd.f.\n\np\n\n167.83\n31.03\n14.58\n345.88\n22.30\n89.37\n7.99\n10.65\n7.99\n22.30\n12.06\n12.06\n25.72\n31.03\n43.59\n\n7 < 0.0001\n4 < 0.0001\n4\n0.0057\n4 < 0.0001\n3\n0.0001\n4 < 0.0001\n0.0047\n1\n2\n0.0049\n0.0047\n1\n0.0001\n3\n0.0024\n2\n0.0024\n2\n6\n0.0003\n4 < 0.0001\n8 < 0.0001\n452.75 11 < 0.0001\n\n+\n\n+\n\n+\n\n\u2212 1.63\u00d710\n\n\u22125(age\u2212 68)3\n\n\u22125(age \u2212 56)3\n\n\u22127(age \u2212 36)3\n\u22127(age\u221268)3\n\n\u22126(cholesterol \u2212 243)3\n\n\u22126(cholesterol \u2212 160)3\n\n+ + 1.7\u00d710\n\u2212 1.31\u00d710\n\n\u22125(age\u221236)3\n\u22126(cholesterol \u2212 208)3\n\n\u22128(cholesterol\u2212243)3\n+ + 4.21\u00d710\n+]+[female][\u22120.111age+8.03\u00d710\n\u2212 0.00044(age \u2212 56)3\n\n\u22120.000106(age\u2212\n+ + 0.0148cholesterol +\n+ + 5.5 \u00d7\n+ + age[\u22120.00029\n\u2212\n+]+cholesterol[2.3\u00d7\n+ + 6.64\u00d7\n++0.000135(age\u2212\n\n\u22126(cholesterol \u2212 319)3\n\u22128(cholesterol\u2212319)3\n\u22125(age\u221236)3\n+ + 0.000224(age\u2212 68)3\n+].\n\nx \u02c6\u03b2 = \u22127.2+2.96[female]+0.164age+7.23\u00d710\n+ + 4.99\u00d710\n48)3\n\u2212 5.5 \u00d7 10\n1.21 \u00d7 10\n+\n\u2212 1.21\u00d7 10\n10\n\u22129(cholesterol\u2212 160)3\ncholesterol + 9.28\u00d710\n4.43\u00d710\n++1.79\u00d710\n\u22127(age \u2212 48)3\n10\n10\n48)3\n+\nthe fit is similar to the former one except that the climb in risk for low-\ncholesterol older subjects is less pronounced. the test for nonlinear interac-\ntion is now more concentrated (p = .54 with 4 d.f.). figure 10.14 accordingly\ndepicts a fit that allows age and cholesterol to have nonlinear main effects,\nbut restricts the interaction to be a product between (untransformed) age\nand cholesterol. the function agrees substantially with the previous fit.\nf \u2190 lrm ( sigdz \u223c rcs ( age ,4) * sex + rcs ( cholesterol ,4) +\n\n\u22128(cholesterol\u2212 208)3\n\u22126(age \u2212 56)3\n\n+\n\n+\n\nage % ia % cholesterol , data = acath )\n\nlatex ( anova ( f ) , caption = ' linear interacti o n surface ' , file = ' ' ,\n\nsize = ' smaller ' , label = ' tab : anova-lia ' ) #table 10.9\n\n# f i g u r e 10.14:\nbplot ( predict (f , cholesterol , age , np =40) , perim = perim ,\n\nlfun = wireframe , zlim = zl , adj.subtitle = false )\n\n# save l i n e a r i n t e r a c t i o n fit for l a t e r\n\nf.linia \u2190 f\n\nltx ( f )\n\n "}, {"Page_number": 275, "text": "252\n\n10 binary logistic regression\n\n4\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\ns\nd\nd\no\n \ng\no\n\nl\n\n70\n\n60\n\n50\n\na\n\ng\n\ne,\n\ny\n\ne\nar\n\n40\n\n30\n\n150\n\n100\n\n400\n\n350\n\n300\n\n250\n\ng   %\n\nst e r ol,  m\n\n200\n\nole\n\nh\n\nc\n\nfig. 10.13 restricted cubic spline fit with age \u00d7 spline(cholesterol) and cholesterol\n\u00d7 spline(age)\n\n+\n\n+\n\n+\n\n\u2212 2.99\u00d710\n\n\u22126(age \u2212 56)3\n\u22126(cholesterol \u2212 243)3\n\n\u22125(age \u2212 68)3\n\u2212 3.26\u00d710\n+ + 0.000205(age\u2212 68)3\n+].\n\n++8.45\u00d710\n\u22125(age\u221248)3\n\u22126(cholesterol \u2212 208)3\n\u22127(cholesterol \u2212 319)3\n\u22125(age \u2212 36)3\n\n\u22125(age\u221236)3\nx \u02c6\u03b2 = \u22127.36+0.182age\u22125.18\u00d710\n10\n\u2212 4.88\u00d7 10\n\u22126(cholesterol \u2212 160)3\n1.76\u00d7 10\n10\ncholesterol + [female][\u22120.107age + 7.71\u00d7 10\n48)3\n+\n\n\u22122.91\u00d7\n+ + 2.8[female] + 0.0139cholesterol +\n+ + 3.45\u00d7\n\u2212 0.00034 age \u00d7\n+ + 0.000115(age \u2212\nthe wald test for age \u00d7 cholesterol interaction yields \u03c72 = 7.99 with 1\nd.f., p = .005. these analyses favor the nonlinear model with simple prod-\nuct interaction in figure 10.14 as best representing the relationships among\ncholesterol, age, and probability of prognostically severe coronary artery dis-\nease. a nomogram depicting this model is shown in figure 10.21.\n\n\u2212 0.000398(age \u2212 56)3\n\n+\n\n+\n\nusing this simple product interaction model, figure 10.15 displays pre-\ndicted cholesterol effects at the mean age within each age tertile. substantial\nagreement with figure 10.9 is apparent.\n\n# make e s t i m a t e s of c h o l e s t e r o l e f f e c t s for mean age in\n# t e r t i l e s c o r r e s p o n d i n g to i n i t i a l a n a l y s i s\n\nmean.age \u2190\n\nwith ( acath ,\n\nas.vector ( tapply ( age , age.tertile , mean , na.rm = true )))\n\nplot ( predict (f , cholesterol , age = round ( mean.age ,2) ,\n\nsex = \" male \" ),\n\nadj.subtitle = false , ylim = yl ) # 3 curves , f i g u r e 10.15\n\n "}, {"Page_number": 276, "text": "10.5 assessment of model fit\n\n253\n\n4\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\ns\nd\nd\no\n \ng\no\n\nl\n\n70\n\n60\n\na\n\ng\ne, \n\ny\n\n50\n\ne\nar\n\n40\n\n30\n\n150\n\n100\n\n400\n\n350\n\n300\n\nst e r ol,  m\n\ng   %\n\n250\n\n200\n\nole\n\nh\n\nc\n\nfig. 10.14 spline fit with nonlinear effects of cholesterol and age and a simple\nproduct interaction\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n4\n\n3\n\n2\n\n1\n\n0\n\n63.73\n\n53.06\n\n41.74\n\n100\n\n200\n\n300\ncholesterol, mg %\n\n400\n\nfig. 10.15 predictions from linear interaction model with mean age in tertiles indi-\ncated.\n\nthe partial residuals discussed in section 10.4 can be used to check lo-\ngistic model fit (although it may be difficult to deal with interactions). as\nan example, reconsider the \u201cduration of symptoms\u201d fit in figure 10.7. fig-\nure 10.16 displays \u201cloess smoothed\u201d and raw partial residuals for the original\nand log-transformed variable. the latter provides a more linear relationship,\nespecially where the data are most dense.\n\n "}, {"Page_number": 277, "text": "254\n\n10 binary logistic regression\n\ntable 10.10 merits of methods for checking logistic model assumptions\n\nmethod\n\nchoice\n\nassumes uses ordering\n\nlow\n\ngood\n\nrequired additivity\n\nof x\n\nvariance\n\nresolution\n\non x\n\nintervals\n\nstratification\nsmoother on x1 bandwidth\nstratifying on x2\nsmooth partial\nresidual plot\nspline model\nfor all xs\n\nbandwidth\n\nknots\n\nx\n\nx\n\nx\n\n(not on x2)\n\n(if min. strat.)\n\n(x1)\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nf \u2190 lrm ( tvdlm \u223c cad.dur , data = dz , x = true , y = true )\n\nresid (f , \" partial \" , pl = \" loess \" , xlim = c (0 ,250) , ylim = c (-3 ,3))\nscat1d ( dz $ cad.dur )\n\nlog.cad.dur \u2190 log10 ( dz $ cad.dur + 1)\nf \u2190 lrm ( tvdlm \u223c log.cad.dur , data = dz , x = true , y = true )\n\nresid (f , \" partial \" , pl = \" loess \" , ylim = c ( -3 ,3))\nscat1d ( log.cad.dur )\n\n# f i g u r e 10.16\n\ni\nr\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\ni\nr\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n0\n\n50\n\n150\n\n250\n\n0.0\n\ncad.dur\n\n1.0\nlog.cad.dur\n\n2.0\n\nfig. 10.16 partial residuals for duration and log10(duration+1). data density shown\nat top of each plot.\n\ntable 10.10 summarizes the relative merits of stratification, nonparametric\nsmoothers, and regression splines for determining or checking binary logistic\nmodel fits.\n\n "}, {"Page_number": 278, "text": "10.7 overly influential observations\n\n255\n\n10.6 collinearity\n\nthe variance inflation factors (vifs) discussed in section 4.6 can apply to\nany regression fit.147, 654 these vifs allow the analyst to isolate which vari-\nable(s) are responsible for highly correlated parameter estimates. recall that,\nin general, collinearity is not a large problem compared with nonlinearity and\noverfitting.\n\n10.7 overly influential observations\n\npregibon511 developed a number of regression diagnostics that apply to the\nfamily of regression models of which logistic regression is a member. influence\nstatistics based on the \u201cleave-out-one\u201d method use an approximation to avoid\nhaving to refit the model n times for n observations. this approximation\nuses the fit and covariance matrix at the last iteration and assumes that\nthe \u201cweights\u201d in the weighted least squares fit can be kept constant, yielding\na computationally feasible one-step estimate of the leave-out-one regression\ncoefficients.\n\nhosmer and lemeshow [305, pp. 149\u2013170] discuss many diagnostics for\nlogistic regression and show how the final fit can be used in any least squares\nprogram that provides diagnostics. a new dependent variable to be used in\nthat way is\n\nzi = x \u02c6\u03b2 +\n\n,\n(10.33)\nvi\nwhere vi = \u02c6pi(1\u2212 \u02c6pi), and \u02c6pi = [1 + exp\u2212x \u02c6\u03b2]\n\u22121 is the predicted probability\nthat yi = 1. the vi, i = 1, 2, . . . , n are used as weights in an ordinary weighted\nleast squares fit of x against z. this least squares fit will provide regression\ncoefficients identical to b. the new standard errors will be off from the actual\nlogistic model ones by a constant.\n\nas discussed in section 4.9, the standardized change in the regression co-\nefficients upon leaving out each observation in turn (dfbetas) is one of the\nmost useful diagnostics, as these can pinpoint which observations are influ-\nential on each part of the model. after carefully modeling predictor trans-\nformations, there should be no lack of fit due to improper transformations.\nhowever, as the white blood count example in section 4.9 indicates, it is\ncommonly the case that extreme predictor values can still have too much\ninfluence on the estimates of coefficients involving that predictor.\n\nin the age\u2013sex\u2013response example of section 10.1.3, both dfbetas and\ndffits identified the same influential observations. the observation given\nby age = 48 sex = female response = 1 was influential for both age and sex,\nwhile the observation age = 34 sex = male response = 1 was influential for\nage and the observation age = 50 sex = male response = 0 was influential\nfor sex. it can readily be seen from figure 10.3 that these points do not fit\nthe overall trends in the data. however, as these data were simulated from a\n\nyi \u2212 \u02c6pi\n\n "}, {"Page_number": 279, "text": "256\n\n10 binary logistic regression\n\ntable 10.11 example influence statistics\n\nfemales\n\nmales\n\ndfbetas\n\ndffits\n\ndfbetas\n\ndffits\n\nintercept age\n0.0\n0.0\n0.0\n0.0\n0.1\n0.1\n-0.7\n0.1\n0.1\n0.1\n0.1\n0.0\n0.0\n0.0\n0.0\n-0.2\n0.2\n0.2\n0.2\n0.2\n\n0.0\n0.0\n0.0\n0.0\n-0.1\n-0.1\n0.7\n-0.1\n-0.1\n-0.1\n-0.1\n-0.1\n-0.1\n0.1\n0.0\n0.1\n-0.1\n-0.2\n-0.2\n-0.2\n\nsex\n0.0\n0.0\n0.0\n0.0\n0.1\n0.1\n-0.8\n0.1\n0.1\n0.1\n0.1\n0.1\n0.1\n-0.2\n0.1\n0.0\n0.0\n0.0\n0.0\n0.1\n\n0\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n1\n-1\n-1\n1\n1\n1\n1\n\nintercept age\n-0.5\n-0.3\n0.1\n0.1\n0.1\n0.0\n0.0\n0.0\n0.0\n-0.1\n0.0\n0.1\n0.1\n-0.3\n0.1\n0.1\n0.1\n0.0\n0.0\n0.0\n\n0.5\n0.2\n-0.1\n-0.1\n-0.1\n0.0\n0.0\n0.0\n0.0\n0.1\n0.0\n-0.1\n-0.1\n0.3\n-0.1\n-0.1\n-0.1\n0.0\n0.0\n0.0\n\nsex\n-0.2\n0.0\n0.0\n0.0\n-0.1\n0.1\n0.1\n0.1\n-0.2\n-0.2\n0.1\n0.1\n0.1\n-0.4\n0.1\n0.1\n0.1\n0.0\n0.0\n0.0\n\n2\n1\n-1\n-1\n-1\n0\n0\n0\n-1\n-1\n0\n0\n0\n-2\n0\n0\n0\n0\n0\n0\n\npopulation model that is truly linear in age and additive in age and sex, the\napparent influential observations are just random occurrences. it is unwise\nto assume that in real data all points will agree with overall trends. removal\nof such points would bias the results, making the model apparently more\npredictive than it will be prospectively. see table 10.11.\nf \u2190 update ( fasr , x = true , y = true )\n\nwhich.influen ce (f , .4 )\n\n# t a b l e 10.11\n\n10.8 quantifying predictive ability\n\nthe test statistics discussed above allow one to test whether a factor or set of\nfactors is related to the response. if the sample is sufficiently large, a factor\nthat grades risk from .01 to .02 may be a significant risk factor. however, that\nfactor is not very useful in predicting the response for an individual subject.\nthere is controversy regarding the appropriateness of r2 from ordinary least\nsquares in this setting.136, 424 the generalized r2\nn index of nagelkerke471 and\ncragg and uhler137, maddala431, and magee432 described in section 9.8.3\ncan be useful for quantifying the predictive strength of a model:\n\n11\n\n12\n\n "}, {"Page_number": 280, "text": "13\n\n14\n\n10.8 quantifying predictive ability\n\nr2\n\nn =\n\n1 \u2212 exp(\u2212lr/n)\n1 \u2212 exp(\u2212l0/n)\n\n,\n\n257\n\n(10.34)\n\nwhere lr is the global log likelihood ratio statistic for testing the importance\nof all p predictors in the model and l0 is the \u22122 log likelihood for the null\nmodel.\n\ntjur613 coined the term \u201ccoefficient of discrimination\u201d d, defined as the\naverage \u02c6p when y = 1 minus the average \u02c6p when y = 0, and showed how it\nties in with sum of squares\u2013based r2 measures. d has many advantages as\nan index of predictive powerd.\n\nlinnet416 advocates quadratic and logarithmic probability scoring rules\nfor measuring predictive performance for probability models. linnet shows\nhow to bootstrap such measures to get bias-corrected estimates and how to\nuse bootstrapping to compare two correlated scores. the quadratic scoring\nrule is brier\u2019s score, frequently used in judging meteorologic forecasts30, 73:\n\nn(cid:3)\n\ni=1\n\nb =\n\n1\nn\n\n( \u02c6pi \u2212 yi)2,\n\n(10.35)\n\nwhere \u02c6pi is the predicted probability and yi the corresponding observed re-\nsponse for the ith observation.\n\na unitless index of the strength of the rank correlation between predicted\nprobability of response and actual response is a more interpretable measure of\nthe fitted model\u2019s predictive discrimination. one such index is the probability\nof concordance, c, between predicted probability and response. the c index,\nwhich is derived from the wilcoxon\u2013mann\u2013whitney two-sample rank test,\nis computed by taking all possible pairs of subjects such that one subject\nresponded and the other did not. the index is the proportion of such pairs\nwith the responder having a higher predicted probability of response than\nthe nonresponder.\n\nbamber39 and hanley and mcneil255 have shown that c is identical to a\nwidely used measure of diagnostic discrimination, the area under a \u201creceiver\noperating characteristic\u201d(roc) curve. a value of c of .5 indicates random pre-\ndictions, and a value of 1 indicates perfect prediction (i.e., perfect separation\nof responders and nonresponders). a model having c greater than roughly\n.8 has some utility in predicting the responses of individual subjects. the\nconcordance index is also related to another widely used index, somers\u2019 dxy\nrank correlation579 between predicted probabilities and observed responses,\nby the identity\n\ndxy = 2(c \u2212 .5).\n\n(10.36)\n\ndxy is the difference between concordance and discordance probabilities.\nwhen dxy = 0, the model is making random predictions. when dxy = 1,\n\nd note that d and b (below) and other indexes not related to c (below) do not work\nwell in case-control studies because of their reliance on absolute probability estimates.\n\n "}, {"Page_number": 281, "text": "258\n\n10 binary logistic regression\n\nthe predictions are perfectly discriminating. these rank-based indexes have\nthe advantage of being insensitive to the prevalence of positive responses.\n\na commonly used measure of predictive ability for binary logistic models is\nthe fraction of correctly classified responses. here one chooses a cutoff on the\npredicted probability of a positive response and then predicts that a response\nwill be positive if the predicted probability exceeds this cutoff. there are a\nnumber of reasons why this measure should be avoided.\n\n1. it\u2019s highly dependent on the cutpoint chosen for a \u201cpositive\u201d prediction.\n2. you can add a highly significant variable to the model and have the per-\ncentage classified correctly actually decrease. classification error is a very\ninsensitive and statistically inefficient measure264, 633 since if the threshold\nfor \u201cpositive\u201d is, say 0.75, a prediction of 0.99 rates the same as one of\n0.751.\n\n3. it gets away from the purpose of fitting a logistic model. a logistic model\nis a model for the probability of an event, not a model for the occurrence\nof the event. for example, suppose that the event we are predicting is\nthe probability of being struck by lightning. without having any data,\nwe would predict that you won\u2019t get struck by lightning. however, you\nmight develop an interesting model that discovers real risk factors that\nyield probabilities of being struck that range from 0.000000001 to 0.001.\n4. if you make a classification rule from a probability model, you are being\npresumptuous. suppose that a model is developed to assist physicians\nin diagnosing a disease. physicians sometimes profess to desiring a binary\ndecision model, but if given a probability they will rightfully apply different\nthresholds for treating different patients or for ordering other diagnostic\ntests. even though the age of the patient may be a strong predictor of\nthe probability of disease, the physician will often use a lower threshold\nof disease likelihood for treating a young patient. this usage is above and\nbeyond how age affects the likelihood.\n\n5. if a disease were present in only 0.02 of the population, one could be 0.98\naccurate in diagnosing the disease by ruling that everyone is disease\u2013free,\ni.e., by avoiding predictors. the proportion classified correctly fails to take\nthe difficulty of the task into account.\n\n6. van houwelingen and le cessie633 demonstrated a peculiar property that\noccurs when you try to obtain an honest estimate of classification error\nusing cross-validation. the cross-validated error rate corrects the apparent\nerror rate only if the predicted probability is exactly 1/2 or is 1/2\u00b11/(2n).\nthe cross-validation estimate of optimism is \u201czero for n even and negligibly\nsmall for n odd.\u201d better measures of error rate such as the brier score and\nlogarithmic scoring rule do not have this problem. they also have the\nnice property of being maximized when the predicted probabilities are the\npopulation probabilities.416.\n\n15\n\n16\n\n "}, {"Page_number": 282, "text": "10.9 validating the fitted model\n\n259\n\n10.9 validating the fitted model\n\nthe major cause of unreliable models is overfitting the data. the methods\ndescribed in section 5.3 can be used to assess the accuracy of models fairly.\nif a sample has been held out and never used to study associations with the\nresponse, indexes of predictive accuracy can now be estimated using that\nsample. more efficient is cross-validation, and bootstrapping is the most ef-\nficient validation procedure. as discussed earlier, bootstrapping does not re-\nquire holding out any data, since all aspects of model development (stepwise\nvariable selection, tests of linearity, estimation of coefficients, etc.) are re-\nvalidated on samples taken with replacement from the whole sample.\n\ncox130 proposed and harrell and lee267 and miller et al.457 further de-\nveloped the idea of fitting a new binary logistic model to a new sample to\nestimate the relationship between the predicted probability and the observed\noutcome in that sample. this fit provides a simple calibration equation that\ncan be used to quantify unreliability (lack of calibration) and to calibrate\nthe predictions for future use. this logistic calibration also leads to indexes\nof unreliability (u ), discrimination (d), and overall quality (q = d \u2212 u )\nwhich are derived from likelihood ratio tests267. q is a logarithmic scoring\nrule, which can be compared with brier\u2019s index (equation 10.35). see [633]\nfor many more ideas.\n\nwith bootstrapping we do not have a separate validation sample for as-\nsessing calibration, but we can estimate the overoptimism in assuming that\nthe final model needs no calibration, that is, it has overall intercept=0 and\nslope=1. as discussed in section 5.3, refitting the model\n\npc = prob{y = 1|x \u02c6\u03b2} = [1 + exp\u2212(\u03b30 + \u03b31x \u02c6\u03b2)]\n\n\u22121\n\n(10.37)\n\n(where pc denotes the calibrated probability and the original predicted prob-\nability is \u02c6p = [1 + exp(\u2212x \u02c6\u03b2)]\n\u22121) in the original sample will always result in\n\u03b3 = (\u03b30, \u03b31) = (0, 1), since a logistic model will always \u201cfit\u201d the training sam-\nple when assessed overall. we thus estimate \u03b3 by using efron\u2019s172 method to\nestimate the overoptimism in (0, 1) to obtain bias-corrected estimates of the\ntrue calibration. simulations have shown this method produces an efficient\nestimate of \u03b3.259\n\nmore stringent calibration checks can be made by running separate calibra-\ntions for different covariate levels. smooth nonparametric curves described in\nsection 10.11 are more flexible than the linear-logit calibration method just\ndescribed.\n\na good set of indexes to estimate for summarizing a model validation is the\nc or dxy indexes and measures of calibration. in addition, the overoptimism\nin the indexes may be reported to quantify the amount of overfitting present.\nthe estimate of \u03b3 can be used to draw a calibration curve by plotting \u02c6p\non the x-axis and \u02c6pc = [1 + exp\u2212(\u03b30 + \u03b31l)]\n\u22121 on the y-axis, where l =\nlogit( \u02c6p ).130, 267 an easily interpreted index of unreliability, emax, follows\nimmediately from this calibration model:\n\n "}, {"Page_number": 283, "text": "260\n\n10 binary logistic regression\n\nemax(a, b) = max\na\u2264 \u02c6p\u2264b\n\n| \u02c6p \u2212 \u02c6pc|,\n\n(10.38)\n\nthe maximum error in predicted probabilities over the range a \u2264 \u02c6p \u2264 b. in\nsome cases, we would compute the maximum absolute difference in predicted\nand calibrated probabilities over the entire interval, that is, use emax(0, 1).\nthe null hypothesis h0 : emax(0, 1) = 0 can easily be tested by testing\nh0 : \u03b30 = 0, \u03b31 = 1 as above. since emax does not weight the discrepancies\nby the actual distribution of predictions, it may be preferable to compute the\naverage absolute discrepancy over the actual distribution of predictions (or\nto use a mean squared error, incorporating the same calibration function).\n\nif stepwise variable selection is being done, a matrix depicting which factors\nare selected at each bootstrap sample will shed light on how arbitrary is the\nselection of \u201csignificant\u201d factors. see section 5.3 for reasons to compare full\nand stepwise model fits.\n\nas an example using bootstrapping to validate the calibration and discrim-\nination of a model, consider the data in section 10.1.3. using 150 samples with\nreplacement, we first validate the additive model with age and sex forced into\nevery model. the optimism-corrected discrimination and calibration statistics\nproduced by validate (see section 10.11) are in the table below.\nd \u2190 sex.age.resp on se\ndd \u2190 datadist ( d ); options ( datadist = ' dd ' )\nf \u2190 lrm ( response \u223c sex + age , data =d , x = true , y = true )\nv1 \u2190 validate (f , b =150)\n\n# for r e p r o d u c i b i l i t y\n\nset.seed (3)\n\nlatex ( v1 ,\n\ncaption = ' bootstrap validation , 2 predictors without\nstepdown ' , digits =2 , size = ' ssize ' , file = ' ' )\n\nbootstrap validation, 2 predictors without stepdown\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.67\n0.43\n0.01\n0.91\n0.02\n0.36\n0.04\n0.32\n0.18\n1.97\n0.34\n\n0.70\n0.70\n0.45\n0.48\n0.00\n0.00\n1.00\n1.00\n0.00\n0.00\n0.39\n0.44\n\u22120.05 \u22120.05\n0.49\n0.44\n0.15\n0.16\n2.49\n2.10\n0.35\n0.35\n\n0.66 150\n0.40 150\n0.01 150\n0.91 150\n0.02 150\n0.32 150\n0.04 150\n0.28 150\n0.19 150\n1.58 150\n0.34 150\n\n0.04\n0.05\n\u22120.01\n0.09\n0.02\n0.07\n\u22120.09\n0.16\n\u22120.03\n0.52\n0.01\n\n "}, {"Page_number": 284, "text": "10.9 validating the fitted model\n\n261\n\nnow we incorporate variable selection. the variables selected in the first\n10 bootstrap replications are shown below. the apparent somers\u2019 dxy is 0.7,\nand the bias-corrected dxy is 0.66. the slope shrinkage factor is 0.91. the\nmaximum absolute error in predicted probability is estimated to be 0.02.\n\nwe next allow for step-down variable selection at each resample. for illus-\ntration purposes only, we use a suboptimal stopping rule based on significance\nof individual variables at the \u03b1 = 0.10 level. of the 150 repetitions, both age\nand sex were selected in 137, and neither variable was selected in 3 samples.\nthe validation statistics are in the table below.\nv2 \u2190 validate (f , b =150 , bw = true ,\n\nrule = ' p ' , sls = .1 , type = ' individual ' )\n\nlatex ( v2 ,\n\ncaption = ' bootstrap validation , 2 predictors with stepdown ' ,\ndigits =2 , b =15 , file = ' ' , size = ' ssize ' )\n\nbootstrap validation, 2 predictors with stepdown\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.70\n0.70\n0.64\n0.45\n0.49\n0.41\n0.00 \u22120.04\n0.00\n1.00\n0.84\n1.00\n0.00\n0.00\n0.05\n0.39\n0.45\n0.34\n\u22120.05 \u22120.05\n0.06\n0.28\n0.50\n0.44\n0.18\n0.14\n0.16\n1.88\n2.60\n2.10\n0.35\n0.35\n0.33\n\n0.63 150\n0.37 150\n\u22120.04 150\n0.84 150\n0.05 150\n0.28 150\n0.06 150\n0.22 150\n0.20 150\n1.38 150\n0.33 150\n\n0.07\n0.09\n0.04\n0.16\n0.05\n0.11\n\u22120.11\n0.22\n\u22120.04\n0.72\n0.02\n\nfactors retained in backwards elimination\n\nfirst 15 resamples\n\n "}, {"Page_number": 285, "text": "262\n\n10 binary logistic regression\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nsex age\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nfrequencies of numbers of factors retained\n\n2\n\n0 1\n3 10 137\n\nthe apparent somers\u2019 dxy is 0.7 for the original stepwise model (which ac-\ntually retained both age and sex), and the bias-corrected dxy is 0.63, slightly\nworse than the more correct model which forced in both variables. the cal-\nibration was also slightly worse as reflected in the slope correction factor\nestimate of 0.84 versus 0.91.\n\nnext, five additional candidate variables are considered. these variables\nare random uniform variables, x1, . . . , x5 on the [0, 1] interval, and have no\nassociation with the response.\n\nset.seed (133)\n\nn \u2190 nrow ( d )\nx1 \u2190 runif ( n )\nx2 \u2190 runif ( n )\nx3 \u2190 runif ( n )\nx4 \u2190 runif ( n )\nx5 \u2190 runif ( n )\nf \u2190 lrm ( response \u223c age + sex + x1 + x2 + x3 + x4 + x5 ,\nv3 \u2190 validate (f , b =150 , bw = true ,\n\ndata =d , x = true , y = true )\n\nrule = ' p ' , sls = .1 , type = ' individual ' )\n\n# c o m p u t e n u m b e r of x 1 - x 5 s e l e c t e d\n\nk \u2190 attr ( v3 , ' kept ' )\nnx \u2190 apply ( k [ ,3:7] , 1, sum )\nv \u2190 colnames ( k )\nas \u2190 apply ( k [ ,1:2] , 1,\n\n# get s e l e c t i o n s of age and sex\n\n "}, {"Page_number": 286, "text": "10.9 validating the fitted model\n\n263\n\ntable ( paste ( as , '\n\n' , nx , ' xs ' ))\n\nfunction (x ) paste ( v [1:2][ x ], collapse = ' , ' ))\n\n0 xs\n50\n\n1 xs\n3\n\nage\n\n2 xs age , sex\n\n1\n\nage , sex\n\n1 xs age , sex\n\n2 xs age , sex\n\n3 xs age , sex\n\nsex\n\n17\n0 xs\n12\n\nsex\n\n11\n1 xs\n3\n\n7\n\n0 xs\n34\n4 xs\n1\n\nlatex ( v3 ,\ncaption = ' bootstrap validation with 5 noise variables and\nstepdown ' , digits =2 , b =15 , size = ' ssize ' , file = ' ' )\n\nindex\n\nbootstrap validation with 5 noise variables and stepdown\noriginal training test optimism corrected n\nindex\nsample sample sample\n0.38\n0.23\n0.03\n0.78\n0.06\n0.18\n0.07\n0.11\n0.22\n1.06\n0.19\n\n0.70\n0.47\n0.45\n0.34\n0.00\n0.00\n1.00\n1.00\n0.00\n0.00\n0.39\n0.31\n\u22120.05 \u22120.05\n0.36\n0.44\n0.17\n0.16\n1.81\n2.10\n0.35\n0.23\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\n0.60 139\n0.34 139\n0.03 139\n0.78 139\n0.06 139\n0.26 139\n0.07 139\n0.19 139\n0.20 139\n1.36 139\n0.31 139\n\n0.09\n0.11\n\u22120.03\n0.22\n0.06\n0.13\n\u22120.12\n0.25\n\u22120.04\n0.75\n0.04\n\nfactors retained in backwards elimination\n\n\u2022\n\nfirst 15 resamples\nage sex x1 x2 x3 x4 x5\n\u2022 \u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022 \u2022\n\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\n\u2022\n\n "}, {"Page_number": 287, "text": "264\n\n10 binary logistic regression\n\nfrequencies of numbers of factors retained\n\n0 1 2 3 4 5 6\n50 15 37 18 11 7 1\n\nusing step-down variable selection with the same stopping rule as before,\nthe \u201cfinal\u201d model on the original sample correctly deleted x1, . . . , x5. of the\n150 bootstrap repetitions, 11 samples yielded a singularity or non-convergence\neither in the full-model fit or after step-down variable selection. of the 139\nsuccessful repetitions, the frequencies of the number of factors selected, as\nwell as the frequency of variable combinations selected, are shown above.\nvalidation statistics are also shown above.\n\nfigure 10.17 depicts the calibration (reliability) curves for the three strate-\ngies using the corrected intercept and slope estimates in the above tables as\n\u03b30 and \u03b31, and the logistic calibration model pc = [1 + exp\u2212(\u03b30 + \u03b31l)]\n\u22121,\nwhere pc is the \u201cactual\u201d or calibrated probability, l is logit( \u02c6p ), and \u02c6p is the\npredicted probability. the shape of the calibration curves (driven by slopes\n< 1) is typical of overfitting\u2014low predicted probabilities are too low and high\npredicted probabilities are too high. predictions near the overall prevalence\nof the outcome tend to be calibrated even when overfitting is present.\ng \u2190 function ( v ) v [ c ( ' intercept ' , ' slope ' ), ' index.correcte d ' ]\nk \u2190 rbind ( g ( v1 ), g ( v2 ), g ( v3 ))\nco \u2190 c (2 ,5 ,4 ,1)\n\nplot (0 , 0, ylim = c (0 ,1) , xlim = c (0 ,1) ,\n\nxlab = \" predicted probability \" ,\nylab = \" estimated actual probability \" , type = \" n \")\n\nlegend ( .45 , .35 , c ( \" age , sex \" , \" age , sex stepdown \" ,\n\n\" age , sex , x1-x5 \" , \" ideal \" ),\n\nlty =1 , col = co , cex = .8 , bty = \" n \" )\n\nprobs \u2190 seq (0 , 1, length =200); l \u2190 qlogis ( probs )\np \u2190 plogis ( k [i , ' intercept ' ] + k [i , ' slope ' ] * l )\n\nfor ( i in 1:3) {\n\nlines ( probs , p , col = co [i ], lwd =1)\n\n}\nabline ( a =0 , b =1 , col = co [4] , lwd =1)\n\n# f i g u r e 10.17\n\n\u201chonest\u201d calibration curves may also be estimated using nonparametric\nsmoothers in conjunction with bootstrapping and cross-validation (see\nsection 10.11).\n\n10.10 describing the fitted model\n\nonce the proper variables have been modeled and all model assumptions have\nbeen met, the analyst needs to present and interpret the fitted model. there\nare at least three ways to proceed. the coefficients in the model may be\ninterpreted. for each variable, the change in log odds for a sensible change in\nthe variable value (e.g., interquartile range) may be computed. also, the odds\n\n "}, {"Page_number": 288, "text": "10.10 describing the fitted model\n\n265\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\na\nu\n\n \n\nt\nc\na\nd\ne\na\nm\n\nt\n\ni\nt\ns\ne\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\nage, sex\nage, sex stepdown\nage, sex, x1\u2212x5\nideal\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\npredicted probability\n\nfig. 10.17 estimated logistic calibration (reliability) curves obtained by bootstrap-\nping three modeling strategies.\n\ntable 10.12 effects\n\nresponse : sigdz\n\nlow high \u03b4 effect\n\nage\n\nodds ratio\n\ncholesterol\n\nodds ratio\n\nsex \u2014 female:male\n\nodds ratio\n\n1\n1\n\n2\n2\n\n59 13 0.90629 0.18381\n59 13 2.47510\n\n46\n46\n196 259 63 0.75479 0.13642\n196 259 63 2.12720\n\n0.546030\n1.726400\n0.487410\n1.628100\n-2.42970 0.14839 -2.720600\n0.08806\n0.065837\n\ns.e. lower 0.95 upper 0.95\n1.26650\n3.54860\n1.02220\n2.77920\n-2.13890\n0.11778\n\nratio or factor by which the odds increases for a certain change in a predictor,\nholding all other predictors constant, may be displayed. table 10.12 contains\nsuch summary statistics for the linear age \u00d7 cholesterol interaction surface\nfit described in section 10.5.\ns \u2190 summary ( f.linia )\nlatex (s , file = ' ' , size = ' ssize ' ,\n\n# t a b l e 10.12\n\nlabel = ' tab : lrm-cholxag e- c on fb a r ' )\n\nplot ( s )\n\n# f i g u r e 10.18\n\nthe outer quartiles of age are 46 and 59 years, so the \u201chalf-sample\u201d odds\nratio for age is 2.47, with 0.95 confidence interval [1.63, 3.74] when sex is male\nand cholesterol is set to its median. the effect of increasing cholesterol from\n196 (its lower quartile) to 259 (its upper quartile) is to increase the log odds\nby 0.79 or to increase the odds by a factor of 2.21. since there are interactions\nallowed between age and sex and between age and cholesterol, each odds ratio\nin the above table depends on the setting of at least one other factor. the\n\n "}, {"Page_number": 289, "text": "266\n\n10 binary logistic regression\n\n0.10\n\n0.75\n\nodds ratio\n2.50\n1.50\n\n3.50\n\nage \u2212 59:46\n\ncholesterol \u2212 259:196\n\nsex \u2212 female:male\n\nadjusted to:age=52 sex=male cholesterol=224.5 \n\nfig. 10.18 odds ratios and confidence bars, using quartiles of age and cholesterol\nfor assessing their effects on the odds of coronary disease\n\nresults are shown graphically in figure 10.18. the shaded confidence bars\nshow various levels of confidence and do not pin the analyst down to, say, the\n0.95 level.\n\nfor those used to thinking in terms of odds or log odds, the preceding\ndescription may be sufficient. many prefer instead to interpret the model in\nterms of predicted probabilities instead of odds. if the model contains only\na single predictor (even if several spline terms are required to represent that\npredictor), one may simply plot the predictor against the predicted response.\nsuch a plot is shown in figure 10.19 which depicts the fitted relationship\nbetween age of diagnosis and the probability of acute bacterial meningitis\n(abm) as opposed to acute viral meningitis (avm), based on an analysis of\n422 cases from duke university medical center.580 the data may be found\non the web site. a linear spline function with knots at 1, 2, and 22 years was\nused to model this relationship.\n\nwhen the model contains more than one predictor, one may graph the pre-\ndictor against log odds, and barring interactions, the shape of this relationship\nwill be independent of the level of the other predictors. when displaying the\nmodel on what is usually a more interpretable scale, the probability scale, a\ndifficulty arises in that unlike log odds the relationship between one predictor\nand the probability of response depends on the levels of all other factors. for\nexample, in the model\n\nprob{y = 1|x} = {1 + exp[\u2212(\u03b20 + \u03b21x1 + \u03b22x2)]}\u22121\n\n(10.39)\n\nthere is no way to factor out x1 when examining the relationship between\nx2 and the probability of a response. for the two-predictor case one can plot\nx2 versus predicted probability for each level of x1. when it is uncertain\nwhether to include an interaction in this model, consider presenting graphs\nfor two models (with and without interaction terms included) as was done\nin [658].\n\n "}, {"Page_number": 290, "text": "10.10 describing the fitted model\n\n267\n\nm\nv\na\n \ns\nv\n \nm\nb\na\n \ny\nt\ni\ni\n\nb\na\nb\no\nr\np\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n0\n\n20\n\n40\n\n60\n\nage in years\n\nfig. 10.19 linear spline fit for probability of bacterial versus viral meningitis as a\nfunction of age at onset580. points are simple proportions by age quantile groups.\n\nwhen three factors are present, one could draw a separate graph for each\nlevel of x3, a separate curve on each graph for each level of x1, and vary x2\non the x-axis. instead of this, or if more than three factors are present, a good\nway to display the results may be to plot \u201cadjusted probability estimates\u201d as\na function of one predictor, adjusting all other factors to constants such as\nthe mean. for example, one could display a graph relating serum cholesterol\nto probability of myocardial infarction or death, holding age constant at 55,\nsex at 1 (male), and systolic blood pressure at 120 mmhg.\n\nthe final method for displaying the relationship between several predictors\nand probability of response is to construct a nomogram.40, 254 a nomogram\nnot only sheds light on how the effect of one predictor on the probability of\nresponse depends on the levels of other factors, but it allows one to quickly\nestimate the probability of response for individual subjects. the nomogram\nin figure 10.20 allows one to predict the probability of acute bacterial menin-\ngitis (given the patient has either viral or bacterial meningitis) using the same\nsample as in figure 10.19. here there are four continuous predictor values,\nnone of which are linearly related to log odds of bacterial meningitis: age\nat admission (expressed as a linear spline function), month of admission (ex-\npressed as |month\u22128|), cerebrospinal fluid glucose/blood glucose ratio (linear\neffect truncated at .6; that is, the effect is the glucose ratio if it is \u2264 .6, and .6\nif it exceeded .6), and the cube root of the total number of polymorphonuclear\nleukocytes in the cerebrospinal fluid.\n\nthe model associated with figure 10.14 is depicted in what could be called\na \u201cprecision nomogram\u201d in figure 10.21. discrete cholesterol levels were re-\nquired because of the interaction between two continuous variables.\n\n17\n\n "}, {"Page_number": 291, "text": "total\npmn\n\n11000\n10000\n9000\n8000\n\n7000\n\n6000\n\n5000\n\n4000\n\n3000\n2500\n\n2000\n\n1500\n\n1000\n\n500\n400\n300\n200\n\n100\n\n50\n\n10\n\n0\n\n268\n\nage\n\n10 binary logistic regression\n\nmonth\n\nprobability\n\nabm vs avm\n\nglucose\n\nratio\n.05\n\nb\n\nreading\n\nline\n\nreading\n\nline\n\n12m\n\n80\n\n12m\n\na\n\n1 feb\n\n1 feb\n\n1 mar\n\n1 jan\n\n1 apr\n\n1 dec\n\n1 may\n\n1 nov\n\n1 jun\n\n1 oct\n\n1 jul\n\n1 sep\n\n1 aug\n\n1 aug\n\n0.99\n\n0.90\n\n0.70\n0.50\n0.30\n\n0.10\n\n0.01\n\n0.95\n\n0.80\n0.60\n0.40\n0.20\n\n0.05\n\n6m\n\n0m\n\n75\n\n70\n\n65\n\n60\n\n55\n\n50\n\n45\n\n40\n\n35\n\n30\n\n18m\n\n2y\n\n5\n\n10\n\n15\n\n25\n\n22\n\n20\n\n22y\n\na\n\n.10\n\n.15\n\n.20\n\n.25\n\n.30\n\n.35\n\n.40\n\n.45\n\n.50\n\n.55\n\n\u2265.60\n\nb\n\nfig. 10.20 nomogram for estimating probability of bacterial (abm) versus viral\n(avm) meningitis. step 1, place ruler on reading lines for patient\u2019s age and month\nof presentation and mark intersection with line a; step 2, place ruler on values for\nglucose ratio and total polymorphonuclear leukocyte (pmn) count in cerebrospinal\nfluid and mark intersection with line b; step 3, use ruler to join marks on lines a and\nb, then read off the probability of abm versus avm.580\n\n# draw a n o m o g r a m that s h o w s e x a m p l e s of c o n f i d e n c e i n t e r v a l s\n\nnom \u2190 nomogram ( f.linia , cholesterol = seq (150 , 400 , by =50) ,\n\ninteract = list ( age = seq (30 , 70 , by =10)) ,\nlp.at = seq (-2 , 3 .5 , by = .5 ),\nconf.int = true , conf.lp = \" all \" ,\nfun = function ( x )1 / (1+ exp ( -x )) ,\nfunlabel = \" probability of cad \" ,\nfun.at = c ( seq ( .1 , .9 , by = .1 ), .95 , .99 )\n)\n\n# f i g u r e 10.21\n\n# or p l o g i s\n\nplot ( nom , col.grid = gray ( c (0 .8 , 0 .95 )) ,\n\nvarname.label = false , ia.space =1 , xfrac = .46 , lmgp = .2 )\n\n "}, {"Page_number": 292, "text": "10.11 r functions\n\n10.11 r functions\n\n269\n\nthe general r statistical modeling functions96 described in section 6.2 work\nwith the author\u2019s lrm function for fitting binary and ordinal logistic regres-\nsion models. lrm has several options for doing penalized maximum likelihood\nestimation, with special treatment of categorical predictors so as to shrink\nall estimates (including the reference cell) to the mean. the following exam-\nple fits a logistic model containing predictors age, blood.pressure, and sex,\nwith age fitted with a smooth five-knot restricted cubic spline function and a\ndifferent shape of the age relationship for males and females.\nfit \u2190 lrm ( death \u223c blood.pressure + sex * rcs ( age ,5))\n\nanova ( fit )\nplot ( predict ( fit , age , sex ))\n\nthe pentrace function makes it easy to check the effects of a sequence of\npenalties. the following code fits an unpenalized model and plots the aic\nand schwarz bic for a variety of penalties so that approximately the best\ncross-validating model can be chosen (and so we can learn how the penalty\nrelates to the effective degrees of freedom). here we elect to only penalize the\nnonlinear or non-additive parts of the model.\nf \u2190 lrm ( death \u223c rcs ( age ,5) * treatment + lsp ( sbp , c (120 ,140)) ,\n\nx = true , y = true )\n\nplot ( pentrace (f ,\n\npenalty = list ( nonlinear = seq ( .25 ,10 , by = .25 ))) )\n\n18\n\nsee sections 9.8.1 and 9.10 for more information.\n\n19\n\nthe residuals function for lrm and the which.influence function can be\nused to check predictor transformations as well as to analyze overly influential\nobservations in binary logistic regression. see figure 10.16 for one application.\nthe residuals function will also perform the unweighted sum of squares test\nfor global goodness of fit described in section 10.5.\n\nthe validate function when used on an object created by lrm does resam-\npling validation of a logistic regression model, with or without backward\nstep-down variable deletion. it provides bias-corrected somers\u2019 dxy rank\ncorrelation, r2\nn index, the intercept and slope of an overall logistic calibra-\ntion equation, the maximum absolute difference in predicted and calibrated\nprobabilities emax, the discrimination index d [(model l.r. \u03c72 \u2212 1)/n], the\nunreliability index u = (difference in \u22122 log likelihood between uncalibrated\nx\u03b2 and x\u03b2 with overall intercept and slope calibrated to test sample)/n,\nand the overall quality index q = d \u2212 u .267 the \u201ccorrected\u201d slope can\nbe thought of as a shrinkage factor that takes overfitting into account. see\npredab.resample in section 6.2 for the list of resampling methods.\n\nthe calibrate function produces bootstrapped or cross-validated calibra-\ntion curves for logistic and linear models. the \u201capparent\u201dcalibration accuracy\nis estimated using a nonparametric smoother relating predicted probabilities\n\n "}, {"Page_number": 293, "text": "270\n\npoints\n\ncholesterol (age=30\nsex=male)\ncholesterol (age=40\nsex=male)\ncholesterol (age=50\nsex=male)\ncholesterol (age=60\nsex=male)\ncholesterol (age=70\nsex=male)\ncholesterol (age=30\nsex=female)\ncholesterol (age=40\nsex=female)\ncholesterol (age=50\nsex=female)\ncholesterol (age=60\nsex=female)\ncholesterol (age=70\nsex=female)\n\ntotal points\n\nlinear predictor\n\nprobability of cad\n\n10 binary logistic regression\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90 100\n\n150\n\n250\n\n150\n\n300\n\n350\n\n400\n\n250\n\n300\n250\n\n350\n300 350 400\n\n400\n\n200\n\n250\n\n350\n\n200\n\n250 400\n\n200\n\n150\n\n250\n\n300\n\n350\n\n400\n\n150\n\n250\n250\n\n300\n\n350\n300 350 400\n\n400\n\n200\n\n250\n\n350\n\n200\n\n250 400\n\n200\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90 100\n\n\u22122 \u22121.5 \u22121 \u22120.5 0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n0.2\n\n0.3 0.4 0.5 0.6 0.7\n\n0.8\n\n0.9\n\n0.95\n\nfig. 10.21 nomogram relating age, sex, and cholesterol to the log odds and to\nthe probability of significant coronary artery disease. select one axis corresponding\nto sex and to age \u2208 {30, 40, 50, 60, 70}. there is linear interaction between age and\nsex and between age and cholesterol. 0.70 and 0.90 confidence intervals are shown\n(0.90 in gray). note that for the \u201clinear predictor\u201d scale there are various lengths\nof confidence intervals near the same value of x \u02c6\u03b2, demonstrating that the standard\nerror of x \u02c6\u03b2 depends on the individual x values. also note that confidence intervals\ncorresponding to smaller patient groups (e.g., females) are wider.\n\nto observed binary outcomes. the nonparametric estimate is evaluated at a\nline\nsequence of predicted probability levels. then the distances from the 45\nare compared with the differences when the current model is evaluated back\non the whole sample (or omitted sample for cross-validation). the differences\nin the differences are estimates of overoptimism. after averaging over many\nreplications, the predicted-value-specific differences are then subtracted from\n\n\u25e6\n\n "}, {"Page_number": 294, "text": "10.12 further reading\n\n271\n\nthe apparent differences and an adjusted calibration curve is obtained. un-\nlike validate, calibrate does not assume a linear logistic calibration. for an\nexample, see the end of chapter 11. calibrate will print the mean absolute\ncalibration error, the 0.9 quantile of the absolute error, and the mean squared\nerror, all over the observed distribution of predicted values.\n\nthe val.prob function is used to compute measures of discrimination and\ncalibration of predicted probabilities for a separate sample from the one\nused to derive the probability estimates. thus val.prob is used in exter-\nnal validation and data-splitting. the function computes similar indexes as\nvalidate plus the brier score and a statistic for testing for unreliability or\nh0 : \u03b30 = 0, \u03b31 = 1.\n\nin the following example, a logistic model is fitted on 100 observations\n\nsimulated from the actual model given by\n\nprob{y = 1|x1, x2, x3} = [1 + exp[\u2212(\u22121 + 2x1)]]\n\n\u22121,\n\n(10.40)\n\nset.seed (13)\n\nwhere x1 is a random uniform [0, 1] variable. hence x2 and x3 are irrelevant.\nafter fitting a linear additive model in x1, x2, and x3, the coefficients are\nused to predict prob{y = 1} on a separate sample of 100 observations.\nn \u2190 200\nx1 \u2190 runif ( n )\nx2 \u2190 runif ( n )\nx3 \u2190 runif ( n )\nlogit \u2190 2 * ( x1-.5 )\np \u2190 1 / (1+ exp ( -logit ))\ny \u2190 ifelse ( runif ( n ) \u2264 p , 1, 0)\nd \u2190 data.frame ( x1 , x2 , x3 , y )\nf \u2190 lrm ( y \u223c x1 + x2 + x3 , subset =1:100)\nphat \u2190 predict (f , d [101:200 ,] , type = ' fitted ' )\nv \u2190 val.prob ( phat , y [101:200] , m =20 , cex = .5 )\n\n# f i g u r e 10.22\n\nthe output is shown in figure 10.22.\n\nthe r built-in function glm, a very general modeling function, can fit binary\nlogistic models. the response variable must be coded 0/1 for glm to work. glm\nis a slight modification of the built-in glm function in the rms package that\nallows fits to use rms methods. this facilitates poisson and several other types\nof regression analysis.\n\n10.12 further reading\n\n1\n2\n\n3\n\nsee [590] for modeling strategies specific to binary logistic regression.\nsee [632] for a nice review of logistic modeling. agresti6 is an excellent source\nfor categorical y in general.\nnot only does discriminant analysis assume the same regression model as lo-\ngistic regression, but it also assumes that the predictors are each normally\ndistributed and that jointly the predictors have a multivariate normal distri-\nbution. these assumptions are unlikely to be met in practice, especially when\n\n "}, {"Page_number": 295, "text": "272\n\n10 binary logistic regression\n\ndxy\nc (roc)  \nr2\nd\nu\nq\nbrier    \nintercept\nslope\nemax\ns:z\ns:p\n\n 0.339\n 0.670\n 0.010\n\u22120.003\n\u22120.020\n 0.017\n 0.235\n\u22120.371\n 0.544\n 0.211\n 2.351\n 0.019\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\na\nu\nt\nc\na\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\nideal\nlogistic calibration\nnonparametric\ngrouped observations\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\npredicted probability\n\nfig. 10.22 validation of a logistic model in a test sample of size n = 100. the\ncalibrated risk distribution (histogram of logistic-calibrated probabilities) is shown.\n\none of the predictors is a discrete variable such as sex group. when discrimi-\nnant analysis assumptions are violated, logistic regression yields more accurate\nestimates.251, 514 even when discriminant analysis is optimal (i.e., when all\nits assumptions are satisfied) logistic regression is virtually as accurate as the\ndiscriminant model.264\nsee [573] for a review of measures of effect for binary outcomes.\ncepedaet al.95 found that propensity adjustment is better than covariate ad-\njustment with logistic models when the number of events per variable is less\nthan 8.\npregibon512 developed a modification of the log likelihood function that when\nmaximized results in a fit that is resistant to overly influential and outlying\nobservations.\nsee hosmer and lemeshow306 for methods of testing for a difference in the\nobserved event proportion and the predicted event probability (average of pre-\ndicted probabilities) for a group of heterogeneous subjects.\nsee hosmer and lemeshow,305 kay and little,341 and collett [115, chap. 5].\nlandwehr et al.373 proposed the partial residual (see also fowlkes199).\nsee berk and booth51 for other partial-like residuals.\nsee [341] for an example comparing a smoothing method with a parametric\nlogistic model fit.\nsee collett [115, chap. 5] and pregibon512 for more information about influence\nstatistics. pregibon\u2019s resistant estimator of \u03b2 handles overly influential groups\nof observations and allows one to estimate the weight that an observation con-\ntributed to the fit after making the fit robust. observations receiving low weight\nare partially ignored but are not deleted.\n\n4\n5\n\n6\n\n7\n\n8\n\n9\n10\n\n11\n\n12 buyse86 showed that in the case of a single categorical predictor, the ordi-\nnary r2 has a ready interpretation in terms of variance explained for binary\nresponses. menard454 studied various indexes for binary logistic regression. he\ncriticized r2\nn for being too dependent on the proportion of observations with\ny = 1. hu et al.309 further studied the properties of variance-based r2 mea-\nsures for binary responses. tjur613 has a nice discussion discrimination graphics\n\n "}, {"Page_number": 296, "text": "10.13 problems\n\n273\n\nand sum of squares\u2013based r2 measures for binary logistic regression, as well\nas a good discussion of \u201cseparation\u201d and infinite regression coefficients. sums of\nsquares are approximated various ways.\n\n13 very little work has been done on developing adjusted r2 measures in logistic\nregression and other non-linear model setups. liao and mcgee406 developed\none adjusted r2 measure for binary logistic regression, but it uses simulation to\nadjust for the bias of overfitting. one might as well use the bootstrap to adjust\nany of the indexes discussed in this section.\n[123, 633] have more pertinent discussion of probability accuracy scores.\n\n14\n15 copas121 demonstrated how roc areas can be misleading when applied to\ndifferent responses having greatly different prevalences. he proposed another\napproach, the logit rank plot. newsom473 is an excellent reference on dxy.\nnewson474 developed several generalizations to dxy including a stratified ver-\nsion, and discussed the jackknife variance estimator for them. roc areas are\nnot very useful for comparing two models118, 493 (but see490).\n\n16 gneiting and raftery219 have an excellent review of proper scoring rules.\nhand253 contains much information about assessing classification accuracy.\nmittlb\u00a8ock and schemper461 have an excellent review of indexes of explained\nvariation for binary logistic models. see also korn and simon366 and zheng\nand agresti.684.\n\n17 pryor et al.515 presented nomograms for a 10-variable logistic model. one of the\nvariables was sex, which interacted with some of the other variables. evaluation\nof predicted probabilities was simplified by the construction of separate nomo-\ngrams for females and males. seven terms for discrete predictors were collapsed\ninto one weighted point score axis in the nomograms, and age by risk factor\ninteractions were captured by having four age scales.\n\n18 moons et al.462 presents a case study in penalized binary logistic regression\n\nmodeling.\n\n19 the rcspline.plot function in the hmisc r package does not allow for in-\nteractions as does lrm, but it can provide detailed output for checking spline\nfits. this function plots the estimated spline regression and confidence limits,\nplacing summary statistics on the graph. if there are no adjustment variables,\nrcspline.plot can also plot two alternative estimates of the regression func-\ntion: proportions or logit proportions on grouped data, and a nonparametric\nestimate. the nonparametric regression estimate is based on smoothing the bi-\nnary responses and taking the logit transformation of the smoothed estimates, if\ndesired. the smoothing uses the \u201csuper smoother\u201d of friedman207 implemented\nin the r function supsmu.\n\n10.13 problems\n\n1. consider the age\u2013sex\u2013response example in section 10.1.3. this dataset is\n\navailable from the text\u2019s web site in the datasets area.\n\na. duplicate the analyses done in section 10.1.3.\nb. for the model containing both age and sex, test h0 : logit response is\nlinear in age versus ha : logit response is quadratic in age. use the best\ntest statistic.\n\nc. using a wald test, test h0 : no age \u00d7 sex interaction. interpret all\n\nparameters in the model.\n\n "}, {"Page_number": 297, "text": "274\n\n10 binary logistic regression\n\nd. plot the estimated logit response as a function of age and sex, with and\n\nwithout fitting an interaction term.\n\ne. perform a likelihood ratio test of h0 : the model containing only age\nand sex is adequate versus ha : model is inadequate. here, \u201cinadequate\u201d\nmay mean nonlinearity (quadratic) in age or presence of an interaction.\nf. assuming no interaction is present, test h0 : model is linear in age versus\nha : model is nonlinear in age. allow \u201cnonlinear\u201d to be more general\nthan quadratic. (hint: use a restricted cubic spline function with knots\nat age=39, 45, 55, 64 years.)\n\ng. plot age against the estimated spline transformation of age (the trans-\nformation that would make age fit linearly). you can set the sex and\nintercept terms to anything you choose. also plot prob{response = 1 |\nage, sex} from this fitted restricted cubic spline logistic model.\n\n2. consider a binary logistic regression model using the following predictors:\nage (years), sex, race (white, african-american, hispanic, oriental, other),\nblood pressure (mmhg). the fitted model is given by\nlogit prob[y = 1|x] = x \u02c6\u03b2 = \u22121.36 + .03(race = african-american)\n\u2212 .04(race = hispanic) + .05(race = oriental) \u2212 .06(race = other)\n+ .07|blood pressure \u2212 110| + .3(sex = male) \u2212 .1age + .002age2 +\n(sex = male)[.05age \u2212 .003age2].\na. compute the predicted logit (log odds) that y = 1 for a 50-year-old\nfemale hispanic with a blood pressure of 90 mmhg. also compute the\nodds that y = 1 (prob[y = 1]/prob[y = 0]) and the estimated proba-\nbility that y = 1.\n\nb. estimate odds ratios for each nonwhite race compared with the ref-\nerence group (white), holding all other predictors constant. why can\nyou estimate the relative effect of race for all types of subjects without\nspecifying their characteristics?\n\nc. compute the odds ratio for a blood pressure of 120 mmhg compared\nwith a blood pressure of 105, holding age first to 30 years and then to\n40 years.\n\nd. compute the odds ratio for a blood pressure of 120 mmhg compared\nwith a blood pressure of 105, all other variables held to unspecified\nconstants. why is this relative effect meaningful without knowing the\nsubject\u2019s age, race, or sex?\n\ne. compute the estimated risk difference in changing blood pressure from\n105 mmhg to 120 mmhg, first for age = 30 then for age = 40, for a\nwhite female. why does the risk difference depend on age?\n\nf. compute the relative odds for males compared with females, for age = 50\n\nand other variables held constant.\n\ng. same as the previous question but for females : males instead of males\n\n: females.\n\nh. compute the odds ratio resulting from increasing age from 50 to 55\nfor males, and then for females, other variables held constant. what is\nwrong with the following question: what is the relative effect of chang-\ning age by one year?\n\n "}, {"Page_number": 298, "text": "chapter 11\ncase study in binary logistic regression,\nmodel selection and approximation:\npredicting cause of death\n\n11.1 overview\n\nthis chapter contains a case study on developing, describing, and validating\na binary logistic regression model. in addition, the following methods are\nexemplified:\n\n1. data reduction using incomplete linear and nonlinear principal compo-\n\nnents\n\n2. use of aic to choose from five modeling variations, deciding which is best\n\nfor the number of parameters\n\n3. model simplification using stepwise variable selection and approximation\n\nof the full model\n\n4. the relationship between the degree of approximation and the degree of\n\npredictive discrimination loss\n\n5. bootstrap validation that includes penalization for model uncertainty\n(variable selection) and that demonstrates a loss of predictive discrimi-\nnation over the full model even when compensating for overfitting the full\nmodel.\n\nthe data reduction and pre-transformation methods used here were discussed\nin more detail in chapter 8. single imputation will be used because of the\nlimited quantity of missing data.\n\n11.2 background\n\nconsider the randomized trial of estrogen for treatment of prostate cancer87\ndescribed in chapter 8. in this trial, larger doses of estrogen reduced the effect\nof prostate cancer but at the cost of increased risk of cardiovascular death.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 11\n\n275\n\n "}, {"Page_number": 299, "text": "276\n\n11 binary logistic regression case study 1\n\nkay340 did a formal analysis of the competing risks for cancer, cardiovascular,\nand other deaths. it can also be quite informative to study how treatment\nand baseline variables relate to the cause of death for those patients who\ndied.376 we subset the original dataset of those patients dying from prostate\ncancer (n = 130), heart or vascular disease (n = 96), or cerebrovascular\ndisease (n = 31). our goal is to predict cardiovascular\u2013cerebrovascular death\n(cvd, n = 127) given the patient died from either cvd or prostate cancer. of\ninterest is whether the time to death has an effect on the cause of death, and\nwhether the importance of certain variables depends on the time of death.\n\n11.3 data transformations and single imputation\n\nin r, first obtain the desired subset of the data and do some preliminary\ncalculations such as combining an infrequent category with the next category,\nand dichotomizing ekg for use in ordinary principal components (pcs).\n\nrequire ( rms )\n\ngethdata ( prostate )\n\nprostate \u2190\n\nwithin ( prostate , {\n\nlevels ( ekg )[ levels ( ekg ) % in %\n\nc ( ' old mi ' , ' recent mi ' )] \u2190 ' mi '\nekg.norm \u2190 1 * ( ekg % in % c ( ' normal ' , ' benign ' ))\nlevels ( ekg ) \u2190 abbreviate ( levels ( ekg ))\npfn \u2190 as.numeric ( pf )\nlevels ( pf ) \u2190 levels ( pf )[ c (1 ,2 ,3 ,3)]\ncvd \u2190 status % in % c (\" dead - heart or vascular \" ,\n\n\" dead - cerebrovascul ar \" )\n\nrxn = as.numeric ( rx ) })\n\n# use t r a n s c a n to c o m p u t e o p t i m a l p r e - t r a n s f o r m a t i o n s\n\nptrans \u2190 # see f i g u r e 8.3\n\ntranscan (\u223c sz + sg + ap + sbp + dbp +\n\nage + wt + hg + ekg + pf + bm + hx + dtime + rx ,\nimputed = true , transformed = true ,\ndata = prostate , pl = false , pr = false )\n\n# use t r a n s c a n s i n g l e i m p u t a t i o n s\n\nimp \u2190 impute ( ptrans , data = prostate , list.out = true )\n\nimputed missing values with the f o l l o w i n g f r e q u e n c i e s\n\nand stored them in v a r i a b l e s with their original names :\n\nsz\n5\n\nsg age\n11\n1\n\nwt ekg\n8\n\n2\n\nnavars \u2190 all.vars (\u223c sz + sg + age + wt + ekg )\nfor ( x in navars ) prostate [[ x ]] \u2190 imp [[ x ]]\nsubset \u2190 prostate $ status % in % c ( \" dead - heart or vascular \" ,\n\n "}, {"Page_number": 300, "text": "11.4 principal components, pretransformations\n\n277\n\n\" dead - cerebrovascul ar \" ,\" dead - prostatic ca \")\n\ntrans \u2190 ptrans $ transformed [ subset ,]\npsub \u2190 prostate [ subset ,]\n\n11.4 regression on original variables, principal\n\ncomponents and pretransformations\n\nwe first examine the performance of data reduction in predicting the cause\nof death, similar to what we did for survival time in section 8.6. the first\nanalyses assess how well pcs (on raw and transformed variables) predict the\ncause of death.\n\nthere are 127 cvds. we use the 15:1 rule of thumb discussed on p. 72 to\njustify using the first 8 pcs. ap is log-transformed because of its extreme\ndistribution.\n\n# function to compute the first k pcs\nipc \u2190 function (x , k =1 , ... )\n\nprincomp (x , ... , cor = true ) $ scores [ ,1: k ]\n\n# compute the first 8 pcs on raw variables then on\n# transformed ones\npc8 \u2190 ipc (\u223c sz + sg + log ( ap ) + sbp + dbp + age +\n\nwt + hg + ekg.norm + pfn + bm + hx + rxn + dtime ,\ndata = psub , k =8)\n\nf8 \u2190 lrm ( cvd \u223c pc8 , data = psub )\npc8t \u2190 ipc ( trans , k =8)\nf8t \u2190 lrm ( cvd \u223c pc8t , data = psub )\n# fit binary logistic model on original variables\nf \u2190 lrm ( cvd \u223c sz + sg + log ( ap ) + sbp + dbp + age +\n\nwt + hg + ekg + pf + bm + hx + rx + dtime , data = psub )\n\n# expand continuous variables using splines\ng \u2190 lrm ( cvd \u223c rcs ( sz ,4) + rcs ( sg ,4) + rcs ( log ( ap ) ,4) +\n\nrcs ( sbp ,4) + rcs ( dbp ,4) + rcs ( age ,4) + rcs ( wt ,4) +\nrcs ( hg ,4) + ekg + pf + bm + hx + rx + rcs ( dtime ,4) ,\ndata = psub )\n\n# fit binary logistic model on individual transformed var.\nh \u2190 lrm ( cvd \u223c trans , data = psub )\n\nthe five approaches to modeling the outcome are compared using aic (where\nsmaller is better).\n\nc ( f8 = aic ( f8 ), f8t = aic ( f8t ), f = aic ( f ), g = aic ( g ), h = aic ( h ))\n\nh\n257.6573 254.5172 255.8545 263.8413 254.5317\n\nf8t\n\nf8\n\nf\n\ng\n\nbased on aic, the more traditional model fitted to the raw data and as-\nsuming linearity for all the continuous predictors has only a slight chance\nof producing worse cross-validated predictive accuracy than other methods.\n\n "}, {"Page_number": 301, "text": "278\n\n11 binary logistic regression case study 1\n\nthe chances are also good that effect estimates from this simple model will\nhave competitive mean squared errors.\n\n11.5 description of fitted model\n\nhere we describe the simple all-linear full model. summary statistics and a\nwald-anova table are below, followed by partial effects plots with pointwise\nconfidence bands, and odds ratios over default ranges of predictors.\n\nprint (f , latex = true )\n\nlogistic regression model\n\nlrm(formula = cvd ~ sz + sg + log(ap) + sbp + dbp + age + wt +\n\nhg + ekg + pf + bm + hx + rx + dtime, data = psub)\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\nfalse\ntrue\nmax| \u2202 log l\n\n\u2202\u03b2 | 6\u00d710\n\n144.39 r2\n\n257 lr \u03c72\n130 d.f.\n21 g\n127 pr(> \u03c72) < 0.0001 gr\n\u221211\ngp\nbrier\n\n0.573 c\n2.688 dxy\n\n14.701 \u03b3\n0.394 \u03c4a\n0.133\n\n0.893\n0.786\n0.787\n0.395\n\ncoef\n-4.5130 3.2210\nintercept\n-0.0640 0.0168\nsz\n-0.2967 0.1149\nsg\n-0.3927 0.1411\nap\n-0.0572 0.0890\nsbp\n0.3917 0.1629\ndbp\n0.0926 0.0286\nage\n-0.0177 0.0140\nwt\n0.0860 0.0925\nhg\n1.0781 0.8793\nekg=bngn\n-0.1929 0.6318\nekg=rd&ec\n-1.3679 0.8279\nekg=hbocd\n0.4365 0.4582\nekg=hrts\nekg=mi\n0.3039 0.5618\npf=in bed < 50% daytime 0.9604 0.6956\npf=in bed > 50% daytime -2.3232 1.2464\n0.1456 0.5067\nbm\nhx\n1.0913 0.3782\n\ns.e. wald z pr(> |z|)\n0.1612\n0.0001\n0.0098\n0.0054\n0.5201\n0.0162\n0.0012\n0.2069\n0.3524\n0.2202\n0.7601\n0.0985\n0.3407\n0.5886\n0.1673\n0.0623\n0.7738\n0.0039\n\n-1.40\n-3.80\n-2.58\n-2.78\n-0.64\n2.40\n3.23\n-1.26\n0.93\n1.23\n-0.31\n-1.65\n0.95\n0.54\n1.38\n-1.86\n0.29\n2.89\n\n "}, {"Page_number": 302, "text": "11.5 description of fitted model\n\n279\n\nrx=0.2 mg estrogen\nrx=1.0 mg estrogen\nrx=5.0 mg estrogen\ndtime\n\ncoef\n-0.3022 0.4908\n0.7526 0.5272\n0.6868 0.5043\n-0.0136 0.0107\n\ns.e. wald z pr(> |z|)\n0.5381\n0.1534\n0.1733\n0.2040\n\n-0.62\n1.43\n1.36\n-1.27\n\nan \u2190 anova ( f )\nlatex ( an , file = ' ' , table.env = false )\n\np\n0.0001\nsz\n0.0098\nsg\n0.0054\nap\n0.5201\nsbp\n0.0162\ndbp\n0.0012\nage\n0.2069\nwt\n0.3524\nhg\n0.2391\nekg\n0.0632\npf\n0.7738\nbm\n0.0039\nhx\n0.1260\nrx\ndtime\n0.2040\ntotal 66.87 21 < 0.0001\n\n\u03c72 d.f.\n1\n1\n1\n1\n1\n1\n1\n1\n5\n2\n1\n1\n3\n1\n\n14.42\n6.67\n7.74\n0.41\n5.78\n10.45\n1.59\n0.86\n6.76\n5.52\n0.08\n8.33\n5.72\n1.61\n\nplot ( an )\n\n# f i g u r e 11.1\n\ns \u2190 f $ stats\ngamma.hat \u2190 ( s [ ' model l.r. ' ] - s [ ' d.f. ' ]) / s [ ' model l.r. ' ]\ndd \u2190 datadist ( psub ); options ( datadist = ' dd ' )\nggplot ( predict ( f ), sepdiscrete = ' vertical ' , vnames = ' names ' ,\n\nrdata = psub ,\nhistspike.opts = list ( frac = function ( f ) .1 * f / max (f ) ))\n# f i g u r e 11.2\n\nplot ( summary ( f ), log = true )\n\n# f i g u r e 11.3\n\nthe van houwelingen\u2013le cessie heuristic shrinkage estimate (equation 4.3)\nis \u02c6\u03b3 = 0.85, indicating that this model will validate on new data about 15%\nworse than on this dataset.\n\n "}, {"Page_number": 303, "text": "280\n\n11 binary logistic regression case study 1\n\nbm\nsbp\nhg\nwt\ndtime\nekg\nrx\npf\ndbp\nsg\nap\nhx\nage\nsz\n\n0\n\n2\n\n4\n\n6\n\n8 10 12\n\n\u03c72\u2212 df\n\nfig. 11.1 ranking of apparent importance of predictors of cause of death\n\n11.6 backwards step-down\n\nnow use fast backward step-down (with total residual aic as the stopping\nrule) to identify the variables that explain the bulk of the cause of death.\nlater validation will take this screening of variables into account.the greatly\nreduced model results in a simple nomogram.\n\nfastbw ( f )\n\nresidual d . f . p\n\naic\n\ndeleted chi - sq d . f . p\nekg\nbm\nhg\nsbp\nwt\ndtime\nrx\npf\nsg\ndbp\n\n6.76\n0.09\n0.38\n0.48\n1.11\n1.47\n5.65\n4.78\n4.28\n5.84\n\n5\n1\n1\n1\n1\n1\n3\n2\n1\n1\n\n6.76\n0.2391\n6.85\n0.7639\n7.23\n0.5378\n7.71\n0.4881\n0.2932\n8.82\n0.2253 10.29\n0.1302 15.93\n0.0915 20.71\n0.0385 25.00\n0.0157 30.83\n\n5\n6\n7\n8\n9\n10\n13\n15\n16\n17\n\n-3.24\n0.2391\n-5.15\n0.3349\n-6.77\n0.4053\n-8.29\n0.4622\n-9.18\n0.4544\n0.4158\n-9.71\n0.2528 -10.07\n-9.29\n0.1462\n-7.00\n0.0698\n0.0209\n-3.17\n\na p p r o x i m a t e e s t i m a t e s after deleting factors\n\ncoef\n\ns . e . wald z\n\np\ni n t e r c e p t -3.74986 1.82887 -2.050 0 . 0 4 0 3 2 8 6\n-0.04862 0.01532 -3.174 0 . 0 0 1 5 0 1 3\nsz\n-0.40694 0.11117 -3.660 0 . 0 0 0 2 5 1 8\nap\n2.342 0 . 0 1 9 1 7 0 1\nage\nhx\n2.533 0 . 0 1 1 3 1 9 8\n\n0.06000 0.02562\n0.86969 0.34339\n\nfactors in final model\n\n[1] sz\n\nap\n\nage hx\n\n "}, {"Page_number": 304, "text": "11.6 backwards step-down\n\n281\n\nage\n\nap\n\ndbp\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n4\n2\n0\n\u22122\n\u22124\n\u22126\n\n4\n2\n0\n\u22122\n\u22124\n\u22126\n\n4\n2\n0\n\u22122\n\u22124\n\u22126\n\n55\n\n60\n\n65\n\n70\n\n75\n\n80 0\n\n20\n\n40\n\n5.0\n\n7.5\n\n10.0\n\n12.5\n\ndtime\n\nhg\n\nsbp\n\n0\n\n20\n\n40\n\n60\n\n10\n\n12\n\n14\n\n16\n\n12.5\n\nsg\n\nsz\n\n17.5\n\n15.0\n\nwt\n\n8\n\n10\n\n12\n\n14 0\n\n10\n\n20\n\n30\n\n40\n\n80\n\n90\n\n100\n\n110\n\n120\n\n1\n\n0\n\nbm\n\npf\n\nin bed > 50% daytime\nin bed < 50% daytime\nnormal activity\n\nmi\nhrts\nhbocd\nrd&ec\nbngn\nnrml\n\n5.0 mg estrogen\n1.0 mg estrogen\n0.2 mg estrogen\nplacebo\n\nekg\n\nhx\n\n1\n\n0\n\nrx\n\n\u22126 \u22124 \u22122 0 2 4\n\n\u22126 \u22124 \u22122 0 2 4\n\nlog odds\n\nfig. 11.2 partial effects (log odds scale) in full model for cause of death, along with\nvertical line segments showing the raw data distribution of predictors\n\nfred \u2190 lrm ( cvd \u223c sz + log ( ap ) + age + hx , data = psub )\nlatex ( fred , file = ' ' )\n\nprob{cvd} =\n\n1\n\n1 + exp(\u2212x\u03b2)\n\n, where\n\nx \u02c6\u03b2 =\n\u22125.009276 \u2212 0.05510121 sz \u2212 0.509185 log(ap) + 0.0788052 age + 1.070601 hx\n\n "}, {"Page_number": 305, "text": "282\n\n11 binary logistic regression case study 1\n\nodds ratio\n 0.10\n\n 0.50  2.00  8.00\n\nsz \u2212 25:6\nsg \u2212 12:9\nap \u2212 7:0.5999756\nsbp \u2212 16:13\ndbp \u2212 9:7\nage \u2212 76:70\nwt \u2212 106:89\nhg \u2212 14.59961:12\nbm \u2212 1:0\nhx \u2212 1:0\ndtime \u2212 37:11\nekg \u2212 nrml:hrts\nekg \u2212 bngn:hrts\nekg \u2212 rd&ec:hrts\nekg \u2212 hbocd:hrts\nekg \u2212 mi:hrts\npf \u2212 in bed < 50% daytime:normal activity\npf \u2212 in bed > 50% daytime:normal activity\nrx \u2212 0.2 mg estrogen:placebo\nrx \u2212 1.0 mg estrogen:placebo\nrx \u2212 5.0 mg estrogen:placebo\n\nfig. 11.3 interquartile-range odds ratios for continuous predictors and simple odds\nratios for categorical predictors. numbers at left are upper quartile : lower quartile or\ncurrent group : reference group. the bars represent 0.9, 0.95, 0.99 confidence limits.\nthe intervals are drawn on the log odds ratio scale and labeled on the odds ratio\nscale. ranges are on the original scale.\n\nnom \u2190 nomogram ( fred , ap = c (.1 , .5 , 1, 5, 10 , 50) ,\n\nfun = plogis , funlabel = \" probability \" ,\nfun.at = c ( .01 , .05 , .1 , .25 , .5 , .75 , .9 , .95 , .99 ))\n\nplot ( nom , xfrac = .45 )\n\n# f i g u r e 11.4\n\nit is readily seen from this model that patients with a history of heart\ndisease, and patients with less extensive prostate cancer are those more likely\nto die from cvd rather than from cancer. but beware that it is easy to over-\ninterpret findings when using unpenalized estimation, and confidence inter-\nvals are too narrow. let us use the bootstrap to study the uncertainty in\nthe selection of variables and to penalize for this uncertainty when estimat-\ning predictive performance of the model. the variables selected in the first 20\nbootstrap resamples are shown, making it obvious that the set of \u201csignificant\u201d\nvariables, i.e., the final model, is somewhat arbitrary.\nf \u2190 update (f , x = true , y = true )\nv \u2190 validate (f , b =200 , bw = true )\n\nlatex (v , b =20 , digits =3)\n\n "}, {"Page_number": 306, "text": "11.6 backwards step-down\n\n283\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\npoints\n\nsize of primary tumor\n(cm^2)\nserum prostatic acid\nphosphatase\n\nage in years\n\nhistory of cardiovascular\ndisease\n\ntotal points\n\nlinear predictor\n\nprobability\n\n70 65 60 55 50 45 40 35 30 25 20 15 10\n\n5\n\n0\n\n50\n\n45\n\n0\n\n0\n\n10\n\n5\n\n1\n\n0.5\n\n0.1\n\n50\n\n55\n\n60\n1\n\n65\n\n70\n\n75\n\n80\n\n85\n\n90\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\n\u22125\n\n\u22124\n\n\u22123\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2\n\n3\n\n4\n\n0.01\n\n0.05 0.1 0.25 0.5 0.75 0.9 0.95\n\nfig. 11.4 nomogram calculating x \u02c6\u03b2 and \u02c6p for cvd as the cause of death, using\nthe step-down model. for each predictor, read the points assigned on the 0\u2013100 scale\nand add these points. read the result on the total points scale and then read the\ncorresponding predictions below it.\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.682\n0.713\n0.643\n0.439\n0.481\n0.393\n0.000 \u22120.006\n0.000\n1.000\n0.811\n1.000\n0.000\n0.000\n0.048\n0.346\n0.395\n0.449\n\u22120.008 \u22120.008\n0.018\n0.329\n0.456\n0.403\n0.162\n0.151\n0.174\n1.756\n2.213\n1.932\n0.341\n0.355\n0.320\n\n0.071\n0.611 200\n0.088\n0.351 200\n0.006 \u22120.006 200\n0.811 200\n0.189\n0.048\n0.048 200\n0.293 200\n0.102\n\u22120.026\n0.018 200\n0.275 200\n0.128\n\u22120.022\n0.184 200\n1.475 200\n0.457\n0.035\n0.306 200\n\n "}, {"Page_number": 307, "text": "284\n\n11 binary logistic regression case study 1\n\nfactors retained in backwards elimination\n\nfirst 20 resamples\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\n\u2022 \u2022\n\u2022 \u2022\n\n\u2022\n\u2022 \u2022 \u2022\n\nsz sg ap sbp dbp age wt hg ekg pf bm hx rx dtime\n\u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\n\u2022\n\nfrequencies of numbers of factors retained\n\n1 2 3 4 5 6 7 8 9 11 12\n6 39 47 61 19 10 8 4 2 3 1\n\nthe slope shrinkage (\u02c6\u03b3) is a bit lower than was estimated above. there is\ndrop-off in all indexes. the estimated likely future predictive discrimination\nfell from 0.682 to 0.611. the\nof the model as measured by somers\u2019 dxy\nlatter estimate is the one that should be claimed when describing model\nperformance.\n\na nearly unbiased estimate of future calibration of the stepwise-derived\n\nmodel is given below.\ncal \u2190 calibrate (f , b =200 , bw = true )\n\nplot ( cal )\n\n# f i g u r e 11.5\n\nthe amount of overfitting seen in figure 11.5 is consistent with the indexes\nproduced by the validate function.\n\nfor comparison, consider a bootstrap validation of the full model without\n\nusing variable selection.\nvfull \u2190 validate (f , b =200)\n\nlatex ( vfull , digits =3)\n\n "}, {"Page_number": 308, "text": "11.6 backwards step-down\n\n285\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\na\nu\nt\nc\na\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\napparent\nbias\u2212corrected\nideal\n\n0.8\n\n1.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\npredicted pr{cvd}\n\nb= 200 repetitions, boot\n\nmean absolute error=0.028 n=257\n\nfig. 11.5 bootstrap overfitting\u2013corrected calibration curve estimate for the back-\nwards step-down cause of death logistic model, along with a rug plot showing the dis-\ntribution of predicted risks. the smooth nonparametric calibration estimator (loess)\nis used.\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.786\n0.833\n0.738\n0.573\n0.641\n0.501\n0.000 \u22120.013\n0.000\n1.000\n0.690\n1.000\n0.000\n0.000\n0.085\n0.468\n0.558\n0.653\n\u22120.008 \u22120.008\n0.051\n0.417\n0.661\n0.566\n0.150\n0.115\n0.133\n2.355\n3.464\n2.688\n0.394\n0.416\n0.366\n\n0.095\n0.691 200\n0.140\n0.433 200\n0.013 \u22120.013 200\n0.690 200\n0.310\n0.085\n0.085 200\n0.373 200\n0.185\n\u22120.058\n0.051 200\n0.322 200\n0.244\n\u22120.035\n0.168 200\n1.579 200\n1.108\n0.050\n0.344 200\n\ncompared to the validation of the full model, the step-down model has less\noptimism, but it started with a smaller dxy due to loss of information from\nremoving moderately important variables. the improvement in optimism was\nnot enough to offset the effect of eliminating variables. if shrinkage were used\nwith the full model, it would have better calibration and discrimination than\nthe reduced model, since shrinkage does not diminish dxy. thus stepwise\nvariable selection failed at delivering excellent predictive discrimination.\n\nfinally, compare previous results with a bootstrap validation of a step-\ndown model using a better significance level for a variable to stay in the\n\n "}, {"Page_number": 309, "text": "286\n\n11 binary logistic regression case study 1\n\nmodel (\u03b1 = 0.5,589) and using individual approximate wald tests rather\nthan tests combining all deleted variables.\nv5 \u2190 validate (f , bw = true , sls =0 .5 , type = ' individual ' , b =200)\n\nb a c k w a r d s step - down - original model\n\nresidual d . f . p\n\naic\n\ndeleted chi - sq d . f . p\nekg\nbm\nhg\nsbp\nwt\ndtime\nrx\n\n6.76\n0.09\n0.38\n0.48\n1.11\n1.47\n5.65\n\n5\n1\n1\n1\n1\n1\n3\n\n6.76\n0.2391\n6.85\n0.7639\n7.23\n0.5378\n7.71\n0.4881\n0.2932\n8.82\n0.2253 10.29\n0.1302 15.93\n\n5\n6\n7\n8\n9\n10\n13\n\n-3.24\n0.2391\n-5.15\n0.3349\n-6.77\n0.4053\n-8.29\n0.4622\n-9.18\n0.4544\n0.4158\n-9.71\n0.2528 -10.07\n\na p p r o x i m a t e e s t i m a t e s after deleting factors\n\ncoef\n\ns . e . wald z\n\np\n-4.86308 2.67292 -1.819 0.068852\ni n t e r c e p t\n-0.05063 0.01581 -3.202 0.001366\nsz\n-0.28038 0.11014 -2.546 0.010903\nsg\n-0.24838 0.12369 -2.008 0.044629\nap\n2.170 0.030008\ndbp\n3.161 0.001572\nage\npf = in bed < 50% daytime\n1.223 0.221485\npf = in bed > 50% daytime -2.19885 1.21212 -1.814 0.069670\nhx\n2.495 0.012592\n\n0.28288 0.13036\n0.08502 0.02690\n0.81151 0.66376\n\n0.87834 0.35203\n\nfactors in final model\n\n[1] sz\n\nsg\n\nap\n\ndbp age pf\n\nhx\n\nlatex ( v5 , digits =3 , b =0)\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.739\n0.801\n0.716\n0.517\n0.598\n0.481\n0.000 \u22120.008\n0.000\n1.000\n0.745\n1.000\n0.000\n0.000\n0.067\n0.444\n0.486\n0.593\n\u22120.008 \u22120.008\n0.033\n0.411\n0.601\n0.494\n0.147\n0.125\n0.156\n2.175\n2.958\n2.351\n0.372\n0.401\n0.358\n\n0.085\n0.654 200\n0.117\n0.400 200\n0.008 \u22120.008 200\n0.745 200\n0.255\n0.067\n0.067 200\n0.337 200\n0.149\n\u22120.040\n0.033 200\n0.304 200\n0.190\n\u22120.030\n0.177 200\n1.567 200\n0.784\n0.043\n0.330 200\n\nthe performance statistics are midway between the full model and the\n\nsmaller stepwise model.\n\n "}, {"Page_number": 310, "text": "11.7 model approximation\n\n287\n\n11.7 model approximation\n\nfrequently a better approach than stepwise variable selection is to approx-\nimate the full model, using its estimates of precision, as discussed in sec-\ntion 5.5. stepwise variable selection as well as regression trees are useful for\nmaking the approximations, and the sacrifice in predictive accuracy is always\napparent.\n\nwe begin by computing the \u201cgold standard\u201d linear predictor from the full\nmodel fit (r2 = 1.0), then running backwards step-down ols regression to\napproximate it.\nlp \u2190 predict ( f )\na \u2190 ols ( lp \u223c sz + sg + log ( ap ) + sbp + dbp + age + wt +\n\n# i n s e r t s i g m a =1 as o t h e r w i s e s i g m a =0 will c a u s e p r o b l e m s\n\n# c o m p u t e l i n e a r p r e d i c t o r from full m o d e l\n\nhg + ekg + pf + bm + hx + rx + dtime , sigma =1 ,\ndata = psub )\n\n# s p e c i f y s i l l y s t o p p i n g c r i t e r i o n to r e m o v e all v a r i a b l e s\n\ns \u2190 fastbw (a , aics =10000)\nbetas \u2190 s $ coefficients\n\u2190 cbind (1 , f $ x)\n\nx\n# c o m p u t e the s e r i e s of a p p r o x i m a t i o n s to lp\n\u2227\n\nap \u2190 x % * % t ( betas )\n\n# matrix , rows = i t e r a t i o n s\n# d e s i g n m a t r i x\n\n# for each a p p r o x . c o m p u t e a p p r o x i m a t i o n r\n# l i k e l i h o o d r a t i o c h i - s q u a r e for a p p r o x i m a t e m o d e l to that\n# of o r i g i n a l m o d e l\n\n2 and r a t i o of\n\nm \u2190 ncol ( ap ) - 1\nr2 \u2190 frac \u2190 numeric (m )\nfullchisq \u2190 f $ stats [ ' model l.r. ' ]\n\n# all but i n t e r c e p t - o n l y m o d e l\n\nfor ( i in 1: m ) {\n\nlpa \u2190 ap [, i ]\nr2 [ i ] \u2190 cor ( lpa , lp )\nfapprox \u2190 lrm ( cvd \u223c lpa , data = psub )\nfrac [ i ] \u2190 fapprox $ stats [ ' model l.r. ' ] / fullchisq\n\n\u2227\n\n2\n\n}\n\n# f i g u r e 11.6:\n\nplot ( r2 , frac , type = ' b ' ,\n\nxlab = expression ( paste ( ' approximation ' , r\nylab = expression ( paste ( ' fraction of ' ,\n\n\u2227\n\nchi\n\n2, ' preserved ' )))\n\n\u2227\n\n2)) ,\n\nabline ( h = .95 , col = gray ( .83 )); abline ( v = .95 , col = gray ( .83 ))\nabline ( a =0 , b =1 , col = gray ( .83 ))\n\nafter 6 deletions, slightly more than 0.05 of both the lr \u03c72 and the approx-\nimation r2 are lost (see figure 11.6). therefore we take as our approximate\nmodel the one that removed 6 predictors. the equation for this model is\nbelow, and its nomogram is in figure 11.7.\nfapprox \u2190 ols ( lp \u223c sz + sg + log ( ap ) + age + ekg + pf + hx +\nfapprox $ stats [ ' r2 ' ]\n\nrx , data = psub )\n\n# as a c h e c k\n\nr2 0.9453396\nlatex ( fapprox , file = ' ' )\n\n "}, {"Page_number": 311, "text": "288\n\n11 binary logistic regression case study 1\n\nd\ne\nv\nr\ne\ns\ne\nr\np\n2\n\u03c7\n \nf\n\n \n\n \n\no\nn\no\n\ni\nt\nc\na\nr\nf\n\n1.0\n\n0.9\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.5\n\n0.7\n\n0.6\n0.8\napproximation r2\n\n0.9\n\n1.0\n\nfig. 11.6 fraction of explainable variation (full model lr \u03c72) in cvd that was\nexplained by approximate models, along with approximation accuracy (x\u2013axis)\n\ne(lp) = x\u03b2, where\n\nx \u02c6\u03b2 =\n\u22122.868303 \u2212 0.06233241 sz \u2212 0.3157901 sg \u2212 0.3834479 log(ap) + 0.09089393 age\n+1.396922[bngn] + 0.06275034[rd&ec] \u2212 1.24892[hbocd] + 0.6511938[hrts]\n+0.3236771[mi]\n+1.116028[in bed < 50% daytime] \u2212 2.436734[in bed > 50% daytime]\n+1.05316 hx\n\u22120.3888534[0.2 mg estrogen] + 0.6920495[1.0 mg estrogen]\n+0.7834498[5.0 mg estrogen]\n\nand [c] = 1 if subject is in group c, 0 otherwise.\nnom \u2190 nomogram ( fapprox , ap = c ( .1 , .5 , 1, 5, 10 , 20 , 30 , 40) ,\n\nfun = plogis , funlabel = \" probability \" ,\nlp.at =( -5 ):4 ,\n\nfun.lp.at = qlogis (c ( .01 , .05 , .25 , .5 , .75 , .95 , .99 )))\n\nplot ( nom , xfrac = .45 )\n\n# f i g u r e 11.7\n\n "}, {"Page_number": 312, "text": "11.7 model approximation\n\n289\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\npoints\n\nsize of primary tumor\n(cm^2)\n\ncombined index of stage\nand hist. grade\n\nserum prostatic acid\nphosphatase\n\nage in years\n\nekg\n\npf\n\n40\n\n45\n\nhbocd\n\nin bed > 50% daytime\n\nhistory of cardiovascular\ndisease\n\n0\n\nplacebo\n\n70 65 60 55 50 45 40 35 30 25 20 15 10\n\n5\n\n0\n\n15 14 13 12 11 10\n\n9\n\n8\n\n7\n\n6\n\n5\n\n10 5\n\n1 0.5\n\n0.1\n\n50\n\n55\n\n60\nnrml\n\nrd&ec\n\n1\n\n65\n\n70\n\n75\nbngn\n\n80\n\n85\n\n90\n\nhrts\n\nnormal activity\n\nin bed < 50% daytime\n\nrx\n\ntotal points\n\nlinear predictor\n\nprobability\n\n0.2 mg estrogen\n\n0\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\n350\n\n400\n\n\u22125\n\n\u22123\n\n\u22121 0 1 2 3 4\n\n0.01 0.05 0.250.50.75 0.95 0.99\n\nfig. 11.7 nomogram for predicting the probability of cvd based on the approximate\nmodel\n\n "}, {"Page_number": 313, "text": "chapter 12\nlogistic model case study 2: survival\nof titanic passengers\n\nthis case study demonstrates the development of a binary logistic regression\nmodel to describe patterns of survival in passengers on the titanic, based on\npassenger age, sex, ticket class, and the number of family members accom-\npanying each passenger. nonparametric regression is also used. since many\nof the passengers had missing ages, multiple imputation is used so that the\ncomplete information on the other variables can be efficiently utilized. titanic\npassenger data were gathered by many researchers. primary references are\nthe encyclopedia titanica at www.encyclopedia-titanica.org and eaton and\nhaas.169 titanic survival patterns have been analyzed previously151, 296, 571\nbut without incorporation of individual passenger ages. thomas cason while\na university of virginia student compiled and interpreted the data from the\nworld wide web. one thousand three hundred nine of the passengers are\nrepresented in the dataset, which is available from this text\u2019s web site under\nthe name titanic3. an early analysis of titanic data may be found in bron75.\n\n12.1 descriptive statistics\n\nfirst we obtain basic descriptive statistics on key variables.\n\nrequire ( rms )\n\n# get d a t a s e t from web site\n\ngethdata ( titanic3 )\n# list of n a m e s of v a r i a b l e s to a n a l y z e\n\nv \u2190 c ( ' pclass ' , ' survived ' , ' age ' , ' sex ' , ' sibsp ' , ' parch ' )\nt3 \u2190 titanic3 [, v ]\nunits ( t3 $ age ) \u2190 ' years '\nlatex ( describe ( t3 ), file = ' ' )\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 12\n\n291\n\n "}, {"Page_number": 314, "text": "292\n\n12 logistic model case study 2: survival of titanic passengers\n\n6 variables\n\nt3\n\n1309 observations\n\npclass\n\nn missing unique\n3\n\n0\n\n1309\n\n1st (323, 25%), 2nd (277, 21%), 3rd (709, 54%)\n\nsurvived : survived\n\nn missing unique info sum mean\n2 0.71 500 0.382\n\n0\n\n1309\n\nage : age [years]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n5 14 21 28 39 50 57\n\n1 29.88\n\n263\n\n98\n\n1046\n\nlowest :\n0.7500\nhighest: 70.5000 71.0000 74.0000 76.0000 80.0000\n\n0.3333\n\n0.4167\n\n0.6667\n\n0.1667\n\nsex\n\nn missing unique\n2\n\n0\n\n1309\n\nfemale (466, 36%), male (843, 64%)\n\nsibsp : number of siblings/spouses aboard\n\nn missing unique info mean\n7 0.67 0.4989\n\n0\n\n1309\n\n4 5 8\nfrequency 891 319 42 20 22 6 9\n%\n2 0 1\n\n1 2 3\n\n3 2\n\n24\n\n68\n\n0\n\nparch : number of parents/children aboard\n\nn missing unique info mean\n8 0.55 0.385\n\n0\n\n1309\n\n2 3 4 5 6 9\nfrequency 1002 170 113 8 6 6 2 2\n%\n9 1 0 0 0 0\n\n13\n\n77\n\n0\n\n1\n\nnext, we obtain access to the needed variables and observations, and save data\ndistribution characteristics for plotting and for computing predictor effects.\nthere are not many passengers having more than 3 siblings or spouses or\nmore than 3 children, so we truncate two variables at 3 for the purpose of\nestimating stratified survival probabilities.\ndd \u2190 datadist ( t3 )\n# d e s c r i b e d i s t r i b u t i o n s of v a r i a b l e s to rms\noptions ( datadist = ' dd ' )\ns \u2190 summary ( survived \u223c age + sex + pclass +\nplot (s , main = ' ' , subtitles = false )\n\ncut2 ( sibsp ,0:3) + cut2 ( parch ,0:3) , data = t3 )\n\n# f i g u r e 12.1\n\nnote the large number of missing ages. also note the strong effects of sex and\npassenger class on the probability of surviving. the age effect does not appear\nto be very strong, because as we show later, much of the effect is restricted to\n\n "}, {"Page_number": 315, "text": "12.1 descriptive statistics\n\nage [years]\n[ 0.167,22.0)\n[22.000,28.5)\n[28.500,40.0)\n[40.000,80.0]\nmissing\nsex\nfemale\nmale\npclass\n1st\n2nd\n3rd\nnumber of siblings/spouses aboard\n0\n1\n2\n[3,8]\nnumber of parents/children aboard\n0\n1\n2\n[3,9]\noverall\n\n293\n\nn\n\n290\n246\n265\n245\n263\n\n466\n843\n\n323\n277\n709\n\n891\n319\n42\n57\n\n1002\n170\n113\n24\n\n1309\n\nfig. 12.1 univariable summaries of titanic survival\n\n0.2\n\n0.3\n\n0.5\n0.4\nsurvived\n\n0.6\n\n0.7\n\nage < 21 years for one of the sexes. the effects of the last two variables are\nunclear as the estimated proportions are not monotonic in the values of these\ndescriptors. although some of the cell sizes are small, we can show four-way\nempirical relationships with the fraction of surviving passengers by creating\nfour cells for sibsp \u00d7 parch combinations and by creating two age groups. we\nsuppress proportions based on fewer than 25 passengers in a cell. results are\nshown in figure 12.2.\ntn \u2190 transform ( t3 ,\n\nagec = ifelse ( age < 21 , ' child ' , ' adult ' ),\nsibsp = ifelse ( sibsp == 0, ' no sib / sp ' , ' sib / sp ' ),\nparch = ifelse ( parch == 0, ' no par / child ' , ' par / child ' ))\n\ng \u2190 function ( y ) if ( length (y ) < 25) na else mean ( y)\ns \u2190 with ( tn , summarize ( survived ,\n\nllist ( agec , sex , pclass , sibsp , parch ), g ))\n\n# llist , s u m m a r i z e in h m i s c p a c k a g e\n# f i g u r e 12.2:\nggplot ( subset (s , agec ! = ' na ' ),\n\naes ( x = survived , y = pclass , shape = sex )) +\n\ngeom_point () + facet_grid ( agec \u223c sibsp * parch ) +\nxlab ( ' proportion surviving ' ) + ylab ( ' passenger class ' ) +\nscale_x_con ti nu o us ( breaks = c (0 , .5 , 1))\n\n "}, {"Page_number": 316, "text": "294\n\n12 logistic model case study 2: survival of titanic passengers\n\nno sib/sp\nno par/child\n\nno sib/sp\npar/child\n\nsib/sp\n\nno par/child\n\nsib/sp\npar/child\n\ns\ns\na\nc\n\nl\n\n \nr\ne\ng\nn\ne\ns\ns\na\np\n\n3rd\n\n2nd\n\n1st\n\n3rd\n\n2nd\n\n1st\n\na\nd\nu\n\nl\nt\n\nc\nh\n\ni\nl\n\nd\n\nsex\n\nfemale\n\nmale\n\n0.0\n\n0.5\n\n1.0 0.0\n\n0.5\n\n1.0 0.0\n\n0.5\n\n1.0 0.0\n\n0.5\n\n1.0\n\nproportion surviving\n\nfig. 12.2 multi-way summary of titanic survival\n\nnote that none of the effects of sibsp or parch for common passenger groups\nappear strong on an absolute risk scale.\n\n12.2 exploring trends with nonparametric regression\n\nas described in section 2.4.7, the loess smoother has excellent performance\nwhen the response is binary, as long as outlier detection is turned off. here\nwe use a ggplot2 add-on function histspikeg in the hmisc package to obtain\nand plot the loess fit and age distribution. histspikeg uses the \u201cno iteration\u201d\noption for the r lowess function when the response is binary.\n\n# f i g u r e 12.3\n\nb \u2190 scale_size_ di s cr et e ( range = c ( .1 , .85 ))\nyl \u2190 ylab ( null )\np1 \u2190 ggplot ( t3 , aes ( x = age , y = survived )) +\n\nhistspikeg ( survived \u223c age , lowess = true , data = t3 ) +\n\nylim (0 ,1) + yl\n\np2 \u2190 ggplot ( t3 , aes ( x = age , y = survived , color = sex )) +\n\nhistspikeg ( survived \u223c age + sex , lowess = true ,\n\np3 \u2190 ggplot ( t3 , aes ( x = age , y = survived , size = pclass )) +\nhistspikeg ( survived \u223c age + pclass , lowess = true ,\n\ndata = t3 ) + ylim (0 ,1) + yl\n\np4 \u2190 ggplot ( t3 , aes ( x = age , y = survived , color = sex ,\n\ndata = t3 ) + b + ylim (0 ,1) + yl\n\nsize = pclass )) +\n\nhistspikeg ( survived \u223c age + sex + pclass ,\n\nlowess = true , data = t3 ) +\n\nb + ylim (0 ,1) + yl\n\ngridextra :: grid.arrange ( p1 , p2 , p3 , p4 , ncol =2)\n\n# c o m b i n e 4\n\n "}, {"Page_number": 317, "text": "12.2 exploring trends with nonparametric regression\n\n295\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\n0\n\n20\n\n60\n\n80\n\n40\nage\n\npclass\n1st\n2nd\n3rd\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\nsex\n\nfemale\nmale\n\npclass\n1st\n2nd\n3rd\n\nsex\n\nfemale\nmale\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\nfig. 12.3 nonparametric regression (loess) estimates of the relationship between\nage and the probability of surviving the titanic, with tick marks depicting the age\ndistribution. the top left panel shows unstratified estimates of the probability of\nsurvival. other panels show nonparametric estimates by various stratifications.\n\nfigure 12.3 shows much of the story of passenger survival patterns. \u201cwomen\nand children first\u201d seems to be true except for women in third class. it is\ninteresting that there is no real cutoff for who is considered a child. for men,\nthe younger the greater chance of surviving. the interpretation of the effects\nof the \u201cnumber of relatives\u201d-type variables will be more difficult, as their\ndefinitions are a function of age. figure 12.4 shows these relationships.\n\n# f i g u r e 12.4\n\ntop \u2190 theme ( legend.positio n = ' top ' )\np1 \u2190 ggplot ( t3 , aes ( x = age , y = survived , color = cut2 ( sibsp ,\n\n0:2))) + stat_plsmo () + b + ylim (0 ,1) + yl + top +\nscale_color _ di s cr et e ( name = ' siblings / spouses ' )\n\n "}, {"Page_number": 318, "text": "296\np2 \u2190 ggplot ( t3 , aes ( x = age , y = survived , color = cut2 ( parch ,\n\n12 logistic model case study 2: survival of titanic passengers\n\n0:2))) + stat_plsmo () + b + ylim (0 ,1) + yl + top +\nscale_color _ di s cr et e ( name = ' parents / children ' )\n\ngridextra :: grid.arrange ( p1 , p2 , ncol =2)\n\nsiblings/spouses\n\n0\n\n1\n\n[2,8]\n\nparents/children\n\n0\n\n1\n\n[2,9]\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\nfig. 12.4 relationship between age and survival stratified by the number of siblings\nor spouses on board (left panel) or by the number of parents or children of the\npassenger on board (right panel).\n\n12.3 binary logistic model with casewise deletion\n\nof missing values\n\nwhat follows is the standard analysis based on eliminating observations hav-\ning any missing data. we develop an initial somewhat saturated logistic\nmodel, allowing for a flexible nonlinear age effect that can differ in shape\nfor all six sex \u00d7 class strata. the sibsp and parch variables do not have suf-\nficiently dispersed distributions to allow for us to model them nonlinearly.\nalso, there are too few passengers with nonzero values of these two variables\nin sex \u00d7 pclass \u00d7 age strata to allow us to model complex interactions in-\nvolving them. the meaning of these variables does depend on the passenger\u2019s\nage, so we consider only age interactions involving sibsp and parch.\nf1 \u2190 lrm ( survived \u223c sex * pclass * rcs ( age ,5) +\nlatex ( anova ( f1 ), file = ' ' , label = ' titanic-anova3 ' ,\n\nrcs ( age ,5) * ( sibsp + parch ), data = t3 )\n\n# t a b l e 12.1\n\nsize = ' small ' )\n\nthree-way interactions are clearly insignificant (p = 0.4) in table 12.1. so\nis parch (p = 0.6 for testing the combined main effect + interaction effects\nfor parch, i.e., whether parch is important for any age). these effects would\nbe deleted in almost all bootstrap resamples had we bootstrapped a variable\nselection procedure using \u03b1 = 0.1 for retention of terms, so we can safely\nignore these terms for future steps. the model not containing those terms\n\n "}, {"Page_number": 319, "text": "12.3 binary logistic model with casewise deletion of missing values\n\n297\n\ntable 12.1 wald statistics for survived\n\n\u03c72\n\nd.f.\n\np\n\nsex (factor+higher order factors)\n\nall interactions\n\npclass (factor+higher order factors)\n\nall interactions\n\nage (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nsibsp (factor+higher order factors)\n\nall interactions\n\nparch (factor+higher order factors)\nall interactions\nsex \u00d7 pclass (factor+higher order factors)\nsex \u00d7 age (factor+higher order factors)\nnonlinear (factor+higher order factors)\nnonlinear interaction : f(a,b) vs. ab\npclass \u00d7 age (factor+higher order factors)\nnonlinear (factor+higher order factors)\nnonlinear interaction : f(a,b) vs. ab\nage \u00d7 sibsp (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\nage \u00d7 parch (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\nsex \u00d7 pclass \u00d7 age (factor+higher order factors)\nnonlinear\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\n46.51 18\n56.20 32\n34.57 28\n28.66 24\n19.67\n5\n4\n12.13\n5\n3.51\n3.51\n4\n\n187.15 15 < 0.0001\n59.74 14 < 0.0001\n100.10 20 < 0.0001\n0.0003\n0.0052\n0.1826\n0.2331\n0.0014\n0.0164\n0.6217\n0.4761\n42.43 10 < 0.0001\n15.89 12\n0.1962\n0.1066\n9\n14.47\n0.2441\n4.17\n3\n0.6385\n13.47 16\n0.3749\n12.92 12\n0.3324\n6\n4\n0.0164\n0.6235\n3\n0.6235\n3\n0.4761\n4\n0.6147\n3\n3\n0.6147\n0.4006\n8\n0.2581\n6\n28.66 24\n0.2331\n75.61 30 < 0.0001\n79.49 33 < 0.0001\n241.93 39 < 0.0001\n\n6.88\n12.13\n1.76\n1.76\n3.51\n1.80\n1.80\n8.34\n7.74\n\nis fitted below. the ^2 in the model formula means to expand the terms in\nparentheses to include all main effects and second-order interactions.\nf \u2190 lrm ( survived \u223c ( sex + pclass + rcs ( age ,5))\n\n2 +\n\n\u2227\n\nrcs ( age ,5) * sibsp , data = t3 )\n\nprint (f , latex = true )\n\nlogistic regression model\n\nlrm(formula = survived ~ (sex + pclass + rcs(age, 5))^2\n\n+ rcs(age, 5) * sibsp, data = t3)\n\nfrequencies of missing values due to each variable\n\nsurvived\n0\n\nsex\n0\n\npclass\n0\n\nage\n263\n\nsibsp\n0\n\n "}, {"Page_number": 320, "text": "298\n\n12 logistic model case study 2: survival of titanic passengers\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\nmax| \u2202 log l\n\n\u2202\u03b2 | 6\u00d710\n\n553.87 r2\n\n1046 lr \u03c72\n619 d.f.\n26 g\n427 pr(> \u03c72) < 0.0001 gr\n\u22126\ngp\nbrier\n\n0.555 c\n2.427 dxy\n11.325 \u03b3\n0.365 \u03c4a\n0.130\n\n0.878\n0.756\n0.758\n0.366\n\ncoef\n3.3075 1.8427\nintercept\n-1.1478 1.0878\nsex=male\n6.7309 3.9617\npclass=2nd\n-1.6437 1.8299\npclass=3rd\n0.0886 0.1346\nage\n-0.7410 0.6513\nage\u2019\n4.9264 4.0047\nage\u201d\n-6.6129 5.4100\nage\u201d\u2019\nsibsp\n-1.0446 0.3441\nsex=male * pclass=2nd -0.7682 0.7083\nsex=male * pclass=3rd 2.1520 0.6214\n-0.2191 0.0722\nsex=male * age\n1.0842 0.3886\nsex=male * age\u2019\n-6.5578 2.6511\nsex=male * age\u201d\n8.3716 3.8532\nsex=male * age\u201d\u2019\npclass=2nd * age\n-0.5446 0.2653\n-0.1634 0.1308\npclass=3rd * age\n1.9156 1.0189\npclass=2nd * age\u2019\n0.8205 0.6091\npclass=3rd * age\u2019\npclass=2nd * age\u201d\n-8.9545 5.5027\n-5.4276 3.6475\npclass=3rd * age\u201d\n9.3926 6.9559\npclass=2nd * age\u201d\u2019\n7.5403 4.8519\npclass=3rd * age\u201d\u2019\nage * sibsp\n0.0357 0.0340\n-0.0467 0.2213\nage\u2019 * sibsp\n0.5574 1.6680\nage\u201d * sibsp\nage\u201d\u2019 * sibsp\n-1.1937 2.5711\n\ns.e. wald z pr(> |z|)\n0.0727\n0.2914\n0.0893\n0.3691\n0.5102\n0.2552\n0.2186\n0.2216\n0.0024\n0.2781\n0.0005\n0.0024\n0.0053\n0.0134\n0.0298\n0.0401\n0.2118\n0.0601\n0.1780\n0.1037\n0.1367\n0.1769\n0.1202\n0.2933\n0.8330\n0.7382\n0.6425\n\n1.79\n-1.06\n1.70\n-0.90\n0.66\n-1.14\n1.23\n-1.22\n-3.04\n-1.08\n3.46\n-3.04\n2.79\n-2.47\n2.17\n-2.05\n-1.25\n1.88\n1.35\n-1.63\n-1.49\n1.35\n1.55\n1.05\n-0.21\n0.33\n-0.46\n\nlatex ( anova ( f ), file = ' ' , label = ' titanic-anova 2 ' , size = ' small ' )\n\n#12.2\n\nthis is a very powerful model (roc area = c = 0.88); the survival patterns\nare easy to detect. the wald anova in table 12.2 indicates especially strong\nsex and pclass effects (\u03c72 = 199 and 109, respectively). there is a very strong\n\n "}, {"Page_number": 321, "text": "12.3 binary logistic model with casewise deletion of missing values\n\n299\n\ntable 12.2 wald statistics for survived\n\n\u03c72\n\nd.f.\n\np\n\n199.42\n56.14\n\nall interactions\n\nall interactions\n\nsex (factor+higher order factors)\n\nage (factor+higher order factors)\n\npclass (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\n7 < 0.0001\n6 < 0.0001\n108.73 12 < 0.0001\n42.83 10 < 0.0001\n0.0006\n47.04 20\n0.0789\n24.51 16\n0.0902\n22.72 15\n19.95\n5\n0.0013\nsibsp (factor+higher order factors)\nall interactions\n4\n10.99\n0.0267\nsex \u00d7 pclass (factor+higher order factors) 35.40\n2 < 0.0001\nsex \u00d7 age (factor+higher order factors)\n0.0391\n4\n10.08\nnonlinear\n0.0426\n3\n8.17\nnonlinear interaction : f(a,b) vs. ab\n8.17\n3\n0.0426\npclass \u00d7 age (factor+higher order factors)\n0.5516\n8\n6.86\nnonlinear\n0.4113\n6\n6.11\n0.4113\n6\n6.11\nnonlinear interaction : f(a,b) vs. ab\nage \u00d7 sibsp (factor+higher order factors)\n0.0267\n4\n10.99\n0.6134\n3\n1.81\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\n1.81\n3\n0.6134\n22.72 15\n0.0902\n67.58 18 < 0.0001\n70.68 21 < 0.0001\n253.18 26 < 0.0001\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\nsex \u00d7 pclass interaction and a strong age \u00d7 sibsp interaction, considering\nthe strength of sibsp overall.\n\nlet us examine the shapes of predictor effects. with so many interactions\nin the model we need to obtain predicted values at least for all combinations\nof sex and pclass. for sibsp we consider only two of its possible values.\np \u2190 predict (f , age , sex , pclass , sibsp =0 , fun = plogis )\n\nggplot ( p )\n\n# fig. 12.5\n\nnote the agreement between the lower right-hand panel of figure 12.3 with\nfigure 12.5. this results from our use of similar flexibility in the parametric\nand nonparametric approaches (and similar effective degrees of freedom). the\nestimated effect of sibsp as a function of age is shown in figure 12.6.\n\nggplot ( predict (f , sibsp , age = c (10 ,15 ,20 ,50) , conf.int = false ))\n# # f i g u r e 12.6\n\nnote that children having many siblings apparently had lower survival. mar-\nried adults had slightly higher survival than unmarried ones.\n\nthere will never be another titanic, so we do not need to validate the\nmodel for prospective use. but we use the bootstrap to validate the model\nanyway, in an effort to detect whether it is overfitting the data. we do not\npenalize the calculations that follow for having examined the effect of parch or\n\n "}, {"Page_number": 322, "text": "12 logistic model case study 2: survival of titanic passengers\n\n1st\n\n2nd\n\n3rd\n\nsex\n\nfemale\n\nmale\n\n300\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n0\n\n20\n\n40\n\n60 0\n\n40\n20\nage, years\n\n60 0\n\n20\n\n40\n\n60\n\nfig. 12.5 effects of predictors on probability of survival of titanic passengers, esti-\nmated for zero siblings or spouses\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n\u22125\n\n\u22126\n\nage, years\n\n10\n\n15\n\n20\n\n50\n\n0\n\n2\n\n4\n\n6\n\n8\n\nnumber of siblings/spouses aboard\n\nfig. 12.6 effect of number of siblings and spouses on the log odds of surviving, for\nthird class males\n\nfor testing three-way interactions, in the belief that these tests would replicate\nwell.\nf \u2190 update (f , x = true , y = true )\n\n# x = true , y = true adds raw data to fit o b j e c t so can b o o t s t r a p\nset.seed (131)\nlatex ( validate (f , b =200) , digits =2 , size = ' ssize ' )\n\n# so can r e p l i c a t e r e - s a m p l e s\n\n "}, {"Page_number": 323, "text": "12.3 binary logistic model with casewise deletion of missing values\n\n301\n\nindex\n\ndxy\nr2\nintercept\nslope\nemax\nd\nu\nq\nb\ng\ngp\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.77\n0.74\n0.58\n0.53\n0.00 \u22120.08\n0.87\n1.00\n0.05\n0.00\n0.50\n0.56\n0.00\n0.01\n0.49\n0.56\n0.13\n0.13\n2.37\n2.75\n0.37\n0.35\n\n0.72 200\n0.50 200\n\u22120.08 200\n0.87 200\n0.05 200\n0.46 200\n0.01 200\n0.46 200\n0.14 200\n2.05 200\n0.35 200\n\n0.03\n0.05\n0.08\n0.13\n0.05\n0.06\n\u22120.01\n0.07\n\u22120.01\n0.37\n0.02\n\n0.76\n0.55\n0.00\n1.00\n0.00\n0.53\n0.00\n0.53\n0.13\n2.43\n0.37\n\ncal \u2190 calibrate (f , b =200)\n\nplot ( cal , subtitles = false )\n\n# f i g u r e 12.7\n\nn =1046\n0.9 quantile of absolute error =0.017\n\nmean absolute error =0.009\n\nmean squared error =0.00012\n\nthe output of validate indicates minor overfitting. overfitting would have\nbeen worse had the risk factors not been so strong. the closeness of the cali-\nline in figure 12.7 demonstrates excellent validation\nbration curve to the 45\non an absolute probability scale. but the extent of missing data casts some\ndoubt on the validity of this model, and on the efficiency of its parameter\nestimates.\n\n\u25e6\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\na\nu\nt\nc\na\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\napparent\n\nbias\u2212corrected\n\nideal\n\n0.8\n\n1.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\npredicted pr{survived=1}\n\nfig. 12.7 bootstrap overfitting-corrected loess nonparametric calibration curve for\ncasewise deletion model\n\n "}, {"Page_number": 324, "text": "302\n\n12 logistic model case study 2: survival of titanic passengers\n\n12.4 examining missing data patterns\n\nthe first step to dealing with missing data is understanding the patterns\nof missing values. to do this we use the hmisc library\u2019s naclus and naplot\nfunctions, and the recursive partitioning library of atkinson and therneau.\nbelow naclus tells us which variables tend to be missing on the same persons,\nand it computes the proportion of missing values for each variable. the rpart\nfunction derives a tree to predict which types of passengers tended to have\nage missing.\nna.patterns \u2190 naclus ( titanic3 )\n\nrequire ( rpart )\n\n# r e c u r s i v e p a r t i t i o n i n g p a c k a g e\n\nwho.na \u2190 rpart ( is.na ( age ) \u223c sex + pclass + survived +\nnaplot ( na.patterns , ' na per var ' )\nplot ( who.na , margin = .1 ); text ( who.na ) # f i g u r e 12.8\nplot ( na.patterns )\n\nsibsp + parch , data = titanic3 , minbucket =15)\n\nwe see in figure 12.8 that age tends to be missing on the same passengers\nas the body bag identifier, and that it is missing in only 0.09 of first or sec-\nond class passengers. the category of passengers having the highest fraction\nof missing ages is third class passengers having no parents or children on\nboard. below we use hmisc\u2019s summary.formula function to plot simple descrip-\ntive statistics on the fraction of missing ages, stratified by other variables. we\nsee that without adjusting for other variables, age is slightly more missing on\nnonsurviving passengers.\nplot ( summary ( is.na ( age ) \u223c sex + pclass + survived +\n\nsibsp + parch , data = t3 ))\n\n# f i g u r e 12.9\n\nlet us derive a logistic model to predict missingness of age, to see if the\nsurvival bias maintains after adjustment for the other variables.\nm \u2190 lrm ( is.na ( age ) \u223c sex * pclass + survived + sibsp + parch ,\n\ndata = t3 )\n\nprint (m , latex = true , needspace = ' 2 in ' )\n\nlogistic regression model\n\nlrm(formula = is.na(age) ~ sex * pclass + survived + sibsp +\n\nparch, data = t3)\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\nfalse\ntrue\nmax| \u2202 log l\n\n\u2202\u03b2 | 5\u00d710\n\n114.99 r2\n\n1309 lr \u03c72\n8 g\n1046 d.f.\n263 pr(> \u03c72) < 0.0001 gr\n\u22126\ngp\nbrier\n\n0.133 c\n1.015 dxy\n2.759 \u03b3\n0.126 \u03c4a\n0.148\n\n0.703\n0.406\n0.452\n0.131\n\n "}, {"Page_number": 325, "text": "12.4 examining missing data patterns\n\n303\n\nfraction of nas in each variable\n\npclass\nsurvived\nname\nsex\nsibsp\nparch\nticket\ncabin\nboat\nfare\nembarked\nage\nhome.dest\nbody\n\npclass=ab\n\n|\n\n0.09167\n\nparch>=0.5\n\n0.1806\n\n0.3249\n\n0.0\n\n0.2\n\n0.4\n\n0.6\nfraction of nas\n\n0.8\n\n0.0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\ne\nr\na\nf\n\ni\n\nn\nb\na\nc\n\nt\ne\nk\nc\ni\nt\n\nh\nc\nr\na\np\n\np\ns\nb\ns\n\ni\n\nt\na\no\nb\n\nd\ne\nk\nr\na\nb\nm\ne\n\ne\ng\na\n\nx\ne\ns\n\ne\nm\na\nn\n\ns\ns\na\nc\np\n\nl\n\ni\n\nd\ne\nv\nv\nr\nu\ns\n\ny\nd\no\nb\n\nt\ns\ne\nd\n.\ne\nm\no\nh\n\ni\n\ni\n\ng\nn\ns\ns\nm\n \nn\no\ni\nt\nc\na\nr\nf\n\nfig. 12.8 patterns of missing data. upper left panel shows the fraction of observa-\ntions missing on each predictor. lower panel depicts a hierarchical cluster analysis of\nmissingness combinations. the similarity measure shown on the y -axis is the frac-\ntion of observations for which both variables are missing. right panel shows the result\nof recursive partitioning for predicting is.na(age). the rpart function found only\nstrong patterns according to passenger class.\n\ncoef\n-2.2030 0.3641\nintercept\n0.6440 0.3953\nsex=male\n-1.0079 0.6658\npclass=2nd\n1.6124 0.3596\npclass=3rd\n-0.1806 0.1828\nsurvived\n0.0435 0.0737\nsibsp\nparch\n-0.3526 0.1253\nsex=male * pclass=2nd 0.1347 0.7545\nsex=male * pclass=3rd -0.8563 0.4214\n\ns.e. wald z pr(> |z|)\n-6.05 < 0.0001\n0.1033\n1.63\n-1.51\n0.1300\n4.48 < 0.0001\n-0.99\n0.3232\n0.5548\n0.59\n0.0049\n-2.81\n0.8583\n0.18\n-2.03\n0.0422\n\nlatex ( anova ( m ), file = ' ' , label = ' titanic-anov a. na ' )\n\n# t a b l e 12.3\n\n "}, {"Page_number": 326, "text": "304\n\n12 logistic model case study 2: survival of titanic passengers\n\nsex\nfemale\nmale\npclass\n1st\n2nd\n3rd\nsurvived\nno\nyes\nnumber of siblings/spouses aboard\n0\n1\n2\n3\n4\n5\n8\nnumber of parents/children aboard\n0\n1\n2\n3\n4\n5\n6\n9\noverall\n\nmean\n\nn\n\n466\n843\n\n323\n277\n709\n\n809\n500\n\n891\n319\n42\n20\n22\n6\n9\n\n1002\n170\n113\n8\n6\n6\n2\n2\n\n1309\n\nfig. 12.9 univariable descriptions of proportion of passengers with missing age\n\n0.0\n\n0.2\n\n0.8\n\n1.0\n\n0.6\n0.4\nis.na(age)\n\nfortunately, after controlling for other variables, table 12.3 provides evi-\ndence that nonsurviving passengers are no more likely to have age missing.\nthe only important predictors of missingness are pclass and parch (the more\nparents or children the passenger has on board, the less likely age was to be\nmissing).\n\n12.5 multiple imputation\n\nmultiple imputation is expected to reduce bias in estimates as well as to\nprovide an estimate of the variance\u2013covariance matrix of \u02c6\u03b2 penalized for im-\nputation. with multiple imputation, survival status can be used to impute\nmissing ages, so the age relationship will not be as attenuated as with single\nconditional mean imputation. aregimpute the following uses the hmisc pack-\nage aregimpute function to do predictive mean matching, using van buuren\u2019s\n\u201ctype 1\u201d matching [85, section 3.4.2] in conjunction with bootstrapping to\nincorporate all uncertainties, in the context of smooth additive imputation\n\n "}, {"Page_number": 327, "text": "12.5 multiple imputation\n\n305\n\ntable 12.3 wald statistics for is.na(age)\n\nall interactions\n\nall interactions\n\nsex (factor+higher order factors)\n\npclass (factor+higher order factors)\n\n\u03c72 d.f.\np\n0.1324\n3\n5.61\n0.0614\n5.58\n2\n4 < 0.0001\n68.43\n0.0614\n2\n5.58\nsurvived\n0.3232\n1\n0.98\nsibsp\n0.35\n0.5548\n1\nparch\n7.92\n1\n0.0049\nsex \u00d7 pclass (factor+higher order factors) 5.58\n2\n0.0614\n82.90\ntotal\n8 < 0.0001\n\nmodels. sampling of donors is handled by distance weighting to yield better\ndistributions of imputed values. by default, aregimpute does not transform\nage when it is being predicted from the other variables. four knots are used\nto transform age when used to impute other variables (not needed here as no\nother missings were present in the variables of interest). since the fraction of\nobservations with missing age is 263\n\n1309 = 0.2 we use 20 imputations.\n# so can r e p r o d u c e r a n d o m a s p e c t s\n\nset.seed (17)\n\nmi \u2190 aregimpute (\u223c age + sex + pclass +\n\nsibsp + parch + survived ,\ndata =t3 , n.impute =20 , nk =4 , pr = false )\n\nmi\n\nmultiple i m p u t a t i o n using b o o t s t r a p and pmm\n\na r e g i m p u t e( formula = \u223cage + sex + pclass + sibsp + parch + survived ,\n\ndata = t3 , n . impute = 20 , nk = 4 , pr = false )\n\nn : 1309\n\np : 6\n\ni m p u t a t i o n s: 20\n\nnk : 4\n\nnumber of nas :\n\nage\n263\n\nsex\n0\n\npclass\n0\n\nsibsp\n0\n\nparch survived\n0\n\n0\n\nage\nsex\npclass\nsibsp\nparch\nsurvived\n\ntype d . f .\n1\n1\n2\n2\n2\n1\n\ns\nc\nc\ns\ns\nl\n\nt r a n s f o r m a t i o n of target v a r i a b l e s forced to be linear\n\nr - squares for p r e d i c t i n g non - missing values for each variable\nusing last i m p u t a t i o n s of p r e d i c t o r s\n\nage\n0.295\n\n "}, {"Page_number": 328, "text": "306\n\n12 logistic model case study 2: survival of titanic passengers\n\n# p r i n t the f i r s t 10 i m p u t a t i o n s for the f i r s t 10 p a s s e n g e r s\n#\nmi $ imputed $ age [1:10 , 1:10]\n\nh a v i n g m i s s i n g age\n\n[ ,1] [ ,2] [ ,3] [ ,4] [ ,5] [ ,6] [ ,7] [ ,8] [ ,9] [ ,10]\n61\n53\n65\n42\n33\n23\n63\n50\n67\n23\n\n29 60.0\n49 80.0\n31 40.0\n48 36.0\n31 38.0\n23 18.0\n30 42.0\n61 45.5\n31 45.0\n62 32.5\n\n58\n2\n60\n46\n22\n24\n31\n58\n30\n38\n\n36\n38\n42\n30\n24\n27\n40\n27\n62\n47\n\n50\n36\n30\n38\n40\n59\n40\n24\n39\n19\n\n64\n38\n64\n64\n19\n19\n64\n64\n64\n64\n\n40\n33\n29\n40\n52\n16\n30\n43\n44\n52\n\n49\n45\n24\n42\n40\n14\n62\n23\n57\n18\n\n24\n40\n19\n29\n22\n23\n57\n36\n47\n24\n\n16\n38\n41\n47\n60\n70\n71\n75\n81\n107\n\nplot ( mi )\necdf ( t3 $ age , add = true , col = ' gray ' , lwd =2 ,\n\nsubtitles = false ) # fig. 12.10\n\nx\n \n=\n<\nn\no\n\n \n\ni\nt\nr\no\np\no\nr\np\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n0\n\n20\n\n40\n\n60\n\n80\n\nimputed age\n\nfig. 12.10 distributions of imputed and actual ages for the titanic dataset. imputed\nvalues are in black and actual ages in gray.\n\nwe now fit logistic models for five completed datasets. the fit.mult.impute\nfunction fits five models and examines the within\u2013 and between\u2013imputation\nvariances to compute an imputation-corrected variance\u2013covariance matrix\nthat is stored in the fit object f.mi. fit.mult.impute will also average the five\n\u02c6\u03b2 vectors, storing the result in f.mi$coefficients. the function also prints\nthe ratio of imputation-corrected variances to average ordinary variances.\nf.mi \u2190 fit.mult.impu te (\n\nsurvived \u223c ( sex + pclass + rcs ( age ,5))\n\n2 +\n\n\u2227\n\nrcs ( age ,5) * sibsp ,\n\n "}, {"Page_number": 329, "text": "12.6 summarizing the fitted model\n\n307\n\ntable 12.4 wald statistics for survived\n\n\u03c72\n\nd.f.\n\np\n\n240.42\n54.56\n\nall interactions\n\nall interactions\n\nsex (factor+higher order factors)\n\nage (factor+higher order factors)\n\npclass (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\n7 < 0.0001\n6 < 0.0001\n114.21 12 < 0.0001\n0.0001\n36.43 10\n0.0002\n50.37 20\n0.0557\n25.88 16\n0.0616\n24.21 15\n0.0002\n24.22\n5\nsibsp (factor+higher order factors)\nall interactions\n4\n12.86\n0.0120\nsex \u00d7 pclass (factor+higher order factors) 30.99\n2 < 0.0001\nsex \u00d7 age (factor+higher order factors)\n0.0226\n4\n11.38\nnonlinear\n0.0430\n3\n8.15\nnonlinear interaction : f(a,b) vs. ab\n8.15\n3\n0.0430\npclass \u00d7 age (factor+higher order factors)\n0.7246\n8\n5.30\nnonlinear\n0.5918\n6\n4.63\n0.5918\n6\n4.63\nnonlinear interaction : f(a,b) vs. ab\nage \u00d7 sibsp (factor+higher order factors)\n0.0120\n4\n12.86\n0.6058\n3\n1.84\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\n1.84\n3\n0.6058\n24.21 15\n0.0616\n67.12 18 < 0.0001\n70.99 21 < 0.0001\n298.78 26 < 0.0001\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\nlrm , mi , data = t3 , pr = false )\n\nlatex ( anova ( f.mi ), file = ' ' , label = ' titanic-anov a. mi ' ,\n\nsize = ' small ' )\n\n# t a b l e 12.4\n\nthe wald \u03c72 for age is reduced by accounting for imputation but is in-\ncreased (by a lesser amount) by using patterns of association with survival\nstatus to impute missing age. the wald tests are all adjusted for multiple im-\nputation. now examine the fitted age relationship using multiple imputation\nvs. casewise deletion.\np1 \u2190 predict (f ,\np2 \u2190 predict ( f.mi ,\np \u2190 rbind ( ' casewise deletion ' = p1 , ' multiple imputation ' = p2 )\nggplot (p , groups = ' sex ' , ylab = ' probability of surviving ' )\n# f i g u r e 12.11\n\nage , pclass , sex , sibsp =0 , fun = plogis )\nage , pclass , sex , sibsp =0 , fun = plogis )\n\n12.6 summarizing the fitted model\n\nin this section we depict the model fitted using multiple imputation, by com-\nputing odds ratios and by showing various predicted values. for age, the odds\nratio for an increase from 1 year old to 30 years old is computed, instead of\nthe default odds ratio based on outer quartiles of age. the estimated odds\n\n "}, {"Page_number": 330, "text": "308\n\n12 logistic model case study 2: survival of titanic passengers\n\ncasewise deletion\n\nmultiple imputation\n\n1\ns\nt\n\nsex\n\n2\nn\nd\n\nfemale\n\nmale\n\n3\nr\nd\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\ni\n\ni\n\ng\nn\nv\nv\nr\nu\ns\n\n \nf\n\no\n\n \ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n0\n\n20\n\n40\n\n0\n\n60\nage, years\n\n20\n\n40\n\n60\n\nfig. 12.11 predicted probability of survival for males from fit using casewise deletion\nagain (top) and multiple random draw imputation (bottom). both sets of predictions\nare for sibsp=0.\n\nratios are very dependent on the levels of interacting factors, so figure 12.12\ndepicts only one of many patterns.\n\n# get p r e d i c t e d v a l u e s for c e r t a i n t y p e s of p a s s e n g e r s\n\ns \u2190 summary ( f.mi , age = c (1 ,30) , sibsp =0:1)\n# o v e r r i d e d e f a u l t r a n g e s for 3 v a r i a b l e s\nplot (s , log = true , main = ' ' )\n\n# f i g u r e 12.12\n\nnow compute estimated probabilities of survival for a variety of settings of\nthe predictors.\n\n "}, {"Page_number": 331, "text": "12.6 summarizing the fitted model\n\n309\n\n0.10\n\n0.50\n\n2.00 5.00\n\nage \u2212 30:1\n\nsibsp \u2212 1:0\n\nsex \u2212 female:male\n\npclass \u2212 1st:3rd\n\npclass \u2212 2nd:3rd\n\nfig. 12.12 odds ratios for some predictor settings\n\nadjusted to:sex=male pclass=3rd age=28 sibsp=0 \n\nphat \u2190 predict ( f.mi ,\n\ncombos \u2190\n\nexpand.grid ( age = c (2 ,21 ,50) , sex = levels ( t3 $ sex ),\n\npclass = levels ( t3 $ pclass ),\nsibsp =0) , type = ' fitted ' )\n\n# can also use p r e d i c t ( f.mi , age = c (2 ,21 ,50) , sex , pclass ,\n#\noptions ( digits =1)\ndata.frame ( combos , phat )\n\ns i b s p =0 , fun = p l o g i s ) $ yhat\n\nage\n\n2\n21\n50\n\n2 female\n21 female\n50 female\nmale\nmale\nmale\n2 female\n21 female\n50 female\nmale\nmale\nmale\n2 female\n21 female\n50 female\nmale\nmale\nmale\n\nsex pclass sibsp phat\n0 0.97\n0 0.98\n0 0.97\n0 0.88\n0 0.48\n0 0.27\n0 1.00\n0 0.90\n0 0.82\n0 1.00\n0 0.08\n0 0.04\n0 0.85\n0 0.57\n0 0.37\n0 0.91\n0 0.13\n0 0.06\n\n1 st\n1 st\n1 st\n1 st\n1 st\n1 st\n2 nd\n2 nd\n2 nd\n2 nd\n2 nd\n2 nd\n3 rd\n3 rd\n3 rd\n3 rd\n3 rd\n3 rd\n\n2\n21\n50\n\n2\n21\n50\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\noptions ( digits =5)\n\nwe can also get predicted values by creating an r function that will evaluate\nthe model on demand.\n\n "}, {"Page_number": 332, "text": "310\n\n12 logistic model case study 2: survival of titanic passengers\n\npred.logit \u2190 function ( f.mi )\n# note : if don ' t d e f i n e s i b s p to p r e d . l o g i t , d e f a u l t s to 0\n# n o r m a l l y just type the f u n c t i o n name to see its body\nlatex ( pred.logit , file = ' ' , type = ' sinput ' , size = ' small ' ,\n\nwidth.cutoff =49)\n\np r e d . l o g i t \u2190 f u n c t i o n ( s e x = \u201dmale \u201d , p c l a s s = \u201d3 rd \u201d ,\n{\n\nage = 2 8 ,\n3 . 2 4 2 7 6 7 1 \u2212 0 . 9 5 4 3 1 8 0 9 \u2217 ( s e x == \u201dmale \u201d ) + 5 . 4 0 8 6 5 0 5 \u2217\n\ns i b s p = 0 )\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\u2227\n\u2227\n\n( p c l a s s == \u201d2nd \u201d ) \u2212 1 . 3 3 7 8 6 2 3 \u2217 ( p c l a s s ==\n\u201d3 rd \u201d ) + 0 . 0 9 1 1 6 2 6 4 9 \u2217 age \u2212 0 . 0 0 0 3 1 2 0 4 3 2 7 \u2217\npmax ( age \u2212 6 , 0 )\n3 \u2212 0 . 0 0 2 7 6 2 7 0 3 2 \u2217 pmax ( age \u2212 2 7 , 0 )\n\u2227\n2 1 , 0 )\n0 . 0 0 0 9 8 0 5 1 3 7 \u2217 pmax ( age \u2212 3 6 , 0 )\npmax ( age \u2212 55 . 8 , 0 )\n3 \u2212 1 . 1 5 6 7 9 7 6 \u2217 s i b s p +\n( s e x == \u201dmale \u201d ) \u2217 ( \u22120. 46061284 \u2217 ( p c l a s s ==\n( s e x == \u201dmale \u201d ) \u2217 ( \u22120. 22469066 \u2217 age + 0 . 0 0 0 4 3 7 0 8 2 9 6 \u2217\n\n3 + 0 . 0 0 2 1 7 5 0 4 1 3 \u2217 pmax ( age \u2212\n3 +\n\n3 \u2212 8 . 0808484e\u221205 \u2217\n\n\u201d2nd \u201d ) + 2 . 0 4 0 6 5 2 3 \u2217 ( p c l a s s == \u201d3 rd \u201d ) ) +\npmax ( age \u2212 6 , 0 )\n2 1 , 0 )\n0 )\n0 )\n0 )\n\n3 + 0 . 0 0 3 1 2 0 1 4 0 4 \u2217 pmax ( age \u2212 2 7 ,\n3 \u2212 0 . 0 0 0 9 7 9 2 3 7 4 9 \u2217 pmax ( age \u2212 3 6 ,\n3 + 7 . 2527708e\u221205 \u2217 pmax ( age \u2212 55 . 8 ,\n3 ) + ( p c l a s s == \u201d2nd \u201d ) \u2217 ( \u22120. 46144083 \u2217\n3 \u2212\n\n3 \u2212 0 . 0 0 2 6 5 0 5 1 3 6 \u2217 pmax ( age \u2212\n\n3 \u2212 0 . 0 0 0 7 9 0 0 8 9 1 \u2217 pmax ( age \u2212\n\n3 + 3 . 5268151e\u221205 \u2217 pmax ( age \u2212 55 . 8 ,\n3 ) + ( p c l a s s == \u201d3 rd \u201d) \u2217 ( \u22120. 17513289 \u2217\n3 \u2212\n\nage + 0 . 0 0 0 7 0 1 9 4 8 4 9 \u2217 pmax ( age \u2212 6 , 0 )\n0 . 0 0 3 4 7 2 6 6 6 2 \u2217 pmax ( age \u2212 2 1 , 0 )\npmax ( age \u2212 2 7 , 0 )\n3 6 , 0 )\n0 )\nage + 0 . 0 0 0 3 5 2 8 3 3 5 8 \u2217 pmax ( age \u2212 6 , 0 )\n0 . 0 0 2 3 0 4 9 3 7 2 \u2217 pmax ( age \u2212 2 1 , 0 )\npmax ( age \u2212 2 7 , 0 )\n3 6 , 0 )\n0 )\npmax ( age \u2212 6 , 0 )\n2 1 , 0 )\n0 )\n4 . 0597949e\u221205 \u2217 pmax ( age \u2212 55 . 8 , 0 )\n\n3 \u2212 0 . 0 0 0 2 5 0 3 9 3 8 5 \u2217 pmax ( age \u2212 2 7 ,\n3 + 0 . 0 0 0 1 7 8 7 1 7 0 1 \u2217 pmax ( age \u2212 3 6 , 0 )\n\u2227\n\n3 + 0 . 0 0 0 1 0 5 6 5 7 3 5 \u2217 pmax ( age \u2212 55 . 8 ,\n\n3 \u2212 0 . 0 0 1 0 5 1 4 5 \u2217 pmax ( age \u2212\n\n3 + 0 . 0 0 0 1 2 7 9 0 2 5 6 \u2217 pmax ( age \u2212\n\n3 ) + s i b s p \u2217 ( 0 . 0 4 0 8 3 0 7 7 3 \u2217 age \u2212 1 . 5627772e\u221205 \u2217\n\n3 + 0 . 0 0 3 5 2 5 5 3 8 7 \u2217\n\n3 + 0 . 0 0 2 8 9 7 8 9 6 2 \u2217\n\n3 \u2212\n\n3 )\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n\u2227\n\n}\n\n# run the n e w l y c r e a t e d f u n c t i o n\nplogis ( pred.logit ( age = c (2 ,21 ,50) , sex = ' male ' , pclass = ' 3 rd ' ))\n\n[1] 0.914817 0.132640 0.056248\n\na nomogram could be used to obtain predicted values manually, but this is\nnot feasible when so many interaction terms are present.\n\n "}, {"Page_number": 333, "text": "chapter 13\nordinal logistic regression\n\n13.1 background\n\nmany medical and epidemiologic studies incorporate an ordinal response\nvariable. in some cases an ordinal response y represents levels of a standard\nmeasurement scale such as severity of pain (none, mild, moderate, severe).\nin other cases, ordinal responses are constructed by specifying a hierarchy\nof separate endpoints. for example, clinicians may specify an ordering of\nthe severity of several component events and assign patients to the worst\nevent present from among none, heart attack, disabling stroke, and death.\nstill another use of ordinal response methods is the application of rank-based\nmethods to continuous responses so as to obtain robust inferences. for ex-\nample, the proportional odds model described later allows for a continuous\ny and is really a generalization of the wilcoxon\u2013mann\u2013whitney rank test.\nthus the semiparametric proportional odds model is a direct competitor of\nordinary linear models.\n\nthere are many variations of logistic models used for predicting an ordinal\nresponse variable y . all of them have the advantage that they do not assume\na spacing between levels of y . in other words, the same regression coefficients\nand p -values result from an analysis of a response variable having levels 0, 1, 2\nwhen the levels are recoded 0, 1, 20. thus ordinal models use only the rank-\nordering of values of y .\n\nin this chapter we consider two of the most popular ordinal logistic models,\nthe proportional odds (po) form of an ordinal logistic model647 and the for-\nward continuation ratio (cr) ordinal logistic model.190 chapter 15 deals with\na wider variety of ordinal models with emphasis on analysis of continuous y .\n\n1\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 13\n\n311\n\n "}, {"Page_number": 334, "text": "312\n\n13 ordinal logistic regression\n\n13.2 ordinality assumption\n\na basic assumption of all commonly used ordinal regression models is that the\nresponse variable behaves in an ordinal fashion with respect to each predictor.\nassuming that a predictor x is linearly related to the log odds of some\nappropriate event, a simple way to check for ordinality is to plot the mean\nof x stratified by levels of y . these means should be in a consistent order.\nif for many of the xs, two adjacent categories of y do not distinguish the\nmeans, that is evidence that those levels of y should be pooled.\none can also estimate the mean or expected value of x|y = j (e(x|y =\nj)) given that the ordinal model assumptions hold. this is a useful tool for\nchecking those assumptions, at least in an unadjusted fashion. for simplicity,\nassume that x is discrete, and let pjx = pr(y = j|x = x) be the probability\nthat y = j given x = x that is dictated from the model being fitted, with\nx being the only predictor in the model. then\n\npr(x = x|y = j) = pr(y = j|x = x) pr(x = x)/pr(y = j)\n\n(cid:3)\n\ne(x|y = j) =\n\nxpjx pr(x = x)/ pr(y = j),\n\n(13.1)\n\nx\n\nand the expectation can be estimated by\n\n\u02c6e(x|y = j) =\n\nx \u02c6pjxfx/gj,\n\n(13.2)\n\nwhere \u02c6pjx denotes the estimate of pjx from the fitted one-predictor model\n(for inner values of y in the po models, these probabilities are differences\nbetween terms given by equation 13.4 below), fx is the frequency of x = x\nin the sample of size n, and gj is the frequency of y = j in the sample. this\nestimate can be computed conveniently without grouping the data by x. for\nn subjects let the n values of x be x1, x2, . . . , xn. then\n\n\u02c6e(x|y = j) =\n\nxi \u02c6pjxi /gj.\n\n(13.3)\n\ni=1\n\nnote that if one were to compute differences between conditional means of x\nand the conditional means of x given po, and if furthermore the means were\nconditioned on y \u2265 j instead of y = j, the result would be proportional to\nmeans of score residuals defined later in equation 13.6.\n\n(cid:3)\n\nx\n\nn(cid:3)\n\n "}, {"Page_number": 335, "text": "13.3 proportional odds model\n\n313\n\n13.3 proportional odds model\n\n13.3.1 model\n\nthe most commonly used ordinal logistic model was described in walker\nand duncan647 and later called the proportional odds (po) model by mc-\ncullagh.449 the po model is best stated as follows, for a response variable\nhaving levels 0, 1, 2, . . . , k:\n\npr[y \u2265 j|x] =\n\n1\n\n,\n\n1 + exp[\u2212(\u03b1j + x\u03b2)]\n\n(13.4)\nwhere j = 1, 2, . . . , k. some authors write the model in terms of y \u2264 j. our\nformulation makes the model coefficients consistent with the binary logistic\nmodel. there are k intercepts (\u03b1s). for fixed j, the model is an ordinary\nlogistic model for the event y \u2265 j. by using a common vector of regression\ncoefficients \u03b2 connecting probabilities for varying j, the po model allows for\nparsimonious modeling of the distribution of y .\n\nthere is a nice connection between the po model and the wilcoxon\u2013\nmann\u2013whitney two-sample test: when there is a single predictor x1 that is\nbinary, the numerator of the score test for testing h0 : \u03b21 = 0 is proportional\nto the two-sample test statistic [664, pp. 2258\u20132259].\n\n13.3.2 assumptions and interpretation of parameters\n\nthere is an implicit assumption in the po model that the regression coef-\nficients (\u03b2) are independent of j, the cutoff level for y . one could say that\nthere is no x \u00d7 y interaction if po holds. for a specific y -cutoff j, the model\nhas the same assumptions as the binary logistic model (section 10.1.1). that\nis, the model in its simplest form assumes the log odds that y \u2265 j is linearly\nrelated to each x and that there is no interaction between the xs.\n\nin designing clinical studies, one sometimes hears the statement that an\nordinal outcome should be avoided since statistical tests of patterns of those\noutcomes are hard to interpret. in fact, one interprets effects in the po model\nusing ordinary odds ratios. the difference is that a single odds ratio is as-\nsumed to apply equally to all events y \u2265 j, j = 1, 2, . . . , k. if linearity and\nadditivity hold, the xm + 1 : xm odds ratio for y \u2265 j is exp(\u03b2m), whatever\nthe cutoff j.\n\nthe proportional hazards assumption is frequently violated, just as the as-\nsumptions of normality of residuals with equal variance in ordinary regression\nare frequently violated, but the po model can still be useful and powerful in\nthis situation. as stated by senn and julious564,\n\n2\n\n "}, {"Page_number": 336, "text": "314\n\n13 ordinal logistic regression\n\nclearly, the dependence of the proportional odds model on the assumption\nof proportionality can be over-stressed. suppose that two different statisticians\nwould cut the same three-point scale at different cut points. it is hard to see how\nanybody who could accept either dichotomy could object to the compromise\nanswer produced by the proportional odds model.\n\nsometimes it helps in interpreting the model to estimate the mean y as\na function of one or more predictors, even though this assumes a spacing for\nthe y -levels.\n\n3\n\n13.3.3 estimation\n\nthe po model is fitted using mle on a somewhat complex likelihood function\nthat is dependent on differences in logistic model probabilities. the estimation\nprocess forces the \u03b1s to be in descending order.\n\n13.3.4 residuals\n\nschoenfeld residuals557 are very effective233 in checking the proportional haz-\nards assumption in the cox132 survival model. for the po model one could\nanalogously compute each subject\u2019s contribution to the first derivative of\nthe log likelihood function with respect to \u03b2m, average them separately by\nlevels of y , and examine trends in the residual plots as in section 20.6.2.\na few examples have shown that such plots are usually hard to interpret.\neasily interpreted score residual plots for the po model can be constructed,\nhowever, by using the fitted po model to predict a series of binary events\ny \u2265 j, j = 1, 2, . . . , k, using the corresponding predicted probabilities\n\n\u02c6pij =\n\n1\n\n1 + exp[\u2212(\u02c6\u03b1j + xi \u02c6\u03b2)]\n\n,\n\n(13.5)\n\nwhere xi stands for a vector of predictors for subject i. then, after forming\nan indicator variable for the event currently being predicted ([yi \u2265 j]), one\ncomputes the score (first derivative) components uim from an ordinary binary\nlogistic model:\n\nuim = xim([yi \u2265 j] \u2212 \u02c6pij ),\n\n(13.6)\n\nfor the subject i and predictor m. then, for each column of u , plot the mean\n\u00afu\u00b7m and confidence limits, with y (i.e., j) on the x-axis. for each predictor\nthe trend against j should be flat if po holds. ain binary logistic regression,\npartial residuals are very useful as they allow the analyst to fit linear effects\n\na if \u02c6\u03b2 were derived from separate binary fits, all \u00afu\u00b7m \u2261 0.\n\n "}, {"Page_number": 337, "text": "13.3 proportional odds model\n\n315\n\nfor all the predictors but then to nonparametrically estimate the true trans-\nformation that each predictor requires (section 10.4). the partial residual is\ndefined as follows, for the ith subject and mth predictor variable.115, 373\n\nwhere\n\nrim = \u02c6\u03b2mxim +\n\nyi \u2212 \u02c6pi\n\u02c6pi(1 \u2212 \u02c6pi)\n\n,\n\n\u02c6pi =\n\n1\n\n1 + exp[\u2212(\u03b1 + xi \u02c6\u03b2)]\n\n.\n\n(13.7)\n\n(13.8)\n\na smoothed plot (e.g., using the moving linear regression algorithm in\nloess111) of xim against rim provides a nonparametric estimate of how xm\nrelates to the log relative odds that y = 1|xm. for ordinal y , we just need\nto compute binary model partial residuals for all cutoffs j:\n\nrim = \u02c6\u03b2mxim +\n\n[yi \u2265 j] \u2212 \u02c6pij\n\u02c6pij (1 \u2212 \u02c6pij )\n\n,\n\n(13.9)\n\nthen to make a plot for each m showing smoothed partial residual curves for\nall j, looking for similar shapes and slopes for a given predictor for all j. each\ncurve provides an estimate of how xm relates to the relative log odds that\ny \u2265 j. since partial residuals allow examination of predictor transformations\n(linearity) while simultaneously allowing examination of po (parallelism),\npartial residual plots are generally preferred over score residual plots for or-\ndinal models.\n\nli and shepherd402 have a residual for ordinal models that serves for the\nentire range of y without the need to consider cutoffs. their residual is use-\nful for checking functional form of predictors but not the proportional odds\nassumption.\n\n13.3.5 assessment of model fit\n\npeterson and harrell502 developed score and likelihood ratio tests for testing\nthe po assumption. the score test is used in the sas proc logistic,540\nbut its extreme anti-conservatism in many cases can make it unreliable.502\n\nfor determining whether the po assumption is likely to be satisfied for\neach predictor separately, there are several graphics that are useful. one is the\ngraph comparing means of x|y with and without assuming po, as described\nin section 13.2 (see figure 14.2 for an example). another is the simple method\nof stratifying on each predictor and computing the logits of all proportions of\nthe form y \u2265 j, j = 1, 2, . . . , k. when proportional odds holds, the differences\nin logits between different values of j should be the same at all levels of x,\n\n4\n\n "}, {"Page_number": 338, "text": "316\n\n13 ordinal logistic regression\n\nbecause the model dictates that logit(y \u2265 j|x) \u2212 logit(y \u2265 i|x) = \u03b1j \u2212 \u03b1i,\nfor any constant x. an example of this is in figure 13.1.\n\nrequire ( hmisc )\n\ngethdata ( support )\n\nsfdm \u2190 as.integer ( support $ sfdm2 ) - 1\nsf \u2190 function ( y )\n\nc ( ' y \u2265 1 ' = qlogis ( mean (y \u2265 1)) , ' y \u2265 2 ' = qlogis ( mean (y \u2265 2)) ,\n\n' y \u2265 3 ' = qlogis ( mean (y \u2265 3)))\n\ns \u2190 summary ( sfdm \u223c adlsc + sex + age + meanbp , fun = sf ,\nplot (s , which =1:3 , pch =1:3 , xlab = ' logit ' , vnames = ' names ' ,\n\ndata = support )\n\nmain = ' ' , width.factor =1 .5 )\n\nadlsc\n0.000\n[0.495,1.167)\n[1.167,3.024)\n[3.024,7.000]\n\nsex\nfemale\nmale\n\nage\n[19.8, 52.4)\n[52.4, 65.3)\n[65.3, 74.8)\n[74.8,100.1]\n\nmeanbp\n[  0, 64)\n[ 64, 78)\n[ 78,108)\n[108,180]\n\noverall\n\n# f i g u r e 13.1\n\nn\n\n282\n150\n199\n210\n\n377\n464\n\n211\n210\n210\n210\n\n211\n216\n204\n210\n\n841\n\n\u22120.5\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\nlogit\n\nfig. 13.1 checking po assumption separately for a series of predictors. the circle,\ntriangle, and plus sign correspond to y \u2265 1, 2, 3, respectively. po is checked by\nexamining the vertical constancy of distances between any two of these three symbols.\nresponse variable is the severe functional disability scale sfdm2 from the 1000-patient\nsupport dataset, with the last two categories combined because of low frequency\nof coma/intubation.\n\nwhen y is continuous or almost continuous and x is discrete, the po model\nassumes that the logit of the cumulative distribution function of y is parallel\n\n "}, {"Page_number": 339, "text": "13.3 proportional odds model\n\n317\n\nacross categories of x. the corresponding, more rigid, assumptions of the\nordinary linear model (here, parametric anova) are parallelism and linear-\nity if the normal inverse cumulative distribution function across categories\nof x. as an example consider the web site\u2019s diabetes dataset, where we con-\nsider the distribution of log glycohemoglobin across subjects\u2019 body frames.\n\ngethdata ( diabetes )\n\na \u2190 ecdf (\u223c log ( glyhb ), group = frame , fun = qnorm ,\n\nxlab = ' log ( hba1c ) ' , label.curves = false , data = diabetes ,\nylab = expression ( paste ( phi\n-1 , ( f [ n ]( x ))))) # fig. 13.2\n\nb \u2190 ecdf (\u223c log ( glyhb ), group = frame , fun = qlogis ,\n\n\u2227\n\nxlab = ' log ( hba1c ) ' , label.curves = list ( keys = ' lines ' ),\ndata = diabetes , ylab = expression ( logit ( f [ n ]( x ))))\n\nprint (a , more = true , split = c (1 ,1 ,2 ,1))\nprint (b , split = c (2 ,1 ,2 ,1))\n\n)\n)\nx\n(\n\nn\nf\n(\n\n1\n\u2212\n\n\u03c6\n\n2\n\n0\n\n\u22122\n\n)\n)\nx\n(\n\nn\nf\n(\nt\ni\n\ng\no\n\nl\n\n5\n\n0\n\n\u22125\n\nsmall\nmedium\nlarge\n\n1.0\n\n2.0\n\n1.5\nlog(hba1c)\n\n2.5\n\n1.0\n\n2.0\n\n1.5\nlog(hba1c)\n\n2.5\n\nfig. 13.2 transformed empirical cumulative distribution functions stratified by body\nframe in the diabetes dataset. left panel: checking all assumptions of the parametric\nanova. right panel: checking all assumptions of the po model (here, kruskal\u2013wallis\ntest).\n\none could conclude the right panel of figure 13.2 displays more parallelism\nthan the left panel displays linearity, so the assumptions of the po model are\nbetter satisfied than the assumptions of the ordinary linear model.\n\nchapter 14 has many examples of graphics for assessing fit of po models.\nregarding assessment of linearity and additivity assumptions, splines, partial\nresidual plots, and interaction tests are among the best tools. fagerland and\nhosmer182 have a good review of goodness-of-fit tests for the po model.\n\n "}, {"Page_number": 340, "text": "318\n\n13 ordinal logistic regression\n\n13.3.6 quantifying predictive ability\n\nthe r2\nn coefficient is really computed from the model lr \u03c72 (\u03c72 added to\na model containing only the k intercept parameters) to describe the model\u2019s\npredictive power. the somers\u2019 dxy rank correlation between x \u02c6\u03b2 and y is\nan easily interpreted measure of predictive discrimination. since it is a rank\nmeasure, it does not matter which intercept \u03b1 is used in the calculation.\nthe probability of concordance, c, is also a useful measure. here one takes all\npossible pairs of subjects having differing y values and computes the fraction\nof such pairs for which the values of x \u02c6\u03b2 are in the same direction as the two\ny values. c could be called a generalized roc area in this setting. as before,\ndxy = 2(c \u2212 0.5). note that dxy, c, and the brier score b can easily be\ncomputed for various dichotomizations of y , to investigate predictive ability\nin more detail.\n\n13.3.7 describing the fitted model\n\nas discussed in section 5.1, models are best described by computing predicted\nvalues or differences in predicted values. for po models there are four and\nsometimes five types of relevant predictions:\n1. logit[y \u2265 j|x], i.e., the linear predictor\n2. prob[y \u2265 j|x]\n3. prob[y = j|x]\n4. quantiles of y |x (e.g., the medianb)\n5. e(y |x) if y is interval scaled.\nfor the first two quantities above a good default choice for j is the middle\ncategory. partial effect plots are as simple to draw for po models as they are\nfor binary logistic models. other useful graphics, as before, are odds ratio\ncharts and nomograms. for the latter, an axis displaying the predicted mean\nmakes the model more interpretable, under scaling assumptions on y .\n\n13.3.8 validating the fitted model\n\nthe po model is validated much the same way as the binary logistic model\n(see section 10.9). for estimating an overfitting-corrected calibration curve\n(section 10.11) one estimates pr(y \u2265 j|x) using one j at a time.\n\nb if y does not have very many levels, the median will be a discontinuous function\nof x and may not be satisfactory.\n\n "}, {"Page_number": 341, "text": "13.4 continuation ratio model\n\n13.3.9 r functions\n\n319\n\nthe rms package\u2019s lrm and orm functions fit the po model directly, assuming\nthat the levels of the response variable (e.g., the levels of a factor variable)\nare listed in the proper order. lrm is intended to be used for the case where the\nnumber of unique values of y are less than a few dozen whereas orm handles\nthe continuous y case efficiently, as well as allowing for links other than the\nlogit. see chapter 15 for more information.\n\nif the response is numeric, lrm assumes the numeric codes properly order\nthe responses. if it is a character vector and is not a factor, lrm assumes the\ncorrect ordering is alphabetic. of course ordered variables in r are appropriate\nresponse variables for ordinal regression. the predict function (predict.lrm)\ncan compute all the quantities listed in section 13.3.7 except for quantiles.\n\nthe r functions popower and posamsize (in the hmisc package) compute\npower and sample size estimates for ordinal responses using the proportional\nodds model.\n\nthe function plot.xmean.ordinaly in rms computes and graphs the quanti-\nties described in section 13.2. it plots simple y -stratified means overlaid with\n\u02c6e(x|y = j), with j on the x-axis. the \u02c6es are computed for both po and con-\ntinuation ratio ordinal logistic models. the hmisc package\u2019s summary.formula\nfunction is also useful for assessing the po assumption (figure 13.1). generic\nrms functions such as validate, calibrate, and nomogram work with po model\nfits from lrm as long as the analyst specifies which intercept(s) to use. rms has\na special function generator mean for constructing an easy-to-use function for\ngetting the predicted mean y from a po model. this is handy with plot and\nnomogram. if the fit has been run through the bootcov function, it is easy to\nuse the predict function to estimate bootstrap confidence limits for predicted\nmeans.\n\n13.4 continuation ratio model\n\n13.4.1 model\n\nunlike the po model, which is based on cumulative probabilities, the contin-\nuation ratio (cr) model is based on conditional probabilities. the (forward)\ncr model31, 52, 190 is stated as follows for y = 0, . . . , k.\n\npr(y = j|y \u2265 j, x) =\n\n1\n\n1 + exp[\u2212(\u03b8j + x\u03b3)]\n\nlogit(y = 0|y \u2265 0, x) = logit(y = 0|x)\n\n= \u03b80 + x\u03b3\n\n(13.10)\n\n "}, {"Page_number": 342, "text": "320\n\n13 ordinal logistic regression\n\nlogit(y = 1|y \u2265 1, x) = \u03b81 + x\u03b3\n\nlogit(y = k \u2212 1|y \u2265 k \u2212 1, x) = \u03b8k\u22121 + x\u03b3.\n\n. . .\n\nthe cr model has been said to be likely to fit ordinal responses when subjects\nhave to \u201cpass through\u201d one category to get to the next. the cr model is a\ndiscrete version of the cox proportional hazards model. the discrete hazard\nfunction is defined as pr(y = j|y \u2265 j).\n\n13.4.2 assumptions and interpretation of parameters\n\nthe cr model assumes that the vector of regression coefficients, \u03b3, is the\nsame regardless of which conditional probability is being computed.\none could say that there is no x\u00d7 condition interaction if the cr model\nholds. for a specific condition y \u2265 j, the model has the same assumptions as\nthe binary logistic model (section 10.1.1). that is, the model in its simplest\nform assumes that the log odds that y = j conditional on y \u2265 j is linearly\nrelated to each x and that there is no interaction between the xs.\na single odds ratio is assumed to apply equally to all conditions y \u2265 j, j =\n0, 1, 2, . . . , k \u2212 1. if linearity and additivity hold, the xm + 1 : xm odds ratio\nfor y = j is exp(\u03b2m), whatever the conditioning event y \u2265 j.\nto compute pr(y > 0|x) from the cr model, one only needs to take\none minus pr(y = 0|x). to compute other unconditional probabilities from\nthe cr model, one must multiply the conditional probabilities. for example,\npr(y > 1|x) = pr(y > 1|x, y \u2265 1) \u00d7 pr(y \u2265 1|x) = [1 \u2212 pr(y = 1|y \u2265\n1, x)][1\u2212 pr(y = 0|x)] = [1\u2212 1/(1 + exp[\u2212(\u03b81 + x\u03b3)])][1\u2212 1/(1 + exp[\u2212(\u03b80 +\n\nx\u03b3)])].\n\n13.4.3 estimation\n\narmstrong and sloan31 and berridge and whitehead52 showed how the cr\nmodel can be fitted using an ordinary binary logistic model likelihood func-\ntion, after certain rows of the x matrix are duplicated and a new binary y\nvector is constructed. for each subject, one constructs separate records by\nconsidering successive conditions y \u2265 0, y \u2265 1, . . . , y \u2265 k \u2212 1 for a response\nvariable with values 0, 1, . . . , k. the binary response for each applicable con-\ndition or \u201ccohort\u201d is set to 1 if the subject failed at the current \u201ccohort\u201d or\n\u201crisk set,\u201d that is, if y = j where the cohort being considered is y \u2265 j. the\nconstructed cohort variable is carried along with the new x and y . this vari-\nable is considered to be categorical and its coefficients are fitted by adding\nk \u2212 1 dummy variables to the binary logistic model. for ease of computation,\n\n "}, {"Page_number": 343, "text": "13.4 continuation ratio model\n\n321\n\nthe cr model is restated as follows, with the first cohort used as the reference\ncell.\n\npr(y = j|y \u2265 j, x) =\n\n1\n\n1 + exp[\u2212(\u03b1 + \u03b8j + x\u03b3)]\n\n.\n\n(13.11)\n\nhere \u03b1 is an overall intercept, \u03b80 \u2261 0, and \u03b81, . . . , \u03b8k\u22121 are increments from \u03b1.\n\n13.4.4 residuals\n\nto check cr model assumptions, binary logistic model partial residuals are\nagain valuable. we separately fit a sequence of binary logistic models using a\nseries of binary events and the corresponding applicable (increasingly small)\nsubsets of subjects, and plot smoothed partial residuals against x for all of\nthe binary events. parallelism in these plots indicates that the cr model\u2019s\nconstant \u03b3 assumptions are satisfied.\n\n13.4.5 assessment of model fit\n\nthe partial residual plots just described are very useful for checking the\nconstant slope assumption of the cr model. the next section shows how to\ntest this assumption formally. linearity can be assessed visually using the\nsmoothed partial residual plot, and interactions between predictors can be\ntested as usual.\n\n13.4.6 extended cr model\n\nthe po model has been extended by peterson and harrell502 to allow for\nunequal slopes for some or all of the xs for some or all levels of y . this partial\npo model requires specialized software. the cr model can be extended more\neasily. in r notation, the ordinary cr model is specified as\ny \u223c cohort + x1 + x2 + x3 + ...\n\n5\n\nwith cohort denoting a polytomous variable. the cr model can be extended\nto allow for some or all of the \u03b2s to change with the cohort or y -cutoff.31\nsuppose that non-constant slope is allowed for x1 and x2. the r notation for\nthe extended model would be\ny \u223c cohort * ( x1 + x2 ) + x3\n\n "}, {"Page_number": 344, "text": "322\n\n13 ordinal logistic regression\n\nthe extended cr model is a discrete version of the cox survival model with\ntime-dependent covariables.\n\nthere is nothing about the cr model that makes it fit a given dataset\nbetter than other ordinal models such as the po model. the real benefit of\nthe cr model is that using standard binary logistic model software one can\nflexibly specify how the equal-slopes assumption can be relaxed.\n\n13.4.7 role of penalization in extended cr model\n\nas demonstrated in the upcoming case study, penalized mle is invaluable in\nallowing the model to be extended into an unequal-slopes model insofar as the\ninformation content in the data will support. faraway186 has demonstrated\nhow all data-driven steps of the modeling process increase the real variance in\n\u201cfinal\u201d parameter estimates, when one estimates variances without assuming\nthat the final model was prespecified. for ordinal regression modeling, the\nmost important modeling steps are (1) choice of predictor variables, (2) se-\nlecting or modeling predictor transformations, and (3) allowance for unequal\nslopes across y -cutoffs (i.e., non-po or non-cr). regarding steps (2) and (3)\none is tempted to rely on graphical methods such as residual plots to make\ndetours in the strategy, but it is very difficult to estimate variances or to\nproperly penalize assessments of predictive accuracy for subjective modeling\ndecisions. regarding (1), shrinkage has been proven to work better than step-\nwise variable selection when one is attempting to build a main-effects model.\nchoosing a shrinkage factor is a well-defined, smooth, and often a unique\nprocess as opposed to binary decisions on whether variables are \u201cin\u201d or \u201cout\u201d\nof the model. likewise, instead of using arbitrary subjective (residual plots)\nor objective (\u03c72 due to cohort \u00d7 covariable interactions, i.e., non-constant\ncovariable effects), shrinkage can systematically allow model enhancements\ninsofar as the information content in the data will support, through the use of\ndifferential penalization. shrinkage is a solution to the dilemma faced when\nthe analyst attempts to choose between a parsimonious model and a more\ncomplex one that fits the data. penalization does not require the analyst to\nmake a binary decision, and it is a process that can be validated using the\nbootstrap.\n\n13.4.8 validating the fitted model\n\nvalidation of statistical indexes such as dxy and model calibration is done\nusing techniques discussed previously, except that certain problems must be\naddressed. first, when using the bootstrap, the resampling must take into ac-\ncount the existence of multiple records per subject that were created to use\n\n "}, {"Page_number": 345, "text": "13.4 continuation ratio model\n\n323\n\nthe binary logistic likelihood trick. that is, sampling should be done with re-\nplacement from subjects rather than records. second, the analyst must isolate\nwhich event to predict. this is because when observations are expanded in\norder to use a binary logistic likelihood function to fit the cr model, several\ndifferent events are being predicted simultaneously. somers\u2019 dxy could be\ncomputed by relating x \u02c6\u03b3 (ignoring intercepts) to the ordinal y , but other\nindexes are not defined so easily. the simplest approach here would be to\nvalidate a single prediction for pr(y = j|y \u2265 j, x), for example. the sim-\nplest event to predict is pr(y = 0|x), as this would just require subsetting\non all observations in the first cohort level in the validation sample. it would\nalso be easy to validate any one of the later conditional probabilities. the\nvalidation functions described in the next section allow for such subsetting,\nas well as handling the cluster sampling. specialized calculations would be\nneeded to validate an unconditional probability such as pr(y \u2265 2|x).\n\n13.4.9 r functions\n\nthe cr.setup function in rms returns a list of vectors useful in constructing\na dataset used to trick a binary logistic function such as lrm into fitting\ncr models. the subs vector in this list contains observation numbers in the\noriginal data, some of which are repeated. here is an example.\nu \u2190 cr.setup ( y )\n\nattach ( mydata [ u $ subs ,])\n\n# y = o r i g i n a l o r d i n a l r e s p o n s e\n# m y d a t a is the o r i g i n a l d a t a s e t\n# m y d a t a [ i ,] s u b s c r i p t s i n p u t data ,\n# u s i n g d u p l i c a t e v a l u e s of i for\n# r e p e a t s\n# c o n s t r u c t e d b i n a r y r e s p o n s e s\n# c o h o r t or risk set c a t e g o r i e s\n\n\u2190 u $ y\n\ny\n\ncohort \u2190 u $ cohort\nf \u2190 lrm ( y \u223c cohort * age + sex )\n\nsince the lrm and pentrace functions have the capability to penalize dif-\nferent parts of the model by different amounts, they are valuable for fitting\nextended cr models in which the cohort \u00d7 predictor interactions are allowed\nto be only as important as the information content in the data will support.\nsimple main effects can be unpenalized or slightly penalized as desired.\n\nthe validate and calibrate functions for lrm allow specification of sub-\nject identifiers when using the bootstrap, so the samples can be constructed\nwith replacement from the original subjects. in other words, cluster sam-\npling is done from the expanded records. this is handled internally by the\npredab.resample function. these functions also allow one to specify a subset of\nthe records to use in the validation, which makes it especially easy to validate\nthe part of the model used to predict pr(y = 0|x).\n\nthe plot.xmean.ordinaly function is useful for checking the cr assumption\n\nfor single predictors, as described earlier.\n\n6\n\n "}, {"Page_number": 346, "text": "324\n\n13 ordinal logistic regression\n\n13.5 further reading\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nsee5, 25, 26, 31, 32, 52, 63, 64, 113, 126, 240, 245, 276, 354, 449, 502, 561, 664, 679 for some\nexcellent background references, applications, and extensions to the ordinal\nmodels.663 and428 demonstrate how to model ordinal outcomes with repeated\nmeasurements within subject using random effects in bayesian models. the first\nto develop an ordinal regression model were aitchison and silvey8.\nsome analysts feel that combining categories improves the performance of test\nstatistics when fitting po models when sample sizes are small and cells are\nsparse. murad et al.469 demonstrated that this causes more problems, because\nit results in overly conservative wald tests.\nanderson and philips [26, p. 29] proposed methods for constructing properly\nspaced response values given a fitted po model.\nthe simplest demonstration of this is to consider a model in which there is a\nsingle predictor that is totally independent of a nine-level response y , so po\nmust hold. a po model is fitted in sas using:\n\ndata test;\ndo i=1 to 50;\n\ny=floor(ranuni(151)*9);\nx=rannor(5);\noutput;\nend;\n\nproc logistic; model y=x;\n\nthe score test for po was \u03c72 = 56 on 7 d.f., p < 0.0001. this problem results\nfrom some small cell sizes in the distribution of y .502 the p -value for testing\nthe regression effect for x was 0.76.\nthe r glmnetcr package by kellie archer provides a different way to fit con-\ntinuation ratio models.\nbender and benner48 have some examples using the precursor of the rms package\nfor fitting and assessing the goodness of fit of ordinal logistic regression models.\n\n13.6 problems\n\ntest for the association between disease group and total hospital cost in\nsupport, without imputing any missing costs (exclude the one patient\nhaving zero cost).\n\n1. use the kruskal\u2013wallis rank test.\n2. use the proportional odds ordinal logistic model generalization of the\nwilcoxon\u2013mann\u2013whitney kruskal\u2013wallis spearman test. group total cost\ninto 20 quantile groups so that only 19 intercepts will need to be in the\nmodel, not one less than the number of subjects (this would have taken\nthe program too long to fit the model). use the likelihood ratio \u03c72 for this\nand later steps.\n\n3. use a binary logistic model to test for association between disease group\nand whether total cost exceeds the median of total cost. in other words,\ngroup total cost into two quantile groups and use this binary variable as\nthe response. what is wrong with this approach?\n\n "}, {"Page_number": 347, "text": "13.6 problems\n\n325\n\n4. instead of using only two cost groups, group cost into 3, 4, 5, 6, 8, 10,\nand 12 quantile groups. describe the relationship between the number of\nintervals used to approximate the continuous response variable and the\nefficiency of the analysis. how many intervals of total cost, assuming that\nthe ordering of the different intervals is used in the analysis, are required\nto avoid losing significant information in this continuous variable?\n\n5. if you were selecting one of the rank-based tests for testing the association\nbetween disease and cost, which of any of the tests considered would you\nchoose?\n\n6. why do all of the tests you did have the same number of degrees of freedom\n\nfor the hypothesis of no association between dzgroup and totcst?\n\n7. what is the advantage of a rank-based test over a parametric test based\n\non log(cost)?\n\n8. show that for a two-sample problem, the numerator of the score test for\ncomparing the two groups using a proportional odds model is exactly the\nnumerator of the wilcoxon-mann-whitney two-sample rank-sum test.\n\n "}, {"Page_number": 348, "text": "chapter 14\ncase study in ordinal regression,\ndata reduction, and penalization\n\nthis case study is taken from harrell et al.272 which described a world health\norganization study439 in which vital signs and a large number of clinical\nsigns and symptoms were used to develop a predictive model for an ordinal\nresponse. this response consists of laboratory assessments of diagnosis and\nseverity of illness related to pneumonia, meningitis, and sepsis. much of the\nmodeling strategy given in chapter 4 was used to develop the model, with ad-\nditional emphasis on penalized maximum likelihood estimation (section 9.10).\nthe following laboratory data are used in the response: cerebrospinal fluid\n(csf) culture from a lumbar puncture (lp), blood culture (bc), arterial\noxygen saturation (sao2, a measure of lung dysfunction), and chest x-ray\n(cxr). the sample consisted of 4552 infants aged 90 days or less.\n\nthis case study covers these topics:\n\n1. definition of the ordinal response (section 14.1);\n2. scoring and clustering of clinical signs (section 14.2);\n3. testing adequacy of weights specified by subject-matter specialists and\nassessing the utility of various scoring schemes using a tentative ordinal\nlogistic model (section 14.3);\n\n4. assessing the basic ordinality assumptions and examining the propor-\ntional odds and continuation ratio (po and cr) assumptions separately\nfor each predictor (section 14.4);\n\n5. deriving a tentative po model using cluster scores and regression splines\n\n(section 14.5);\n\n6. using residual plots to check po, cr, and linearity assumptions (sec-\n\ntion 14.6);\n\n7. examining the fit of a cr model (section 14.7);\n8. utilizing an extended cr model to allow some or all of the regression\ncoefficients to vary with cutoffs of the response level as well as to provide\nformal tests of constant slopes (section 14.8);\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 14\n\n327\n\n "}, {"Page_number": 349, "text": "328\n\n14 ordinal regression, data reduction, and penalization\n\ntable 14.1 ordinal outcome scale\n\noutcome\n\ndefinition\n\nn\n\nfraction in outcome level\n\nlevel\n\ny\n\n0\n1\n\n2\n\nnone of the below\n3551\n90% \u2264 sao2 < 95% 490\nor cxr+\nbc+ or csf+\nor sao2 < 90%\n\n511\n\nbc, cxr\nindicated\n(n = 2398)\n\nnot\n\nindicated\n(n = 1979)\n\nrandom\nsample\n\n(n = 175)\n\n0.63\n0.17\n\n0.21\n\n0.96\n0.04a\n\n0.00b\n\n0.91\n0.05\n\n0.03\n\na sao2 was measured but cxr was not done\nb assumed zero since neither bc nor lp were done.\n\n9. using penalized maximum likelihood estimation to improve accuracy\n\n(section 14.9);\n\n10. approximating the full model by a sub-model and drawing a nomogram\n\non the basis of the sub-model (section 14.10); and\n\n11. validating the ordinal model using the bootstrap (section 14.11).\n\n14.1 response variable\n\nto be a candidate for bc and cxr, an infant had to have a clinical indication\nfor one of the three diseases, according to prespecified criteria in the study\nprotocol (n = 2398). blood work-up (but not necessarily lp) and cxr was\nalso done on a random sample intended to be 10% of infants having no signs\nor symptoms suggestive of infection (n = 175). infants with signs suggestive\nof meningitis had lp done. all 4552 infants received a full physical exam and\nstandardized pulse oximetry to measure sao2. the vast majority of infants\ngetting cxr had the x-rays interpreted by three independent radiologists.\nthe analyses that follow are not corrected for verification bias687 with\nrespect to bc, lp, and cxr, but section 14.1 has some data describing the\nextent of the problem, and the problem is reduced by conditioning on a large\nnumber of covariates.\n\npatients were assigned to the worst qualifying outcome category. table 14.1\nshows the definition of the ordinal outcome variable y and shows the distri-\nbution of y by the lab work-up strategy.\n\nthe effect of verification bias is a false negative fraction of 0.03 for y = 2,\nfrom comparing the detection fraction of zero for y = 2 in the \u201cnot indicated\u201d\ngroup with the observed positive fraction of 0.03 in the random sample that\nwas fully worked up. the extent of verification bias in y = 1 is 0.05\u2212 0.04 =\n0.01. these biases are ignored in this analysis.\n\n "}, {"Page_number": 350, "text": "14.2 variable clustering\n\n329\n\n14.2 variable clustering\n\nforty-seven clinical signs were collected for each infant. most questionnaire\nitems were scored as a single variable using equally spaced codes, with 0 to\n3 representing, for example, sign not present, mild, moderate, severe. the\nresulting list of clinical signs with their abbreviations is given in table 14.2.\nthe signs are organized into clusters as discussed later.\n\ntable 14.2 clinical signs\n\ncluster name\n\nsign\n\nbul.conv\n\nhydration\n\ndrowsy\n\nagitated\n\ncrying\n\nreffort\n\nstop.breath\n\nausc\n\nhxprob\n\nfeeding\n\nlabor\n\nabdominal\n\nfever.ill\n\npustular\n\nabbreviation\nabb\nconvul\nabk\nhdi\ndeh\nstu\ndcp\nhcl\nqcr\ncsd\nslpm\nwake\naro\nmvm\nhcm\nslpl\ncon\ncsa\nhcm\nhcs\nqcr\nsmi2\nnfl\nlcw\ngru\nccy\nhap\napn\nwhz\ncoh\ncrs\nhfb\nhdb\nhlt\nhfa\nabsu\nafe\nchi\nfde\nldy\ntwb\nadb\njau\nomph\nilld\nhfe\nconj\noto\npuskin\n\nname\nof sign\n\nvalues\n\nbulging fontanel\nhx convulsion\nsunken fontanel\nhx diarrhoea\ndehydrated\nskin turgor\ndigital capillary refill\nless activity\nquality of crying\ndrowsy state\nsleeping more\nwakes less easily\narousal\namount of movement\ncrying more\nsleeping less\nconsolability\nagitated state\ncrying more\ncrying less\nquality of crying\nsmiling ability \u00d7 age > 42 days\nnasal flaring\nlower chest in-drawing\ngrunting\ncentral cyanosis\nhx stop breathing\napnea\nwheezing\ncough heard\ncrepitation\nfast breathing\ndifficulty breathing\nmother report resp. problems\nhx abnormal feeding\nsucking ability\ndrinking ability\nprevious child died\nfever at delivery\ndays in labor\nwater broke\nabdominal distension\njaundice\nomphalitis\nage-adjusted no. days ill\nhx fever\nconjunctivitis\notoscopy impression\npustular skin rash\n\n0-1\n0-1\n0-1\n0-1\n0-2\n0-2\n0-2\n0-1\n0-2\n0-2\n0-1\n0-1\n0-2\n0-2\n0-1\n0-1\n0-2\n0-1\n0-1\n0-1\n0-2\n0-2\n0-3\n0-3\n0-2\n0-1\n0-1\n0-1\n0-1\n0-1\n0-2\n0-1\n0-1\n\nnone, chest, other\n\n0-3\n0-2\n0-2\n0-1\n0-1\n1-9\n0-1\n0-4\n0-1\n0-1\n\n0-1\n0-1\n0-2\n0-1\n\n "}, {"Page_number": 351, "text": "330\n\n14 ordinal regression, data reduction, and penalization\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\n2\n\u03c1\n \nn\na\nm\nr\na\ne\np\ns\n\ne\nd\nf\n\ni\n\nh\nc\n\no\nt\no\n\nt\nt\na\n\nb\nw\n\ny\nd\n\nl\n\nt\n\nd\n\nl\nl\ni\n\nr\nt\n\ni\n\n2s\nm\ns\n\nu\na\n\nj\n\nh\np\nm\no\n\nh\no\nc\n\nz\nh\nw\n\nj\n\nn\no\nc\n\ni\n\nn\nk\ns\nu\np\n\ne\nf\nh\n\np\na\nh\n\nn\np\na\n\ny\nc\nc\n\np\nc\nd\n\ns\nc\nh\n\nl\n\nc\nh\n\na\nf\nh\n\ni\n\nd\nh\n\nm\np\ns\n\ne\nk\na\nw\n\nl\n\nk\nb\na\n\nd\nb\na\n\nu\nr\ng\n\nb\nb\na\n\nl\n\nu\nv\nn\no\nc\n\na\ns\nc\n\nn\no\nc\n\nl\n\np\ns\n\nl\n\nm\nc\nh\n\no\nr\na\n\nd\ns\nc\n\nr\nc\nq\n\nm\nv\nm\n\ns\nr\nc\n\nb\nf\nh\n\nt\ns\ne\nh\nc\n/\nr\ni\np\ns\ne\nr\n \ny\nh\n\nt\nl\nh\n\nw\nc\n\nl\nf\nn\n\nl\n\nb\nd\nh\n\nt\ns\ne\nh\nc\n \no\nn\n/\nr\ni\np\ns\ne\nr\n \ny\nh\n\nt\nl\nh\n\nu\nt\ns\n\nh\ne\nd\n\ne\nf\na\n\nu\ns\nb\na\n\nfig. 14.1 hierarchical variable clustering using spearman \u03c12 as a similarity measure\nfor all pairs of variables. note that since the hlt variable was nominal, it is represented\nby two dummy variables here.\n\nhere, hx stands for history, ausc for auscultation, and hxprob for history of\nproblems. two signs (qcr, hcm) were listed twice since they were later placed\ninto two clusters each.\n\nnext, hierarchical clustering was done using the matrix of squared spear-\nman rank correlation coefficients as the similarity matrix. the varclus r\nfunction was used as follows.\n\nrequire ( rms )\n\ngethdata ( ari )\n\nvclust \u2190\n\n# defines ari , sc , y , y.death\n\nvarclus (\u223c illd + hlt + slpm + slpl + wake + convul + hfa +\n\n+ hfe + hap\nhfb\n+ chi + twb\nfde\n+ gru + coh\nstr\ncsa\n+ aro + qcr\nabsu + stu + deh\nwhz\n\n+ hcl\n+ ldy\n+ ccy\n+ con\n+ dcp\n+ hdb + smi2 + abd\n\n+ hcs\n+ hcm\n+ lcw\n+ apn\n+ omph\n+ jau\n+ mvm\n+ att\n+ abb\n+ crs\n+ conj + oto\n\n+ hdi +\n+ nfl +\n+ csd +\n+ afe +\n+ abk +\n+ puskin ,\n\ndata = ari )\n\nplot ( vclust )\n\n# figure 14.1\n\nthe output appears in figure 14.1. this output served as a starting point\nfor clinicians to use in constructing more meaningful clinical clusters. the\nclusters in table 14.2 were the consensus of the clinicians who were the in-\nvestigators in the who study. prior subject matter knowledge plays a key\nrole at this stage in the analysis.\n\n14.3 developing cluster summary scores\n\nthe clusters listed in table 14.2 were first scored by the first principal com-\nponent of transcan-transformed signs, denoted by p c1. knowing that the\nresulting weights may be too complex for clinical use, the primary reasons\n\n "}, {"Page_number": 352, "text": "14.3 developing cluster summary scores\n\n331\n\ntable 14.3 clinician combinations, rankings, and scorings of signs\n\ncluster\nbul.conv\ndrowsy\nagitated\nreffort\nausc\nfeeding\n\nabdominal\n\ncombined/ranked signs in order of severity\n\nabb \u222a convul\nhcl, qcr>0, csd>0 \u222a slpm \u222a wake, aro>0, mvm>0\nhcm, slpl, con=1, csa, con=2\nnfl>0, lcw>1, gru=1, gru=2, ccy\nwhz, coh, crs>0\nhfa=1, hfa=2, hfa=3, absu=1 \u222a afe=1,\nabsu=2 \u222a afe=2\njau \u222a abd>0 \u222a omph\n\nweights\n\n0\u20131\n0\u20135\n\n0, 1, 2, 7, 8, 10\n\n0\u20135\n0\u20133\n0\u20135\n\n0\u20131\n\nfor analyzing the principal components were to see if some of the clusters\ncould be removed from consideration so that the clinicians would not spend\ntime developing scoring rules for them. let us \u201cpeek\u201d at y to assist in scoring\nclusters at this point, but to do so in a very structured way that does not\ninvolve the examination of a large number of individual coefficients.\n\nto judge any cluster scoring scheme, we must pick a tentative outcome\nmodel. for this purpose we chose the po model. by using the 14 p c1s cor-\nresponding to the 14 clusters, the fitted po model had a likelihood ratio\n(lr) \u03c72 of 1155 with 14 d.f., and the predictive discrimination of the clus-\nters was quantified by a somers\u2019 dxy rank correlation between x \u02c6\u03b2 and y\nof 0.596. the following clusters were not statistically important predictors\nand we assumed that the lack of importance of the p c1s in predicting y\n(adjusted for the other p c1s) justified a conclusion that no sign within that\ncluster was clinically important in predicting y : hydration, hxprob, pustular,\ncrying, fever.ill, stop.breath, labor. this list was identified using a back-\nward step-down procedure on the full model. the total wald \u03c72 for these\nseven p c1s was 22.4 (p = 0.002). the reduced model had lr \u03c72 = 1133\nwith 7 d.f., dxy = 0.591. the bootstrap validation in section 14.11 penalizes\nfor examining all candidate predictors.\n\nthe clinicians were asked to rank the clinical severity of signs within each\npotentially important cluster. during this step, the clinicians also ranked\nseverity levels of some of the component signs, and some cluster scores were\nsimplified, especially when the signs within a cluster occurred infrequently.\nthe clinicians also assessed whether the severity points or weights should be\nequally spaced, assigning unequally spaced weights for one cluster (agitated).\nthe resulting rankings and sign combinations are shown in table 14.3. the\nsigns or sign combinations separated by a comma are treated as separate\ncategories, whereas some signs were unioned (\u201cor\u201d\u2013ed) when the clinicians\ndeemed them equally important. as an example, if an additive cluster score\nwas to be used for drowsy, the scorings would be 0 = none present, 1 = hcl,\n2 = qcr>0, 3 = csd>0 or slpm or wake, 4 = aro>0, 5 = mvm>0 and the scores\nwould be added.\n\n "}, {"Page_number": 353, "text": "332\n\n14 ordinal regression, data reduction, and penalization\n\ntable 14.4 predictive information of various cluster scoring strategies. aic is on\nthe likelihood ratio \u03c72 scale.\n\nlr \u03c72 d.f. aic\nscoring method\np c1 of each cluster\n7 1119\n1133\nunion of all signs\n1045\n7 1031\nunion of higher categories\n7 1109\n1123\nhierarchical (worst sign)\n7 1180\n1194\nadditive, equal weights\n7 1141\n1155\nadditive using clinician weights\n1183\n7 1169\nhierarchical, data-driven weights 1227 25 1177\n\nthis table reflects some data reduction already (unioning some signs and\nselection of levels of ordinal signs) but more reduction is needed. even after\nsigns are ranked within a cluster, there are various ways of assigning the clus-\nter scores. we investigated six methods. we started with the purely statistical\napproach of using p c1 to summarize each cluster. second, all sign combina-\ntions within a cluster were unioned to represent a 0/1 cluster score. third,\nonly sign combinations thought by the clinicians to be severe were unioned,\nresulting in drowsy=aro>0 or mvm>0, agitated=csa or con=2, reffort=lcw>1 or\ngru>0 or ccy, ausc=crs>0, and feeding=absu>0 or afe>0. for clusters that are\nnot scored 0/1 in table 14.3, the fourth summarization method was a hi-\nerarchical one that used the weight of the worst applicable category as the\ncluster score. for example, if aro=1 but mvm=0, drowsy would be scored as 4.\nthe fifth method counted the number of positive signs in the cluster. the\nsixth method summed the weights of all signs or sign combinations present.\nfinally, the worst sign combination present was again used as in the sec-\nond method, but the points assigned to the category were data-driven ones\nobtained by using extra dummy variables. this provided an assessment of\nthe adequacy of the clinician-specified weights. by comparing rows 4 and 7\nin table 14.4 we see that response data-driven sign weights have a slightly\nworse aic, indicating that the number of extra \u03b2 parameters estimated was\nnot justified by the improvement in \u03c72. the hierarchical method, using the\nclinicians\u2019 weights, performed quite well. the only cluster with inadequate\nclinician weights was ausc\u2014see below. the p c1 method, without any guid-\nance, performed well, as in268. the only reasons not to use it are that it\nrequires a coefficient for every sign in the cluster and the coefficients are not\ntranslatable into simple scores such as 0, 1, . . ..\n\nrepresentation of clusters by a simple union of selected signs or of all signs\nis inadequate, but otherwise the choice of methods is not very important in\nterms of explaining variation in y . we chose the fourth method, a hierar-\nchical severity point assignment (using weights that were prespecified by the\nclinicians), for its ease of use and of handling missing component variables\n(in most cases) and potential for speeding up the clinical exam (examining\n\n "}, {"Page_number": 354, "text": "14.5 a tentative full proportional odds model\n\n333\n\nto detect more important signs first). because of what was learned regard-\ning the relationship between ausc and y , we modified the ausc cluster score\nby redefining it as ausc=crs>0 (crepitations present). note that neither the\n\u201ctweaking\u201d of ausc nor the examination of the seven scoring methods dis-\nplayed in table 14.4 is taken into account in the model validation.\n\n14.4 assessing ordinality of y for each x,\n\nand unadjusted checking of po and cr\nassumptions\n\nsection 13.2 described a graphical method for assessing the ordinality as-\nsumption for y separately with respect to each x, and for assessing po and\ncr assumptions individually. figure 14.2 is an example of such displays. for\nthis dataset we expect strongly nonlinear effects for temp, rr, and hrat, so for\nthose predictors we plot the mean absolute differences from suitable \u201cnormal\u201d\nvalues as an approximate solution.\nsc \u2190 transform ( sc ,\n\nausc = 1 * ( ausc == 3) ,\nbul.conv = 1 * ( bul.conv == ' true ' ),\nabdominal = 1 * ( abdominal == ' true ' ))\n\nplot.xmean. o rd in a ly (y \u223c age + abs ( temp-37 ) + abs ( rr-60 ) +\n\nabs ( hrat-125 ) + waz + bul.conv + drowsy +\nagitated + reffort + ausc + feeding +\nabdominal , data = sc , cr = true ,\nsubn = false , cex.points = .65 ) # f i g u r e 14.2\n\nthe plot is shown in figure 14.2. y does not seem to operate in an ordinal\nfashion with respect to age, |rr\u221260|, or ausc. for the other variables, ordinality\nholds, and po holds reasonably well for the other variables. for heart rate,\nthe po assumption appears to be satisfied perfectly. cr model assumptions\nappear to be more tenuous than po assumptions, when one variable at a\ntime is fitted.\n\n14.5 a tentative full proportional odds model\n\nbased on what was determined in section 14.3, the original list of 47 signs\nwas reduced to seven predictors: two unions of signs (bul.conv, abdominal),\none single sign (ausc), and four \u201cworst category\u201d point assignments (drowsy,\nagitated, reffort, feeding). seven clusters were dropped for the time being\nbecause of weak associations with y . such a limited use of variable selection\nreduces the severe problems inherent with that technique.\n\n "}, {"Page_number": 355, "text": "334\n\n14 ordinal regression, data reduction, and penalization\n\ne\ng\na\n\nz\na\nw\n\nt\nr\no\nf\nf\ne\nr\n\n1\n4\n\n9\n3\n\n7\n3\n\nc\nl\n\n0\n\nl\n2 c\n\n.\n\n0\n\u2212\n\n.\n\n6\n0\n\u2212\n\n.\n\n0\n1\n\u2212\n\n0\n.\n2\n\n5\n.\n1\n\n0\n.\n1\n\n5\n.\n0\n\n0\n\nc\nl\n\n0\n\nl\n\nc\n\n1\n\ny\n\nc\nl\n\n1\ny\n\nl\n\nc\n\n1\n\ny\n\nc\nl\n\n2\n\nl\nc\n\n2\n\nc\nl\n\n2\n\n \n\n \n\n)\n7\n3\n\u2212\np\nm\ne\nt\n(\ns\nb\na\n\nv\nn\no\nc\n.\nl\n\nu\nb\n\nc\ns\nu\na\n\n0\n\n.\n\n1\n\n8\n\n.\n\n0\n\n6\n\n.\n\n0\n\n6\n1\n0\n\n.\n\n0\n1\n\n.\n\n0\n\n4\n0\n0\n\n.\n\n0\n4\n.\n0\n\n5\n2\n.\n0\n\n0\n1\n.\n0\n\nl\nc\n\n0\n\nl\nc\n\n0\n\nc\nl\n\n0\n\nl\nc\n\n1\n\ny\n\nl\nc\n\n1\ny\n\nl\n\nc\n\n1\n\ny\n\nc\nl\n\n2\n\nl\nc\n\n2\n\nc\nl\n\n2\n\n \n\n)\n0\n6\n\u2212\n \nr\nr\n(\ns\nb\na\n\n.\n\n0\n4\n1\n\nl\nc\n\n.\n\n0\n3\n1\n\n.\n\n0\n2\n1\n\n0\n\n0\n\n.\n\n2\n\ny\ns\nw\no\nr\nd\n\n0\n\n.\n\n1\n\nl\nc\n\n0\n\n5\n.\n2\n\n5\n.\n1\n\ni\n\ng\nn\nd\ne\ne\nf\n\n5\n.\n0\n\nc\nl\n\n0\n\nl\n\nc\n\n2\n\nc\nl\n\n2\n\nc\nl\n\n2\n\n)\n5\n2\n1\n\u2212\n\n \n\n \nt\n\na\nr\nh\n(\ns\nb\na\n\nd\ne\na\n\nt\n\nt\ni\n\ng\na\n\nl\n\ni\n\na\nn\nm\no\nd\nb\na\n\nc\nl\n\n0\n\nc\nl\n\n0\n\n0\n4\n\n6\n3\n\n2\n3\n\n5\n\n.\n\n3\n\n5\n\n.\n\n2\n\n5\n\n.\n\n1\n\n4\n2\n.\n0\n\n8\n1\n.\n0\n\n2\n1\n.\n0\n\nl\nc\n\n0\n\nc\nl\n\n2\n\nc\nl\n\n2\n\nc\nl\n\n2\n\nl\n\nc\n\n1\n\ny\n\nl\n\nc\n\n1\ny\n\nl\nc\n\n1\n\ny\n\nc\n\nl\n\n1\n\ny\n\nl\nc\n\n1\ny\n\nl\nc\n\n1\n\ny\n\nfig. 14.2 examination of the ordinality of y for each predictor by assessing how\nvarying y relate to the mean x, and whether the trend is monotonic. solid lines\nconnect the simple stratified means, and dashed lines connect the estimated expected\nvalue of x|y = j given that po holds. estimated expected values from the cr model\nare marked with cs.\n\nat this point in model development add to the model age and vital signs:\ntemp (temperature), rr (respiratory rate), hrat (heart rate), and waz, weight-\nfor-age z-score. since age was expected to modify the interpretation of temp,\nrr, and hrat, and interactions between continuous variables would be difficult\nto use in the field, we categorized age into three intervals: 0\u20136 days (n = 302),\n7\u201359 days (n = 3042), and 60\u201390 days (n = 1208).a\nsc $ ageg \u2190 cut2 ( sc $ age , c (7 , 60))\n\nthe new variables temp, rr, hrat, waz were missing in, respectively, n =\n13, 11, 147, and 20 infants. since the three vital sign variables are somewhat\ncorrelated with each other, customized single imputation models were de-\nveloped to impute all the missing values without assuming linearity or even\nmonotonicity of any of the regressions.\n\na these age intervals were also found to adequately capture most of the interaction\neffects.\n\n "}, {"Page_number": 356, "text": "14.5 a tentative full proportional odds model\n\n335\n\nvsign.trans \u2190 transcan (\u223c temp + hrat + rr , data = sc ,\n\nimputed = true , pl = false )\n\nc o n v e r g e n c e c r i t e r i o n :2.222 0.643 0.191 0.056 0.016\nc o n v e r g e n c e in 6 i t e r a t i o n s\nr2 achieved in p r e d i c t i n g each variable :\n\ntemp\n\nrr\n0.168 0.160 0.066\n\nhrat\n\nadjusted r2:\n\ntemp\n\nrr\n0.167 0.159 0.064\n\nhrat\n\nsc \u2190 transform ( sc ,\n\ntemp = impute ( vsign.trans , temp ),\nhrat = impute ( vsign.trans , hrat ),\nrr\n\n= impute ( vsign.trans , rr ))\n\nafter transcan estimated optimal restricted cubic spline transformations, temp\ncould be predicted with adjusted r2 = 0.17 from hrat and rr, hrat could be\npredicted with adjusted r2 = 0.16 from temp and rr, and rr could be pre-\ndicted with adjusted r2 of only 0.06. the first two r2, while not large, mean\nthat customized imputations are more efficient than imputing with constants.\nimputations on rr were closer to the median rr of 48/minute as compared\nwith the other two vital signs whose imputations have more variation. in a\nsimilar manner, waz was imputed using age, birth weight, head circumference,\nbody length, and prematurity (adjusted r2 for predicting waz from the oth-\ners was 0.74). the continuous predictors temp, hrat, rr were not assumed to\nlinearly relate to the log odds that y \u2265 j. restricted cubic spline functions\nwith five knots for temp,rr and four knots for hrat,waz were used to model\nthe effects of these variables:\nf1 \u2190 lrm ( y \u223c ageg * ( rcs ( temp ,5)+ rcs ( rr ,5)+ rcs ( hrat ,4)) +\n\nrcs ( waz ,4) + bul.conv + drowsy + agitated +\nreffort + ausc + feeding + abdominal ,\ndata = sc , x= true , y = true )\n\n# x = true , y = true used by r e s i d () b e l o w\nprint ( f1 , latex = true , coefs =5)\n\nlogistic regression model\n\nlrm(formula = y ~ ageg * (rcs(temp, 5) + rcs(rr, 5) + rcs(hrat,\n\n4)) + rcs(waz, 4) + bul.conv + drowsy + agitated + reffort +\nausc + feeding + abdominal, data = sc, x = true, y = true)\n\n "}, {"Page_number": 357, "text": "336\n\n14 ordinal regression, data reduction, and penalization\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\n2\nmax| \u2202 log l\n\n\u2202\u03b2 | 2\u00d710\n\n1393.18 r2\n\n4552 lr \u03c72\n3551 d.f.\n45 g\n490 pr(> \u03c72) < 0.0001 gr\ngp\n511\n\u22126\nbrier\n\n0.355 c\n1.485 dxy\n4.414 \u03b3\n0.225 \u03c4a\n0.120\n\n0.826\n0.653\n0.654\n0.240\n\ncoef\n0.0653\n-1.0646\n9.5590\n\ns.e. wald z pr(> |z|)\ny\u22651\n0.9932\n7.6563\ny\u22652\n0.8894\n7.6563\n0.3346\nageg=[ 7,60)\n9.9071\nageg=[60,90] 29.1376 15.8915\n0.0667\ntemp\n0.7480\n0.2160\n. . .\n\n0.01\n-0.14\n0.96\n1.83\n-0.32\n\n-0.0694\n\nwald tests of nonlinearity and interaction are shown in table 14.5.\n\nlatex ( anova ( f1 ), file = ' ' , label = ' ordinal-anov a. f1 ' ,\n\ncaption = ' wald statistics from the proportional odds model ' ,\nsize = ' smaller ' )\n\n# t a b l e 14.5\n\nthe bottom four lines of the table are the most important. first, there is\nstrong evidence that some associations with y exist (45 d.f. test) and very\nstrong evidence of nonlinearity in one of the vital signs or in waz (26 d.f. test).\nthere is moderately strong evidence for an interaction effect somewhere in the\nmodel (22 d.f. test). we see that the grouped age variable ageg is predictive\nof y , but mainly as an effect modifier for rr, and hrat. temp is extremely\nnonlinear, and rr is moderately so. hrat, a difficult variable to measure reliably\nin young infants, is perhaps not important enough (\u03c72 = 19, 9 d.f.) to keep\nin the final model.\n\n14.6 residual plots\n\nsection 13.3.4 defined binary logistic score residuals for isolating the po\nassumption in an ordinal model. for the tentative po model, score residuals\nfor four of the variables were plotted using\nresid ( f1 , ' score.binary ' , pl = true , which = c (17 ,18 ,20 ,21))\n# # f i g u r e 14.3\n\nthe result is shown in figure 14.3. we see strong evidence of non-po for\nausc and moderate evidence for drowsy and bul.conv,\nin agreement with\nfigure 14.2.\n\n "}, {"Page_number": 358, "text": "14.6 residual plots\n\n337\n\ntable 14.5 wald statistics from the proportional odds model\n\nageg (factor+higher order factors)\n\nall interactions\n\ntemp (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nrr (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nhrat (factor+higher order factors)\n\nall interactions\nnonlinear (factor+higher order factors)\n\nwaz\n\nnonlinear\n\nbul.conv\ndrowsy\nagitated\nreffort\nausc\nfeeding\nabdominal\nageg \u00d7 temp (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\nageg \u00d7 rr (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\nageg \u00d7 hrat (factor+higher order factors)\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\n\ntotal nonlinear\ntotal interaction\ntotal nonlinear + interaction\ntotal\n\np\n\n\u03c72\nd.f.\n41.49 24\n40.48 22\n37.08 12\n8\n9\n\n0.0147\n0.0095\n0.0002\n0.5617\n6.77\n31.08\n0.0003\n81.16 12 < 0.0001\n0.0006\n27.37\n8\n27.36\n0.0012\n9\n0.0252\n19.00\n9\n0.1836\n8.83\n6\n6\n7.35\n0.2901\n3 < 0.0001\n35.82\n13.21\n2\n0.0014\n1\n12.16\n0.0005\n1 < 0.0001\n17.79\n1\n8.25\n0.0041\n1 < 0.0001\n63.39\n105.82\n1 < 0.0001\n1 < 0.0001\n30.38\n0.3895\n1\n0.74\n0.5617\n8\n6.77\n0.3801\n6\n6.40\n6.40\n6\n0.3801\n0.0006\n8\n27.37\n0.0214\n6\n14.85\n0.0214\n6\n14.85\n0.1836\n6\n8.83\n2.42\n4\n0.6587\n0.6587\n4\n2.42\n78.20 26 < 0.0001\n40.48 22\n0.0095\n96.31 32 < 0.0001\n1073.78 45 < 0.0001\n\npartial residuals computed separately for each y -cutoff (section 13.3.4) are\nthe most useful residuals for ordinal models as they simultaneously check lin-\nearity, find needed transformations, and check po. in figure 14.4, smoothed\npartial residual plots were obtained for all predictors, after first fitting a sim-\nple model in which every predictor was assumed to operate linearly. inter-\nactions were temporarily ignored and age was used as a continuous variable.\n\nf2 \u2190 lrm ( y \u223c age + temp + rr + hrat + waz +\n\nbul.conv + drowsy + agitated + reffort + ausc +\nfeeding + abdominal , data = sc , x = true , y = true )\n\nresid ( f2 , ' partial ' , pl = true , l a b e l . c u r v e s = false ) # figure 14.4\n\n "}, {"Page_number": 359, "text": "338\n\n14 ordinal regression, data reduction, and penalization\n\nv\nv\nn\nn\no\no\nc\nc\n.\n.\nl\nl\n\nu\nu\nb\nb\n\nt\nt\nr\nr\no\no\n\nf\nf\nf\nf\n\ne\ne\nr\nr\n\n2\n0\n0\n\n.\n\n0\n\n4\n0\n0\n\n.\n\n0\n\u2212\n\n2\n0\n0\n\n.\n\n0\n0\n\n.\n\n0\n\n2\n0\n\n.\n\n0\n\u2212\n\n1\n\n1\n\ny\ny\n\ny\ny\n\ny\ny\ns\ns\nw\nw\no\no\nr\nr\nd\nd\n\n2\n0\n\n.\n\n0\n\n2\n0\n\n.\n\n0\n\u2212\n\nc\nc\ns\ns\nu\nu\na\na\n\n5\n0\n0\n\n.\n\n0\n\n0\n1\n0\n\n.\n\n0\n\u2212\n\n1\n\n1\n\n2\n\n2\n\n2\n\n2\n\ny\ny\n\ny\ny\n\nfig. 14.3 binary logistic model score residuals for binary events derived from two\ncutoffs of the ordinal response y . note that the mean residuals, marked with closed\ncircles, correspond closely to differences between solid and dashed lines at y = 1, 2\nin figure 14.2. score residual assessments for spline-expanded variables such as rr\nwould have required one plot per d.f.\n\nthe degree of non-parallelism generally agreed with the degree of non-flatness\nin figure 14.3 and with the other score residual plots that were not shown.\nthe partial residuals show that temp is highly nonlinear and that it is much\nmore useful in predicting y = 2. for the cluster scores, the linearity assump-\ntion appears reasonable, except possibly for drowsy. other nonlinear effects\nare taken into account using splines as before (except for age, which is cate-\ngorized).\n\na model can have significant lack of fit with respect to some of the predic-\ntors and still yield quite accurate predictions. to see if that is the case for this\npo model, we computed predicted probabilities of y = 2 for all infants from\nthe model and compared these with predictions from a customized binary\nlogistic model derived to predict pr(y = 2). the mean absolute difference\nin predicted probabilities between the two models is only 0.02, but the 0.90\nquantile of that difference is 0.059. for high-risk infants, discrepancies of 0.2\nwere common. therefore we elected to consider a different model.\n\n14.7 graphical assessment of fit of cr model\n\nin order to take a first look at the fit of a cr model, let us consider the\ntwo binary events that need to be predicted, and assess linearity and paral-\n\n "}, {"Page_number": 360, "text": "14.7 graphical assessment of fit of cr model\n\n339\n\nlelism over y -cutoffs. here we fit a sequence of binary fits and then use the\nplot.lrm.partial function, which assembles partial residuals for a sequence\nof fits and constructs one graph per predictor.\ncr0 \u2190 lrm ( y ==0 \u223c age + temp + rr + hrat + waz +\n\nbul.conv + drowsy + agitated + reffort + ausc +\nfeeding + abdominal , data = sc , x = true , y= true )\n# use the u p d a t e f u n c t i o n to save r e p e a t i n g m o d e l r i g h t -\n# hand s i d e .\n# r e s p o n s e v a r i a b l e b e l o w\n\nan i n d i c a t o r v a r i a b l e for y =1 is the\n\ncr1 \u2190 update ( cr0 , y ==1 \u223c . , subset = y \u2265 1)\n\nplot.lrm.par ti al ( cr0 , cr1 , center = true )\n\n# f i g u r e 14.5\n\nthe output is in figure 14.5. there is not much more parallelism here than\nin figure 14.4. for the two most important predictors, ausc and rr, there are\nstrongly differing effects for the different events being predicted (e.g., y = 0\nor y = 1|y \u2265 1). as is often the case, there is no one constant \u03b2 model that\nsatisfies assumptions with respect to all predictors simultaneously, especially\n\n0\n7\n\n.\n\n0\n6\n\n.\n\n0\n5\n\n.\n\n0\n4\n\n.\n\n5\n2\n\n.\n\n5\n1\n\n.\n\n5\n0\n\n.\n\n0\n3\n\n.\n\n0\n2\n\n.\n\n0\n1\n\n.\n\n0\n0\n\n.\n\n0\n\n20\n\n40\n\n60\n\n80\n\n32\n\n34\n\n36\n\n38\n\n40\n\n0\n\n40\n\n80\n\n120\n\n50\n\nage\n\ntemp\n\nrr\n\n250\n\n150\n\nhrat\n\n2\n1\n\n.\n\n8\n0\n\n.\n\n4\n0\n\n.\n\n.\n\n2\n0\n\u2212\n\n8\n0\n\n.\n\n4\n0\n\n.\n\n0\n0\n\n.\n\n.\n\n4\n0\n\u2212\n\n8\n0\n\n.\n\n4\n0\n\n.\n\n0\n0\n\n.\n\n.\n\n4\n0\n\u2212\n\n\u22124\n\n0\n\n2\n\n4\n\n0.0\n\n0.4\n\n0.8\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\nwaz\n\nbul.conv\n\ndrowsy\n\nagitated\n\n0\n.\n1\n\n5\n.\n0\n\n0\n.\n0\n\n0\n1\n\n.\n\n5\n.\n0\n\n0\n.\n0\n\n4\n0\n\n.\n\n2\n.\n0\n\n0\n.\n0\n\n2\n.\n0\n\u2212\n\n4\n0\n\n.\n\n0\n0\n\n.\n\n.\n\n6\n0\n\u2212\n\n0\n1\n\n.\n\n.\n\n5\n0\n\u2212\n\n.\n\n0\n2\n\u2212\n\n5\n1\n\n.\n\n5\n.\n0\n\n5\n.\n0\n\u2212\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0.0\n\n0.4\n\n0.8\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0.0\n\n0.4\n\n0.8\n\nreffort\n\nausc\n\nfeeding\n\nabdominal\n\nfig. 14.4 smoothed partial residuals corresponding to two cutoffs of y , from a model\nin which all predictors were assumed to operate linearly and additively. the smoothed\ncurves estimate the actual predictor transformations needed, and parallelism relates\nto the po assumption. solid lines denote y \u2265 1 while dashed lines denote y \u2265 2.\n\n "}, {"Page_number": 361, "text": "340\n\n1\n.\n0\n\n1\n.\n0\n\u2212\n\ncr1\n\n4\n.\n0\n\u2212\n\ncr0\n\n14 ordinal regression, data reduction, and penalization\n\n5\n.\n0\n\ncr1\n\n0\n.\n0\n\n5\n.\n0\n\u2212\n\n0\n.\n0\n\n4\n.\n0\n\u2212\n\n8\n.\n0\n\u2212\n\ncr0\n\ncr1\n\ncr0\n\ncr0\n\n0\n.\n0\n\n0\n.\n1\n\u2212\n\ncr1\n\n0\n.\n2\n\u2212\n\n0\n\n20\n\n40\nage\n\n60\n\n80\n\n32\n\n34\n\n36\n38\ntemp\n\n40\n\n0\n\n40\n\n80\n\n120\n\n50\n\nrr\n\n250\n\n150\nhrat\n\ncr0\n\n0\n.\n0\n\ncr1\n\n2\n.\n0\n\u2212\n\n4\n.\n0\n\u2212\n\n2\n.\n0\n\n0\n.\n0\n\ncr1\ncr0\n\n4\n.\n0\n\u2212\n\ncr1\n\ncr0\n\n2\n.\n0\n\n1\n.\n0\n\u2212\n\n4\n.\n0\n\u2212\n\ncr0\n\ncr1\n\n\u22124\n\n0\n\n2\n\n4\n\n0.0\n\n0.4\n\n0.8\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\nwaz\ncr1\n\ncr0\n\n0\n\n.\n\n0\n\n4\n\n.\n\n0\n\u2212\n\n0\n\n.\n\n1\n\u2212\n\nbul.conv\n\ndrowsy\n\nagitated\n\ncr1\n\ncr0\n\n0\n\n.\n\n0\n\n4\n\n.\n\n0\n\u2212\n\n8\n\n.\n\n0\n\u2212\n\ncr1\n\ncr0\n\n5\n0\n\n.\n\n0\n\u2212\n\n5\n1\n\n.\n\n0\n\u2212\n\ncr1\n\ncr0\n\n5\n.\n0\n\n5\n.\n0\n\u2212\n\n0\n\n.\n\n0\n\n4\n\n.\n\n0\n\u2212\n\n0\n\n.\n\n1\n\u2212\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0.0\n\n0.4\n\n0.8\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n0.0\n\n0.4\n\n0.8\n\nreffort\n\nausc\n\nfeeding\n\nabdominal\n\nfig. 14.5 loess smoothed partial residual plots for binary models that are compo-\nnents of an ordinal continuation ratio model. solid lines correspond to a model for\ny = 0, and dotted lines correspond to a model for y = 1|y \u2265 1.\n\nwhen there is evidence for non-ordinality for ausc in figure 14.2. the cr\nmodel will need to be generalized to adequately fit this dataset.\n\n14.8 extended continuation ratio model\n\nthe cr model in its ordinary form has no advantage over the po model for\nthis dataset. but section 13.4.6 discussed how the cr model can easily be\nextended to relax any of its assumptions. first we use the cr.setup function\nto set up the data for fitting a cr model using the binary logistic trick.\nu \u2190 cr.setup ( y )\nsc.expanded \u2190 sc [ u $ subs , ]\ncohort \u2190 u $ cohort\n\n\u2190 u $ y\n\ny\n\n "}, {"Page_number": 362, "text": "14.8 extended continuation ratio model\n\n341\n\nhere the cohort variable has values \u2019all\u2019, \u2019y>=1\u2019 corresponding to the condi-\ntioning events in equation 13.10. once the data frame is expanded to include\nthe different risk cohorts, vectors such as age are lengthened (to 5553 records).\nnow we fit a fully extended cr model that makes no equal slopes assump-\ntions; that is, the model has to fit y assuming the covariables are linear and\nadditive. at this point, we omit hrat but add back all variables that were\ndeleted by examining their association with y . recall that most of these\nseven cluster scores were summarized using p c1. adding back \u201cinsignificant\u201d\nvariables will allow us to validate the model fairly using the bootstrap, as\nwell as to obtain confidence intervals that are not falsely narrow.16\nfull \u2190\n\nlrm ( y \u223c cohort * ( ageg * ( rcs ( temp ,5) + rcs ( rr ,5)) +\n\nrcs ( waz ,4) + bul.conv + drowsy + agitated + reffort +\nausc + feeding + abdominal + hydration + hxprob +\npustular + crying + fever.ill + stop.breath + labor ),\ndata = sc.expanded , x = true , y = true )\n\n# x = true , y = true are for pentrace , validate , c a l i b r a t e b e l o w\n\nperf \u2190 function ( fit ) {\n\n# m o d e l p e r f o r m a n c e for y =0\n\npr \u2190 predict ( fit , type = ' fitted ' )[ cohort == ' all ' ]\ns \u2190 round ( somers2 ( pr , y [ cohort == ' all ' ]) , 3)\npr \u2190 1 - pr\nf \u2190 round ( c ( mean ( pr < .05 ), mean ( pr > .25 ),\nf \u2190 paste ( f [1] , ' , ' , f [2] , ' , and ' , f [3] , ' . ' , sep = ' ' )\n\n# p r e d i c t prob [ y > 0] i n s t e a d of prob [ y = 0]\n\nmean ( pr > .5 )) , 2)\n\nlist ( somers =s , fractions = f )\n\n}\n\nperf.unpen \u2190 perf ( full )\n\nprint ( full , latex = true , coefs =5)\n\nlogistic regression model\n\nlrm(formula = y ~ cohort * (ageg * (rcs(temp, 5) +\n\nrcs(rr, 5)) + rcs(waz, 4) + bul.conv + drowsy +\nagitated + reffort + ausc + feeding + abdominal +\nhydration + hxprob + pustular + crying + fever.ill +\nstop.breath + labor), data = sc.expanded, x = true,\ny = true)\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\nmax| \u2202 log l\n\n\u2202\u03b2 | 8\u00d710\n\n1824.33 r2\n\n5553 lr \u03c72\n1512 d.f.\n87 g\n4041 pr(> \u03c72) < 0.0001 gr\ngp\nbrier\n\n\u22127\n\n0.406 c\n1.677 dxy\n5.350 \u03b3\n0.269 \u03c4a\n0.135\n\n0.843\n0.685\n0.687\n0.272\n\n "}, {"Page_number": 363, "text": "342\n\n14 ordinal regression, data reduction, and penalization\n\ntable 14.6 wald statistics for cohort in the cr model\n\u03c72\n\nd.f.\n\np\n\ncohort (factor+higher order factors) 199.47 44 < 0.0001\n172.12 43 < 0.0001\n199.47 44 < 0.0001\n\nall interactions\n\ntotal\n\ns.e. wald z pr(> |z|)\ncoef\n0.8778\n1.3966\n9.0827\n0.9180\n1.5077 14.6443\n0.4115\n-9.3715 11.4104\n0.1245\n-26.4502 17.2188\n-0.0049\n0.2551\n0.9846\n\n0.15\n0.10\n-0.82\n-1.54\n-0.02\n\nintercept\ncohort=y\u22651\nageg=[ 7,60)\nageg=[60,90]\ntemp\n. . .\n\nlatex ( anova ( full , cohort ), file = ' ' ,\n\n# t a b l e 14.6\n\ncaption = ' wald statistics for \\\\ co { cohort } in the cr model ' ,\nsize = ' smaller [2] ' , label = ' ordinal-anov a .c oh o rt ' )\n\nan \u2190 anova ( full , india = false , indnl = false )\n\nlatex ( an , file = ' ' , label = ' ordinal-anov a. fu ll ' ,\n\ncaption = ' wald statistics for the continuation ratio model.\ninteractions with \\\\ co { cohort } assess non-proportio na l\nhazards ' , caption.lot = ' wald statistics for $ y $ in the\n\nsize = ' smaller [2] ' )\n\n# t a b l e 14.7\n\ncontinuation ratio model ' ,\n\nthis model has lr \u03c72 = 1824 with 87 d.f. wald statistics are in tables 14.6\nand 14.7. the global test of the constant slopes assumption in the cr model\n(test of all interactions involving cohort) has wald \u03c72 = 172 with 43 d.f.,\np < 0.0001. consistent with figure 14.5, the formal tests indicate that ausc\nis the biggest violator, followed by waz and rr.\n\n14.9 penalized estimation\n\nwe know that the cr model must be extended to fit these data adequately. if\nthe model is fully extended to allow for all cohort \u00d7 predictor interactions, we\nhave not gained any precision or power in using an ordinal model over using a\npolytomous logistic model. therefore we seek some restrictions on the model\u2019s\nparameters. the lrm and pentrace functions allow for differing \u03bb for shrinking\ndifferent types of terms in the model. here we do a grid search to determine\nthe optimum penalty for simple main effect (non-interaction) terms and the\npenalty for interaction terms, most of which are terms interacting with cohort\n\n "}, {"Page_number": 364, "text": "14.9 penalized estimation\n\n343\n\ntable 14.7 wald statistics for the continuation ratio model. interactions with\ncohort assess non-proportional hazards\n\n\u03c72\n\nd.f.\n\np\n\n199.47 44 < 0.0001\ncohort\n0.0742\n48.89 36\nageg\n59.37 24\n0.0001\ntemp\n93.77 24 < 0.0001\nrr\n6 < 0.0001\n39.69\nwaz\n0.0045\n2\n10.80\nbul.conv\n15.19\n2\n0.0005\ndrowsy\n2\n13.55\n0.0011\nagitated\n2 < 0.0001\n51.85\nreffort\n2 < 0.0001\n109.80\nausc\n2 < 0.0001\n27.47\nfeeding\n1.78\n2\n0.4106\nabdominal\n0.1069\n2\n4.47\nhydration\n0.0364\n2\n6.62\nhxprob\n0.2194\n2\n3.03\npustular\n0.4604\n2\n1.55\ncrying\n3.63\n2\n0.1630\nfever.ill\n0.0693\n2\n5.34\nstop.breath\n0.0690\n5.35\n2\nlabor\nageg \u00d7 temp\n0.9432\n8.18 16\nageg \u00d7 rr\n0.0015\n38.11 16\ncohort \u00d7 ageg\n14.88 18\n0.6701\ncohort \u00d7 temp\n0.7225\n8.77 12\ncohort \u00d7 rr\n0.0736\n19.67 12\ncohort \u00d7 waz\n0.0288\n3\n9.04\ncohort \u00d7 bul.conv\n0.5658\n1\n0.33\ncohort \u00d7 drowsy\n1\n0.4489\n0.57\ncohort \u00d7 agitated\n0.4593\n1\n0.55\ncohort \u00d7 reffort\n1\n0.1298\n2.29\ncohort \u00d7 ausc\n1 < 0.0001\n38.11\ncohort \u00d7 feeding\n0.1152\n1\n2.48\ncohort \u00d7 abdominal\n1\n0.7696\n0.09\ncohort \u00d7 hydration\n0.4682\n1\n0.53\ncohort \u00d7 hxprob\n0.1109\n1\n2.54\ncohort \u00d7 pustular\n0.1210\n1\n2.40\ncohort \u00d7 crying\n0.5310\n1\n0.39\ncohort \u00d7 fever.ill\n1\n0.0749\n3.17\ncohort \u00d7 stop.breath\n0.0839\n1\n2.99\ncohort \u00d7 labor\n0.8309\n1\n0.05\ncohort \u00d7 ageg \u00d7 temp\n0.9736\n8\n2.22\ncohort \u00d7 ageg \u00d7 rr\n10.22\n8\n0.2500\n93.36 40 < 0.0001\ntotal nonlinear\ntotal interaction\n203.10 59 < 0.0001\ntotal nonlinear + interaction 257.70 67 < 0.0001\ntotal\n1211.73 87 < 0.0001\n\n "}, {"Page_number": 365, "text": "344\n\n14 ordinal regression, data reduction, and penalization\n\nto allow for unequal slopes. the following code uses pentrace on the full\nextended cr model fit to find the optimum penalty factors. all combinations\nof the simple and interaction \u03bbs for which the interaction penalty \u2265 the\npenalty for the simple parameters are examined.\nd \u2190 options ( digits =4)\n\npentrace ( full ,\n\nlist ( simple = c (0 , .025 , .05 , .075 , .1 ),\n\ninteraction = c (0 ,10 ,50 ,100 ,125 ,150)))\n\nbest penalty :\n\nsimple interaction\n\ndf\n125 49.75\n\nsimple interaction\n\ndf\n\naic\n\n0.05\n\n0.000\n0.000\n0.025\n0.050\n0.075\n0.100\n0.000\n0.025\n0.050\n0.075\n0.100\n0.000\n0.025\n0.050\n0.075\n0.100\n0.000\n0.025\n0.050\n0.075\n0.100\n0.000\n0.025\n0.050\n0.075\n0.100\n\n0 87.00 1650 1074\n10 60.63 1671 1269\n10 60.11 1672 1274\n10 59.80 1672 1276\n10 59.58 1671 1277\n10 59.42 1671 1278\n50 54.64 1671 1309\n50 54.14 1672 1313\n50 53.83 1672 1316\n50 53.62 1672 1317\n50 53.46 1672 1318\n100 51.61 1672 1330\n100 51.11 1673 1334\n100 50.81 1673 1336\n100 50.60 1672 1337\n100 50.44 1672 1338\n125 50.55 1672 1337\n125 50.05 1673 1341\n125 49.75 1673 1343\n125 49.54 1672 1344\n125 49.39 1672 1345\n150 49.65 1672 1343\n150 49.15 1672 1347\n150 48.85 1673 1349\n150 48.64 1672 1350\n150 48.49 1672 1351\n\nbic aic . c\n1648\n1669\n1670\n1670\n1670\n1670\n1670\n1671\n1671\n1671\n1671\n1671\n1672\n1672\n1671\n1671\n1671\n1672\n1672\n1672\n1671\n1671\n1672\n1672\n1671\n1671\n\noptions ( d )\n\nwe see that shrinkage from 87 d.f. down to 49.75 effective d.f. results in an\nimprovement in \u03c72\u2013scaled aic of 23. the optimum penalty factors were 0.05\nfor simple terms and 125 for interaction terms.\n\nlet us now store a penalized version of the full fit, find where the effective\nd.f. were reduced, and compute \u03c72 for each factor in the model. we take\nthe effective d.f. for a collection of model parameters to be the sum of the\n\n "}, {"Page_number": 366, "text": "14.9 penalized estimation\n\n345\n\ndiagonals of the matrix product defined underneath gray\u2019s equation 2.9237\nthat correspond to those parameters.\nfull.pen \u2190\n\nupdate ( full ,\n\npenalty = list ( simple = .05 , interaction =125))\n\nprint ( full.pen , latex = true , coefs = false )\n\nlogistic regression model\n\nlrm(formula = y ~ cohort * (ageg * (rcs(temp, 5) + rcs(rr, 5)) +\n\nrcs(waz, 4) + bul.conv + drowsy + agitated + reffort + ausc +\nfeeding + abdominal + hydration + hxprob + pustular + crying +\nfever.ill + stop.breath + labor), data = sc.expanded, x = true,\ny = true, penalty = list(simple = 0.05, interaction = 125))\n\npenalty factors\n\nsimple nonlinear interaction nonlinear.interaction\n125\n\n0.05\n\n0.05\n\n125\n\nmodel likelihood discrimination rank discrim.\n\nratio test\n\nindexes\n\nindexes\n\nobs\n\n0\n1\nmax| \u2202 log l\n\n\u2202\u03b2 | 1\u00d710\n\n1772.11 r2\n\n5553 lr \u03c72\n1512 d.f.\n49.75 g\n4041 pr(> \u03c72) < 0.0001 gr\n21.48 gp\n\n\u22127 penalty\n\neffective.df ( full.pen )\n\nbrier\n\n0.392 c\n1.594 dxy\n4.924 \u03b3\n0.263 \u03c4a\n0.136\n\n0.840\n0.679\n0.681\n0.269\n\noriginal and effective degrees of freedom\n\nall\nsimple terms\ninteraction or nonlinear\nnonlinear\ninteraction\nnonlinear interaction\n\noriginal penalized\n49.75\n19.98\n29.77\n16.82\n22.57\n9.62\n\n87\n20\n67\n40\n59\n32\n\n# # c o m p u t e d i s c r i m i n a t i o n for y =0 vs. y >0\n# f i g u r e 14.6\n\nperf.pen \u2190 perf ( full.pen )\n\n# e x c l u d e i n t e r a c t i o n s and c o h o r t e f f e c t s from plot\nplot ( anova ( full.pen ), cex.labels =0 .75 , rm.ia = true ,\n\nrm.other = ' cohort\n\n( factor + higher order factors ) ' )\n\n "}, {"Page_number": 367, "text": "346\n\n14 ordinal regression, data reduction, and penalization\n\nageg\nfever.ill\ncrying\npustular\nabdominal\nhydration\nstop.breath\nlabor\nhxprob\nbul.conv\nagitated\ndrowsy\ntemp\nfeeding\nwaz\nrr\nreffort\nausc\n\n\u221220\n\n0\n\n20\n\n60\n\n40\n\u03c72 \u2212 df\n\n80\n\n100\n\n120\n\nfig. 14.6 importance of predictors in full penalized model, as judged by partial\nwald \u03c72 minus the predictor d.f. the wald \u03c72 values for each line in the dot plot\ninclude contributions from all higher-order effects. interaction effects by themselves\nhave been removed as has the cohort effect.\n\nthis will be the final model except for the model used in section 14.10.\nthe model has lr \u03c72 = 1772. the output of effective.df shows that non-\ninteraction terms have barely been penalized, and coefficients of interaction\nterms have been shrunken from 59 d.f. to effectively 22.6 d.f. predictive dis-\ncrimination was assessed by computing the somers\u2019 dxy rank correlation\nbetween x \u02c6\u03b2 and whether y = 0, in the subset of records for which y = 0 is\nwhat was being predicted. here dxy = 0.672, and the roc area is 0.838 (the\nunpenalized model had an apparent dxy = 0.676). to summarize in another\nway the effectiveness of this model in screening infants for risks of any abnor-\nmality, the fraction of infants with predicted probabilities that y > 0 being\n< 0.05, > 0.25, and > 0.5 are, respectively, 0.1, 0.28, and 0.14. anova output is\nplotted in figure 14.6 to give a snapshot of the importance of the various pre-\ndictors. the wald statistics used here are computed on a variance\u2013covariance\nmatrix which is adjusted for penalization (using gray equation 2.6237 before\nit was determined that the sandwich covariance estimator performs less well\nthan the inverse of the penalized information matrix\u2014see p. 211).\n\nthe full equation for the fitted model is below. only the part of the equa-\ntion used for predicting pr(y = 0) is shown, other than an intercept for\ny \u2265 1 that does not apply when y = 0.\nlatex ( full.pen , which =1:21 , file = ' ' )\n\n "}, {"Page_number": 368, "text": "14.9 penalized estimation\n\n347\n\n\u22125(rr \u2212 76)3\n\n+\n\n+ \u2212 0.4418073 bul.conv\n\n\u2212 2.833442(temp \u2212 37)3\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n\u22125(rr \u2212 49)3\n\n+ + 8.405441\u00d710\n\n\u22125(rr \u2212 42)3\n+ + 1.960063\u00d710\n\u2212 0.1185068(waz + 0.75)3\n\n\u2212 2.507527(temp \u2212 37.69998)3\n\n+ \u2212 0.02915754(waz \u2212 1.73)3\n\n\u22125(rr \u2212 32)3\n\u2212 0.0001018105(rr \u2212 59)3\n\nx \u02c6\u03b2 =\n\u22121.337435[y >= 1]\n+0.1074525[ageg \u2208 [ 7, 60)] + 0.1971287[ageg \u2208 [60, 90]]\n+0.1978706temp + 0.1091831(temp \u2212 36.19998)3\n+5.07114(temp \u2212 37.29999)3\n+0.1606456(temp \u2212 39)3\n+0.02090741rr \u2212 6.336873\u00d710\n+6.152416\u00d710\n\u22120.07589699waz + 0.02508918(waz + 2.9)3\n+0.1225752(waz \u2212 0.28)3\n\u22120.08185088 drowsy \u2212 0.05327209 agitated \u2212 0.2304409 reffort\n\u22121.158604 ausc \u2212 0.1599588 feeding \u2212 0.1608684 abdominal\n\u22120.05409718 hydration + 0.08086387 hxprob + 0.007519746 pustular\n+0.04712091 crying + 0.004298725 fever.ill \u2212 0.3519033 stop.breath\n+0.06863879 labor\n+[ageg \u2208 [ 7, 60)][6.499592\u00d710\n\u22120.008691166(temp \u2212 37)3\n+0.0259236(temp \u2212 37.69998)3\n+[ageg \u2208 [60, 90]][0.0001320368temp \u2212 0.00182639(temp \u2212 36.19998)3\n\u22120.01640406(temp \u2212 37)3\n+0.09142148(temp \u2212 37.69998)3\n+[ageg \u2208 [ 7, 60)][\u22120.0009437598rr \u2212 1.044673\u00d710\n\u22121.670499\u00d710\n\u22126.382087\u00d710\n+[ageg \u2208 [60, 90]][\u22120.001920811rr \u2212 5.52134\u00d710\n\u22128.628392\u00d710\n\u22121.98372\u00d710\n\n+ \u2212 0.0476041(temp \u2212 37.29999)3\n+\n\u2212 0.02558693(temp \u2212 39)3\n+]\n\u22126(rr \u2212 32)3\n\n\u2212 0.004987871(temp \u2212 37.29999)3\n\u2212 0.009444801(temp \u2212 39)3\n+]\n\n\u22126(rr \u2212 42)3\n+ \u2212 5.189082\u00d710\n\u22126(rr \u2212 76)3\n+]\n\n\u22125 temp \u2212 0.00279976(temp \u2212 36.19998)3\n\n\u22126(rr \u2212 42)3\n+\n\u22125(rr \u2212 76)3\n+]\n\n\u2212 4.147347\u00d710\n\n+ + 3.813427\u00d710\n\n+ + 1.428634\u00d710\n\n\u22126(rr \u2212 49)3\n\n\u22126(rr \u2212 32)3\n\n\u22126(rr \u2212 49)3\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n+\n\n\u22125(rr \u2212 59)3\n\n+\n\n\u22125(rr \u2212 59)3\n\n+\n\nwhere [c] = 1 if subject is in group c, 0 otherwise; (x)+ = x if x > 0, 0 otherwise.\n\nnow consider displays of the shapes of effects of the predictors. for the\ncontinuous variables temp and rr that interact with age group, we show the\neffects for all three age groups separately for each y cutoff. all effects have\nbeen centered so that the log odds at the median predictor value is zero\nwhen cohort=\u2019all\u2019, so these plots actually show log odds relative to reference\nvalues. the patterns in figures 14.9 and 14.8 are in agreement with those in\nfigure 14.5.\n\n "}, {"Page_number": 369, "text": "348\n\n14 ordinal regression, data reduction, and penalization\n\nyl \u2190 c ( -3 , 1)\n\n# put all plots on common y-axis scale\n\nmake a separate plot for each ' cohort '\n\n# plot predictors that interact with another predictor\n# vary ageg over all age groups , then vary temp over its\n# default range (10 th smallest to 10 th largest values in\n# data ).\n# ref.zero centers effects using median x\ndd \u2190 datadist ( sc.expande d ); dd \u2190 datadist ( dd , cohort )\noptions ( datadist = ' dd ' )\np1 \u2190 predict ( full.pen , temp , ageg , cohort ,\np2 \u2190 predict ( full.pen , rr ,\np \u2190 rbind ( temp = p1 , rr = p2 )\nsource ( paste ( ' http : / / b i o s t a t . m c . v a n d e r b i l t . e d u / wiki / pub / main ' ,\nggplot (p , \u223c cohort , groups = ' ageg ' , varypred = true ,\n\nref.zero = true , conf.int = false )\nageg , cohort ,\n\n' r c o n f i g u r a t i o n / g r a p h i c s s e t . r ' , sep = ' / ' ))\n\nref.zero = true , conf.int = false )\n\n# figure 14.7:\n\nylim = yl , layout = c (2 , 1) , l e g e n d . p o s i t i o n = c ( .85 , .8 ) ,\naddlayer = ltheme ( width =3 , height =3 , text =2 .5 , title =2 .5 ) ,\na d j . s u b t i t l e = false )\n\n# ltheme defined with source()\n\n# for each p r e d i c t o r that only i n t e r a c t s with cohort , show\n# the d i f f e r i n g e f f e c t s of the p r e d i c t o r for p r e d i c t i n g\n# pr ( y =0) and pr ( y =1 g i v e n y e x c e e d s 0) on the same g r a p h\n\ndd $ limits [ ' adjust to ' , ' cohort ' ] \u2190 ' y \u2265 1 '\nv \u2190 cs ( waz , bul.conv , drowsy , agitated , reffort , ausc ,\n\nfeeding , abdominal , hydration , hxprob , pustular ,\ncrying )\n\nyeq1 \u2190 predict ( full.pen , name =v , ref.zero = true )\nyl \u2190 c ( -1.5 , 1 .5 )\nggplot ( yeq1 , ylim = yl , sepdiscrete = ' vertical ' )\ndd $ limits [ ' adjust to ' , ' cohort ' ] \u2190 ' all '\nall \u2190 predict ( full.pen , name =v , ref.zero = true )\nggplot ( all , ylim = yl , sepdiscrete = ' vertical ' )\n\n# f i g u r e 14.8\n\n# o r i g i n a l d e f a u l t\n\n# f i g u r e 14.9\n\n1\n\n14.10 using approximations to simplify the model\n\nparsimonious models can be developed by approximating predictions from\nthe model to any desired level of accuracy. let \u02c6l = x \u02c6\u03b2 denote the predicted\nlog odds from the full penalized ordinal model, including multiple records for\nsubjects with y > 0. then we can use a variety of techniques to approximate\n\u02c6l from a subset of the predictors (in their raw form). with this approach\none can immediately see what is lost over the full model by computing, for\n\n "}, {"Page_number": 370, "text": "14.10 using approximations to simplify the model\n\n349\n\nexample, the mean absolute error in predicting \u02c6l. another advantage to full\nmodel approximation is that shrinkage used in computing \u02c6l is inherited by\nany model that predicts \u02c6l. in contrast, the usual stepwise methods result in\n\u02c6\u03b2 that are too large since the final coefficients are estimated as if the model\nstructure were prespecified.\n\ncart would be particularly useful as a model approximator as it would\nresult in a prediction tree that would be easy for health workers to use.\n\n2\n\nall\n\ny>=1\n\n34\n\n36\n\n38\n\n34\n\n40\ntemperature\n\n36\n\n38\n\n40\n\nall\n\ny>=1\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n30\n\n60\n\n90\n\n30\n\n60\n\n90\n\nadjusted respiratory rate\n\nfig. 14.7 centered effects of predictors on the log odds, showing the effects of two\npredictors with interaction effects for the age intervals noted. the title all refers\nto the prediction of y = 0|y \u2265 0, that is, y = 0. y>=1 refers to predicting the\nprobability of y = 1|y \u2265 1.\n\n "}, {"Page_number": 371, "text": "350\n\n14 ordinal regression, data reduction, and penalization\n\nweight\u2212for\u2212age zscore\n\ncrying\n\ndrowsy\n\n1\n0\n\u22121\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n1\n0\n\u22121\n\n1\n0\n\u22121\n\n1\n0\n\n1\n0\n\n0.0\n\n2.5\n\n5.0\n\n7.5 10.0 \u22125 \u22124 \u22123 \u22122 \u22121\n\n0\n\n1 0\n\n1\n\nfeeding\n\nhxprob\n\n2\n3\nhydration\n\n4\n\n5\n\n0\n\n1\n\n2\n3\nreffort\n\n4\n\n5\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2.5\n\n5.0\n\n7.5\n\n10.0\n\nwaz\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\u22124\n\n\u22122\n\n0\n\n2\n\nany pustular condition\n\nbul.conv\n\n1\n0\n\n1\n0\n\n1\n\nausc\n\npustular\n\n\u22121\n\n0\n\n1\n\n\u22121\n\n0\n\n1\n\nlog odds\n\nfig. 14.8 centered effects of predictors on the log odds, for predicting y = 1|y \u2265 1\n\nunfortunately, a 50-node cart was required to predict \u02c6l with an r2 \u2265 0.9,\nand the mean absolute error in the predicted logit was still 0.4. this will\nhappen when the model contains many important continuous variables.\n\nlet\u2019s approximate the full model using its important components, by using\na step-down technique predicting \u02c6l from all of the component variables using\nordinary least squares. in using step-down with the least squares function ols\nin rms there is a problem when the initial r2 = 1.0 as in that case the esti-\nmate of \u03c3 = 0. this can be circumvented by specifying an arbitrary nonzero\nvalue of \u03c3 to ols (here 1.0), as we are not using the variance\u2013covariance\nmatrix from ols anyway. since cohort interacts with the predictors, separate\napproximations can be developed for each level of y . for this example we\napproximate the log odds that y = 0 using the cohort of patients used for\ndetermining y = 0, that is, y \u2265 0 or cohort=\u2019all\u2019.\n\n "}, {"Page_number": 372, "text": "14.10 using approximations to simplify the model\n\n351\n\nweight\u2212for\u2212age zscore\n\ncrying\n\ndrowsy\n\n1\n0\n\u22121\n\ns\nd\nd\no\ng\no\n\n \n\nl\n\n1\n0\n\u22121\n\n1\n0\n\u22121\n\n1\n0\n\n1\n0\n\n0.0\n\n2.5\n\n5.0\n\n7.5 10.0 \u22125 \u22124 \u22123 \u22122 \u22121\n\n0\n\n1 0\n\n1\n\nfeeding\n\nhxprob\n\n2\n3\nhydration\n\n4\n\n5\n\n0\n\n1\n\n2\n3\nreffort\n\n4\n\n5\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2.5\n\n5.0\n\n7.5\n\n10.0\n\nwaz\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\u22124\n\n\u22122\n\n0\n\n2\n\nany pustular condition\n\nbul.conv\n\n1\n0\n\n1\n0\n\nausc\n\npustular\n\n\u22121\n\n0\n\n1\n\n\u22121\n\n0\n\n1\n\nfig. 14.9 centered effects of predictors on the log odds, for predicting y \u2265 1. no\nplot was made for the fever.ill, stop.breath. or labor cluster scores.\n\nlog odds\n\nplogit \u2190 predict ( full.pen )\nf \u2190 ols ( plogit \u223c ageg * ( rcs ( temp ,5) + rcs ( rr ,5)) +\n\nrcs ( waz ,4) + bul.conv + drowsy + agitated +\nreffort + ausc + feeding + abdominal + hydration +\nhxprob + pustular + crying + fever.ill +\nstop.breath + labor ,\nsubset = cohort == ' all ' , data = sc.expanded , sigma =1)\n\n# do fast b a c k w a r d s t e p d o w n\n\nw \u2190 options ( width =120)\n\nfastbw (f , aics =1 e10 )\n\n "}, {"Page_number": 373, "text": "352\n\n14 ordinal regression, data reduction, and penalization\n\nchi\u2212sq\n\nd . f . p\n\nr e s i d u a l d . f . p\n\nd e l e t e d\na g e g \u2217 temp\na g e g\np u s t u l a r\nf e v e r . i l l\nc r y i n g\na b d o m i n a l\nr r\nh y d r a t i o n\nl a b o r\ns t o p . b r e a t h\nb u l . conv\na g i t a t e d\nhxprob\ndrowsy\ntemp\nwaz\nr e f f o r t\na g e g \u2217 r r\na u s c\nf e e d i n g\n\n1 . 8 7 8\n0 . 0 5 2\n0 . 0 2 1\n0 . 0 8 1\n9 . 4 7 1\n1 2 . 6 6 1\n1 7 . 9 0 4\n1 3 . 2 1 1\n2 3 . 4 8 1\n3 3 . 4 0 1\n5 1 . 5 3 1\n6 3 . 6 6 1\n8 4 . 1 6 1\n1 0 9 . 8 6 1\n2 9 5 . 6 7 4\n3 6 8 . 8 6 3\n4 4 9 . 8 3 1\n7 5 1 . 1 9 8\n1 9 0 6 . 8 2 1\n3 9 0 0 . 3 3 1\n\n1 . 8 7\n0 . 9 8 4 8\n1 . 9 2\n0 . 9 7 4 0\n1 . 9 4\n0 . 8 7 7 8\n2 . 0 2\n0 . 7 8 2 8\n1 1 . 4 9\n0 . 0 0 2 1\n2 4 . 1 5\n0 . 0 0 0 4\n4 2 . 0 5\n0 . 0 0 1 3\n5 5 . 2 6\n0 . 0 0 0 3\n7 8 . 7 4\n0 . 0 0 0 0\n1 1 2 . 1 4\n0 . 0 0 0 0\n1 6 3 . 6 7\n0 . 0 0 0 0\n2 2 7 . 3 3\n0 . 0 0 0 0\n3 1 1 . 4 9\n0 . 0 0 0 0\n4 2 1 . 3 5\n0 . 0 0 0 0\n7 1 7 . 0 1\n0 . 0 0 0 0\n0 . 0 0 0 0 1 0 8 5 . 8 7\n0 . 0 0 0 0 1 5 3 5 . 7 0\n0 . 0 0 0 0 2 2 8 6 . 9 0\n0 . 0 0 0 0 4 1 9 3 . 7 2\n0 . 0 0 0 0 8 0 9 4 . 0 4\n\n8\n10\n11\n12\n13\n14\n18\n19\n20\n21\n22\n23\n24\n25\n29\n32\n33\n41\n42\n43\n\nr2\n\naic\n\n0 . 9 8 4 8 \u221214.13 1 . 0 0 0\n0 . 9 9 6 9 \u221218.08 1 . 0 0 0\n0 . 9 9 8 7 \u221220.06 1 . 0 0 0\n0 . 9 9 9 4 \u221221.98 1 . 0 0 0\n0 . 5 6 9 8 \u221214.51 0 . 9 9 9\n\u22123.85 0 . 9 9 7\n0 . 0 4 4 0\n6 . 0 5 0 . 9 9 5\n0 . 0 0 1 1\n1 7 . 2 6 0 . 9 9 3\n0 . 0 0 0 0\n0 . 0 0 0 0\n3 8 . 7 4 0 . 9 9 0\n0 . 0 0 0 0\n7 0 . 1 4 0 . 9 8 6\n1 1 9 . 6 7 0 . 9 8 0\n0 . 0 0 0 0\n1 8 1 . 3 3 0 . 9 7 2\n0 . 0 0 0 0\n2 6 3 . 4 9 0 . 9 6 2\n0 . 0 0 0 0\n3 7 1 . 3 5 0 . 9 4 8\n0 . 0 0 0 0\n0 . 0 0 0 0\n6 5 9 . 0 1 0 . 9 1 1\n0 . 0 0 0 0 1 0 2 1 . 8 7 0 . 8 6 6\n0 . 0 0 0 0 1 4 6 9 . 7 0 0 . 8 1 0\n0 . 0 0 0 0 2 2 0 4 . 9 0 0 . 7 1 7\n0 . 0 0 0 0 4 1 0 9 . 7 2 0 . 4 8 2\n0 . 0 0 0 0 8 0 0 8 . 0 4 0 . 0 0 0\n\napproximate e s t i m a t e s a f t e r d e l e t i n g f a c t o r s\n\n[ 1 , ] 1 . 6 1 7 0 . 0 1 4 8 2\n\ns . e . wald z p\n1 0 9 . 1 0\n\nco e f\n\nf a c t o r s\n\ni n f i n a l model\n\nnone\n\noptions ( w )\n# 1 e10 c a u s e s all v a r i a b l e s to e v e n t u a l l y be\n# d e l e t e d so can see most i m p o r t a n t ones in o r d e r\n\n# fit an a p p r o x i m a t i o n to the full p e n a l i z e d m o d e l u s i n g\n# most i m p o r t a n t v a r i a b l e s\n\nfull.approx \u2190\n\nols ( plogit \u223c rcs ( temp ,5) + ageg * rcs ( rr ,5) +\n\nrcs ( waz ,4) + bul.conv + drowsy + reffort +\nausc + feeding ,\nsubset = cohort == ' all ' , data = sc.expanded )\n\np \u2190 predict ( full.approx )\nabserr \u2190 mean ( abs ( p - plogit [ cohort == ' all ' ]))\ndxy \u2190 somers2 (p , y [ cohort == ' all ' ])[ ' dxy ' ]\n\nthe approximate model had r2 against the full penalized model of 0.972, and\nthe mean absolute error in predicting \u02c6l was 0.17. the dxy rank correlation\nbetween the approximate model\u2019s predicted logit and the binary event y = 0\n\n "}, {"Page_number": 374, "text": "14.11 validating the model\n\n353\n\nis 0.665 as compared with the full model\u2019s dxy = 0.672. see section 19.5 for\nan example of computing correct estimates of variance of the parameters in\nan approximate model.\n\nnext turn to diagramming this model approximation so that all predicted\nvalues can be computed without the use of a computer. we draw a type of\nnomogram that converts each effect in the model to a 0 to 100 scale which is\njust proportional to the log odds. these points are added across predictors\nto derive the \u201ctotal points,\u201d which are converted to \u02c6l and then to predicted\nprobabilities. for the interaction between rr and ageg, rms\u2019s nomogram func-\ntion automatically constructs three rr axes\u2014only one is added into the total\npoint score for a given subject. here we draw a nomogram for predicting the\nprobability that y > 0, which is 1 \u2212 pr(y = 0). this probability is derived\nby negating \u02c6\u03b2 and x \u02c6\u03b2 in the model derived to predict pr(y = 0).\nf \u2190 full.approx\nf $ linear.predi c to rs \u2190 -f $ linear.predic to rs\nn \u2190 nomogram (f ,\n\n\u2190 -f $ coefficients\n\nf $ coefficients\n\ntemp =32:41 , rr = seq (20 ,120 , by =10) ,\nwaz = seq ( -1.5 ,2 , by = .5 ),\nfun = plogis , funlabel = ' pr (y >0) ' ,\nfun.at = c ( .02 , .05 , seq ( .1 , .9 , by = .1 ), .95 , .98 ))\n\n# p r i n t n to see p o i n t t a b l e s\nplot (n , lmgp = .2 , cex.axis = .6 )\n\nnewsubject \u2190\n\n# f i g u r e 14.10\n\ndata.frame ( ageg = ' [ 0, 7) ' , rr =30 , temp =39 , waz =0 , drowsy =5 ,\n\nxb \u2190 predict (f , newsubject )\n\nreffort =2 , bul.conv =0 , ausc =0 , feeding =0)\n\nthe nomogram is shown in figure 14.10. as an example in using the nomo-\ngram, a six-day-old infant gets approximately 9 points for having a respiration\nc, 11 points for\nrate of 30/minute, 19 points for having a temperature of 39\nwaz=0, 14 points for drowsy=5, and 15 points for reffort=2. assuming that\nbul.conv=ausc=feeding=0, that infant gets 68 total points. this corresponds to\nx \u02c6\u03b2 = \u22120.68 and a probability of 0.34.\n\n\u25e6\n\n3\n\n14.11 validating the model\n\nfor the full cr model that was fitted using penalized maximum likelihood\nestimation (pmle), we used 200 bootstrap replications to estimate and then\nto correct for optimism in various statistical indexes: dxy, generalized r2,\nintercept and slope of a linear re-calibration equation for x \u02c6\u03b2, the maximum\ncalibration error for pr(y = 0) based on the linear-logistic re-calibration\n(emax), and the brier quadratic probability score b. pmle is used at each\nof the 200 resamples. during the bootstrap simulations, we sample with\n\n "}, {"Page_number": 375, "text": "354\n\npoints\n\ntemperature\n\nrr (ageg=[ 0, 7))\n\nrr (ageg=[ 7,60))\n\nrr (ageg=[60,90])\n\nweight\u2212for\u2212age\nzscore\n\nbul.conv\n\ndrowsy\n\nreffort\n\nausc\n\nfeeding\n\ntotal points\n\nlinear predictor\n\npr(y>0)\n\n14 ordinal regression, data reduction, and penalization\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n38\n\n39\n\n41\n\n37\n\n36\n50\n\n35\n\n34\n\n33\n\n32\n\n60\n\n70\n\n90 110\n\n70\n\n80\n\n90\n\n100\n\n110\n\n120\n\n70\n\n80\n\n90\n\n100\n\n110\n\n120\n\n40\n50\n\n30\n\n20\n\n60\n\n40\n\n30\n\n50\n\n20\n\n60\n\n40\n\n30\n\n20\n\n2\n\n1\n\n0 \u22120.5\n\n1\n\n0\n\n0\n\n0\n\n0\n\n0\n\n0\n\n1\n\n3\n\n5\n\n4\n\n2\n\n1\n\n3\n\n5\n\n2\n\n4\n\n1\n\n1\n\n3\n\n5\n\n2\n\n4\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\n\n140\n\n160\n\n180\n\n200\n\n220\n\n240\n\n260\n\n\u22124\n\n\u22123\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n0.02\n\n0.05\n\n0.1\n\n0.2\n\n0.3 0.4 0.5 0.6 0.7\n\n0.8\n\n0.9\n\n0.95\n\n0.98\n\nfig. 14.10 nomogram for predicting pr(y > 0) from the penalized extended cr\nmodel, using an approximate model fitted using ordinary least squares (r2 = 0.972\nagainst the full model\u2019s predicted logits).\n\nreplacement from the patients and not from the 5553 expanded records, hence\nthe specification cluster=u$subs, where u$subs is the vector of sequential pa-\ntient numbers computed from cr.setup above. to be able to assess predictive\naccuracy of a single predicted probability, the subset parameter is specified\nso that pr(y = 0) is being assessed even though 5553 observations are used\nto develop each of the 200 models.\n\nset.seed (1)\n\n# so can r e p r o d u c e r e s u l t s\n\nv \u2190 validate ( full.pen , b =200 , cluster = u $ subs ,\nlatex (v , file = ' ' , digits =2 , size = ' smaller ' )\n\nsubset = cohort == ' all ' )\n\n "}, {"Page_number": 376, "text": "14.12 summary\n\nindex\n\n355\n\nindex\n\n0.67\n0.38\n\noriginal training test optimism corrected n\nsample sample sample\n0.67\n0.37\n0.00\n1.00\n0.00\n0.28\n0.00\n0.28\n0.12\n1.45\n0.22\n\n0.68\ndxy\nr2\n0.38\nintercept \u22120.03 \u22120.03\n1.03\nslope\n0.00\nemax\n0.29\nd\n0.00\nu\n0.29\nq\n0.12\nb\n1.50\ng\n0.23\ngp\n\n0.66 200\n0.36 200\n0.00 200\n1.00 200\n0.00 200\n0.27 200\n0.00 200\n0.27 200\n0.12 200\n1.42 200\n0.22 200\n\n0.01\n0.01\n\u22120.03\n0.03\n0.00\n0.01\n0.00\n0.01\n0.00\n0.04\n0.00\n\n1.03\n0.00\n0.28\n0.00\n0.28\n0.12\n1.47\n0.22\n\nv \u2190 round (v , 3)\n\nwe see that for the apparent dxy = 0.672 and that the optimism from\noverfitting was estimated to be 0.011 for the pmle model, so the bias-\ncorrected estimate of predictive discrimination is 0.661. the intercept and\nslope needed to re-calibrate x \u02c6\u03b2 to a 45\nline are very near (0, 1). the es-\ntimate of the maximum calibration error in predicting pr(y = 0) is 0.001,\nwhich is quite satisfactory. the corrected brier score is 0.122.\n\n\u25e6\n\nthe simple calibration statistics just listed do not address the issue of\nwhether predicted values from the model are miscalibrated in a nonlinear\nway, so now we estimate an overfitting-corrected calibration curve nonpara-\nmetrically.\ncal \u2190 calibrate ( full.pen , b =200 , cluster = u $ subs ,\nerr \u2190 plot ( cal )\n\nsubset = cohort == ' all ' )\n# f i g u r e 14.11\n\nn=5553\n0 . 9 q u a n t i l e o f a b s o l u t e e r r o r =0.038\n\nmean a b s o l u t e e r r o r =0.017\n\nmean s q u a r e d e r r o r =0.00043\n\nthe results are shown in figure 14.11. one can see a slightly nonlinear cali-\nbration function estimate, but the overfitting-corrected calibration is excellent\neverywhere, being only slightly worse than the apparent calibration. the esti-\nmated maximum calibration error is 0.044. the excellent validation for both\npredictive discrimination and calibration are a result of the large sample size,\nfrequency distribution of y , initial data reduction, and pmle.\n\n14.12 summary\n\nclinically guided variable clustering and item weighting resulted in a great\nreduction in the number of candidate predictor degrees of freedom and hence\nincreased the true predictive accuracy of the model. scores summarizing clus-\nters of clinical signs, along with temperature, respiration rate, and weight-\nfor-age after suitable nonlinear transformation and allowance for interactions\n\n "}, {"Page_number": 377, "text": "356\n\n14 ordinal regression, data reduction, and penalization\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\na\nu\nt\nc\na\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\napparent\n\nbias\u2212corrected\n\nideal\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\npredicted pr{y=1}\n\nfig. 14.11 bootstrap calibration curve for the full penalized extended cr model.\n200 bootstrap repetitions were used in conjunction with the loess smoother.111 also\nshown is a \u201crug plot\u201d to demonstrate how effective this model is in discriminating\npatients into low- and high-risk groups for pr(y = 0) (which corresponds with the\nderived variable value y = 1 when cohort=\u2019all\u2019).\n\nwith age, are powerful predictors of the ordinal response. graphical methods\nare effective for detecting lack of fit in the po and cr models and for dia-\ngramming the final model. model approximation allowed development of par-\nsimonious clinical prediction tools. approximate models inherit the shrinkage\nfrom the full model. for the ordinal model developed here, substantial shrink-\nage of the full model was needed.\n\n14.13 further reading\n\n1\n\n2\n\n3\n\nsee moons et al.462 for another case study in penalized maximum likelihood\nestimation.\nthe lasso method of tibshirani608, 609 also incorporates shrinkage into variable\nselection.\nto see how this compares with predictions using the full model, the extra clinical\nsigns in that model that are not in the approximate model were predicted\nindividually on the basis of x \u02c6\u03b2 from the reduced model along with the signs\nthat are in that model, using ordinary linear regression. the signs not specified\nwhen evaluating the approximate model were then set to predicted values based\non the values given for the 6-day-old infant above. the resulting x \u02c6\u03b2 for the full\nmodel is \u22120.81 and the predicted probability is 0.31, as compared with -0.68\nand 0.34 quoted above.\n\n "}, {"Page_number": 378, "text": "14.14 problems\n\n14.14 problems\n\n357\n\ndevelop a proportional odds ordinal logistic model predicting the severity\nof functional disability (sfdm2) in support. the highest level of this vari-\nable corresponds to patients dying before the two-month follow-up interviews.\nconsider this level as the most severe outcome. consider the following pre-\ndictors: age, sex, dzgroup, num.co, scoma, race (use all levels), meanbp, hrt,\ntemp, pafi, alb, adlsc. the last variable is the baseline level of functional\ndisability from the \u201cactivities of daily living scale.\u201d\n\n1. for the variables adlsc, sex, age, meanbp, and others if you like, make\nplots of means of predictors stratified by levels of the response, to check\nfor ordinality. on the same plot, show estimates of means assuming the pro-\nportional odds relationship between predictors and response holds. com-\nment on the evidence for ordinality and for proportional odds.\n\n2. to allow for maximum adjustment of baseline functional status, treat\nthis predictor as nominal (after rounding it to the nearest whole num-\nber; fractional values are the result of imputation) in remaining steps, so\nthat all dummy variables will be generated. make a single chart showing\nproportions of various outcomes stratified (individually) by adlsc, sex,\nage, meanbp. for continuous predictors use quartiles. you can pass the fol-\nlowing function to the summary (summary.formula) function to obtain the\nproportions of patients having sfdm2 at or worse than each of its possi-\nble levels (other than the first level). an easy way to do this is to use\nthe cumcategory function with the hmisc package\u2019s summary.formula func-\ntion. cumcategorysummary.formula print estimates to only two significant\ndigits of precision. manually check the calculations for the sex variable\nusing table(sex, sfdm2). then plot all estimates on a single graph using\nplot(object, which=1:4), where object was created by summary (actually\nsummary.formula). note: for printing tables you may want to convert sfdm2\nto a 0\u20134 variable so that column headers are short and so that later cal-\nculations are simpler. you can use for example:\nsfdm \u2190 as.integer ( sfdm2 ) - 1\n\n3. use an r function such as the following to compute the logits of the cu-\n\nmulative proportions.\nsf \u2190 function (y )\n\nc ( ' y \u2265 1 ' = qlogis ( mean ( y \u2265 1)) ,\n' y \u2265 2 ' = qlogis ( mean ( y \u2265 2)) ,\n' y \u2265 3 ' = qlogis ( mean ( y \u2265 3)) ,\n' y \u2265 4 ' = qlogis ( mean ( y \u2265 4)))\n\nas the y = 3 category is rare, it may be even better to omit the y \u2265 4\ncolumn above, as was done in section 13.3.9 and figure 13.1. for each\npredictor pick two rows of the summary table having reasonable sample\nsizes, and take the difference between the two rows. comment on the\n\n "}, {"Page_number": 379, "text": "358\n\n14 ordinal regression, data reduction, and penalization\n\nvalidity of the proportional odds assumption by assessing how constant\nthe row differences are across columns. note: constant differences in log\nodds (logits) mean constant ratios of odds or constant relative effects of\nthe predictor across outcome levels.\n\n4. make two plots nonparametrically relating age to all of the cumulative\nproportions or their logits. you can use commands such as the following\n(to use the r hmisc package).\n\nfor ( i in 1:4)\n\nplsmo ( age , sfdm \u2265 i , add =i >1 ,\n\nylim = c (.2 , .8 ), ylab = ' proportion y \u2265 j ' )\n\nfor ( i in 1:4)\n\nplsmo ( age , sfdm \u2265 i , add =i >1 , fun = qlogis ,\nylim = qlogis ( c ( .2 , .8 )) , ylab = ' logit ' )\n\ncomment on the linearity of the age effect (which of the two plots do\nyou use?) and on the proportional odds assumption for age, by assessing\nparallelism in the second plot.\n\n5. impute race using the most frequent category and pafi and alb using\n\n\u201cnormal\u201d values.\n\n6. fit a model to predict the ordinal response using all predictors. for con-\ntinuous ones assume a smooth relationship but allow it to be nonlinear.\nquantify the ability of the model to discriminate patients in the five out-\ncomes. do an overall likelihood ratio test for whether any variables are\nassociated with the level of functional disability.\n\n7. compute partial tests of association for each predictor and a test of nonlin-\nearity for continuous ones. compute a global test of nonlinearity. graphi-\ncally display the ranking of importance of the predictors.\n\n8. display the shape of how each predictor relates to the log odds of exceeding\nany level of sfdm2 you choose, setting other predictors to typical values\n(one value per predictor). by default, predict will make predictions for\nthe second response category, which is a satisfactory choice here.\n\n9. use resampling to validate the somers\u2019 dxy rank correlation between pre-\ndicted logit and the ordinal outcome. also validate the generalized r2,\nand slope shrinkage coefficient, all using a single r command. comment\non the quality (potential \u201cexport-ability\u201d) of the model.\n\n "}, {"Page_number": 380, "text": "chapter 15\nregression models for continuous y\nand case study in ordinal regression\n\nthis chapter concerns univariate continuous y . there are many multivariable\nmodels for predicting such response variables, such as\n\u2022 linear models with assumed normal residuals, fitted with ordinary least\n\nsquares\n\n\u2022 generalized linear models and other parametric models based on special\n\ndistributions such as the gamma\n\n\u2022 generalized additive models (gams)277\n\u2022 generalization of gams to also nonparametrically transform y (see\n\nchapter 16)\n\n\u2022 quantile regression (see section 15.2)\n\u2022 other robust regression models that, like quantile regression, use an objec-\n\ntive different from minimizing the sum of squared errors635\n\n\u2022 semiparametric models based on the ranks of y , such as the cox pro-\nportional hazards model (chapter 20) and the proportional odds ordinal\nlogistic model (chapters 13 and 14)\n\n\u2022 cumulative probability models (often called cumulative link models) which\nare semiparametric models from a wider class of families than the logistic.\n\nsemiparametric models that treat y as ordinal but not interval-scaled have\nmany advantages including robustness and freedom from all distributional\nassumptions for y conditional on any given set of predictors. advantages\nare demonstrated in a case study of a cumulative probability ordinal model.\nsome of the results are compared to quantile regression and ols. many of\nthe methods used in the case study also apply to ordinary linear models.\n\n15.1 the linear model\n\nthe most popular multivariable model for analyzing a univariate continuous\ny is the linear model\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 15\n\n359\n\n "}, {"Page_number": 381, "text": "(cid:2)\n\n360 15 regression models for continuous y and case study in ordinal regression\n\ne(y |x) = x\u03b2,\n\n(15.1)\n\n(yi \u2212 x \u02c6\u03b2)2.\n\nwhere \u03b2 is estimated using ordinary least squares, that is, by solving for \u02c6\u03b2 to\nminimize\nto compute p -values and confidence limits using parametric methods we\nwould have to assume that y |x is normal with mean x\u03b2 and constant vari-\nance \u03c32a. one could estimate conditional means of y without any distribu-\ntional assumptions, but least squares estimators are not robust to outliers or\nhigh-leverage points, and the model would be inaccurate in estimating condi-\ntional quantiles of y |x or prob[y \u2265 c|x] unless normality of residuals holds.\nto be accurate in estimating all quantities, the linear model assumes that\nthe gaussian distribution of y |x1 is a simple shift from the distribution of\ny |x2.\n\n15.2 quantile regression\n\nquantile regression355, 357 is a different approach to modeling y . it makes no\ndistributional assumptions other than continuity of y , while having all the\nusual right hand side assumptions. quantile regression provides essentially\nthe same estimates as sample quantiles if there is only an intercept or a cate-\ngorical predictor in the model. quantile regression is transformation invariant\n\u2014 pre-transforming y is not important.\n(cid:2)n\nquantile regression is a natural generalization of sample quantiles. let\n\u03c1\u03c4 (y) = y(\u03c4 \u2212 [y < 0]). the \u03c4 th sample quantile is the minimizer q of\ni\u22121 \u03c1\u03c4 (yi \u2212 q). for a conditional \u03c4 th quantile of y |x the corresponding\nquantile regression estimator \u02c6\u03b2\u03c4 minimizes\n\n(cid:2)n\ni=1 \u03c1\u03c4 (yi \u2212 x\u03b2).\n\nin non-large samples, quantile regression is not as efficient at estimating\nquantiles as is ordinary least squares at estimating the mean, if the latter\u2019s\nassumptions hold.\n\nkoenker\u2019s quantreg package in r356 implements quantile regression, and\nthe rms package\u2019s rq function provides a front-end that gives rise to various\ngraphics and inference tools.\n\nusing quantile regression, we directly model the median as a function\nof covariates so that only the x\u03b2 structure need be correct. other quantiles\n(e.g., 90th percentile) can be modeled but standard errors will be much larger\nas it is more difficult to precisely estimate outer quantiles.\n\na the latter assumption may be dispensed with if we use a robust huber\u2013white or\nbootstrap covariance matrix estimate. normality may sometimes be dispensed with\nby using bootstrap confidence intervals.\n\n "}, {"Page_number": 382, "text": "15.3 ordinal regression models for continuous y\n\n361\n\n15.3 ordinal regression models for continuous y\n\na different robust semiparametric regression approach than quantile regres-\nsion is the cumulative probability ordinal model. semiparametric models\nhave several advantages over parametric models such as ols. while quantile\nregression has no restriction in the parameters when modeling one quantile\nversus anotherb, ordinal cumulative probability models assume a connection\nbetween distributions of y for different x. ordinal regression even makes\none less assumption than quantile regression about the distribution of y for\na specific x: the distribution need not be continuous.\n\napplying an increasing 1\u20131 transformation to y results in no change to\nregression coefficient estimates with ordinal regressionc. regression coefficient\nestimates are completely robust to extreme y valuesd. estimates of quantiles\nof y from ordinal regression are exactly transformation-preserving, e.g., the\nestimate of the median of log y is exactly the log of the estimate of the\nmedian y .\n\nfor a general continuous distribution function f (y), an ordinal regression\nmodel based on cumulative probabilities may be stated as followse. let the\nordered unique values of y be denoted by y1, y2, . . . , yk and let the intercepts\nassociated with y1, . . . , yk be \u03b11, \u03b12, . . . , \u03b1k, where \u03b11 = \u221e because prob[y \u2265\ny1] = 1. let \u03b1y = \u03b1i, i : yi = y. then\n\nprob[y \u2265 yi|x] = f (\u03b1i + x\u03b2) = f (\u03b1yi + x\u03b2)\n\n(15.2)\n\nfor the ols fully parametric case, the model may be restated\n\nprob[y \u2265 y|x] = prob[\n\ny \u2212 x\u03b2\n\n= 1 \u2212 \u03c6(\n\ny \u2212 x\u03b2\n\n\u03c3\n\n) = \u03c6(\n\n\u03c3\n\n\u2265 y \u2212 x\u03b2\n\u2212y\n\u03c3\n\n\u03c3\nx\u03b2\n\u03c3\n\n+\n\n]\n\n)\n\n(15.3)\n\n(15.4)\n\nb quantile regression allows the estimated value of the 0.5 quantile to be higher than\nthe estimated value of the 0.6 quantile for some values of x. composite quantile\nregression690 removes this possibility by forcing all the x coefficients to be the same\nacross multiple quantiles, a restriction not unlike what cumulative probability ordinal\nmodels make.\nc for symmetric distributions applying a decreasing transformation will negate the\ncoefficients. for asymmetric distributions (e.g., gumbel), reversing the order of y\nwill do more than change signs.\nd only an estimate of mean y from these \u02c6\u03b2s is non-robust.\ne it is more traditional to state the model in terms of prob[y \u2264 y|x] but we use\nprob[y \u2265 y|x] so that higher predicted values are associated with higher y .\n\n "}, {"Page_number": 383, "text": "362 15 regression models for continuous y and case study in ordinal regression\n\ntable 15.1 distribution families used in ordinal cumulative probability models. \u03c6\ndenotes the gaussian cumulative distribution function. for the connection column,\np1 = prob[y \u2265 y|x1], p2 = prob[y \u2265 y|x2], \u03b4 = (x2 \u2212 x1)\u03b2. the connection\nspecifies the only distributional assumption if the model is fitted semiparametrically,\ni.e, contains an intercept for every unique y value less one. for parametric models, p1\nmust be specified absolutely instead of just requiring a relationship between p1 and\np2. for example, the traditional gaussian parametric model specifies that prob[y \u2265\ny|x] = 1 \u2212 \u03c6( y\u2212x\u03b2\n\n\u2212y+x\u03b2\n\n) = \u03c6(\n\n).\n\n\u03c3\n\n\u03c3\n\ndistribution\n\nf\n\ninverse\n\nlink name\n\nconnection\n\nlogistic\n\n[1 + exp(\u2212y)]\n\u03c6(y)\n\n\u22121\n\n1\u2212y )\n\n(link function)\nlog( y\n\u03c6\u22121(y)\nlog(\u2212 log(y))\n\nlogit\n\ngaussian\ngumbel maximum exp(\u2212 exp(\u2212y))\ngumbel minimum 1 \u2212 exp(\u2212 exp(y)) log(\u2212 log(1 \u2212 y)) complementary 1 \u2212 p2 = (1 \u2212 p1)exp(\u03b4)\n\nprobit\nlog \u2212 log\n\nvalue\n\n1\n\n= p1\n1\u2212p1\n\np2\nexp(\u03b4)\n1\u2212p2\np2 = \u03c6(\u03c6\u22121(p1) + \u03b4)\np2 = p exp(\u03b4)\n\nvalue\ncauchy\n\n1\n\u03c0 tan\n\n\u22121(y) + 1\n\n2\n\ntan[\u03c0(y \u2212 1\n\n2\n\n)]\n\nlog \u2212 log\ncauchit\n\n\u2212y\nso that to within an additive constantf \u03b1y =\n\u03c3 (intercepts \u03b1 are linear in\ny whereas they are arbitrarily descending in the ordinal model), and \u03c3 is\nabsorbed in \u03b2 to put the ols model into the new notation.\n\nthe general ordinal regression model assumes that for fixed x1, x2,\n\n\u22121(prob[y \u2265 y|x2]) \u2212 f\n\nf\n\n\u22121(prob[y \u2265 y|x1])\n= (x2 \u2212 x1)\u03b2\n\nindependent of the \u03b1s (parallelism assumption). if f = [1 + exp(\u2212y)]\nis the proportional odds assumption.\n\ncommon choices of f , implemented in the r rms orm function, are shown\nin table 15.1. the gumbel maximum value distribution is also called the\nextreme value type i distribution. this distribution (log \u2212 log link) also rep-\nresents a continuous time proportional hazards model. the hazard ratio when\nx changes from x1 to x2 is exp(\u2212(x2 \u2212 x1)\u03b2).\nthe mean of y |x is easily estimated from a fitted cumulative probability\n(cid:11)prob[y = yi|x]\nand the qth quantile of y |x is y such that f\n\n\u22121(1 \u2212 q) \u2212 x \u02c6\u03b2 = \u02c6\u03b1y.g\n\nordinal model by computing\n\nn(cid:3)\n\n(15.7)\n\ni=1\n\nyi\n\nf \u02c6\u03b1y are unchanged if a constant is added to all y.\ng the intercepts have to be shifted to the left one position in solving this equation\nbecause the quantile is such that prob[y \u2264 y] = q whereas the model is stated in\nterms of prob[y \u2265 y].\n\n(15.5)\n(15.6)\n\u22121, this\n\n "}, {"Page_number": 384, "text": "15.3 ordinal regression models for continuous y\n\n363\n\nthe orm function in the rms package takes advantage of the information\nmatrix being of a sparse tri-band diagonal form for the intercept parameters.\nthis makes the computations efficient even for hundreds of intercepts (i.e.,\nunique values of y ). orm is made to handle continuous y .\n\nordinal regression has nice properties in addition to those listed above,\n\nallowing for\n\u2022 estimation of quantiles as efficiently as quantile regression if the parallel\n\nslopes assumptions hold\n\n\u2022 efficient estimation of mean y\n\u2022 direct estimation of prob[y \u2265 y|x]\n\u2022 arbitrary clumping of values of y , while still estimating \u03b2 and mean y\n\nefficientlyh\n\n\u2022 solutions for \u02c6\u03b2 using ordinary newton-raphson or other popular optimiza-\n\ntion techniques\n\n\u2022 being based on a standard likelihood function, penalized estimation can\n\nbe straightforward\n\n\u2022 wald, score, and likelihood ratio \u03c72 tests that are more powerful than tests\n\nfrom quantile regression.\n\non the last point, if there is a single predictor in the model and it is binary,\nthe score test from the proportional odds model is essentially the wilcoxon\ntest, and the score test from the gumbel\nlog-log cumulative probability\nmodel is essentially the log-rank test.\n\n15.3.1 minimum sample size requirement\n\nwhen y is continuous and the purpose of an ordinal model includes semi-\nparametric estimation of probabilities or quantiles, the accuracy of estimates\nis limited even more by the accuracy of estimating the empirical cumulative\ndistribution of y than by estimating \u03b2. when \u03b2 = 0, intercept estimates are\ntransformations of the empirical distribution step function. as described in\nsection 20.3, the sample size must be 184 to estimate the entire distribution\nof y with a global margin of error not exceeding 0.1. for estimating the mean\nof y , smaller sample sizes may be needed.\n\nh but it is not sensible to estimate quantiles of y when there are heavy ties in y in\nthe area containing the quantile.\n\n "}, {"Page_number": 385, "text": "364 15 regression models for continuous y and case study in ordinal regression\n\n15.4 comparison of assumptions of various models\n\nquantile regression makes the fewest left-hand-side model assumptions except\nfor the assumption that y be continuous, but can have less estimator precision\nthan other models and has lower power. to summarize how assumptions of\nparametric models compare to assumptions of semiparametric ordinal models,\nconsider the ordinary linear model or its special case the equal variance two-\nsample t-test, vs. the probit or logit (proportional odds) ordinal model or\ntheir special cases the van der waerden (normal-scores) two-sample rank test\nor the wilcoxon two-sample test. all the assumptions of the linear model\nother than independence of residuals are captured in the following, using the\nmore standard y \u2264 y notation:\n\nf (y|x) = prob[y \u2264 y|x] = \u03c6(\n\n\u22121(f (y|x)) =\n\u03c6\n\ny \u2212 x\u03b2\n\n\u03c3\ny \u2212 x\u03b2\n\n\u03c3\n\n)\n\n(15.8)\n\n(15.9)\n\non the other hand, ordinal models assume the following:\n\n\u03c6\u22121(f(y|x))\n\n\u2212 \u03b4x\u03b2 \u03c3\n\n\u03c6\u22121(f(y|x))\nlogit(f(y|x))\n\n\u2212 \u03b4x\u03b2\n\ny\n\ny\n\nfig. 15.1 assumptions of the linear model (left panel) and semiparametric ordi-\nnal probit or logit (proportional odds) models (right panel). ordinal models do not\nassume any shape for the distribution of y for a given x; they only assume paral-\nlelism. the linear model can relax the parallelism assumption if \u03c3 is allowed to vary,\nbut in practice it is difficult to know how to vary it except for the unequal variance\ntwo-sample t-test.\n\nprob[y \u2264 y|x] = f (g(y) \u2212 x\u03b2),\n\n(15.10)\n\nwhere g is unknown and may be discontinuous. this translates to the paral-\nlelism assumption in the right panel of figure 15.1, whereas the linear model\n\n "}, {"Page_number": 386, "text": "15.5 dataset and descriptive statistics\n\n365\n\nmakes the additional strong assumption of linearity of normal inverse cu-\nmulative distribution function, which arises from the gaussian distribution\nassumption.\n\n15.5 dataset and descriptive statistics\n\ndiabetes mellitus (dm) type ii (adult onset diabetes) is strongly associ-\nated with obesity. the currently best laboratory test for diabetes measures\nglycosylated hemoglobin (hba1c), also called glycated hemoglobin, glycohe-\nmoglobin, or hemoglobin a1c. hba1c reflects average blood glucose for the\npreceding 60 to 90 days. hba1c > 7.0 is sometimes taken as a positive di-\nagnosis of diabetes even though there are no data to support the use of a\nthreshold.\n\nthe goals of this analyses are to better understand effects of body size\nmeasurements on risk of dm and to enhance screening for dm. the best way\nto develop a model for dm screening is not to fit a binary logistic model\nwith hba1c > 7 as the response variable. there are at least two reasons for\nthis. first, when the relationship between a measurement and its ultimate\nclinical impact is smooth, all cutpoints are arbitrary. there is no justification\nfor any putative cut on hba1c. second, such an analysis loses information by\ntreating hba1c=2 the same as hba1c=6.9, and by treating hba1c=7.1 as\nequal to hba1c=10. failure to use all available information results in larger\nstandard errors of \u02c6\u03b2, lower power, and wider confidence bands. it is better to\npredict continuous hba1c using a continuous response model, then use that\nmodel to estimate the probability that hba1c exceeds any cutoff, or estimate\nthe 0.9 quantile of hba1c.\n\nthe data used here are from the national health and nutrition examina-\ntion survey (nhanes) 2009\u20132010 from the u.s. national center for health\nstatistics/centers for disease control. the original data may be obtained\nfrom http://www.cdc.gov/nchs/nhanes.htm94; the analysis file used here,\ncalled nhgh, may be obtained from the datasets wiki page, along with r code\nused to download and create the file. note that cdc coded age \u2265 80 as 80.\nwe use the subset of subjects with age \u2265 21 who have neither been diagnosed\nnor treated for dm. descriptive statistics are shown below.\n\nrequire ( rms )\n\ngethdata ( nhgh )\n\nw \u2190 subset ( nhgh , age \u2265 21 & dx ==0 & tx ==0 , select = -c ( dx , tx ))\nlatex ( describe ( w ) , file = ' ' )\n\n "}, {"Page_number": 387, "text": "366 15 regression models for continuous y and case study in ordinal regression\n\n18 variables\n\nw\n4629 observations\n\nseqn : respondent sequence number\n.05\n\nn missing unique info mean\n\n4629\n\n0\n\n4629\n\n.95\n1 56902 52136 52633 54284 56930 59495 61079 61641\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\nlowest : 51624 51629 51630 51645 51647\nhighest: 62152 62153 62155 62157 62158\n\nsex\n\nn missing unique\n2\n\n0\n\n4629\n\nmale (2259, 49%), female (2370, 51%)\n\nage : age [years]\n\nn missing unique info mean\n\n.95\n1 48.57 23.33 26.08 33.92 46.83 61.83 74.83 80.00\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n4629\n\n0\n\n703\n\nlowest : 21.00 21.08 21.17 21.25 21.33\nhighest: 79.67 79.75 79.83 79.92 80.00\n\nre : race/ethnicity\n\nn missing unique\n5\n\n0\n\n4629\n\nmexican american (832, 18%), other hispanic (474, 10%)\nnon-hispanic white (2318, 50%), non-hispanic black (756, 16%)\nother race including multi-racial (249, 5%)\n\nincome : family income\n\nn missing unique\n14\n\n240\n\n4389\n\n[0,5000) (162, 4%), [5000,10000) (216, 5%), [10000,15000) (371, 8%)\n[15000,20000) (300, 7%), [20000,25000) (374, 9%)\n[25000,35000) (535, 12%), [35000,45000) (421, 10%)\n[45000,55000) (346, 8%), [55000,65000) (257, 6%), [65000,75000) (188, 4%)\n> 20000 (149, 3%), < 20000 (52, 1%), [75000,100000) (399, 9%)\n>= 100000 (619, 14%)\n\nwt : weight [kg]\n\nn missing unique info mean\n\n.95\n1 80.49 52.44 57.18 66.10 77.70 91.40 106.52 118.00\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n4629\n\n0\n\n890\n\nlowest :\n38.7\nhighest: 184.3 186.9 195.3 196.6 203.0\n\n37.9\n\n38.5\n\n36.1\n\n33.2\n\nht : standing height [cm]\n\nn missing unique info mean\n\n.95\n1 167.5 151.1 154.4 160.1 167.2 175.0 181.0 184.8\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n4629\n\n0\n\n512\n\nlowest : 123.3 135.4 137.5 139.4 139.8\nhighest: 199.2 199.3 199.6 201.7 202.7\n\n "}, {"Page_number": 388, "text": "15.5 dataset and descriptive statistics\n\n367\n\nbmi : body mass index [kg/m2]\nn missing unique info mean\n\n4629\n\n0\n\n1994\n\n.95\n1 28.59 20.02 21.35 24.12 27.60 31.88 36.75 40.68\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\nlowest : 13.18 14.59 15.02 15.40 15.49\nhighest: 61.20 62.81 65.62 71.30 84.87\n\nleg : upper leg length [cm]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 38.39 32.0 33.5 36.0 38.4 41.0 43.3 44.6\n\n155\n\n216\n\n4474\n\nlowest : 20.4 24.9 25.0 25.1 26.4, highest: 49.0 49.5 49.8 50.0 50.3\n\narml : upper arm length [cm]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 37.01 32.6 33.5 35.0 37.0 39.0 40.6 41.7\n\n156\n\n127\n\n4502\n\nlowest : 24.8 27.0 27.5 29.2 29.5, highest: 45.2 45.5 45.6 46.0 47.0\n\narmc : arm circumference [cm]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 32.87 25.4 26.9 29.5 32.5 35.8 39.1 41.4\n\n290\n\n130\n\n4499\n\nlowest : 17.9 19.0 19.3 19.5 19.9, highest: 54.2 54.9 55.3 56.0 61.0\n\nwaist : waist circumference [cm]\n\nn missing unique info mean .05 .10 .25 .50\n\n.95\n1 97.62 74.8 78.6 86.9 96.3 107.0 117.8 125.0\n\n.75\n\n.90\n\n4465\n\n164\n\n716\n\nlowest :\n62.4\nhighest: 160.0 160.6 162.2 162.7 168.7\n\n61.5\n\n62.0\n\n59.7\n\n60.0\n\ntri : triceps skinfold [mm]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 18.94 7.2 8.8 12.0 18.0 25.2 31.0 33.8\n\n342\n\n334\n\n4295\n\nlowest :\n\n2.6\n\n3.1\n\n3.2\n\n3.3\n\n3.4, highest: 39.6 39.8 40.0 40.2 40.6\n\nsub : subscapular skinfold [mm]\n\nn missing unique info mean .05\n\n.95\n1 20.8 8.60 10.30 14.40 20.30 26.58 32.00 35.00\n\n.25\n\n.75\n\n.50\n\n.90\n\n.10\n\n3974\n\n655\n\n329\n\nlowest :\n\n3.8\n\n4.2\n\n4.6\n\n4.8\n\n4.9, highest: 40.0 40.1 40.2 40.3 40.4\n\ngh : glycohemoglobin [%]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n63 0.99 5.533 4.8 5.0 5.2 5.5 5.8 6.0 6.3\n\n0\n\n4629\n\nlowest :\n\n4.0\n\n4.1\n\n4.2\n\n4.3\n\n4.4, highest: 11.9 12.0 12.1 12.3 14.5\n\nalbumin : albumin [g/dl]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n26 0.99 4.261 3.7 3.9 4.1 4.3 4.5 4.7 4.8\n\n53\n\n4576\n\nlowest : 2.6 2.7 3.0 3.1 3.2, highest: 4.9 5.0 5.1 5.2 5.3\n\n "}, {"Page_number": 389, "text": "368 15 regression models for continuous y and case study in ordinal regression\n\nbun : blood urea nitrogen [mg/dl]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n8 10 12 15 19 22\n\n50 0.99 13.03\n\n53\n\n7\n\n4576\n\nlowest :\n\n1 2\n\n3 4 5, highest: 49 53 55 56 63\n\nscr : creatinine [mg/dl]\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 0.8887 0.58 0.62 0.72 0.84 0.99 1.14 1.25\n\n167\n\n53\n\n4576\n\nlowest :\nhighest:\n\n0.34\n5.98\n\n0.38\n6.34\n\n0.39\n0.41\n9.13 10.98 15.66\n\n0.40\n\ndd \u2190 datadist ( w ); options ( datadist = ' dd ' )\n\n15.5.1 checking assumptions of ols\n\nand other models\n\nfirst let\u2019s see if gh would make a gaussian residuals model fit. use ordinary\nregression on four key variables to collapse these into one variable (predicted\nmean from the ols model). stratify the predicted means into six quantile\n\u22121 to the\ngroups. apply the normal inverse cumulative distribution function \u03c6\nempirical cumulative distribution functions (ecdf) of gh using these strata,\nand check for normality and constant \u03c32. the ecdf estimates prob[y \u2264\ny|x] but for ordinal modeling we want to state models in terms of prob[y \u2265\ny|x] so take one minus the ecdf before inverse transforming.\nf \u2190 ols ( gh \u223c rcs ( age ,5) + sex + re + rcs ( bmi , 3) , data = w )\npgh \u2190 fitted (f )\np \u2190 function ( fun , row , col ) {\n\nf \u2190 substitute ( fun ); g \u2190 function ( f ) eval ( f )\nz \u2190 ecdf (\u223c gh , groups = cut2 ( pgh , g =6) ,\n\nfun = function ( f ) g (1 - f ) ,\nylab = a s . e x p r e s s i o n ( f ) , xlim = c (4 .5 , 7 .75 ) , data =w ,\nlabel.curv e = false )\n\nprint (z , split = c ( col , row , 2 , 2) , more = row < 2 | col < 2)\n\n}\n1 , 1)\np ( log ( f / (1 -f )) ,\n1 , 2)\np ( qnorm ( f ) ,\n2 , 1)\np ( -log ( -log ( f )) ,\np ( log ( -log (1 -f )) , 2 , 2)\n# get slopes of pgh for some cutoffs of y\n# use glm complementary log-log link on prob (y < cutoff) to\n# get log-log link on prob (y \u2265 cutoff)\nr \u2190 null\nfor ( link in c ( ' logit ' , ' probit ' , ' cloglog ' ))\n\nfor ( k in c (5 , 5 .5 , 6)) {\n\nco \u2190 coef ( glm ( gh < k \u223c pgh , data =w , family = binomial ( link )))\n\n "}, {"Page_number": 390, "text": "15.5 dataset and descriptive statistics\n\n369\n\nr \u2190 rbind (r , data.frame ( link = link , cutoff =k ,\n\nslope = round ( co [2] ,2)))\n\n}\nprint (r , row.names = false )\n\nlink cutoff slope\n5.0 -3.39\n5.5 -4.33\n6.0 -5.62\n5.0 -1.69\n5.5 -2.61\n6.0 -3.07\n5.0 -3.18\n5.5 -2.97\n6.0 -2.51\n\nlogit\nlogit\nlogit\nprobit\nprobit\nprobit\ncloglog\ncloglog\ncloglog\n\n \n\n)\n)\nf\n\u2212\n \n1\n(\nf\n(\ng\no\n\n/\n\nl\n\n)\n)\nf\n(\ng\no\n\nl\n\n \n\n\u2212\n(\ng\no\n\nl\n\n \n\n\u2212\n\n5\n\n0\n\n\u22125\n\n6\n\n4\n\n2\n\n0\n\n\u22122\n\n)\nf\n(\n\n \n\nm\nr\no\nn\nq\n\n5.0 5.5 6.0 6.5 7.0 7.5\n\nglycohemoglobin, %\n\n \n\n)\n)\nf\n\u2212\n \n1\n(\ng\no\n\nl\n\n \n\n\u2212\n(\n\n \n\ng\no\n\nl\n\n5.0 5.5 6.0 6.5 7.0 7.5\n\nglycohemoglobin, %\n\n2\n\n0\n\n\u22122\n\n2\n\n0\n\n\u22122\n\n\u22124\n\n\u22126\n\n5.0 5.5 6.0 6.5 7.0 7.5\n\nglycohemoglobin, %\n\n5.0 5.5 6.0 6.5 7.0 7.5\n\nglycohemoglobin, %\n\nfig. 15.2 examination of normality and constant variance assumption, and assump-\ntions for various ordinal models\n\n "}, {"Page_number": 391, "text": "370 15 regression models for continuous y and case study in ordinal regression\n\nthe upper right curves in figure 15.2 are not linear, implying that a normal\nconditional distribution cannot work for ghi there is non-parallelism for the\nlogit model. the other graphs will be used to guide selection of an ordinal\nmodel below.\n\n15.6 ordinal regression applied to hba1c\n\nin the upper left panel of figure 15.2, logit inverse curves are not parallel\nso the proportional odds assumption does not hold when predicting hba1c.\nthe log-log link yields the highest degree of parallelism and most constant\nregression coefficients across cutoffs of gh, so we use this link in an ordinal\nregression model (linearity of the curves is not required).\n\n15.6.1 checking fit for various models using age\n\nanother way to examine model fit is to flexibly fit the single most important\npredictor (age) using a variety of methods, and compare predictions to sample\nquantiles and means based on subsets on age. we use overlapping subsets\nto gain resolution, with each subset composed of those subjects having age\nwithin five years of the point being predicted by the models. here we predict\nthe 0.5, 0.75, and 0.9 quantiles and the mean. for quantiles we can compare\nto quantile regression (discussed below) and for means we compare to ols.\nag \u2190 25:75\nlag \u2190 length ( ag )\nq2 \u2190 q3 \u2190 p90 \u2190 means \u2190 numeric ( lag )\n\nfor ( i in 1: lag ) {\n\ns \u2190 which ( abs ( w $ age - ag [ i ]) < 5)\ny \u2190 w $ gh [ s ]\na \u2190 quantile (y , probs = c ( .5 , .75 , .9 ))\n\nq2 [ i ]\nq3 [ i ]\n\n\u2190 a [1]\n\u2190 a [2]\np90 [ i ] \u2190 a [3]\nmeans [ i ] \u2190 mean ( y )\n\n}\n\n\u2190 er \u2190 list ()\n\nfams \u2190 c ( ' logistic ' , ' probit ' , ' loglog ' , ' cloglog ' )\nfe \u2190 function ( pred , target ) mean ( abs ( pred $ yhat - target ))\nmod \u2190 gh \u223c rcs ( age ,6)\np\nfor ( est in c ( ' q2 ' , ' q3 ' , ' p90 ' , ' mean ' )) {\nmeth \u2190 if ( est == ' mean ' ) ' ols ' else ' qr '\np \u2190 list ()\ner \u2190 rep ( na , 5)\nnames ( er ) \u2190 c ( fams , meth )\n\nfor ( family in fams ) {\n\nh \u2190 orm ( mod , family = family , data = w )\nfun \u2190 if ( est == ' mean ' ) mean ( h )\n\nelse {\n\nqu \u2190 quantile ( h )\n\ni they are not parallel either.\n\n "}, {"Page_number": 392, "text": "15.6 ordinal regression applied to hba1c\n\n371\n\nswitch ( est , q2\nq3\np90 = function ( x ) qu ( .9 ,\n\nx ) ,\n= function ( x ) qu ( .5 ,\n= function ( x ) qu ( .75 , x ) ,\nx ))\n\n}\n\np [[ family ]] \u2190 z \u2190 predict (h , age = ag , fun = fun , conf.int = false )\ner [ family ] \u2190 fe (z , switch ( est , mean = means , q2 = q2 , q3 = q3 , p90 = p90 ))\n\n}\n\nh \u2190 switch ( est ,\n\nmean = ols ( mod , data = w ) ,\n= rq ( mod , data = w ) ,\nq2\nq3\n= rq ( mod , tau =0 .75 , data = w ) ,\np90 = rq ( mod , tau =0 .90 , data = w ))\n\np [[ meth ]] \u2190 z \u2190 predict (h , age = ag , conf.int = false )\ner [ meth ] \u2190 fe (z , switch ( est , mean = means , q2 = q2 , q3 = q3 , p90 = p90 ))\ner [[ est ]] \u2190 er\npr \u2190 do.call ( ' rbind ' , p )\npr $ est \u2190 est\np \u2190 r b i n d . d a t a . f r a m e(p , pr )\n\n}\n\nxyplot ( yhat \u223c age | est , groups = .set. , data =p , type = ' l ' , #\n\nf i g u r e 15.3\n\nauto.key = list ( x = .75 , y = .2 , points = false , lines = true ) ,\npanel = function ( ... , s u b s c r i p t s) {\n\np a n e l . x y p l o t( ... , s u b s c r i p t s= s u b s c r i p t s)\n\nest \u2190 p $ est [ s u b s c r i p t s[1]]\n\nlpoints ( ag , switch ( est , mean = means , q2 = q2 , q3 = q3 , p90 = p90 ) ,\n\ncol = gray ( .7 ))\n\ner \u2190 format ( round ( er [[ est ]] ,3) , nsmall =3)\nltext (26 , 6 .15 , paste ( names ( er ) , collapse = ' \\ n ' ) ,\n\ncex = .7 , adj =0)\n\nltext (40 , 6 .15 , paste ( er , collapse = ' \\ n ' ) ,\n\ncex = .7 , adj =1)})\n\nit can be seen in figure 15.3 that models dedicated to a specific task\n(quantile regression for quantiles and ols for means) were best for those\ntasks. although the log-log ordinal cumulative probability model did not\nestimate the median as accurately as some other methods, it does well for\nthe 0.75 and 0.9 quantiles and is the best compromise overall because of\nits ability to also directly predict the mean as well as quantities such as\n\nprob[hba1c > 7|x].\n\nfrom here on we focus on the log-log ordinal model. returning to the\nbottom left of figure 15.2, let\u2019s look at quantile groups of predicted hba1c\nby ols and plot predicted distributions of actual hba1c against empirical\ndistributions.\nw $ pghg \u2190 cut2 ( pgh , g =6)\nf \u2190 orm ( gh \u223c pghg , data = w )\nlp \u2190 predict (f , newdata = data.frame ( pghg = levels (w $ pghg )))\nep \u2190 exprob ( f )\nz \u2190 ep ( lp )\nj \u2190 order ( w $ pghg )\nplot (z , xlim = c (4 , 7 .5 ) , data = w [j , c ( ' pghg ' , ' gh ' )]) # fig. 15.4\n\n# exceedance prob. functn. generator in rms\n\n# puts in order of lp ( levels of pghg )\n\nagreement between predicted and observed exceedance probability distribu-\ntions is excellent in figure 15.4.\n\n "}, {"Page_number": 393, "text": "372 15 regression models for continuous y and case study in ordinal regression\n\nq2\n\nlogistic\nprobit\nloglog\ncloglog\nqr\n\n0.048\n0.052\n0.058\n0.072\n0.024\n\n30\n\n40\n\n50\n\nq3\n\n60\n\n70\n\nlogistic\nprobit\nloglog\ncloglog\nqr\n\n0.050\n0.045\n0.037\n0.077\n0.027\n\n6.2\n\n6.0\n\n5.8\n\n5.6\n\n5.4\n\n5.2\n\nt\na\nh\ny\n\nmean\n\np90\n\nlogistic\nprobit\nloglog\ncloglog\nols\n\n0.021\n0.025\n0.026\n0.033\n0.013\n\nlogistic\nprobit\nloglog\ncloglog\nqr\n\n0.053\n0.047\n0.041\n0.101\n0.030\n\n6.2\n\n6.0\n\n5.8\n\n5.6\n\n5.4\n\n5.2\n\nlogistic\nprobit\nloglog\ncloglog\nqr\nols\n\n30\n\n40\n\n50\n\n60\n\n70\n\nage\n\nfig. 15.3 three estimated quantiles and estimated mean using 6 methods, compared\nagainst caliper-matched sample quantiles/means (circles). numbers are mean abso-\nlute differences between predicted and sample quantities using overlapping intervals\nof age and caliper matching. qr:quantile regression.\n\nto return to the initial look at a linear model with assumed gaussian\nresiduals, fit a probit ordinal model and compare the estimated intercepts to\nthe linear relationship with gh that is assumed by the normal distribution.\nf \u2190 orm ( gh \u223c rcs ( age ,6) , family = probit , data = w )\ng \u2190 ols ( gh \u223c rcs ( age ,6) , data = w )\ns \u2190 g $ stats [ ' sigma ' ]\nyu \u2190 f $ yunique [ -1 ]\nr \u2190 quantile (w $ gh , c ( .005 , .995 ))\nalphas \u2190 coef ( f )[1: n u m . i n t e r c e p t s ( f )]\nplot ( -yu / s , alphas , type = ' l ' , xlim = rev ( - r / s ) , # fig. 15.5\nxlab = expressio n ( -y / hat ( sigma )) , ylab = expressio n ( alpha [ y ]))\n\nfigure 15.5 depicts a significant departure from the linear form implied by\ngaussian residuals (eq. 15.4).\n\n "}, {"Page_number": 394, "text": "15.6 ordinal regression applied to hba1c\n\n373\n\n[4.88,5.29)\n[5.29,5.44)\n[5.44,5.56)\n[5.56,5.66)\n[5.66,5.76)\n[5.76,6.48]\n\n \n\n)\ny\n\u2265\n \ny\n(\nb\no\nr\np\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n4.0\n\n4.5\n\n5.0\n\n5.5\n\n6.0\n\n6.5\n\n7.0\n\n7.5\n\ngh\n\nfig. 15.4 observed (dashed lines, open circles) and predicted (solid lines, closed cir-\ncles) exceedance probability distributions from a model using 6-tiles of ols-predicted\nhba1c. key shows quantile group intervals of predicted mean hba1c.\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n\u22125\n\ny\n\n \n\n\u03b1\n\n\u221214\n\n\u221212\n\u2212y \u03c3^\n\n\u221210\n\n\u22128\n\nfig. 15.5 estimated intercepts from probit model. linearity would have indicated\ngaussian residuals.\n\n "}, {"Page_number": 395, "text": "374 15 regression models for continuous y and case study in ordinal regression\n\n15.6.2 examination of bmi\n\nbody mass index (bmi, weight divided by height2) is commonly used as an\nobesity measure because it is well correlated with abdominal visceral fat.\nbut it is not obvious that bmi is the correct summary of height and weight\nfor predicting pre-clinical diabetes, and it may be the case that body size\nmeasures other than height and weight are better predictors.\n\nuse the log-log ordinal model to check the adequacy of bmi, adjusting for\nage (without assuming linearity). this can be done by examining the ratio\nof coefficients of log height and log weight, and also by using aic to judge\nwhether bmi is an adequate summary of height and weight when compared\nto nonlinear functions of the logs, and to a tensor spline interaction surface.\nf \u2190 orm ( gh \u223c rcs ( age ,5) + log ( ht ) + log ( wt ) ,\n\nfamily = loglog , data = w )\n\nprint (f , latex = true )\n\n-log-log ordinal regression model\n\norm(formula = gh ~ rcs(age, 5) + log(ht) + log(wt), data = w,\n\nfamily = loglog)\n\nmodel likelihood\n\ndiscrimination\n\nrank discrim.\n\nratio test\n\nindexes\n\n1126.94 r2\n\n6 g\n5.5 pr(> \u03c72) < 0.0001 gr\n\n4629 lr \u03c72\n\nobs\nunique y 63 d.f.\ny0.5\nmax| \u2202 log l\n\u2202\u03b2 | score \u03c72\n\u22126\n\n1\u00d710\n\npr(> \u03c72) < 0.0001\n\n1262.81 |pr(y \u2265 y0.5) \u2212 1\n\n2\n\nindexes\n\n0.486\n\n0.217 \u03c1\n0.627\n1.872\n| 0.153\n\ncoef\n0.0398 0.0055\nage\nage\u2019\n-0.0158 0.0275\nage\u201d -0.0072 0.0866\nage\u201d\u2019 0.0309 0.1135\n-3.0680 0.2789\nht\nwt\n1.2748 0.0704\n\ns.e. wald z pr(> |z|)\n7.29 < 0.0001\n0.5657\n-0.57\n-0.08\n0.9333\n0.7853\n0.27\n-11.00 < 0.0001\n18.10 < 0.0001\n\naic \u2190 null\nfor ( mod in list ( gh \u223c rcs ( age ,5) + rcs ( log ( bmi ) ,5) ,\n\ngh \u223c rcs ( age ,5) + rcs ( log ( ht ) ,5) + rcs ( log ( wt ) ,5) ,\ngh \u223c rcs ( age ,5) + rcs ( log ( ht ) ,4) * rcs ( log ( wt ) ,4)))\n\naic \u2190 c ( aic , aic ( orm ( mod , family = loglog , data = w )))\n\nprint ( aic )\n\n[1] 25910.77 25910.17 25906.03\n\n "}, {"Page_number": 396, "text": "15.6 ordinal regression applied to hba1c\n\n375\n\nthe ratio of the coefficient of log height to the coefficient of log weight is -\n2.4, which is between what bmi uses and the more dimensionally reasonable\nweight / height3. by aic, a spline interaction surface between height and\nweight does slightly better than bmi in predicting hba1c, but a nonlinear\nfunction of bmi is barely worse. it will require other body size measures to\ndisplace bmi as a predictor.\n\nas an aside, compare this model fit to that from the cox proportional\nhazards model. the cox model uses a conditioning argument to obtain\na partial likelihood free of the intercepts \u03b1 (and requires a second step to\nestimate these log discrete hazard components) whereas we are using a full\nmarginal likelihood of the ranks of y 330.\nprint ( cph ( surv ( gh ) \u223c rcs ( age ,5) + log ( ht ) + log ( wt ) , data = w ) ,\n\nlatex = true )\n\ncox proportional hazards model\n\ncph(formula = surv(gh) ~ rcs(age, 5) + log(ht)\n\n+ log(wt), data = w)\n\nmodel tests discrimination\n\nindexes\n\n1120.20 r2\n6 dxy\n\n4629 lr \u03c72\n4629 d.f.\n\nobs\nevents\ncenter 8.3792 pr(> \u03c72) 0.0000 g\nscore \u03c72 1258.07 gr\npr(> \u03c72) 0.0000\n\n0.215\n0.359\n0.622\n1.863\n\ncoef\n-0.0392 0.0054\nage\n0.0148 0.0274\nage\u2019\nage\u201d\n0.0093 0.0862\nage\u201d\u2019 -0.0321 0.1131\n3.0477 0.2779\nht\nwt\n-1.2653 0.0701\n\ns.e. wald z pr(> |z|)\n-7.24 < 0.0001\n0.54\n0.5888\n0.9144\n0.11\n-0.28\n0.7767\n10.97 < 0.0001\n-18.04 < 0.0001\n\nclose agreement of the two is seen, as expected.\n\n15.6.3 consideration of all body size measurements\n\nnext we examine all body size measures, and check their redundancies.\nv \u2190 varclus (\u223c wt + ht + bmi + leg + arml + armc + waist +\n\ntri + sub + age + sex + re , data = w )\n\nplot ( v )\n\n "}, {"Page_number": 397, "text": "376 15 regression models for continuous y and case study in ordinal regression\n\n# omit wt so it won ' t be r e m o v e d b e f o r e bmi\nredun (\u223c ht + bmi + leg + arml + armc + waist + tri + sub ,\n\ndata =w , r2 = .75 )\n\nr e d u n d a n c y analysis\n\nredun ( formula = \u223cht + bmi + leg + arml + armc + waist + tri +\n\nsub , data = w , r2 = 0.75)\n\nn : 3853\n\np : 8\n\nnk : 3\n\nnumber of nas :\nf r e q u e n c i e s of missing values due to each variable\n\n776\n\nht\n0\n\nbmi\n0\n\nleg\n155\n\narml\n127\n\narmc waist\n164\n\n130\n\ntri\n334\n\nsub\n655\n\nt r a n s f o r m a t i o n of target v a r i a b l e s forced to be linear\n\nr2 cutoff : 0.75\n\ntype : ordinary\n\nr2 with which each variable can be p r e d i c t e d from all other v a r i a b l e s:\n\nht\n\nsub\n0.829 0.924 0.682 0.748 0.843 0.864 0.531 0.594\n\narmc waist\n\narml\n\nbmi\n\nleg\n\ntri\n\nr e n d u n d a n t v a r i a b l e s:\n\nbmi ht\n\np r e d i c t e d from v a r i a b l e s:\n\nleg arml armc waist tri sub\n\nvariable deleted\n\nr2 r2 after later d e l e t i o n s\n\n1\n2\n\nbmi 0.924\nht 0.792\n\n0.909\n\nsix size measures adequately capture the entire set. height and bmi are\nremoved (figure 15.6). an advantage of removing height is that it is age-\ndependent due to vertebral compression in the elderly:\nf \u2190 orm ( ht \u223c rcs ( age ,4) * sex , data = w )\nqu \u2190 quantile ( f ); med \u2190 function ( x ) qu ( .5 , x )\n\n# p r o p . odds m o d e l\n\nggplot ( predict (f , age , sex , fun = med , conf.int = false ),\n\nylab = ' predicted median height , cm ' )\n\nhowever, upper leg length has the same declining trend, implying a survival\n\nbias or birth year effect.\n\nin preparing to create a multivariable model, degrees of freedom are allo-\n\ncated according to the generalized spearman \u03c12(figure 15.7)j.\ns \u2190 spearman2 ( gh \u223c age + sex + re + wt + leg + arml + armc +\n\nwaist + tri + sub , data =w , p =2)\n\nplot ( s )\n\nparameters will be allocated in descending order of \u03c12. but note that\nsubscapular skinfold has a large number of nas and other predictors also have\nnas. suboptimal casewise deletion will be used until the final model is fitted\n(figure 15.8).\n\nj competition between collinear size measures hurts interpretation of partial tests of\nassociation in a saturated additive model.\n\n "}, {"Page_number": 398, "text": "15.6 ordinal regression applied to hba1c\n\n377\n\n2\n\u03c1\n \nn\na\nm\nr\na\ne\np\ns\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\ni\nr\nt\n\nb\nu\ns\n\nl\n\ne\na\nm\ne\nf\nx\ne\ns\n\ng\ne\n\nl\n\nt\n\nh\n\nl\n\nm\nr\na\n\ni\n\nm\nb\n\ni\n\nt\ns\na\nw\n\nt\n\nw\n\nc\nm\nr\na\n\ni\n\nc\nn\na\np\ns\nh\n\ni\n\n \nr\ne\nh\no\ne\nr\n\nt\n\ne\n\nt\ni\n\ni\n\nh\nw\n \nc\nn\na\np\ns\nh\n\u2212\nn\no\nn\ne\nr\n\ni\n\nl\n\ni\n\nk\nc\na\nb\n \nc\nn\na\np\ns\nh\n\u2212\nn\no\nn\ne\nr\n\ni\n\ne\ng\na\n\nl\n\ni\n\na\nc\na\nr\n\u2212\n\ni\nt\nl\n\n \n\nu\nm\ng\nn\nd\nu\nc\nn\n\nl\n\ni\n\ni\n \n\ne\nc\na\nr\n\n \nr\ne\nh\no\ne\nr\n\nt\n\nfig. 15.6 variable clustering for all potential predictors\n\n180\n\nm\nc\n \n,\nt\n\n175\n\ni\n\ni\n\n \n\nh\ng\ne\nh\nn\na\nd\ne\nm\nd\ne\nt\nc\nd\ne\nr\np\n\n \n\ni\n\n170\n\n165\n\n160\n\n155\n\n20\n\nsex\n\nmale\n\nfemale\n\n80\n\n40\n\n60\n\nage, years\n\nfig. 15.7 estimated median height as a smooth function of age, allowing age to\ninteract with sex, from a proportional odds model\n\nbecause there are many competing body measures, we use backwards step-\ndown to arrive at a set of predictors. the bootstrap will be used to penal-\nize predictive ability for variable selection. first the full model is fit using\ncasewise deletion, then we do a composite test to assess whether any of the\nfrequently\u2013missing predictors is important.\nf \u2190 orm ( gh \u223c rcs ( age ,5) + sex + re + rcs ( wt ,3) + rcs ( leg ,3) + arml +\n\nrcs ( armc ,3) + rcs ( waist ,4) + tri + rcs ( sub ,3) ,\nfamily = ' loglog ' , data =w , x = true , y = true )\n\nprint (f , latex = true , coefs = false )\n\n "}, {"Page_number": 399, "text": "378 15 regression models for continuous y and case study in ordinal regression\n\nspearman \u03c12\n\nresponse : gh\n\nage\nwaist\nleg\nsub\narmc\nwt\nre\ntri\narml\nsex\n\nn  df\n4629 2\n4465 2\n4474 2\n3974 2\n4499 2\n4629 2\n4629 4\n4295 2\n4502 2\n4629 1\n\n0.00\n\n0.05\n\n0.10\n\n0.15\n\n0.20\n\nadjusted \u03c12\n\nfig. 15.8 generalized squared rank correlations\n\n-log-log ordinal regression model\n\norm(formula = gh ~ rcs(age, 5) + sex + re + rcs(wt, 3)\n\n+ rcs(leg, 3) + arml + rcs(armc, 3) + rcs(waist, 4)\n+ tri + rcs(sub, 3), data = w, x = true, y = true,\nfamily = \"loglog\")\n\nfrequencies of missing values due to each variable\nn\n655\n334\n164\n155\n130\n127\n0\n0\n0\n0\n0\n\nsub\ntri\nwaist\nleg\narmc\narml\ngh\nage\nsex\nre\nwt\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n700\n\n "}, {"Page_number": 400, "text": "15.6 ordinal regression applied to hba1c\n\n379\n\nmodel likelihood\n\ndiscrimination\n\nrank discrim.\n\nratio test\n\nindexes\n\n1180.13 r2\n\n22 g\n5.5 pr(> \u03c72) < 0.0001 gr\n\n3853 lr \u03c72\n\nobs\nunique y 60 d.f.\ny0.5\nmax| \u2202 log l\n\u2202\u03b2 | score \u03c72\n\u22125\n\n3\u00d710\n\npr(> \u03c72) < 0.0001\n\n1298.88 |pr(y \u2265 y0.5) \u2212 1\n\n2\n\nindexes\n\n0.520\n\n0.265 \u03c1\n0.732\n2.080\n| 0.172\n\n# #\n\nc o m p o s i t e\n\nlan \u2190 function ( a ) latex (a , t a b l e . e n v= false , file = ' ' )\n\nt e s t :\n\nlan ( anova (f , leg , arml , armc , waist , tri , sub ))\n\nleg\n\nnonlinear\n\nnonlinear\n\narml\narmc\n\n\u03c72\n8.30\n3.32\n0.16\n6.66\n3.29\n29.40\n4.29\n16.62\n40.75\n4.50\ntotal nonlinear 14.95\ntotal\n\np\nd.f.\n0.0158\n2\n0.0685\n1\n0.6924\n1\n0.0358\n2\n0.0695\n1\n3 < 0.0001\n2\n0.1171\n1 < 0.0001\n2 < 0.0001\n0.0340\n1\n5\n0.0106\n128.29 11 < 0.0001\n\nnonlinear\n\nnonlinear\n\ntri\nsub\n\nwaist\n\nthe model achieves spearman \u03c1 = 0.52, the rank correlation between\n\npredicted and observed hba1c.\n\nwe show the predicted mean and median hba1c as a function of age,\nadjusting other variables to their median or mode (figure 15.9). compare the\nestimate of the median and 90th percentile with that from quantile regression.\n\nm\nqu\nmed\np90\nfq\nfq90\n\n\u2190 mean ( f )\n\u2190 quantile ( f)\n\u2190 function ( x) qu ( .5 , x )\n\u2190 function ( x) qu ( .9 , x )\n\u2190 rq ( formula (f ), data = w )\n\u2190 rq ( formula (f ), data =w , tau = .9 )\n\npmed\np90\n\npmean \u2190 predict (f ,\n\u2190 predict (f ,\n\u2190 predict (f ,\npmedqr \u2190 predict ( fq ,\np90qr \u2190 predict ( fq90 , age , conf.int = false )\nz \u2190 rbind ( ' orm mean ' = pmean , ' orm median ' = pmed , ' orm p90 ' = p90 ,\nggplot (z , groups = ' .set. ' ,\n\nage , fun =m ,\nconf.int = false )\nage , fun = med , conf.int = false )\nage , fun = p90 , conf.int = false )\nage , conf.int = false )\n\n' qr median ' = pmedqr , ' qr p90 ' = p90qr )\n\nadj.subtitle = false , legend.label = false )\n\n "}, {"Page_number": 401, "text": "380 15 regression models for continuous y and case study in ordinal regression\n\nprint ( fastbw (f , rule = ' p ' ), estimates = false )\n\n6.00\n\n5.75\n\n5.50\n\n5.25\n\norm mean\n\norm median\n\norm p90\n\nqr median\n\nqr p90\n\n5.00\n\n20\n\n40\n\n60\n\n80\n\nage, years\n\nfig. 15.9 estimated mean and 0.5 and 0.9 quantiles from the log-log ordinal model\nusing casewise deletion, along with predictions of 0.5 and 0.9 quantiles from quantile\nregression (qr). age is varied and other predictors are held constant to medians/-\nmodes.\n\ndeleted chi - sq d . f . p\narml\nsex\nwt\narmc\n\n0.16\n0.45\n5.72\n3.32\n\n1\n1\n2\n2\n\n0.6924 0.16\n0.5019 0.61\n0.0572 6.33\n0.1897 9.65\n\nresidual d . f . p\n\naic\n\n1\n2\n4\n6\n\n0.6924 -1.84\n0.7381 -3.39\n0.1759 -1.67\n0.1400 -2.35\n\nfactors in final model\n\n[1] age\n\nre\n\nleg\n\nwaist tri\n\nsub\n\nset.seed (13)\n\nv \u2190 validate (f , b =100 , bw = true , estimates = false , rule = ' p ' )\n\n# so can r e p r o d u c e r e s u l t s\n\n "}, {"Page_number": 402, "text": "15.6 ordinal regression applied to hba1c\n\n381\n\nb a c k w a r d s step - down - original model\n\ndeleted chi - sq d . f . p\narml\nsex\nwt\narmc\n\n0.16\n0.45\n5.72\n3.32\n\n1\n1\n2\n2\n\n0.6924 0.16\n0.5019 0.61\n0.0572 6.33\n0.1897 9.65\n\nresidual d . f . p\n\naic\n\n1\n2\n4\n6\n\n0.6924 -1.84\n0.7381 -3.39\n0.1759 -1.67\n0.1400 -2.35\n\nfactors in final model\n\n[1] age\n\nre\n\nleg\n\nwaist tri\n\nsub\n\n# show n u m b e r of v a r i a b l e s s e l e c t e d in f i r s t 30 b o o t s\nlatex (v , b =30 , file = ' ' , size = ' small ' )\n\nindex\n\n\u03c1\nr2\nslope\ng\n|pr(y \u2265 y0.5) \u2212 1\n\n2\n\n|\n\noriginal training test optimism corrected n\nsample sample sample\n0.5290 0.5208\n0.2788 0.2692\n1.0000 0.9761\n1.2505 1.2207\n0.2050 0.1987\n\n0.5142 100\n0.2617 100\n0.9761 100\n1.1978 100\n0.1943 100\n\n0.5225\n0.2712\n1.0000\n1.2276\n0.2007\n\n0.0083\n0.0095\n0.0239\n0.0298\n0.0064\n\nindex\n\nfactors retained in backwards elimination\n\n\u2022\n\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nfirst 30 resamples\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nage sex re wt leg arml armc waist tri sub\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022 \u2022 \u2022\n\u2022\n\u2022\n\n\u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022 \u2022\n\u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\u2022 \u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\n\u2022\n\n\u2022\n\n "}, {"Page_number": 403, "text": "382 15 regression models for continuous y and case study in ordinal regression\n\nfrequencies of numbers of factors retained\n\n5 6 7 8 9 10\n1 19 29 46 4 1\n\nnext we fit the reduced model, using multiple imputation to impute miss-\n\ning predictors (figure 15.10).\na \u2190 a r e g i m p u t e(\u223c gh + wt + ht + bmi + leg + arml + armc + waist +\ng \u2190 f i t . m u l t . i m p u t e( gh \u223c rcs ( age ,5) + re + rcs ( leg ,3) +\n\ntri + sub + age + re , data =w , n.impute =5 , pr = false )\n\nrcs ( waist ,4) + tri + rcs ( sub ,4) ,\norm , a , family = loglog , data =w , pr = false )\n\nprint (g , latex = true , n e e d s p a c e= ' 1 .5in ' )\n\n-log-log ordinal regression model\n\nfit.mult.impute(formula = gh ~ rcs(age, 5) + re + rcs(leg, 3)\n\n+ rcs(waist, 4) + tri + rcs(sub, 4), fitter = orm,\nxtrans = a, data = w, pr = false, family = loglog)\n\nmodel likelihood\n\ndiscrimination\n\nrank discrim.\n\nratio test\n\nindexes\n\n1448.42 r2\n\n17 g\n5.5 pr(> \u03c72) < 0.0001 gr\n\n4629 lr \u03c72\n\nobs\nunique y 63 d.f.\ny0.5\nmax| \u2202 log l\n\u2202\u03b2 | score \u03c72\n\u22125\n\n1\u00d710\n\npr(> \u03c72) < 0.0001\n\n1569.21 |pr(y \u2265 y0.5) \u2212 1\n\n2\n\nindexes\n\n0.513\n\n0.269 \u03c1\n0.743\n2.102\n| 0.173\n\ncoef\n0.0404 0.0055\nage\n-0.0228 0.0279\nage\u2019\n0.0126 0.0876\nage\u201d\n0.0424 0.1148\nage\u201d\u2019\n-0.0766 0.0597\nre=other hispanic\n-0.4121 0.0449\nre=non-hispanic white\nre=non-hispanic black\n0.0645 0.0566\nre=other race including multi-racial -0.0555 0.0750\n-0.0339 0.0091\nleg\nleg\u2019\n0.0153 0.0105\n0.0073 0.0050\nwaist\n0.0304 0.0158\nwaist\u2019\n-0.0910 0.0508\nwaist\u201d\ntri\n-0.0163 0.0026\n-0.0027 0.0097\nsub\n0.0674 0.0289\nsub\u2019\nsub\u201d\n-0.1895 0.0922\n\ns.e. wald z pr(> |z|)\n7.29 < 0.0001\n0.4137\n-0.82\n0.8857\n0.14\n0.7116\n0.37\n-1.28\n0.1992\n-9.17 < 0.0001\n0.2543\n1.14\n0.4593\n-0.74\n0.0002\n-3.73\n1.46\n0.1434\n0.1428\n1.47\n0.0536\n1.93\n-1.79\n0.0732\n-6.28 < 0.0001\n0.7817\n-0.28\n0.0198\n2.33\n-2.06\n0.0398\n\n "}, {"Page_number": 404, "text": "15.6 ordinal regression applied to hba1c\n\n383\n\nan \u2190 anova ( g )\n\nlan ( an )\n\n\u03c72\n\nd.f.\n\np\n\nage\n\nwaist\n\nre\nleg\n\nnonlinear\n\nnonlinear\n\n692.50\n28.47\n168.91\n24.37\n2.14\n128.31\n4.05\n39.44\n39.30\n6.63\ntotal nonlinear 46.80\ntotal\n\n4 < 0.0001\n3 < 0.0001\n4 < 0.0001\n2 < 0.0001\n1\n0.1434\n3 < 0.0001\n2\n0.1318\n1 < 0.0001\n3 < 0.0001\n2\n0.0363\n8 < 0.0001\n1464.24 17 < 0.0001\n\nnonlinear\n\nnonlinear\n\ntri\nsub\n\nb \u2190 anova (g , leg , waist , tri , sub )\ns \u2190 rbind ( an , size = b [ ' total ' , ])\nclass ( s ) \u2190 ' a n o v a . r m s '\n\nl i n e s\n\np l o t\n\nw i t h\n\nt h e\n\nn e w\n\na d d\n\nt o\n\n#\n\nc o m b i n e d\n\ne f f e c t\n\no f\n\n4\n\ns i z e\n\nv a r .\n\nplot ( s )\n\nleg\n\nsub\n\ntri\n\nwaist\n\nre\n\nsize\n\nage\n\n0\n\n100\n\n200\n\n300\n\u03c72\u2212 df\n\n400\n\n500\n\n600\n\n700\n\nfig. 15.10 anova for reduced model, after multiple imputation, with addition of\na combined effect for four size variables\n\nggplot ( predict ( g ) , abbrev = true , ylab = null )\n\n#\n\nf i g u r e 15.11\n\n "}, {"Page_number": 405, "text": "384 15 regression models for continuous y and case study in ordinal regression\n\ncompare the estimated age partial effects and confidence intervals with\nthose from a model using casewise deletion, and with bootstrap nonparamet-\nric confidence intervals (also with casewise deletion).\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n20\n\n40\n60\nage, years\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n80\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n20\n\n10\n\n40\nsubscapular skinfold, mm\n\n30\n\n35\n\n30\nupper leg length, cm\n\n40\n\n45\n\n20\n\n10\ntriceps skinfold, mm\n\n30\n\norim\u2212r\n\nnn\u2212hsb\n\nnn\u2212hsw\n\nl\n\ni\n\ny\nt\ni\nc\nn\nh\ne\n\nt\n\ne\nc\na\nr\n\nothrhs\n\nmxcnam\n\nl\n\nl\n\nl\n\nl\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n40\n\n\u22121.0\u22120.50.0 0.5 1.0 1.5\n\n80\n\n100 120 140\n\nwaist circumference, cm\n\nfig. 15.11 partial effects (log hazard or log-log cumulative probability scale) of all\npredictors in reduced model, after multiple imputation\n\ngc \u2190 orm ( gh \u223c rcs ( age ,5) + re + rcs ( leg ,3) +\n\nrcs ( waist ,4) + tri + rcs ( sub ,4) ,\nfamily = loglog , data =w , x = true , y = true )\n\ngb \u2190 bootcov ( gc , b =300)\nbootclb \u2190 predict ( gb , age , boot.type = ' basic ' )\nbootclp \u2190 predict ( gb , age , boot.type = ' percentile ' )\nmultimp \u2190 predict (g ,\n\nage )\n\nplot ( predict ( gc , age ), addpanel = function ( ... ) {\nwith ( bootclb , { llines ( age , lower , col = ' blue ' )\n\nllines ( age , upper , col = ' blue ' )})\n\nwith ( bootclp , { llines ( age , lower , col = ' blue ' , lty =2)\n\nllines ( age , upper , col = ' blue ' , lty =2)})\n\nwith ( multimp , { llines ( age , lower , col = ' red ' )\nllines ( age , upper , col = ' red ' )\nllines ( age , yhat , col = ' red ' )} ) },\n\ncol.fill = gray ( .9 ), adj.subtitle = false )\n\n# f i g u r e 15.12\n\n "}, {"Page_number": 406, "text": "15.6 ordinal regression applied to hba1c\n\n385\n\nd\nr\na\nz\na\nh\n\n \n\ng\no\n\nl\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n20\n\n30\n\n40\n\n50\n\nage, years\n\n60\n\n70\n\n80\n\nfig. 15.12 partial effect for age from multiple imputation (center red line) and\ncasewise deletion (center blue line) with symmetric wald 0.95 confidence bands using\ncasewise deletion (gray shaded area), basic bootstrap confidence bands using casewise\ndeletion (blue lines), percentile bootstrap confidence bands using casewise deletion\n(dashed blue lines), and symmetric wald confidence bands accounting for multiple\nimputation (red lines).\n\nfigure 15.13 depicts the relationship between various predicted quantities,\ndemonstrating that the ordinal model makes fewer model assumptions that\ndictate their connections. a gaussian or log-gaussian model would have a\nstraight-line relationship between the predicted mean and median.\nm \u2190 mean ( g )\nqu \u2190 quantile ( g )\nmed \u2190 function ( lp ) qu ( .5 , lp )\nq90 \u2190 function ( lp ) qu ( .9 , lp )\nlp \u2190 predict ( g )\nlpr \u2190 quantile ( predict (g ), c ( .002 , .998 ), na.rm = true )\nlps \u2190 seq ( lpr [1] , lpr [2] , length =200)\npmn \u2190 m ( lps )\npme \u2190 med ( lps )\np90 \u2190 q90 ( lps )\n\nplot ( pmn , pme ,\n\n# f i g u r e 15.13\n\nxlab = expression ( paste ( ' predicted mean ' ,\nylab = ' median and 0 .9 quantile ' , type = ' l ' ,\nxlim = c (4 .75 , 8 .0 ), ylim = c (4 .75 , 8 .0 ), bty = ' n ' )\n\nhba [ \" 1 c \" ])) ,\n\nbox ( col = gray ( .8 ))\n\n "}, {"Page_number": 407, "text": "386 15 regression models for continuous y and case study in ordinal regression\n\nlines ( pmn , p90 , col = ' blue ' )\nabline ( a =0 , b =1 , col = gray ( .8 ))\ntext (6 .5 , 5 .5 , ' median ' )\ntext (5 .5 , 6 .3 , ' 0 .9 ' , col = ' blue ' )\nnint \u2190 350\n\nscat1d ( m ( lp ),\nscat1d ( med ( lp ), side =2 , nint = nint )\nscat1d ( q90 ( lp ), side =4 , col = ' blue ' , nint = nint )\n\nnint = nint )\n\n8.0\n\n7.5\n\n7.0\n\n6.5\n\n6.0\n\n5.5\n\n5.0\n\n0.9\n\nmedian\n\ne\n\nl\ni\nt\n\nn\na\nu\nq\n9\n\n \n\n.\n\n \n\n \n\n0\nd\nn\na\nn\na\nd\ne\nm\n\ni\n\n5.0\n\n5.5\n\n6.0\n\n7.0\npredicted mean hba1c\n\n6.5\n\n7.5\n\n8.0\n\nfig. 15.13 predicted mean hba1cvs. predicted median and 0.9 quantile along with\ntheir marginal distributions\n\nfinally, let us draw a nomogram that shows the full power of ordinal\n\nmodels, by predicting five quantities of interest.\n\n\u2190 newlevels (g , list ( re = abbreviate ( levels ( w $ re ))))\n\ng\n\nexprob \u2190 exprob ( g )\nnom \u2190\n\nnomogram (g , fun = list ( mean =m ,\n\n' median glycohemoglobi n ' = med ,\n' 0 .9 quantile '\n= q90 ,\n' prob ( hba1c \u2265 6 .5 ) ' =\n' prob ( hba1c \u2265 7 .0 ) ' =\n' prob ( hba1c \u2265 7 .5 ) ' =\n\nfunction ( x ) exprob (x , y =7) ,\n\nfunction ( x ) exprob (x , y =6 .5 ),\n\n "}, {"Page_number": 408, "text": "15.6 ordinal regression applied to hba1c\n\n387\n\nfunction ( x ) exprob (x , y =7 .5 )) ,\n\nfun.at = list ( seq (5 , 8, by = .5 ),\n\nc (5 ,5 .25 ,5 .5 ,5 .75 ,6 ,6 .25 ),\nc (5 .5 ,6 ,6 .5 ,7 ,8 ,10 ,12 ,14) ,\nc ( .01 , .05 , .1 , .2 , .3 , .4 ),\nc ( .01 , .05 , .1 , .2 , .3 , .4 ),\nc ( .01 , .05 , .1 , .2 , .3 , .4 )))\n\nplot ( nom , lmgp = .28 )\n\n# f i g u r e 15.14\n\npoints\n\nage\n\nrace/ethnicity\n\nupper leg length\n\nwaist circumference\n\ntriceps skinfold\n\nsubscapular skinfold\n\ntotal points\n\nlinear predictor\n\nmean\n\nmedian glycohemoglobin\n\n0.9 quantile\n\nprob(hba1c >= 6.5)\n\nprob(hba1c >= 7.0)\n\nprob(hba1c >= 7.5)\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n20\n\nn\u2212hw\n\n25\n\n30\n\nothh\n\norim\n\n35\n\n40\n\n45\n\n50\n\n55\n\n60\n\n65 70 75\n\n80\n\n55\n\n50\n\n45\n\n35\n\n30\n\n25\n\n20\n\n70\n\n90\n\n100\n\n110\n\n120\n\n130\n\n140\n\n150\n\n160\n\n170\n\n45\n15 20\n\n35\n\n25\n\n30\n\n25\n\n15\n5\n35 40 45\n\n0\n\n10\n\n0\n\n20\n\n40\n\n\u22121.5\n\n60\n\n\u22121\n\n5\n\n5\n\n80\n\n100\n\n120\n\n140\n\n160\n\n180\n\n200\n\n220\n\n240\n\n260\n\n280\n\n\u22120.5\n\n0\n\n5.25\n\n5.5\n\n0.5\n\n5.5\n\n5.5\n\n6\n\n1\n\n1.5\n\n2\n\n2.5\n\n6\n\n6.5\n\n7 7.5 8\n\n5.75\n\n6\n\n6.25\n\n6.5 7 8 10 12\n\n14\n\n0.01\n\n0.05 0.1\n\n0.2\n\n0.3 0.4\n\n0.01\n\n0.05 0.1\n\n0.2\n\n0.3 0.4\n\n0.01\n\n0.05 0.1\n\n0.2\n\n0.3\n\nfig. 15.14 nomogram for predicting median, mean, and 0.9 quantile of glycohe-\nmoglobin, along with the estimated probability that hba1c\u2265 6.5, 7, or 7.5, all from\nthe log-log ordinal model\n\n "}, {"Page_number": 409, "text": "chapter 16\ntransform-both-sides regression\n\n16.1 background\n\nfitting multiple regression models by the method of least squares is one of the\nmost commonly used methods in statistics. there are a number of challenges\nto the use of least squares, even when it is only used for estimation and not\ninference, including the following.\n\n1. how should continuous predictors be transformed so as to get a good fit?\n2. is it better to transform the response variable? how does one find a good\n3. what if y needs to be transformed non-monotonically (e.g., |y \u2212 100|)\n\ntransformation that simplifies the right-hand side of the equation?\n\nbefore it will have any correlation with x?\n\nwhen one is trying to draw an inference about population effects using con-\nfidence limits or hypothesis tests, the most common approach is to assume\nthat the residuals have a normal distribution. this is equivalent to assuming\nthat the conditional distribution of the response y given the set of predictors\nx is normal with mean depending on x and variance that is (one hopes)\na constant independent of x. the need for a distributional assumption to\nenable us to draw inferences creates a number of other challenges such as the\nfollowing.\n\n1. if for the untransformed original scale of the response y the distribution of\nthe residuals is not normal with constant spread, ordinary methods will not\nyield correct inferences (e.g., confidence intervals will not have the desired\ncoverage probability and the intervals will need to be asymmetric).\n\n2. quite often there is a transformation of y that will yield well-behaving\nresiduals. how do you find this transformation? can you find a transfor-\nmation for the xs at the same time?\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 16\n\n389\n\n "}, {"Page_number": 410, "text": "390\n\n16 transform-both-sides regression\n\n3. all classical statistical inferential methods assume that the full model was\npre-specified, that is, the model was not modified after examining the data.\nhow does one correct confidence limits, for example, for data-based model\nand transformation selection?\n\n16.2 generalized additive models\n\nhastie and tibshirani275 have developed generalized additive models (gams)\nfor a variety of distributions for y . there are semiparametric gams, but\nmost gams for continuous y assume that the conditional distribution of y is\nfrom a specific distribution family. gams nicely estimate the transformation\neach continuous x requires so as to optimize a fitting criterion such as sum\nof squared errors or log likelihood, subject to the degrees of freedom the\nanalyst desires to spend on each predictor. however, gams assume that y\nhas already been transformed to fit the specified distribution family.\n\nthere is excellent software available for fitting a wide variety of gams,\n\nsuch as the r packages gam, mgcv, and robustgam.\n\n16.3 nonparametric estimation of y -transformation\n\nwhen the model\u2019s left-hand side also needs transformation, either to im-\nprove r2 or to achieve constant variance of the residuals (which increases the\nchances of satisfying a normality assumption), there are a few approaches\navailable. one approach is breiman and friedman\u2019s alternating conditional\nexpectation (ace) method.68 ace simultaneously transforms both y and\neach of the xs so as to maximize the multiple r2 between the transformed\ny and the transformed xs. the model is given by\n\ng(y ) = f1(x1) + f2(x2) + . . . + fp(xp).\n\n(16.1)\n\nace allows the analyst to impose restrictions on the transformations such\nas monotonicity. it allows for categorical predictors, whose categories will\nautomatically be given numeric scores. the transformation for y is allowed to\nbe non-monotonic. one feature of ace is its ability to estimate the maximal\ncorrelation between an x and the response y . unlike the ordinary correlation\ncoefficient (which assumes linearity) or spearman\u2019s rank correlation (which\nassumes monotonicity), the maximal correlation has the property that it is\nzero if and only if x and y are statistically independent. this property holds\nbecause ace allows for non-monotonic transformations of all variables. the\n\u201csuper smoother\u201d(see the s supsmu function) is the basis for the nonparametric\nestimation of transformations for continuous xs.\n\n "}, {"Page_number": 411, "text": "16.4 obtaining estimates on the original scale\n\n391\n\ntibshirani developed a different algorithm for nonparametric additive\nregression based on least squares, additivity and variance stabilization\n(avas).607 unlike ace, avas forces g(y ) to be monotonic. avas\u2019s fit-\nting criterion is to maximize r2 while forcing the transformation for y to\nresult in nearly constant variance of residuals. the model specification is the\nsame as for ace (equation 16.3).\n\nace and avas are powerful fitting algorithms, but they can result in over-\nfitting (r2 can be greatly inflated when one fits many predictors), and they\nprovide no statistical inferential measures. as discussed earlier, the process of\nestimating transformations (especially those for y ) can result in significant\nvariance under-estimation, especially for small sample sizes. the bootstrap\ncan be used to correct the apparent r2 (r2\napp) for overfitting. as before,\nit estimates the optimism (bias) in r2\napp and subtracts this optimism from\nr2\napp to get a more trustworthy estimate. the bootstrap can also be used to\ncompute confidence limits for all estimated transformations, and confidence\nlimits for estimated predictor effects that take fully into account the uncer-\ntainty associated with the transformations. to do this, all steps involved in\nfitting the additive models must be repeated fresh for each re-sample.\n\nlimited testing has shown that the sample size needs to exceed 100 for\nace and avas to provide stable estimates. in small sample sizes the boot-\nstrap bias-corrected estimate of r2 will be zero because the sample informa-\ntion did not support simultaneous estimation of all transformations.\n\n16.4 obtaining estimates on the original scale\n\na common practice in least squares fitting is to attempt to rectify lack of\nfit by taking parametric transformations of y before fitting; the logarithm\nis the most common transformation.a if after transformation the model\u2019s\nresiduals have a population median of zero, the inverse transformation of a\npredicted transformed value estimates the population median of y given x.\nthis is because unlike means, quantiles are transformation-preserving. many\nanalysts make the mistake of not reporting which population parameter is\nbeing estimated when inverse transforming x \u02c6\u03b2, and sometimes they even\nreport that the mean is being estimated.\n\nhow would one go about estimating the population mean or other param-\neter on the untransformed scale? if the residuals are assumed to be normally\ndistributed and if log(y ) is the transformation, the mean of the log-normal\ndistribution, a function of both the mean and the variance of the residuals,\ncan be used to derive the desired quantity. however, if the residuals are not\nnormally distributed, this procedure will not result in the correct estimator.\n\na a disadvantage of transform-both-sides regression is this difficulty of interpreting\nestimates on the original scale. sometimes the use of a special generalized linear model\ncan allow for a good fit without transforming y .\n\n "}, {"Page_number": 412, "text": "392\n\n16 transform-both-sides regression\n\nduan165 developed a \u201csmearing\u201d estimator for more nonparametrically ob-\ntaining estimates of parameters on the original scale. in the simple one-sample\ncase without predictors in which one has computed \u02c6\u03b8 =\ni=1 log(yi)/n, the\nresiduals from this fitted value are given by ei = log(yi) \u2212 \u02c6\u03b8. the smearing\nexp[\u02c6\u03b8 + ei]/n. in this simple case the\nestimator of the population mean is\nresult is the ordinary sample mean y .\n\n(cid:2)\n\n(cid:2)n\n\nthe worth of duan\u2019s smearing estimator is in regression modeling. sup-\npose that the regression was run on g(y ) from which estimated values\n\u02c6g(yi) = xi \u02c6\u03b2 and residuals on the transformed scale ei = \u02c6g(yi)\u2212xi \u02c6\u03b2 were ob-\ntained. instead of restricting ourselves to estimating the population mean, let\nw (y1, y2, . . . , yn) denote any function of a vector of untransformed response\nvalues. to estimate the population mean in the homogeneous one-sample\ncase, w is the simple average of all of its arguments. to estimate the pop-\nulation 0.25 quantile, w is the sample 0.25 quantile of y1, . . . , yn. then the\nsmearing estimator of the population parameter estimated by w given x is\n\u22121 is the inverse of the\nw (g\ng transformation and a = x \u02c6\u03b2.\n\n\u22121(a + en)), where g\n\n\u22121(a + e2), . . . , g\n\n\u22121(a + e1), g\n\nwhen using the avas algorithm, the monotonic transformation g is es-\ntimated from the data, and the predicted value of \u02c6g(y ) is given by equa-\n\u22121(a+\ntion 16.3. so we extend the smearing estimator as w (\u02c6g\nen)), where a is the predicted transformed response given x. as \u02c6g is non-\nparametric (i.e., a table look-up), the areg.boot function described below\ncomputes \u02c6g\n\n\u22121 using reverse linear interpolation.\n\n\u22121(a+e1), . . . , \u02c6g\n\nif residuals from \u02c6g(y ) are assumed to be symmetrically distributed, their\npopulation median is zero and we can estimate the median on the untrans-\n\u22121(x \u02c6\u03b2). to be safe, areg.boot adds the median\nformed scale by computing \u02c6g\nresidual to x \u02c6\u03b2 when estimating the population median (the median residual\ncan be ignored by specifying statistic=\u2019fitted\u2019 to functions that operate on\nobjects created by areg.boot).\n\nwhen quantiles of y are of major interest, a more direct way to obtain\nestimates is through the use of quantile regression357. an excellent case study\nincluding comparisons with other methods such as cox regression can be\nfound in austin et al.38.\n\n16.5 r functions\n\nthe r acepack package\u2019s ace function implements all the features of the ace\nalgorithm, and its avas function does likewise for avas. the bootstrap and\nsmearing capabilities mentioned above are offered for these estimation func-\ntions by the areg.boot (\u201cadditive regression using the bootstrap\u201d) function\nin the hmisc package. unlike the ace and avas functions, areg.boot uses the\nr modeling language, making it easier for the analyst to specify the predic-\n\n "}, {"Page_number": 413, "text": "16.6 case study\n\n393\n\ntor variables and what is assumed about their relationships with the trans-\nformed y . areg.boot also implements a parametric transform-both-sides ap-\nproach using restricted cubic splines and canonical variates, and offers various\nestimation options with and without smearing. it can estimate the effect of\nchanging one predictor, holding others constant, using the ordinary bootstrap\nto estimate the standard deviation of difference in two possibly transformed\nestimates (for two values of x), assuming normality of such differences. nor-\nmality is assumed to avoid generating a large number of bootstrap replica-\ntions of time-consuming model fits. it would not be very difficult to add non-\nparametric bootstrap confidence limit capabilities to the software. areg.boot\nre-samples every aspect of the modeling process it uses, just as faraway186\ndid for parametric least squares modeling.\n\nareg.boot implements a variety of methods as shown in the simple exam-\nple below. the monotone function restricts a variable\u2019s transformation to be\nmonotonic, while the i function restricts it to be linear.\nf \u2190 areg.boot ( y \u223c monotone ( age ) +\n\nsex + weight + i ( blood.pressure ))\n\nplot ( f )\nfunction ( f )\n\n# show t r a n s f o r m a t i o n s , cls\n# g e n e r a t e s f u n c t i o n s\n# d e f i n i n g t r a n s f o r m a t i o n s\n# get p r e d i c t i o n s , s m e a r i n g e s t i m a t e s\n# c o m p u t e cls on e f f e c t s of each x\n\npredict ( f )\nsummary ( f )\nsmearingest () # g e n e r a l i z e d s m e a r i n g e s t i m a t o r s\nmean ( f )\n\nquantile ( f )\n\n# d e r i v e s f u n c t i o n to\n# c o m p u t e s m e a r i n g mean y\n# d e r i v e f u n c t i o n to c o m p u t e s m e a r i n g q u a n t i l e\n\nthe methods are best described in a case study.\n\n16.6 case study\n\nconsider simulated data where the conditional distribution of y is log-normal\ngiven x, but where transform-both-sides regression methods use unlogged\n|, and\ny . predictor x1 is linearly related to log y , x2 is related by |x2 \u2212 1\ncategorical x3 has reference group a effect of zero, group b effect of 0.3, and\ngroup c effect of 0.5.\n\n2\n\nrequire ( rms )\n\nset.seed (7)\n\nn \u2190 400\nx1 \u2190 runif ( n )\nx2 \u2190 runif ( n )\nx3 \u2190 factor ( sample ( c ( ' a ' , ' b ' , ' c ' ), n , true ))\ny \u2190 exp ( x1 + 2 * abs ( x2 - .5 ) + .3 * ( x3 == ' b ' ) + .5 * ( x3 == ' c ' ) +\n\n.5 * rnorm ( n ))\n\n "}, {"Page_number": 414, "text": "394\n\n16 transform-both-sides regression\n\n# for r e f e r e n c e fit a p p r o p r i a t e ols m o d e l\n\nprint ( ols ( log ( y ) \u223c x1 + rcs ( x2 , 5) + x3 ), coefs = false ,\n\nlatex = true )\n\nlinear regression model\n\nols(formula = log(y) ~ x1 + rcs(x2, 5) + x3)\n\nmodel likelihood discrimination\n\nratio test\n\nindexes\n\nobs 400 lr \u03c72\n\u03c3 0.4722 d.f.\nd.f. 392 pr(> \u03c72) 0.0000 g\n\n236.87 r2\n7 r2\n\nadj\n\n0.447\n0.437\n\n0.482\n\nresiduals\n\nmin\n1q median 3q max\n\u22121.346 \u22120.3075 \u22120.0134 0.327 1.527\n\nnow fit the avas model. we use 300 bootstrap repetitions but only plot\nthe first 20 estimates to see clearly how the bootstrap re-estimates of trans-\nformations vary. had we wanted to restrict transformations to be linear, we\nwould have specified the identity function, for example, i(x1).\nf \u2190 areg.boot ( y \u223c x1 + x2 + x3 , method = ' avas ' , b =300)\n\nf\n\navas additive r e g r e s s i o n model\n\nareg . boot ( x = y \u223c x1 + x2 + x3 , b = 300 , method = \" avas \")\n\np r e d i c t o r types\n\ntype\ns\ns\nc\n\nx1\nx2\nx3\n\ny type : s\n\nn = 400\n\np = 3\n\napparent r2 on t r a n s f o r m e d y scale : 0.444\nb o o t s t r a p v a l i d a t e d r2\n\n: 0.42\n\nc o e f f i c i e n t s of s t a n d a r d i z e d t r a n s f o r m a t i o n s:\n\ni n t e r c e p t\n-3.443111 e -16\n\nx1\n9.702960 e -01\n\nx2\n1.224320 e +00\n\nx3\n9.881150 e -01\n\nr e s i d u a l s on t r a n s f o r m e d scale :\n\n "}, {"Page_number": 415, "text": "16.6 case study\n\n395\n\nmedian\n-1.877152 e +00 -5.252194 e -01 -3.732200 e -02\n\nmin\n\n1 q\n\n3 q\n5.339122 e -01\n\nmax\n2.172680 e +00\n\nmean\n8.673617 e -19\n\ns . d .\n7.420788 e -01\n\nnote that the coefficients above do not mean very much as the scale of the\ntransformations is arbitrary. we see that the model was very slightly overfit-\nted (r2 dropped from 0.44 to 0.42), and the r2 are in agreement with the\nols model fit above.\n\nnext we plot the transformations, 0.95 confidence bands, and a sample of\n\nthe bootstrap estimates.\n\nplot (f , boot =20) # f i g u r e 16.1\n\ny\n \n\nd\ne\nm\nr\no\nf\ns\nn\na\nr\nt\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n2\nx\n \n\nd\ne\nm\nr\no\nf\ns\nn\na\nr\nt\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n\u22120.2\n\n\u22120.4\n\n1\nx\n \n\nd\ne\nm\nr\no\nf\ns\nn\na\nr\nt\n\n0.6\n0.4\n0.2\n0.0\n\u22120.2\n\u22120.4\n\u22120.6\n\n0\n\n5\n\n10\n\n15\n\n20\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\ny\n\nx1\n\n0.4\n\n0.2\n\n0.0\n\n\u22120.2\n\n\u22120.4\n\n3\nx\n \n\nd\ne\nm\nr\no\nf\ns\nn\na\nr\nt\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\na\n\nx2\n\nb\nx3\n\nc\n\nfig. 16.1 avas transformations: overall estimates, pointwise 0.95 confidence bands,\nand 20 bootstrap estimates (red lines).\n\nthe plot is shown in figure 16.1. the nonparametrically estimated transfor-\nmation of x1 is almost linear, and the transformation of x2 is close to |x2\u22120.5|.\nwe know that the true transformation of y is log(y), so variance stabilization\nand normality of residuals will be achieved if the estimated y-transformation\nis close to log(y).\n\n "}, {"Page_number": 416, "text": "396\n\n16 transform-both-sides regression\n\nys \u2190 seq ( .8 , 20 , length =200)\nytrans \u2190 function ( f) $ y\nplot ( log ( ys ), ytrans ( ys ), type = ' l ' )\nabline ( lm ( ytrans ( ys ) \u223c log ( ys )) , col = gray ( .8 ))\n\n# f i g u r e 16.2\n\n# f u n c t i o n o u t p u t s all t r a n s f o r m s\n\n)\ns\ny\n(\ns\nn\na\nr\nt\ny\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n0.0 0.5 1.0 1.5 2.0 2.5 3.0\n\nlog(ys)\n\nfig. 16.2 checking estimated against optimal transformation\n\napproximate linearity indicates that the estimated transformation is very\nlog-like.b\n\nnow let us obtain approximate tests of effects of each predictor. summary\ndoes this by setting all other predictors to reference values (e.g., medians),\nand comparing predicted responses for a given level of the predictor x with\npredictions for the lowest setting of x. the default predicted response for\nsummary is the median, which is used here. therefore tests are for differences\nin medians.\n\nsummary (f , values = list ( x1 = c (.2 , .8 ), x2 = c ( .1 , .5 )))\n\nsummary . areg . boot ( object = f , values = list ( x1 = c (0.2 , 0.8) ,\n\nx2 = c (0.1 , 0.5)))\n\ne s t i m a t e s based on 300 r e s a m p l e s\n\nvalues to which p r e d i c t o r s are set when e s t i m a t i n g\neffects of other p r e d i c t o r s:\n\nx3\n3.728843 0.500000 0.300000 2.000000\n\nx2\n\nx1\n\ny\n\nb beware that use of a data\u2013derived transformation in an ordinary model, as this will\nresult in standard errors that are too small. this is because model selection is not\ntaken into account.186\n\n "}, {"Page_number": 417, "text": "16.6 case study\n\n397\n\ne s t i m a t e s of d i f f e r e n c e s of effects on median y ( from first x\nvalue ) , and b o o t s t r a p standard errors of these d i f f e r e n c e s.\nsettings for x are shown as row headings .\n\np r e d i c t o r: x1\n\nx\n\n0.2\n0.8\n\nd i f f e r e n c e s\n0.000000\nna\n1.546992 0 . 2 0 9 9 9 5 9\n\ns . e lower 0.95 upper 0.95\nna\n\npr (| z |)\nna\n1.958577 7.366773 1.747491 e -13\n\nz\nna\n\nna\n1.135408\n\np r e d i c t o r: x2\n\nx\n\n0.1\n0.5\n\nd i f f e r e n c e s\n0.000000\n\nna\n-1.658961 0 . 3 1 6 3 3 6 1\n\ns . e lower 0.95 upper 0.95\nna\n\npr (| z |)\nna\n-1.038953 -5.244298 1.568786 e -07\n\nz\nna\n\nna\n-2.278968\n\np r e d i c t o r: x3\n\nx\n\na\nb\nc\n\nd i f f e r e n c e s\n0 . 0 0 0 0 0 0 0\nna\n0 . 8 4 4 7 4 2 2 0 . 1 7 6 8 2 4 4\n1 . 3 5 2 6 1 5 1 0 . 2 2 0 6 3 9 5\n\nna\n0 . 4 9 8 1 7 2 8\n0 . 9 2 0 1 6 9 7\n\ns . e lower 0.95 upper 0.95\nna\n\npr (| z |)\nna\n1.191312 4.777295 1.776692 e -06\n1.785061 6.130431 8.764127 e -10\n\nz\nna\n\nfor example, when x1 increases from 0.2 to 0.8 we predict an increase in\nmedian y by 1.55 with bootstrap standard error 0.21, when all other predictors\nare held to constants. setting them to other constants will yield different\nestimates of the x1 effect, as the transformation of y is nonlinear.\n\nnext depict the fitted model by plotting predicted values, with x2 varying\non the x-axis, and three curves corresponding to three values of x3. x1 is set\nto 0.5. figure 16.3 shows estimates of both the median and the mean y.\nnewdat \u2190 expand.grid ( x2 = seq ( .05 , .95 , length =200) ,\nx3 = c ( ' a ' , ' b ' , ' c ' ), x1 = .5 ,\nstatistic = c ( ' median ' , ' mean ' ))\n\nyhat \u2190 c ( predict (f , subset ( newdat , statistic == ' median ' ),\n\npredict (f , subset ( newdat , statistic == ' mean ' ),\n\nstatistic = ' median ' ),\n\nstatistic = ' mean ' ))\n\nnewdat \u2190\n\nupdata ( newdat ,\n\nlp = x1 + 2 * abs ( x2 - .5 ) + .3 * ( x3 == ' b ' ) +\n\n.5 * ( x3 == ' c ' ),\n\nytrue = ifelse ( statistic == ' median ' , exp ( lp ),\n\nexp ( lp + 0 .5 * (0 .5\n\n2))) , pr = false )\n\n\u2227\n\ninput object size :\nadded variable\nadded variable\nadded variable\n\n45472 bytes ;\nlp\nytrue\npr\n\n4 v a r i a b l e s\n\nnew object size :\n\n69800 bytes ;\n\n7 v a r i a b l e s\n\n# use h m i s c f u n c t i o n x y p l o t to p r o d u c e f i g u r e 16.3\n\nxyplot ( yhat \u223c x2 | statistic , groups = x3 ,\n\ndata = newdat , type = ' l ' , col =1 ,\nylab = expression ( hat (y )) ,\npanel = function ( ... ) {\n\n "}, {"Page_number": 418, "text": "398\n\n16 transform-both-sides regression\n\npanel.xyplot ( ... )\n\ndat \u2190 subset ( newdat ,\nfor ( w in c ( ' a ' , ' b ' , ' c ' ))\n\nstatistic == c ( ' median ' , ' mean ' )[ current.column ()])\n\nwith ( subset ( dat , x3 == w ),\n\nllines ( x2 , ytrue , col = gray ( .7 ), lwd =1 .5 ))\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nmedian\n\nmean\n\nc\n\nb\n\na\n\nc\n\nb\n\na\n\n}\n\n)\n\n7\n\n6\n\n5\n\n4\n\n3\n\n2\n\ny^\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nx2\n\nfig. 16.3 predicted median (left panel) and mean (right panel) y as a function of\nx2 and x3. true population values are shown in gray.\n\n "}, {"Page_number": 419, "text": "chapter 17\nintroduction to survival analysis\n\n17.1 background\n\nsuppose that one wished to study the occurrence of some event in a popu-\nlation of subjects. if the time until the occurrence of the event were unim-\nportant, the event could be analyzed as a binary outcome using the logistic\nregression model. for example, in analyzing mortality associated with open\nheart surgery, it may not matter whether a patient dies during the proce-\ndure or he dies after being in a coma for two months. for other outcomes,\nespecially those concerned with chronic conditions, the time until the event\nis important. in a study of emphysema, death at eight years after onset of\nsymptoms is different from death at six months. an analysis that simply\ncounted the number of deaths would be discarding valuable information and\nsacrificing statistical power.\n\nsurvival analysis is used to analyze data in which the time until the event\nis of interest. the response variable is the time until that event and is often\ncalled a failure time, survival time, or event time. examples of responses\nof interest include the time until cardiovascular death, time until death or\nmyocardial infarction, time until failure of a light bulb, time until pregnancy,\nor time until occurrence of an ecg abnormality during exercise. bull and\nspiegelhalter83 have an excellent overview of survival analysis.\n\nthe response, event time, is usually continuous, but survival analysis al-\nlows the response to be incompletely determined for some subjects. for exam-\nple, suppose that after a five-year follow-up study of survival after myocardial\ninfarction a patient is still alive. that patient\u2019s survival time is censored on\nthe right at five years; that is, her survival time is known only to exceed five\nyears. the response value to be used in the analysis is 5+. censoring can also\noccur when a subject is lost to follow-up.\n\nif no responses are censored, standard regression models for continuous\nresponses could be used to analyze the failure times by writing the ex-\npected failure time as a function of one or more predictors, assuming that\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 17\n\n399\n\n1\n\n2\n\n "}, {"Page_number": 420, "text": "400\n\n17 introduction to survival analysis\n\nthe distribution of failure time is properly specified. however, there are still\nseveral reasons for studying failure time using the specialized methods of\nsurvival analysis.\n\n1. time to failure can have an unusual distribution. failure time is restricted\nto be positive so it has a skewed distribution and will never be normally\ndistributed.\n\n2. the probability of surviving past a certain time is often more relevant than\nthe expected survival time (and expected survival time may be difficult to\nestimate if the amount of censoring is large).\n\n3. a function used in survival analysis, the hazard function, helps one to\n\nunderstand the mechanism of failure.308\n\nsurvival analysis is used often in industrial life-testing experiments, and\nit is heavily used in clinical and epidemiologic follow-up studies. examples\ninclude a randomized trial comparing a new drug with placebo for its ability\nto maintain remission in patients with leukemia, and an observational study\nof prognostic factors in coronary heart disease. in the latter example subjects\nmay well be followed for varying lengths of time, as they may enter the study\nover a period of many years.\n\nwhen regression models are used for survival analysis, all the advantages\nof these models can be brought to bear in analyzing failure times. multiple,\nindependent prognostic factors can be analyzed simultaneously and treatment\ndifferences can be assessed while adjusting for heterogeneity and imbalances\nin baseline characteristics. also, patterns in outcome over time can be pre-\ndicted for individual subjects.\n\neven in a simple well-designed experiment, survival modeling can allow\n\none to do the following in addition to making simple comparisons.\n\n1. test for and describe interactions with treatment. subgroup analyses can\neasily generate spurious results and they do not consider interacting fac-\ntors in a dose-response manner. once interactions are modeled, relative\ntreatment benefits can be estimated (e.g., hazard ratios), and analyses\ncan be done to determine if some patients are too sick or too well to have\neven a relative benefit.\n\n2. understand prognostic factors (strength and shape).\n3. model absolute effect of treatment. first, a model for the probability of\nsurviving past time t is developed. then differences in survival probabilities\nfor patients on treatments a and b can be estimated. the differences will\nbe due primarily to sickness (overall risk) of the patient and to treatment\ninteractions.\n\n4. understand time course of treatment effect. the period of maximum effect\nor period of any substantial effect can be estimated from a plot of relative\neffects of treatment over time.\n\n5. gain power for testing treatment effects.\n6. adjust for imbalances in treatment allocation in non-randomized studies.\n\n "}, {"Page_number": 421, "text": "3\n\n17.2 censoring, delayed entry, and truncation\n\n401\n\n17.2 censoring, delayed entry, and truncation\n\nresponses may be left\u2013censored and interval\u2013censored besides being right\u2013\ncensored. interval\u2013censoring is present, for example, when a measuring device\nfunctions only for a certain range of the response; measurements outside that\nrange are censored at an end of the scale of the device. interval\u2013censoring also\noccurs when the presence of a medical condition is assessed during periodic ex-\nams. when the condition is present, the time until the condition developed is\nonly known to be between the current and the previous exam. left\u2013censoring\nmeans that an event is known to have occurred before a certain time. in addi-\ntion, left\u2013truncation and delayed entry are common. nomenclature is confus-\ning as many authors refer to delayed entry as left\u2013truncation. left\u2013truncation\nreally means that an unknown subset of subjects failed before a certain time\nand the subjects didn\u2019t get into the study. for example, one might study the\nsurvival patterns of patients who were admitted to a tertiary care hospital.\npatients who didn\u2019t survive long enough to be referred to the hospital com-\npose the left-truncated group, and interesting questions such as the optimum\ntiming of admission to the hospital cannot be answered from the data set.\n\ndelayed entry occurs in follow-up studies when subjects are exposed to the\nrisk of interest only after varying periods of survival. for example, in a study\nof occupational exposure to a toxic compound, researchers may be interested\nin comparing life length of employees with life expectancy in the general\npopulation. a subject must live until the beginning of employment before\nexposure is possible; that is, death cannot be observed before employment.\nthe start of follow-up is delayed until the start of employment and it may be\nright\u2013censored when follow-up ends. in some studies, a researcher may want\nto assume that for the purpose of modeling the shape of the hazard function,\ntime zero is the day of diagnosis of disease, while patients enter the study\nat various times since diagnosis. delayed entry occurs for patients who don\u2019t\nenter the study until some time after their diagnosis. patients who die before\nstudy entry are left-truncated. note that the choice of time origin is very\nimportant.53, 83, 112, 133\n\nheart transplant studies have been analyzed by considering time zero to be\nthe time of enrollment in the study. pre-transplant survival is right\u2013censored\nat the time of transplant. transplant survival experience is based on delayed\nentry into the \u201crisk set\u201d to recognize that a transplant patient is not at risk\nof dying from transplant failure until after a donor heart is found. in other\nwords, survival experience is not credited to transplant surgery until the day\nof transplant. comparisons of transplant experience with medical treatment\nsuffer from \u201cwaiting time bias\u201d if transplant survival begins on the day of\ntransplant instead of using delayed entry.209, 438, 570\n\nthere are several planned mechanisms by which a response is right\u2013\ncensored. fixed type i censoring occurs when a study is planned to end af-\nter two years of follow-up, or when a measuring device will only measure\nresponses up to a certain limit. there the responses are observed only if they\n\n "}, {"Page_number": 422, "text": "4\n\n402\n\n17 introduction to survival analysis\n\nfall below a fixed value c. in type ii censoring, a study ends when there is\na pre-specified number of events. if, for example, 100 mice are followed until\n50 die, the censoring time is not known in advance.\n\nwe are concerned primarily with random type i right-censoring in which\neach subject\u2019s event time is observed only if the event occurs before a certain\ntime, but the censoring time can vary between subjects. whatever the cause\nof censoring, we assume that the censoring is non-informative about the event;\nthat is, the censoring is caused by something that is independent of the im-\npending failure. censoring is non-informative when it is caused by planned\ntermination of follow-up or by a subject moving out of town for reasons unre-\nlated to the risk of the event. if subjects are removed from follow-up because\nof a worsening condition, the informative censoring will result in biased esti-\nmates and inaccurate statistical inference about the survival experience. for\nexample, if a patient\u2019s response is censored because of an adverse effect of\na drug or noncompliance to the drug, a serious bias can result if patients\nwith adverse experiences or noncompliance are also at higher risk of suffering\nthe outcome. in such studies, efficacy can only be assessed fairly using the\nintention to treat principle: all events should be attributed to the treatment\nassigned even if the subject is later removed from that treatment.\n\n17.3 notation, survival, and hazard functions\n\nin survival analysis we use t to denote the response variable, as the response\nis usually the time until an event. instead of defining the statistical model\nfor the response t in terms of the expected failure time, it is advantageous\nto define it in terms of the survival function, s(t), given by\n\ns(t) = prob{t > t} = 1 \u2212 f (t),\n\n(17.1)\n\nwhere f (t) is the cumulative distribution function for t . if the event is death,\ns(t) is the probability that death occurs after time t, that is, the probability\nthat the subject will survive at least until time t. s(t) is always 1 at t = 0;\nall subjects survive at least to time zero. the survival function must be\nnon-increasing as t increases. an example of a survival function is shown in\nfigure 17.1. in that example subjects are at very high risk of the event in the\nearly period so that the s(t) drops sharply. the risk is low for 0.1 \u2264 t \u2264 0.6, so\ns(t) is somewhat flat. after t = .6 the risk again increases, so s(t) drops more\nquickly. figure 17.2 depicts the cumulative hazard function corresponding\nto the survival function in figure 17.1. this function is denoted by \u03bb(t).\nit describes the accumulated risk up until time t, and as is shown later,\nis the negative of the log of the survival function. \u03bb(t) is non-decreasing\nas t increases; that is, the accumulated risk increases or remains the same.\nanother important function is the hazard function, \u03bb(t), also called the force\n\n "}, {"Page_number": 423, "text": "17.3 notation, survival, and hazard functions\n\n403\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n)\n\nt\n\n(\n\ns\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nt\n\nfig. 17.1 survival function\n\n3.0\n\n2.5\n\n2.0\n\n)\n\nt\n\n(\n\n\u03bb\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nt\n\nfig. 17.2 cumulative hazard function\n\nof mortality, or instantaneous event (death, failure) rate. the hazard at time\nt is related to the probability that the event will occur in a small interval\naround t, given that the event has not occurred before time t. by studying\nthe event rate at a given time conditional on the event not having occurred by\n\n "}, {"Page_number": 424, "text": "404\n\n17 introduction to survival analysis\n\n)\n\nt\n\n(\n\u03bb\n\n14\n\n12\n\n10\n\n8\n\n6\n\n4\n\n2\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nfig. 17.3 hazard function\n\nt\n\nthat time, one can learn about the mechanisms and forces of risk over time.\nfigure 17.3 depicts the hazard function corresponding to s(t) in figure 17.1\nand to \u03bb(t) in figure 17.2. notice that the hazard function allows one to\nmore easily determine the phases of increased risk than looking for sudden\ndrops in s(t) or \u03bb(t).\n\nthe hazard function is defined formally by\n\n\u03bb(t) = lim\nu\u21920\n\nprob{t < t \u2264 t + u|t > t}\n\nu\n\n,\n\n(17.2)\n\nwhich using the law of conditional probability becomes\n\n\u03bb(t) = lim\nu\u21920\n\nprob{t < t \u2264 t + u}/prob{t > t}\nu\n[f (t + u) \u2212 f (t)]/u\n\ns(t)\n\n(17.3)\n\n= lim\nu\u21920\n\u2202f (t)/\u2202t\n\n=\n\ns(t)\n\n=\n\nf (t)\ns(t)\n\n,\n\n "}, {"Page_number": 425, "text": "17.3 notation, survival, and hazard functions\n\n405\n\nwhere f (t) is the probability density function of t evaluated at t, the deriva-\ntive or slope of the cumulative distribution function 1 \u2212 s(t). since\n\n\u2202 log s(t)\n\n\u2202t\n\n=\n\n\u2202s(t)/\u2202t\n\ns(t)\n\n= \u2212 f (t)\ns(t)\n\n,\n\n(17.4)\n\nthe hazard function can also be expressed as\n\u03bb(t) = \u2212 \u2202 log s(t)\n\n\u2202t\n\n,\n\n(17.5)\n\nthe negative of the slope of the log of the survival function. working back-\n\nwards, the integral of \u03bb(t) is:(cid:12) t\n\n\u03bb(v)dv = \u2212 log s(t).\n\n(17.6)\n\n0\n\nthe integral or area under \u03bb(t) is defined to be \u03bb(t), the cumulative hazard\nfunction. therefore\n\n\u03bb(t) = \u2212 log s(t),\n\nor\n\ns(t) = exp[\u2212\u03bb(t)].\n\nso knowing any one of the functions s(t), \u03bb(t), or \u03bb(t) allows one to derive\nthe other two functions. the three functions are different ways of describing\nthe same distribution.\nt \u223c s(t), the density of t is \u03bb(t)s(t) and\n\none property of \u03bb(t) is that the expected value of \u03bb(t ) is unity, since if\n\n(17.7)\n\n(17.8)\n\ne[\u03bb(t )] =\n\n\u03bb(t)\u03bb(t) exp(\u2212\u03bb(t))dt\nu exp(\u2212u)du\n\n(17.9)\n\n(cid:12) \u221e\n(cid:12) \u221e\n\n0\n\n=\n\n0\n= 1.\n\nnow consider properties of the distribution of t . the population qth quan-\ntile (100qth percentile), tq, is the time by which a fraction q of the subjects\nwill fail. it is the value t such that s(t) = 1 \u2212 q; that is\n\ntq = s\n\n\u22121(1 \u2212 q).\n\n(17.10)\n\nthe median life length is the time by which half the subjects will fail, obtained\nby setting s(t) = 0.5:\n\n(17.11)\nthe qth quantile of t can also be computed by setting exp[\u2212\u03bb(t)] = 1 \u2212 q,\ngiving\n\nt0.5 = s\n\n\u22121(0.5).\n\n "}, {"Page_number": 426, "text": "406\n\n17 introduction to survival analysis\n\ntq = \u03bb\nt.5 = \u03bb\n\n\u22121[\u2212 log(1 \u2212 q)] and as a special case,\n\u22121(log 2).\n\n(17.12)\n\nthe mean or expected value of t (the expected failure time) is the area under\nthe survival function for t ranging from 0 to \u221e:\n\n(cid:12) \u221e\n\n\u03bc =\n\ns(v)dv.\n\n0\n\n(17.13)\n\nirwin has defined mean restricted life (see [334, 335]), which is the area under\ns(t) up to a fixed time (usually chosen to be a point at which there is still\nadequate follow-up information).\n\nthe random variable t denotes a random failure time from the survival\ndistribution s(t). we need additional notation for the response and censoring\ninformation for the ith subject. let ti denote the response for the ith subject.\nthis response is the time until the event of interest, and it may be censored\nif the subject is not followed long enough for the event to be observed. let ci\ndenote the censoring time for the ith subject, and define the event indicator as\n\nei = 1 if the event was observed (ti \u2264 ci),\n\n= 0 if the response was censored (ti > ci).\n\n(17.14)\n\nthe observed response is\n\nyi = min(ti, ci),\n\n(17.15)\n\nwhich is the time that occurred first: the failure time or the censoring time.\nthe pair of values (yi, ei) contains all the response information for most\npurposes (i.e., the potential censoring time ci is not usually of interest if the\nevent occurred before ci).\n\nfigure 17.4 demonstrates this notation. the line segments start at study\n\nentry (survival time t = 0).\n\na useful property of the cumulative hazard function can be derived as fol-\nlows. let z be any cutoff time and consider the expected value of \u03bb evaluated\nat the earlier of the cutoff time or the actual failure time.\n\ne[\u03bb(min(t, z))] = e[\u03bb(t )[t \u2264 z] + \u03bb(z)[t > z]]\n= e[\u03bb(t )[t \u2264 z]] + \u03bb(z)s(z).\n\n(17.16)\n\nthe first term in the right\u2013hand side is\n\n(cid:12) \u221e\n(cid:12) z\n\n0\n\n=\n\n0\n\n\u03bb(t)[t \u2264 z]\u03bb(t) exp(\u2212\u03bb(t))dt\n\u03bb(t)\u03bb(t) exp(\u2212\u03bb(t))dt\n\n(17.17)\n\n "}, {"Page_number": 427, "text": "17.4 homogeneous failure time distributions\n\n407\n\nti\n\n75\n7\n\n68+\n52+\n20\n\nci\n\n81\n76\n68\n52\n56\n\nyi\n\n75\n7\n68\n52\n20\n\nei\n\n1\n1\n0\n0\n1\n\nfig. 17.4 some censored data. circles denote events.\n\ntermination of study\n\n= \u2212[u exp(\u2212u) + exp(\u2212u)]|\u03bb(z)\n= 1 \u2212 s(z)[\u03bb(z) + 1].\n\n0\n\nadding \u03bb(z)s(z) results in\n\ne[\u03bb(min(t, z))] = 1 \u2212 s(z) = f (z).\n\n(17.18)\n\n(cid:2)n\n\nit follows that\noccurring before time z among the n subjects.\n\ni=1 \u03bb(min(ti, z)) estimates the expected number of failures\n\n5\n\n17.4 homogeneous failure time distributions\n\nin this section we assume that each subject in the sample has the same dis-\ntribution of the random variable t that represents the time until the event.\nin particular, there are no covariables that describe differences between sub-\njects in the distribution of t . as before we use s(t), \u03bb(t), and \u03bb(t) to denote,\nrespectively, the survival, hazard, and cumulative hazard functions.\n\nthe form of the true population survival distribution function s(t) is al-\nmost always unknown, and many distributional forms have been used for\ndescribing failure time data. we consider first the two most popular para-\nmetric survival distributions: the exponential and weibull distributions. the\nexponential distribution is a very simple one in which the hazard function is\nconstant; that is, \u03bb(t) = \u03bb . the cumulative hazard and survival functions\nare then\n\n\u03bb(t) = \u03bbt\ns(t) = exp(\u2212\u03bb(t)) = exp(\u2212\u03bbt).\n\nand\n\n(17.19)\n\nthe median life length is \u03bb\n\n\u22121(log 2) or\n\n "}, {"Page_number": 428, "text": "408\n\n17 introduction to survival analysis\n\nt0.5 = log(2)/\u03bb.\n\n(17.20)\n\nthe time by which 1/2 of the subjects will have failed is then proportional to\nthe reciprocal of the constant hazard rate \u03bb . this is true also of the expected\nor mean life length, which is 1/\u03bb.\n\nthe exponential distribution is one of the few distributions for which a\nclosed-form solution exists for the estimator of its parameter when censoring\nis present. this estimator is a function of the number of events and the total\nperson-years of exposure. methods based on person-years in fact implicitly\nassume an exponential distribution. the exponential distribution is often used\nto model events that occur \u201cat random in time.\u201d323 it has the property that\nthe future lifetime of a subject is the same, no matter how \u201cold\u201d it is, or\n\nprob{t > t0 + t|t > t0} = prob{t > t}.\n\n(17.21)\n\nthis \u201cageless\u201d property also makes the exponential distribution a poor choice\nfor modeling human survival except over short time periods.\n\nthe weibull distribution is a generalization of the exponential distribution.\n\nits hazard, cumulative hazard, and survival functions are given by\n\n\u03bb(t) = \u03b1\u03b3t\u03b3\u22121\n\u03bb(t) = \u03b1t\u03b3\ns(t) = exp(\u2212\u03b1t\u03b3).\n\n(17.22)\n\nthe weibull distribution with \u03b3 = 1 is an exponential distribution (with\nconstant hazard). when \u03b3 > 1, its hazard is increasing with t, and when\n\u03b3 < 1 its hazard is decreasing. figure 17.5 depicts some of the shapes of\nthe hazard function that are possible.\nif t has a weibull distribution, the\nmedian of t is\n\nt0.5 = [(log 2)/\u03b1]1/\u03b3.\n\n(17.23)\n\nthere are many other traditional parametric survival distributions, some of\nwhich have hazards that are \u201cbathtub shaped\u201d as in figure 17.3.243, 323 the\nrestricted cubic spline function described in section 2.4.5 is an alternative\nbasis for \u03bb(t).286, 287 this function family allows for any shape of smooth\n\u03bb(t) since the number of knots can be increased as needed, subject to the\nnumber of events in the sample. nonlinear terms in the spline function can\nbe tested to assess linearity of hazard (rayleigh-ness) or constant hazard\n(exponentiality).\n\n6\n\nthe restricted cubic spline hazard model with k knots is\n\nk\u22122(cid:3)\n\n\u03bbk(t) = a + bt +\n\n\u03b3jwj(t),\n\n(17.24)\n\nj=1\n\n "}, {"Page_number": 429, "text": "17.5 nonparametric estimation of s and \u03bb\n\n409\n\n.5\n1\n2\n4\n\n7\n\n6\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\n0.0\n\n0.2\n\n0.4\n\n0.8\n\n1.0\n\n1.2\n\n0.6\nt\n\nfig. 17.5 some weibull hazard functions with \u03b1 = 1 and various values of \u03b3.\n\nwhere the wj(t) are the restricted cubic spline terms of equation 2.25. there\nterms are cubic terms in t. a set of knots v1, . . . , vk is selected from the\nquantiles of the uncensored failure times (see section 2.4.5 and [286]).\n\nthe cumulative hazard function for this model is\n\n\u03bb(t) = at +\n\n1\n2\n\nt2 +\n\n1\n4\n\n\u00d7 quartic terms in t.\n\n(17.25)\n\nstandard maximum likelihood theory is used to obtain estimates of the k\nunknown parameters to derive, for example, smooth estimates of \u03bb(t) with\nconfidence bands. the flexible estimates of s(t) using this method are as\nefficient as kaplan\u2013meier estimates, but they are smooth and can be used as a\nbasis for modeling predictor variables. the spline hazard model is particularly\nuseful for fitting steeply falling and gently rising hazard functions that are\ncharacteristic of high-risk medical procedures.\n\n17.5 nonparametric estimation of s and \u03bb\n\n17.5.1 kaplan\u2013meier estimator\n\nas the true form of the survival distribution is seldom known, it is useful to\nestimate the distribution without making any assumptions. for many anal-\nyses, this may be the last step, while in others this step helps one select a\nstatistical model for more in-depth analyses. when no event times are cen-\nsored, a nonparametric estimator of s(t) is 1\u2212 fn(t) where fn(t) is the usual\n\n "}, {"Page_number": 430, "text": "410\n\n17 introduction to survival analysis\n\ntable 17.1 kaplan-meier computations\n\nday no. subjects deaths censored\n\ncumulative\n\nat risk\n\n100\n99\n96\n93\n.\n.\n\n12\n30\n60\n72\n.\n.\n\n1\n2\n0\n3\n.\n.\n\nsurvival\n\n99/100 = .99\n\n97/99 \u00d7 99/100 = .97\n96/96 \u00d7 .97 = .97\n90/93 \u00d7 .97 = .94\n\n.\n.\n\n0\n1\n3\n0\n.\n.\n\nempirical cumulative distribution function based on the observed failure times\nt1, . . . , tn. let sn(t) denote this empirical survival function. sn(t) is given\nby the fraction of observed failure times that exceed t:\n\nsn(t) = [number of ti > t]/n.\n\n(17.26)\n\nwhen censoring is present, s(t) can be estimated (at least for t up until\nthe end of follow-up) by the kaplan\u2013meier333 product-limit estimator. this\nmethod is based on conditional probabilities. for example, suppose that ev-\nery subject has been followed for 39 days or has died within 39 days so that\nthe proportion of subjects surviving at least 39 days can be computed. after\n39 days, some subjects may be lost to follow-up besides those removed from\nfollow-up because of death within 39 days. the proportion of those still fol-\nlowed 39 days who survive day 40 is computed. the probability of surviving\n40 days from study entry equals the probability of surviving day 40 after\nliving 39 days, multiplied by the chance of surviving 39 days.\n\nthe life table in table 17.1 demonstrates the method in more detail. we\nsuppose that 100 subjects enter the study and none die or are lost before\nday 12.\n\ntimes in a life table should be measured as precisely as possible. if the\nevent being analyzed is death, the failure time should usually be specified\nto the nearest day. we assume that deaths occur on the day indicated and\nthat being censored on a certain day implies the subject survived through the\nend of that day. the data used in computing kaplan\u2013meier estimates consist\nof (yi, ei), i = 1, 2, . . . , n using notation defined previously. primary data\ncollected to derive (yi, ei) usually consist of entry date, event date (if subject\nfailed), and censoring date (if subject did not fail). instead, the entry date,\ndate of event/censoring, and event/censoring indicator ei may be specified.\nthe kaplan\u2013meier estimator is called the product-limit estimator because\nit is the limiting case of actuarial survival estimates as the time periods\nshrink so that an entry is made for each failure time. an entry need not\nbe in the table for censoring times (when no failures occur at that time) as\nlong as the number of subjects censored is subtracted from the next number\n\n "}, {"Page_number": 431, "text": "17.5 nonparametric estimation of s and \u03bb\n\n411\n\ntable 17.2 summaries used in kaplan-meier computations\n\ni ti ni di (ni \u2212 di)/ni\n1 1 7 1\n2 3 6 2\n3 9 2 1\n\n6/7\n4/6\n1/2\n\nat risk. kaplan\u2013meier estimates are preferred to actuarial estimates because\nthey provide more resolution and make fewer assumptions. in constructing\na yearly actuarial life table, for example, it is traditionally assumed that\nsubjects censored between two years were followed 0.5 years.\n\nthe product-limit estimator is a nonparametric maximum likelihood es-\ntimator [331, pp. 10\u201313]. the formula for the kaplan\u2013meier product-limit\nestimator of s(t) is as follows. let k denote the number of failures in the\nsample and let t1, t2, . . . , tk denote the unique event times (ordered for ease\nof calculation). let di denote the number of failures at ti and ni be the num-\nber of subjects at risk at time ti; that is, ni = number of failure/censoring\ntimes \u2265 ti . the estimator is then\n\nskm(t) =\n\n(1 \u2212 di/ni).\n\n(17.27)\n\n(cid:8)\n\ni:ti\u2264t\n\nthe kaplan\u2013meier estimator of \u03bb(t) is \u03bbkm(t) = \u2212 log skm(t). an estimate\nkm(1 \u2212 q), if follow-up is long enough so that\n\u22121\nskm(t) drops as low as 1\u2212 q. if the last subject followed failed so that skm(t)\n\nof quantile q of failure time is s\n\ndrops to zero, the expected failure time can be estimated by computing the\narea under the kaplan\u2013meier curve.\n\nto demonstrate computation of skm(t), imagine a sample of failure times\n\ngiven by\n\n1 3 3 6+ 8+ 9 10+,\n\nwhere + denotes a censored time. the quantities needed to compute skm are\nin table 17.2. thus\n\nskm(t) = 1,\n\n0 \u2264 t < 1\n\n= 6/7 = .85, 1 \u2264 t < 3\n= (6/7)(4/6) = .57, 3 \u2264 t < 9\n= (6/7)(4/6)(1/2) = .29, 9 \u2264 t < 10.\n\n(17.28)\n\nnote that the estimate of s(t) is undefined for t > 10 since not all subjects\nhave failed by t = 10 but no follow-up extends beyond t = 10. a graph of the\nkaplan\u2013meier estimate is found in figure 17.6.\n\n "}, {"Page_number": 432, "text": "412\n\n17 introduction to survival analysis\n\nrequire ( rms )\n\ntt \u2190 c (1 ,3 ,3 ,6 ,8 ,9 ,10)\nstat \u2190 c (1 ,1 ,1 ,0 ,0 ,1 ,0)\ns \u2190 surv ( tt , stat )\nsurvplot ( npsurv ( s \u223c 1) , conf = \" bands \" , n.risk = true ,\nsurvplot ( npsurv ( s \u223c 1, type = \" fleming-harri n gt on \" ,\n\nxlab = expression ( t ))\n\nconf.int = false ), add = true , lty =3)\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n7\n\n7\n\n6\n\n6\n\n4\n\n4\n\n4\n\n3\n\n3\n\n2\n\n1\n\n0 1 2 3 4 5 6 7 8 9 10\n\nt\n\nfig. 17.6 kaplan\u2013meier product\u2013limit estimator with 0.95 confidence bands. the\naltschuler\u2013nelson\u2013aalen\u2013fleming\u2013harrington estimator is depicted with the dotted\nlines.\n\nthe variance of skm(t) can be estimated using greenwood\u2019s formula [331,\np. 14], and using normality of skm(t) in large samples this variance can\nbe used to derive a confidence interval for s(t). a better method is to de-\nrive an asymmetric confidence interval for s(t) based on a symmetric in-\nterval for log \u03bb(t). this latter method ensures that a confidence limit does\nnot exceed one or fall below zero, and is more accurate since log \u03bbkm(t) is\nmore normally distributed than skm(t). once a confidence interval, say [a, b]\nis determined for log \u03bb(t), the confidence interval for s(t) is computed by\n[exp{\u2212 exp(b)}, exp{\u2212 exp(a)}]. the formula for an estimate of the variance\nof interest is [331, p. 15]:\n\n(cid:2)\n{(cid:2)\ni:ti\u2264t di/[ni(ni \u2212 di)]\ni:ti\u2264t log[(ni \u2212 di)/ni]}2 .\n\n(17.29)\n\nvar{log \u03bbkm(t)} =\n\n "}, {"Page_number": 433, "text": "17.6 analysis of multiple endpoints\n\n413\n\nletting s denote the square root of this variance estimate, an approximate\n1 \u2212 \u03b1 confidence interval for log \u03bb(t) is given by log \u03bbkm(t) \u00b1 zs , where z is\nthe 1\u2212\u03b1/2 standard normal critical value. after simplification, the confidence\ninterval for s(t) becomes\n\nskm(t)exp(\u00b1zs).\n\n(17.30)\n\neven though the log \u03bb basis for confidence limits has theoretical advan-\ntages, on the log \u2212 log scale the estimate of s(t) has the greatest instability\nwhere much information is available: when s(t) falls just below 1.0. for that\nreason, the recommended default confidence limits are on the \u03bb(t) scale using\n\nvar{\u03bbkm(t)} =\n\ndi\n\n[ni(ni \u2212 di)]\n\n.\n\n(17.31)\n\nletting s denote its square root, an approximate 1\u2212 \u03b1 confidence interval for\ns(t) is given by\n\nexp(\u00b1zs)skm(t),\n\n(17.32)\n\ntruncated to [0, 1].\n\n17.5.2 altschuler\u2013nelson estimator\n\n(cid:3)\n\ni:ti\u2264t\n\naltschuler19, nelson472, aalen1 and fleming and harrington196 proposed es-\ntimators of \u03bb(t) or of s(t) based on an estimator of \u03bb(t):\n\n(cid:3)\n\ndi\nni\n\n\u02c6\u03bb(t) =\ns\u03bb(t) = exp(\u2212 \u02c6\u03bb(t)).\n\ni:ti\u2264t\n\n(cid:2)n\n\n(17.33)\n\n(cid:2)n\n\ns\u03bb(t) has advantages over skm(t). first,\ni=1 ei\n[605, appendix 3]. in other words, the estimator gives the correct expected\nnumber of events. second, there is a wealth of asymptotic theory based on\nthe altschuler\u2013nelson estimator.196\n\ni=1\n\n\u02c6\u03bb(yi) =\n\nsee figure 17.6 for an example of the s\u03bb(t) estimator. this estimator has\n\nthe same variance as skm(t) for large enough samples.\n\n17.6 analysis of multiple endpoints\n\nclinical studies frequently assess multiple endpoints. a cancer clinical trial\nmay, for example, involve recurrence of disease and death, whereas a car-\ndiovascular trial may involve nonfatal myocardial infarction and death. end-\npoints may be combined, and the new event (e.g., time until infarction or\n\n7\n\n8\n\n "}, {"Page_number": 434, "text": "414\n\n17 introduction to survival analysis\n\ndeath) may be analyzed with any of the tools of survival analysis because only\nthe usual censoring mechanism is used. sometimes the various endpoints may\nneed separate study, however, because they may have different risk factors.\nwhen the multiple endpoints represent multiple causes of a terminating\nevent (e.g., death), prentice et al. have developed standard methods for an-\nalyzing cause-specific hazards513 [331, pp. 163\u2013178]. their methods allow\neach cause of failure to be analyzed separately, censoring on the other causes.\nthey do not assume any mechanism for cause removal nor make any assump-\ntions regarding the interrelation among causes of failure. however, analyses\nof competing events using data where some causes of failure are removed in\na different way from the original dataset will give rise to different inferences.\nwhen the multiple endpoints represent a mixture of fatal and nonfatal\noutcomes, the analysis may be more complex. the same is true when one\nwishes to jointly study an event-time endpoint and a repeated measurement.\n\n17.6.1 competing risks\n\nwhen events are independent, each event may also be analyzed separately by\ncensoring on all other events as well as censoring on loss to follow-up. this will\nyield an unbiased estimate of an easily interpreted cause-specific \u03bb(t) or s(t)\nbecause censoring is non-informative [331, pp. 168\u2013169]. one minus skm(t)\ncomputed in this manner will correctly estimate the probability of failing from\nthe event in the absence of other events. even when the competing events are\nnot independent, the cause-specific hazard model may lead to valid results,\nbut the resulting model does not allow one to estimate risks conditional on\nremoval of one or more causes of the event. see kay340 for a nice example\nof competing risks analysis when a treatment reduces the risk of death from\none cause but increases the risk of death from another cause.\n\nlarson and dinse376 have an interesting approach that jointly models the\ntime until (any) failure and the failure type. for r failure types, they use\nan r-category polytomous logistic model to predict the probability of failing\nfrom each cause. they assume that censoring is unrelated to cause of event.\n\n17.6.2 competing dependent risks\n\nin many medical and epidemiologic studies one is interested in analyzing\nmultiple causes of death. if the goal is to estimate cause-specific failure prob-\nabilities, treating subjects dying from extraneous causes as censored and\nthen computing the ordinary kaplan\u2013meier estimate results in biased (high)\nsurvival estimates212, 225. if cause m is of interest, the cause-specific hazard\n\n9\n\n10\n\n "}, {"Page_number": 435, "text": "17.6 analysis of multiple endpoints\n\n415\n\nfunction is defined as\n\npr{fail from cause m in [t, t + u)|alive at t}\n\n\u03bbm(t) = lim\nu\u21920\n\nu\n\n.\n\n(17.34)\n\nthe cumulative incidence function or probability of failure from cause m by\ntime t is given by\n\n(cid:12) t\n\n(cid:2)\n\nfm(t) =\n\n\u03bbm(u)s(u)du,\n\n0\n\n(17.35)\n\nequals exp[\u2212(cid:13) u\nmentioned, 1\u2212fm(t) = exp[\u2212(cid:13) t\n\nwhere s(u) is the probability of surviving (ignoring cause of death), which\n\u03bbm(x))dx] [212]; [444, chapter 10]; [102,408]. as previously\n0 \u03bbm(u)du] only if failures due to other causes\nare eliminated and if the cause-specific hazard of interest remains unchanged\nin doing so.212\n\n0 (\n\nagain letting t1, t2, . . . , tk denote the unique ordered failure times, a non-\n\nparametric estimate of fm(t) is given by\n\n(cid:3)\n\ni:ti\u2264t\n\n\u02c6fm(t) =\n\ndmi\nni\n\nskm(ti\u22121),\n\n(17.36)\n\nwhere dmi is the number of failures of type m at time ti and ni is the number\nof subjects at risk of failure at ti.\n\npepe and others494, 496, 497 showed how to use a combination of kaplan\u2013\nmeier estimators to derive an estimator of the probability of being free of\nevent 1 by time t given event 2 has not occurred by time t (see also [349]).\nlet t1 and t2 denote, respectively, the times until events 1 and 2. let s1(t)\nand s2(t) denote, respectively, the two survival functions. let us suppose\nthat event 1 is not a terminating event (e.g., is not death) and that even\nafter event 1 subjects are followed to ascertain occurrences of event 2. the\nprobability that t1 > t given t2 > t is\nprob{t1 > t|t2 > t} =\n\nprob{t1 > t and t2 > t}\n\nprob{t2 > t}\n\n=\n\ns12(t)\ns2(t)\n\n,\n\n(17.37)\n\nwhere s12(t) is the survival function for min(t1, t2), the earlier of the two\nevents. since s12(t) does not involve any informative censoring (assuming as\nalways that loss to follow-up is non-informative), s12 may be estimated by\nthe kaplan\u2013meier estimator skm12 (or by s\u03bb). for the type of event 1 we\nhave discussed above, s2 can also be estimated without bias by skm2. thus\nwe estimate, for example, the probability that a subject still alive at time t\nwill be free of myocardial infarction as of time t by skm12 /skm2.\n\n "}, {"Page_number": 436, "text": "416\n\n17 introduction to survival analysis\n\nanother quantity that can easily be computed from ordinary survival es-\n\ntimates is s2(t) \u2212 s12(t) = [1 \u2212 s12(t)] \u2212 [1 \u2212 s2(t)], which is the probability\n\nthat event 1 occurs by time t and that event 2 has not occurred by time t.\n\nthe ratio estimate above is used to estimate the survival function for one\nevent given that another has not occurred. another function of interest is\nthe crude survival function which is a marginal distribution; that is, it is the\nprobability that t1 > t whether or not event 2 occurs:362\n\nsc(t) = 1 \u2212 f1(t)\nf1(t) = prob{t1 \u2264 t},\n\n(17.38)\n\nwhere f1(t) is the crude incidence function defined previously. note that the\nt1 \u2264 t implies that the occurrence of event 1 is part of the probability being\n\ncomputed. if event 2 is a terminating event so that some subjects can never\nsuffer event 1, the crude survival function for t1 will never drop to zero. the\ncrude survival function can be interpreted as the survival distribution of w\nwhere w = t1 if t1 < t2 and w = \u221e otherwise.362\n\n11\n\n17.6.3 state transitions and multiple types\n\nof nonfatal events\n\nin many studies there is one final, absorbing state (death, all causes) and mul-\ntiple live states. the live states may represent different health states or phases\nof a disease. for example, subjects may be completely free of cancer, have an\nisolated tumor, metastasize to a distant organ, and die. unlike this example,\nthe live states need not have a definite ordering. one may be interested in es-\ntimating transition probabilities, for example, the probability \u03c0ij (t1, t2) that\nan individual in state i at time t1 is in state j after an additional time t2.\nstrauss and shavelle596 have developed an extended kaplan\u2013meier estimator\nkm (t|t1) denote the ordinary kaplan\u2013meier estimate\nfor this situation. let si\nof the probability of not dying before time t (ignoring distinctions between\nmultiple live states) for a cohort of subjects beginning follow-up at time t1\nin state i. this is an estimate of the probability of surviving an additional t\ntime units (in any live state) given that the subject was alive and in state i\nat time t1. strauss and shavelle\u2019s estimator is given by\nkm (t2|t1),\nsi\n\n\u03c0ij (t1, t2) =\n\n(17.39)\n\nnij(t1, t2)\nni(t1, t2)\n\nwhere ni(t1, t2) is the number of subjects in live state i at time t1 who are\nalive and uncensored t2 time units later, and nij(t1, t2) is the number of such\nsubjects in state j t2 time units beyond t1.\n\n12\n\n "}, {"Page_number": 437, "text": "17.6 analysis of multiple endpoints\n\n417\n\n17.6.4 joint analysis of time and severity\n\nof an event\n\nin some studies, an endpoint is given more weight if it occurs earlier or\nif it is more severe clinically, or both. for example, the event of interest\nmay be myocardial infarction, which may be of any severity from minimal\ndamage to the left ventricle to a fatal infarction. berridge and whitehead52\nhave provided a promising model for the analysis of such endpoints. their\nmethod assumes that the severity of endpoints which do occur is measured\non an ordinal categorical scale and that severity is assessed at the time of\nthe event. berridge and whitehead\u2019s example was time until first headache,\nwith severity of headaches graded on an ordinal scale. they proposed a joint\nhazard of an individual who responds with ordered category j:\n\n\u03bbj(t) = \u03bb(t)\u03c0j (t),\n\n(17.40)\n\nwhere \u03bb(t) is the hazard for the failure time and \u03c0j(t) is the probability of an\nindividual having event severity j given she fails at time t. note that a shift\nin the distribution of response severity is allowed as the time until the event\nincreases.\n\n13\n\n17.6.5 analysis of multiple events\n\nit is common to choose as an endpoint in a clinical trial an event that can\nrecur. examples include myocardial infarction, gastric ulcer, pregnancy, and\ninfection. using only the time until the first event can result in a loss of\nstatistical information and power.a there are specialized multivariate survival\nmodels (whose assumptions are extremely difficult to verify) for handling this\nsetup, but in many cases a simpler approach will be efficient.\n\nthe simpler approach involves modeling the marginal distribution of the\ntime until each event.407, 495 here one forms one record per subject per event,\nand the survival time is the time to the first event for the first record, or is\nthe time from the previous event to the next event for all later records. this\napproach yields consistent estimates of distribution parameters as long as the\nmarginal distributions are correctly specified.655 one can allow the number of\nprevious events to influence the hazard function of another event by modeling\nthis count as a covariable.\n\nthe multiple events within subject are not independent, so variance esti-\nmates must be corrected for intracluster correlation. the clustered sandwich\ncovariance matrix estimator described in section 9.5 and in [407] will provide\n\na an exception to this is the case in which once an event occurs for the first time, that\nevent is likely to recur multiple times for any patient. then the latter occurrences are\nredundant.\n\n "}, {"Page_number": 438, "text": "418\n\n17 introduction to survival analysis\n\nconsistent estimates of variances and covariances even if the events are de-\npendent. lin407 also discussed how this method can easily be used to model\nmultiple events of differing types.\n\n14\n\n17.7 r functions\n\nthe event.chart function of lee et al.394 will draw a variety of charts for dis-\nplaying raw survival time data, for both single and multiple events per sub-\nject. relationships with covariables can also be displayed. the event.history\nfunction of dubin et al.166 draws an event history graph for right-censored\nsurvival data, including time-dependent covariate status. these function are\nin the hmisc package.\n\nthe analyses described in this chapter can be viewed as special cases of the\ncox proportional hazards model.132 the programs for cox model analyses\ndescribed in section 20.13 can be used to obtain the results described here, as\nlong as there is at least one stratification factor in the model. there are, how-\never, several r functions that are pertinent to the homogeneous or stratified\ncase. the r function survfit, and its particular renditions of the print, plot,\nlines, and points generic functions (all part of the survival package written\nby terry therneau), will compute, print, and plot kaplan\u2013meier and nelson\nsurvival estimates. confidence intervals for s(t) may be based on s, \u03bb, or\nlog \u03bb. the rms package\u2019s front-end to the survival package\u2019s survfit function\nis npsurv for \u201cnonparametric survival\u201d. it and other functions described in\nlater chapters use therneau\u2019s surv function to combine the response variable\nand event indicator into a single r \u201csurvival time\u201d object. in its simplest form,\nuse surv(y, event), where y is the failure/right\u2013censoring time and event is\nthe event/censoring indicator, usually coded t/f, 0 = censored 1 = event or\n1 = censored 2 = event. if the event status variable has other coding (e.g., 3\nmeans death), use surv(y, s==3). to handle interval time-dependent covari-\nables, or to use andersen and gill\u2019s counting process formulation of the cox\nmodel,23 use the notation surv(tstart, tstop, status). the counting process\nnotation allows subjects to enter and leave risk sets at random. for each\ntime interval for each subject, the interval is made up of tstart< t \u2264tstop.\nfor time-dependent stratification, there is an optional origin argument to\nsurv that indicates the hazard shape time origin at the time of crossover\nto a new stratum. a type argument is used to handle left\u2013 and interval\u2013\ncensoring, especially for parametric survival models. possible values of type\nare \"right\",\"left\",\"interval\",\"counting\",\"interval2\",\"mstate\".\n\nthe surv expression will usually be used inside another function, but it is\nfine to save the result of surv in another object and to use this object in the\nparticular fitting function.\n\nnpsurv is invoked by the following, with default parameter settings indi-\n\ncated.\n\n "}, {"Page_number": 439, "text": "17.7 r functions\n\n419\n\nrequire ( rms )\n\nunits ( y ) \u2190 \" month \"\nnpsurv ( surv (y , event ) \u223c svar1 + svar2 + ... , data , subset ,\n\n# d e f a u l t is \" day \" - used for axis labels , etc.\n\ntype = c ( \" kaplan-meier \" , \" fleming-har ri ng t on \" , \" fh2 \" ),\nerror = c ( \" greenwood \" , \" tsiatis \" ), se.fit = true ,\nconf.int = .95 ,\nconf.type = c ( \" log \" ,\" log-log \" ,\" plain \" ,\" none \" ), ... )\n\nif there are no stratification variables (svar1, . . . ), omit them. to print a table\nof estimates, use\nf \u2190 npsurv ( ... )\n\nprint ( f )\nsummary (f , times , censored = false )\n\n# p r i n t b r i e f s u m m a r y of f\n\n# in s u r v i v a l\n\nfor failure times stored in days, use\nf \u2190 npsurv ( surv ( futime , event ) \u223c sex )\n\nsummary (f , seq (30 , 180 , by =30))\n\nto print monthly estimates.\n\nthere is a plot method to plot the object returned by survfit and npsurv.\n\nthis invokes plot.survfit.\n\nobjects created by npsurv can be passed to the more comprehensive plot-\nting function survplot (here, actually survplot.npsurv) for other options that\ninclude automatic curve labeling and showing the number of subjects at risk\nat selected times. see figure 17.6 for an example. stratified estimates, with\nfour treatments distinguished by line type and curve labels, could be drawn\nby\nunits ( y ) \u2190 \" year \"\nf \u2190 npsurv ( surv (y , stat ) \u223c treatment )\n\nsurvplot (f , ylab = \" fraction pain-free \" )\n\nthe groupkm in rms computes and optionally plots skm(u) or log \u03bbkm(u) (if\nloglog=true) for fixed u with automatic stratification on a continuous predic-\ntor x. as in cut2 (section 6.2) you can specify the number of subjects per\ninterval (default is m=50), the number of quantile groups (g), or the actual cut-\npoints (cuts). groupkm plots the survival or log\u2013log survival estimate against\nmean x in each x interval.\n\nthe bootkm function in the hmisc package bootstraps kaplan\u2013meier sur-\nvival estimates or kaplan\u2013meier estimates of quantiles of the survival time\ndistribution. it is easy to use bootkm to compute, for example, a nonparametric\nconfidence interval for the ratio of median survival times for two groups.\n\nsee the web site for a list of functions from other users for nonparametric\nestimation of s(t) with left\u2013, right\u2013, and interval\u2013censored data. the adaptive\nlinear spline log-hazard fitting function heft361 is freely available.\n\n "}, {"Page_number": 440, "text": "420\n\n17 introduction to survival analysis\n\n17.8 further reading\n\n1\n\n2\n\n3\n\n4\n\n5\n6\n\n7\n\n8\n\n9\n\n10\n\nsome excellent general references for survival analysis are [57, 83, 114, 133, 154,\n197, 282, 308, 331, 350, 382, 392, 444, 484, 574, 604]. govindarajulu et al.229 have\na nice review of frailty models in survival analysis, for handling clustered time-\nto-event data.\nsee goldman,220 bull and spiegelhalter,83, lee et al.394, and dubin et al.166\nfor ways to construct descriptive graphs depicting right\u2013censored data.\nsome useful references for left\u2013truncation are [83,112,244,524]. mandel435 care-\nfully described the difference between censoring and truncation.\nsee [384, p. 164] for some ideas for detecting informative censoring. bilker and\nwang54 discuss right\u2013truncation and contrast it with right\u2013censoring.\narjas29 has applications based on properties of the cumulative hazard function.\nkooperberg et al.361, 594 have an adaptive method for fitting hazard functions\nusing linear splines in the log hazard. binquet et al.56 studied a related approach\nusing quadratic splines. mudholkar et al.466 presented a generalized weibull\nmodel allowing for a variety of hazard shapes.\nhollander et al.299 provide a nonparametric simultaneous confidence band for\ns(t), surprisingly using likelihood ratio methods. miller459 showed that if the\nparametric form of s(t) is known to be weibull with known shape parameter (an\nunlikely scenario), the kaplan\u2013meier estimator is very inefficient (i.e., has high\nvariance) when compared with the parametric maximum likelihood estimator.\nsee [666] for a discussion of how the efficiency of kaplan\u2013meier estimators can\nbe improved by interpolation as opposed to piecewise flat step functions. that\npaper also discusses a variety of other estimators, some of which are significantly\nmore efficient than kaplan\u2013meier.\nsee [112, 244, 438, 570, 614, 619] for methods of estimating s or \u03bb in the presence\nof left\u2013truncation. see turnbull616 for nonparametric estimation of s(t) with\nleft\u2013, right\u2013, and interval\u2013censoring, and kooperberg and clarkson360 for a\nflexible parametric approach to modeling that allows for interval\u2013censoring.\nlindsey and ryan413 have a nice tutorial on the analysis of interval\u2013censored\ndata.\nhogan and laird297, 298 developed methods for dealing with mixtures of fa-\ntal and nonfatal outcomes, including some ideas for handling outcome-related\ndropouts on the repeated measurements. see also finkelstein and schoenfeld.193\nthe 30 april 1997 issue of statistics in medicine (vol. 16) is devoted to methods\nfor analyzing multiple endpoints as well as designing multiple endpoint stud-\nies. the papers in that issue are invaluable, as is therneau and hamilton606\nand therneau and grambsch.604 huang and wang311 presented a joint model\nfor recurrent events and a terminating event, addressing such issues as the fre-\nquency of recurrent events by the time of the terminating event.\nsee lunn and mcneil429 and marubini and valsecchi [444, chapter 10] for\npractical approaches to analyzing competing risks using ordinary cox propor-\ntional hazards models. a nice overview of competing risks with comparisons of\nvarious approaches is found in tai et al.599, geskus214, and koller et al.358.\nbryant and dignam78 developed a semiparametric procedure in which com-\npeting risks are adjusted for nonparametrically while a parametric cumulative\nincidence function is used for the event of interest, to gain precision. fine and\ngray192 developed methods for analyzing competing risks by estimating sub-\ndistribution functions. nishikawa et al.478 developed some novel approaches to\ncompeting risk analysis involving time to adverse drug events competing with\ntime to withdrawal from therapy. they also dealt with different severities of\nevents in an interesting way. putter et al.517 has a nice tutorial on competing\nrisks, multi-state models, and associated r software. fiocco et al.194 developed\n\n "}, {"Page_number": 441, "text": "17.9 problems\n\n421\n\n11\n\n12\n\n13\n\n14\n\nan approach to avoid the problems caused by having to estimate a large num-\nber of regression coefficients in multi-state models. ambrogi et al.22 provide\nclinically useful estimates from competing risks analyses.\njiang, chappell, and fine322 present methods for estimating the distribution\nof event times of nonfatal events in the presence of terminating events such as\ndeath.\nshen and thall568 have developed a flexible parametric approach to multi-state\nsurvival analysis.\nlancar et al.372 developed a method for analyzing repeated events of varying\nseverities.\nlawless and nadeau384 have a very good description of models dealing with\nrecurrent events. they use the notion of the cumulative mean function, which\nis the expected number of events experienced by a subject by a certain time.\nlawless383 contrasts this approach with other approaches. see aalen et al.3\nfor a nice example in which multivariate failure times (time to failure of fill-\nings in multiple teeth per subject) are analyzed. francis and fuller204 devel-\noped a graphical device for depicting complex event history data. therneau and\nhamilton606 have very informative comparisons of various methods for model-\ning multiple events, showing the importance of whether the analyst starts the\nclock over after each event. kelly and lim343 have another very useful paper\ncomparing various methods for analyzing recurrent events. wang and chang650\ndemonstrated the difficulty of using kaplan\u2013meier estimates for recurrence time\ndata.\n\n17.9 problems\n\n1. make a rough drawing of a hazard function from birth for a man who de-\nvelops significant coronary artery disease at age 50 and undergoes coronary\nartery bypass surgery at age 55.\n\n2. define in words the relationship between the hazard function and the sur-\n\nvival function.\n\n3. in a study of the life expectancy of light bulbs as a function of the bulb\u2019s\nwattage, 100 bulbs of various wattage ratings were tested until each had\nfailed. what is wrong with using the product-moment linear correlation\ntest to test whether wattage is associated with life length concerning (a)\ndistributional assumptions and (b) other assumptions?\n\n4. a placebo-controlled study is undertaken to ascertain whether a new drug\ndecreases mortality. during the study, some subjects are withdrawn be-\ncause of moderate to severe side effects. assessment of side effects and\nwithdrawal of patients is done on a blinded basis. what statistical tech-\nnique can be used to obtain an unbiased treatment comparison of survival\ntimes? state at least one efficacy endpoint that can be analyzed unbiasedly.\n5. consider long-term follow-up of patients in the support dataset. what pro-\nportion of the patients have censored survival times? does this imply that\none cannot make accurate estimates of chances of survival? make a his-\ntogram or empirical distribution function estimate of the censored follow-\nup times. what is the typical follow-up duration for a patient in the study\n\n "}, {"Page_number": 442, "text": "422\n\n17 introduction to survival analysis\n\nwho has survived so far? what is the typical survival time for patients who\nhave died? taking censoring into account, what is the median survival time\nfrom the kaplan\u2013meier estimate of the overall survival function? estimate\nthe median graphically or using any other sensible method.\n\n6. plot kaplan\u2013meier survival function estimates stratified by dzclass. esti-\nmate the median survival time and the first quartile of time until death\nfor each of the four disease classes.\n\n7. repeat problem 6 except for tertiles of meanbp.\n8. the commonly used log-rank test for comparing survival times between\ngroups of patients is a special case of the test of association between the\ngrouping variable and survival time in a cox proportional hazards regres-\nsion model. depending on how one handles tied failure times, the log-rank\n\u03c72 statistic exactly equals the score \u03c72 statistic from the cox model, and\nthe likelihood ratio and wald \u03c72 test statistics are also appropriate. to\nobtain global score or lr \u03c72 tests and p -values you can use a statement as\nthe following, where cph is in the rms package. it is similar to the survival\npackage\u2019s coxph function.\ncph ( survobject \u223c predictor )\n\nhere survobject is a survival time object created by the surv function. ob-\ntain the log-rank (score) \u03c72 statistic, degrees of freedom, and p -value for\ntesting for differences in survival time between levels of dzclass. interpret\nthis test, referring to the graph you produced in problem 6 if needed.\n\n9. do preliminary analyses of survival time using the mayo clinic primary bil-\niary cirrhosis dataset described in section 8.9. make graphs of altschuler\u2013\nnelson or kaplan\u2013meier survival estimates stratified separately by a few\ncategorical predictors and by categorized versions of one or two continuous\npredictors. estimate median failure time for the various strata. you may\nwant to suppress confidence bands when showing multiple strata on one\ngraph. see [361] for parametric fits to the survival and hazard function for\nthis dataset.\n\n "}, {"Page_number": 443, "text": "chapter 18\nparametric survival models\n\n18.1 homogeneous models (no predictors)\n\nthe nonparametric estimator of s(t) is a very good descriptive statistic for\ndisplaying survival data. for many purposes, however, one may want to make\nmore assumptions to allow the data to be modeled in more detail. by speci-\nfying a functional form for s(t) and estimating any unknown parameters in\nthis function, one can\n\n1. easily compute selected quantiles of the survival distribution;\n2. estimate (usually by extrapolation) the expected failure time;\n3. derive a concise equation and smooth function for estimating s(t), \u03bb(t),\n\nand \u03bb(t); and\n\n4. estimate s(t) more precisely than skm(t) or s\u03bb(t) if the parametric form\n\nis correctly specified.\n\n18.1.1 specific models\n\nparametric modeling requires choosing one or more distributions. the weibull\nand exponential distributions were discussed in chapter 18. other commonly\nused survival distributions are obtained by transforming t and using a stan-\ndard distribution. the log transformation is most commonly employed. the\nlog-normal distribution specifies that log(t ) has a normal distribution with\nmean \u03bc and variance \u03c32. stated another way, log(t ) \u223c \u03bc + \u03c3\u0001, where \u0001\nhas a standard normal distribution. then s(t) = 1 \u2212 \u03c6((log(t) \u2212 \u03bc)/\u03c3),\nwhere \u03c6 is the standard normal cumulative distribution function. the log-\nlogistic distribution is given by s(t) = [1 + exp(\u2212(log(t) \u2212 \u03bc)/\u03c3)]\n\u22121. here\nlog(t ) \u223c \u03bc+\u03c3\u0001 where \u0001 follows a logistic distribution [1+exp(\u2212u)]\n\u22121. the log\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 18\n\n423\n\n "}, {"Page_number": 444, "text": "424\n\n18 parametric survival models\n\nextreme value distribution is given by s(t) = exp[\u2212 exp((log(t) \u2212 \u03bc)/\u03c3)], and\nlog(t ) \u223c \u03bc + \u03c3\u0001, where \u0001 \u223c 1 \u2212 exp[\u2212 exp(u)].\n\nthe generalized gamma and generalized f distributions provide a richer\nvariety of distribution and hazard functions127, 128. spline hazard\nmodels286, 287, 361 are other excellent alternatives.\n\n18.1.2 estimation\n\nmaximum likelihood (ml) estimation is used to estimate the unknown\nparameters of s(t). the general method presented in chapter 9 must be\naugmented, however, to allow for censored failure times. the basic idea is as\nfollows. again let t be a random variable representing time until the event,\nti be the (possibly censored) failure time for the ith observation, and yi\ndenote the observed failure or censoring time min(ti, ci), where ci is the\ncensoring time. if yi is uncensored, observation i contributes a factor to the\nlikelihood equal to the density function for t evaluated at yi, f (yi). if yi\ninstead represents a censored time so that ti = y +\n, it is only known that\ni\nti exceeds yi. the contribution to the likelihood function is the probability\nthat ti > ci (equal to prob{ti > yi}). this probability is s(yi). the joint\nlikelihood over all observations i = 1, 2, . . . , n is\n\nn(cid:8)\n\nn(cid:8)\n\nl =\n\nf (yi)\n\ns(yi).\n\n(18.1)\n\ni:yi uncensored\n\ni:yi censored\n\nthere is one more component to l: the distribution of censoring times if\nthese are not fixed in advance. recall that we assume that censoring is non-\ninformative, that is, it is independent of the risk of the event. this inde-\npendence implies that the likelihood component of the censoring distribution\nsimply multiplies l and that the censoring distribution contains little infor-\nmation about the survival distribution. in addition, the censoring distribution\nmay be very difficult to specify. for these reasons we can maximize l sepa-\nrately to estimate parameters of s(t) and ignore the censoring distribution.\nrecalling that f (t) = \u03bb(t)s(t) and \u03bb(t) = \u2212 log s(t), the log likelihood\n\ncan be written as\n\nlog l =\n\nn(cid:3)\n\nlog \u03bb(yi) \u2212 n(cid:3)\n\n\u03bb(yi).\n\n(18.2)\n\ni:yi uncensored\n\ni=1\n\nall observations then contribute an amount to the log likelihood equal to the\nnegative of the cumulative hazard evaluated at the failure/censoring time.\nin addition, uncensored observations contribute an amount equal to the log\nof the hazard function evaluated at the time of failure. once l or log l\nis specified, the general ml methods outlined earlier can be used without\n\n "}, {"Page_number": 445, "text": "n(cid:3)\n\nlog \u03bb \u2212 n(cid:3)\n\ni:yi uncensored\n\ni=1\n\nlog l = nu log \u03bb \u2212 n(cid:3)\n\n18.1 homogeneous models (no predictors)\n\n425\n\nchange in most situations. the principal difference is that censored observa-\ntions contribute less information to the statistical inference than uncensored\nobservations. for distributions such as the log-normal that are written only\nin terms of s(t), it may be easier to write the likelihood in terms of s(t)\nand f (t).\n\nas an example, we turn to the exponential distribution, for which log\nl has a simple form that can be maximized explicitly. recall that for this\ndistribution \u03bb(t) = \u03bb and \u03bb(t) = \u03bbt. therefore,\n\nlog l =\n\n\u03bbyi.\n\n(18.3)\n\nletting nu denote the number of uncensored event times,\n\n\u03bbyi.\n\n(18.4)\n\nletting w denote the sum of all failure/censoring times (\u201cperson years of\nexposure\u201d):\n\nn(cid:3)\n\ni=1\n\nthe derivatives of log l are given by\n\nw =\n\nyi,\n\ni=1\n\n\u2202 log l\n\n\u2202\u03bb\n\n= nu/\u03bb \u2212 w\n\u2202\u03bb2 = \u2212nu/\u03bb2.\n\n\u22022 log l\n\nequating the derivative of log l to zero implies that the mle of \u03bb is\n\n\u02c6\u03bb = nu/w\n\n(18.5)\n\n(18.6)\n\n(18.7)\n\nor the number of failures per person-years of exposure. by inserting the mle\nof \u03bb into the formula for the second derivative we obtain the observed esti-\nmated information, w2/nu. the estimated variance of \u02c6\u03bb is thus nu/w2 and\nthe standard error is n1/2\nu /w. the precision of the estimate depends primarily\non nu.\n\nrecall that the expected life length \u03bc is 1/\u03bb for the exponential distribu-\ntion. the mle of \u03bc is w/nu and its estimated variance is w2/n3\nu. the mle\nof s(t), \u02c6s(t), is exp(\u2212\u02c6\u03bbt), and the estimated variance of log( \u02c6\u03bb(t)) is simply\n1/nu.\n\nas an example, consider the sample listed previously,\n\n1 3 3 6+ 8+ 9 10+.\n\n "}, {"Page_number": 446, "text": "426\n\n18 parametric survival models\n\nhere nu = 4 and w = 40, so the mle of \u03bb is 0.1 failure per person-period.\nthe estimated standard error is 2/40 = 0.05. estimated expected life length\nis 10 units with a standard error of 5 units. estimated median failure time is\nlog(2)/0.1 = 6.931. the estimated survival function is exp(\u22120.1t), which at\nt = 1, 3, 9, 10 yields 0.90, 0.74, 0.41, and 0.37, which can be compared to the\nproduct limit estimates listed earlier (0.85, 0.57, 0.29, 0.29).\n\nnow consider the weibull distribution. the log likelihood function is\n\nn(cid:3)\n\n] \u2212 n(cid:3)\n\nlog l =\n\n\u03b3\u22121\nlog[\u03b1\u03b3y\ni\n\n\u03b1y\n\n\u03b3\ni .\n\n(18.8)\n\ni:yi uncensored\n\ni=1\n\nalthough log l can be simplified somewhat, it cannot be solved explicitly for\n\u03b1 and \u03b3. an iterative method such as the newton\u2013raphson method is used\nto compute the mles of \u03b1 and \u03b3. once these estimates are obtained, the\nestimated variance\u2013covariance matrix and other derived quantities such as\n\u02c6s(t) can be obtained in the usual manner.\n\nfor the dataset used in the exponential fit, the weibull fit follows.\n\n\u02c6\u03b1 = 0.0728\n\n\u02c6\u03b3 = 1.164\n\n\u02c6s(t) = exp(\u22120.0728t1.164)\n\n\u22121(0.5) = [(log 2)/ \u02c6\u03b1]1/\u02c6\u03b3 = 6.935 (estimated median).\n\n\u02c6s\n\n(18.9)\n\nthis fit is very close to the exponential fit since \u02c6\u03b3 is near 1.0. note that the\ntwo medians are almost equal. the predicted survival probabilities for the\nweibull model for t = 1, 3, 9, 10 are, respectively, 0.93, 0.77, 0.39, 0.35.\n\nsometimes a formal test can be made to assess the fit of the proposed\nparametric survival distribution. for the data just analyzed, a formal test of\nexponentiality versus a weibull alternative is obtained by testing h0 : \u03b3 = 1\nin the weibull model. a score test yielded \u03c72 = 0.14 with 1 d.f., p = 0.7,\nshowing little evidence for non-exponentiality (note that the sample size is\ntoo small for this test to have any power).\n\n18.1.3 assessment of model fit\n\nthe fit of the hypothesized survival distribution can often be checked eas-\nily using graphical methods. nonparametric estimates of s(t) and \u03bb(t)\nare primary tools for this purpose. for example, the weibull distribution\ns(t) = exp(\u2212\u03b1t\u03b3) can be rewritten by taking logarithms twice:\n\nlog[\u2212 log s(t)] = log \u03bb(t) = log \u03b1 + \u03b3(log t).\n\n(18.10)\n\n "}, {"Page_number": 447, "text": "18.2 parametric proportional hazards models\n\n427\n\nthe fit of a weibull model can be assessed by plotting log \u02c6\u03bb(t) versus log t\nand checking whether the curve is approximately linear. also, the plotted\ncurve provides approximate estimates of \u03b1 (the antilog of the intercept) and\n\u03b3 (the slope). since an exponential distribution is a special case of a weibull\ndistribution when \u03b3 = 1, exponentially distributed data will tend to have a\ngraph that is linear with a slope of 1.\n\n\u22121[s\u03bb(t)] or s\n\nfor any assumed distribution s(t), a graphical assessment of goodness of\n\u22121[skm(t)] against t and checking\nfit can be made by plotting s\nfor linearity. for log distributions, s specifies the distribution of log(t ), so\n\u22121[s\u03bb(t)]\nwe plot against log t. for a log-normal distribution we thus plot \u03c6\n\u22121 is the inverse of the standard normal cumulative\nagainst log t, where \u03c6\ndistribution function. for a log-logistic distribution we plot logit[s\u03bb(t)] versus\nlog t. for an extreme value distribution we use log \u2212 log plots as with the\nweibull distribution. parametric model fits can also be checked by plotting\nthe fitted \u02c6s(t) and s\u03bb(t) against t on the same graph.\n\n18.2 parametric proportional hazards models\n\nin this section we present one way to generalize the survival model to a\nsurvival regression model. in other words, we allow the sample to be hetero-\n\ngeneous by adding predictor variables x = {x1, x2, . . . , xk}. as with other\n\nregression models, x can represent a mixture of binary, polytomous, continu-\nous, spline-expanded, and even ordinal predictors (if the categories are scored\nto satisfy the linearity assumption). before discussing ways in which the re-\ngression part of a survival model might be specified, first recall how regression\neffects have been modeled in other settings. in multiple linear regression, the\nregression effect x\u03b2 = \u03b20 + \u03b21x1 + \u03b22x2 + . . . + \u03b2kxk can be thought of\nas an increment in the expected value of the response y . in binary logistic\nregression, x\u03b2 specifies the log odds that y = 1, or exp(x\u03b2) multiplies the\nodds that y = 1.\n\n18.2.1 model\n\nthe most widely used survival regression specification is to allow the hazard\nfunction \u03bb(t) to be multiplied by exp(x\u03b2). the survival model is thus gener-\nalized from a hazard function \u03bb(t) for the failure time t to a hazard function\n\u03bb(t) exp(x\u03b2) for the failure time given the predictors x:\n\n\u03bb(t|x) = \u03bb(t) exp(x\u03b2).\n\n(18.11)\n\n "}, {"Page_number": 448, "text": "428\n\n18 parametric survival models\n\nthis regression formulation is called the proportional hazards (ph) model.\nthe \u03bb(t) part of \u03bb(t|x) is sometimes called an underlying hazard function or\na hazard function for a standard subject, which is a subject with x\u03b2 = 0. any\nparametric hazard function can be used for \u03bb(t), and as we show later, \u03bb(t)\ncan be left completely unspecified without sacrificing the ability to estimate\n\u03b2, by the use of cox\u2019s semi-parametric ph model.132 depending on whether\nthe underlying hazard function \u03bb(t) has a constant scale parameter, x\u03b2 may\nor may not include an intercept \u03b20. the term exp(x\u03b2) can be called a relative\nhazard function and in many cases it is the function of primary interest as it\ndescribes the (relative) effects of the predictors.\n\nthe ph model can also be written in terms of the cumulative hazard and\n\nsurvival functions:\n\n\u03bb(t|x) = \u03bb(t) exp(x\u03b2)\ns(t|x) = exp[\u2212\u03bb(t) exp(x\u03b2)] = exp[\u2212\u03bb(t)]exp(x\u03b2).\n\n(18.12)\n\u03bb(t) is an \u201cunderlying\u201d cumulative hazard function. s(t|x), the probability\nof surviving past time t given the values of the predictors x, can also be\nwritten as\n\n(18.13)\nwhere s(t) is the \u201cunderlying\u201d survival distribution, exp(\u2212\u03bb(t)). the effect\nof the predictors is to multiply the hazard and cumulative hazard functions\nby a factor exp(x\u03b2), or equivalently to raise the survival function to a power\nequal to exp(x\u03b2).\n\ns(t|x) = s(t)exp(x\u03b2),\n\n18.2.2 model assumptions and interpretation\n\nof parameters\n\nin the general regression notation of section 2.2, the log hazard or log cumu-\nlative hazard can be used as the property of the response t evaluated at time\nt that allows distributional and regression parts to be isolated and checked.\nthe ph model can be linearized with respect to x\u03b2 using the following\nidentities.\n\nlog \u03bb(t|x) = log \u03bb(t) + x\u03b2\nlog \u03bb(t|x) = log \u03bb(t) + x\u03b2.\n\n(18.14)\n\nno matter which of the three model statements are used, there are certain\nassumptions in a parametric ph survival model. these assumptions are listed\nbelow.\n\n1. the true form of the underlying functions (\u03bb, \u03bb, and s) should be specified\n\ncorrectly.\n\n "}, {"Page_number": 449, "text": "18.2 parametric proportional hazards models\n\n429\n\n2. the relationship between the predictors and log hazard or log cumulative\nhazard should be linear in its simplest form. in the absence of interaction\nterms, the predictors should also operate additively.\n\n3. the way in which the predictors affect the distribution of the response\nshould be by multiplying the hazard or cumulative hazard by exp(x\u03b2)\nor equivalently by adding x\u03b2 to the log hazard or log cumulative hazard\nat each t. the effect of the predictors is assumed to be the same at all\nvalues of t since log \u03bb(t) can be separated from x\u03b2. in other words, the\nph assumption implies no t by predictor interaction.\n\nthe regression coefficient for xj, \u03b2j, is the increase in log hazard or log\ncumulative hazard at any fixed point in time if xj is increased by one unit\nand all other predictors are held constant. this can be written formally as\n\n\u03b2j = log \u03bb(t|x1, x2, . . . , xj + 1, xj+1, . . . , xk)\u2212 log \u03bb(t|x1, . . . , xj, . . . , xk),\n\n(18.15)\nwhich is equivalent to the log of the ratio of the hazards at time t. the\nregression coefficient can just as easily be written in terms of a ratio of hazards\nat time t. the ratio of hazards at xj + d versus xj, all other factors held\nconstant, is exp(\u03b2jd). thus the effect of increasing xj by d is to increase the\nhazard of the event by a factor of exp(\u03b2jd) at all points in time, assuming xj\nis linearly related to log \u03bb(t). in general, the ratio of hazards for an individual\nwith predictor variable values x\ncompared to an individual with predictors\nx is\n\n\u2217\n\n\u2217\n\nx\n\n: x hazard ratio = [\u03bb(t) exp(x\n\n\u03b2)]/[\u03bb(t) exp(x\u03b2)]\n\n= exp(x\n\n\u03b2)/ exp(x\u03b2) = exp[(x\n\n\u2217 \u2212 x)\u03b2].\n\n(18.16)\n\n\u2217\n\n\u2217\n\nif there is only one predictor x1 and that predictor is binary, the ph model\ncan be written\n\n\u03bb(t|x1 = 0) = \u03bb(t)\n\u03bb(t|x1 = 1) = \u03bb(t) exp(\u03b21).\n\n(18.17)\n\nhere exp(\u03b21) is the x1 = 1 : x1 = 0 hazard ratio. this simple case has\nno regression assumption but assumes ph and a form for \u03bb(t). if the single\npredictor x1 is continuous, the model becomes\n\n\u03bb(t|x1) = \u03bb(t) exp(\u03b21x).\n\n(18.18)\n\nwithout further modification (such as taking a transformation of the predic-\ntor), the model assumes a straight line in the log hazard or that for all t, an\nincrease in x by one unit increases the hazard by a factor of exp(\u03b21).\n\nas in logistic regression, much more general regression specifications can\nbe made, including interaction effects. unlike logistic regression, however, a\nmodel containing, say age, sex, and age \u00d7 sex interaction is not equivalent to\n\n "}, {"Page_number": 450, "text": "430\n\n18 parametric survival models\n\nfitting two separate models. this is because even though males and females\nare allowed to have unequal age slopes, both sexes are assumed to have the\n\ntable 18.1 mortality differences and ratios when hazard ratio is 0.5\n\nsubject 5-year difference mortality\n\nsurvival\nc t\n\n0.98 0.99\n0.80 0.89\n0.25 0.50\n\nratio (t/c)\n\n0.01\n0.09\n0.25\n\n0.01/0.02 = 0.5\n0.11/0.2 = 0.55\n0.5/0.75 = 0.67\n\n1\n2\n3\n\nunderlying hazard function proportional to \u03bb(t) (i.e., the ph assumption\nholds for sex in addition to age).\n\n18.2.3 hazard ratio, risk ratio, and risk\n\ndifference\n\nother ways of modeling predictors can also be specified besides a multiplica-\ntive effect on the hazard. for example, one could postulate that the effect of\na predictor is to add to the hazard of failure instead of to multiply it by a\nfactor. the effect of a predictor could also be described in terms of a mor-\ntality ratio (relative risk), risk difference, odds ratio, or increase in expected\nfailure time. however, just as an odds ratio is a natural way to describe an\neffect on a binary response, a hazard ratio is often a natural way to describe\nan effect on survival time. one reason is that a hazard ratio can be constant.\ntable 18.1 provides treated (t) to control (c) survival (mortality) dif-\nferences and mortality ratios for three hypothetical types of subjects. we\nsuppose that subjects 1, 2, and 3 have increasingly worse prognostic factors.\nfor example, the age at baseline of the subjects might be 30, 50, and 70 years,\nrespectively. we assume that the treatment affects the hazard by a constant\nmultiple of 0.5 (i.e., ph is in effect and the constant hazard ratio is 0.5). note\nthat st = s0.5\nc . notice that the mortality difference and ratio depend on the\nsurvival of the control subject. a control subject having \u201cgood\u201d predictor\nvalues will leave little room for an improved prognosis from the treatment.\n\nthe hazard ratio is a basis for describing the mechanism of an effect. in the\nabove example, it is reasonable that the treatment affect each subject by low-\nering her hazard of death by a factor of 2, even though less sick subjects have\na low mortality difference. hazard ratios also lead to good statistical tests\nfor differences in survival patterns and to predictive models. once the model\nis developed, however, survival differences may better capture the impact of\na risk factor. absolute survival differences rather than relative differences\n\n "}, {"Page_number": 451, "text": "18.2 parametric proportional hazards models\n\n431\n\n(hazard ratios) also relate more closely to statistical power. for example,\neven if the effect of a treatment is to halve the hazard rate, a population\nwhere the control survival is 0.99 will require a much larger sample than will\na population where the control survival is 0.3.\n\nfigure 18.1 depicts the relationship between survival s(t) of a control\nsubject at any time t, relative reduction in hazard (h), and difference in\nsurvival s(t)\u2212 s(t)h. this figure demonstrates that absolute clinical benefit\n\nl\n\ni\n\na\nv\nv\nr\nu\ns\nn\n\n \n\ni\n \nt\n\nn\ne\nm\ne\nv\no\nr\np\nm\n\ni\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\n0.2\n\n0.1\n\n0.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nsurvival for control subject\n\nfig. 18.1 absolute clinical benefit as a function of survival in a control subject and\nthe relative benefit (hazard ratio). the hazard ratios are given for each curve.\n\nis primarily a function of the baseline risk of a subject. clinical benefit will\nalso be a function of factors that interact with treatment, that is, factors\nthat modify the relative benefit of treatment. once a model is developed\nfor estimating s(t|x), this model can be used to estimate absolute benefit\nas a function of baseline risk factors as well as factors that interact with a\ntreatment. let x1 be a binary treatment indicator and let a = {x2, . . . , xp}\nx1). then the estimate of s(t|x1 = 0, a) \u2212 s(t|x1 = 1, a) can be plotted\nagainst s(t|x1 = 0) or against levels of variables in a to display absolute\n\nbe the other factors (which for convenience we assume do not interact with\n\nbenefit versus overall risk or specific subject characteristics.\n\n1\n\n18.2.4 specific models\n\nlet x\u03b2 denote the linear combination of predictors excluding an intercept\nterm. using the ph formulation, an exponential survival regression model218\ncan be stated as\n\n "}, {"Page_number": 452, "text": "432\n\n18 parametric survival models\n\n\u03bb(t|x) = \u03bb exp(x\u03b2)\ns(t|x) = exp[\u2212\u03bbt exp(x\u03b2)] = exp(\u2212\u03bbt)exp(x\u03b2).\n\n(18.19)\n\nthe parameter \u03bb can be thought of as the antilog of an intercept term since\nthe model could be written \u03bb(t|x) = exp[(log \u03bb) + x\u03b2]. the effect of x on\nthe expected or median failure time is as follows.\ne{t|x} = 1/[\u03bb exp(x\u03b2)]\nt0.5|x = (log 2)/[\u03bb exp(x\u03b2)].\n\n(18.20)\n\nthe exponential regression model can be written in another form that is more\nnumerically stable by replacing the \u03bb parameter with an intercept term in\nx\u03b2, specifically \u03bb = exp(\u03b20). after redefining x\u03b2 to include \u03b20, \u03bb can be\ndropped in all the above formulas.\n\nthe weibull regression model is defined by one of the following functions\n\n(assuming that x\u03b2 does not contain an intercept).\n\u03bb(t|x) = \u03b1\u03b3t\u03b3\u22121 exp(x\u03b2)\n\u03bb(t|x) = \u03b1t\u03b3 exp(x\u03b2)\ns(t|x) = exp[\u2212\u03b1t\u03b3 exp(x\u03b2)]\n= [exp(\u2212\u03b1t\u03b3)]exp(x\u03b2).\n\n(18.21)\n\nnote that the parameter \u03b1 in the homogeneous weibull model has been\nreplaced with \u03b1 exp(x\u03b2). the median survival time is given by\n\nt0.5|x = {log 2/[\u03b1 exp(x\u03b2)]}1/\u03b3.\n\n(18.22)\n\nas with the exponential model, the parameter \u03b1 could be dropped (and\nreplaced with exp(\u03b20)) if an intercept \u03b20 is added to x\u03b2.\n\nfor numerical reasons it is sometimes advantageous to write the weibull\n\nph model as\n\nwhere\n\ns(t|x) = exp(\u2212\u03bb(t|x)),\n\n\u03bb(t|x) = exp(\u03b3 log t + x\u03b2).\n\n(18.23)\n\n(18.24)\n\n18.2.5 estimation\n\nthe parameters in \u03bb and \u03b2 are estimated by maximizing a log likelihood\nfunction constructed in the same manner as described in section 18.1. the\nonly difference is the insertion of exp(xi\u03b2) in the likelihood function:\n\n "}, {"Page_number": 453, "text": "18.2 parametric proportional hazards models\n\nn(cid:3)\n\nlog[\u03bb(yi) exp(xi\u03b2)] \u2212 n(cid:3)\n\n433\n\n\u03bb(yi) exp(xi\u03b2).\n\n(18.25)\n\nlog l =\n\ni:yi uncensored\n\ni=1\n\nonce \u02c6\u03b2, the mle of \u03b2, is computed along with the large-sample standard\nerror estimates, hazard ratio estimates and their confidence intervals can\nreadily be computed. letting s denote the estimated standard error of \u02c6\u03b2j,\na 1 \u2212 \u03b1 confidence interval for the xj + 1 : xj hazard ratio is given by\nexp[ \u02c6\u03b2j \u00b1 zs], where z is the 1 \u2212 \u03b1/2 critical value for the standard normal\ndistribution.\nonce the parameters of the underlying hazard function are estimated, the\nmle of \u03bb(t), \u02c6\u03bb(t), can be derived. the mle of \u03bb(t|x), the hazard as a\nfunction of t and x, is given by\n\n\u02c6\u03bb(t|x) = \u02c6\u03bb(t) exp(x \u02c6\u03b2).\n\n(18.26)\n\nthe mle of \u03bb(t), \u02c6\u03bb(t), can be derived from the integral of \u02c6\u03bb(t) with respect\nto t. then the mle of s(t|x) can be derived:\n\n\u02c6s(t|x) = exp[\u2212 \u02c6\u03bb(t) exp(x \u02c6\u03b2)].\n\n(18.27)\n\nfor the weibull model, we denote the mles of the hazard parameters \u03b1 and\n\u03b3 by \u02c6\u03b1 and \u02c6\u03b3. the mle of \u03bb(t|x), \u03bb(t|x), and s(t|x) for this model are\n\n\u02c6\u03bb(t|x) = \u02c6\u03b1\u02c6\u03b3t\u02c6\u03b3\u22121 exp(x \u02c6\u03b2)\n\u02c6\u03bb(t|x) = \u02c6\u03b1t\u02c6\u03b3 exp(x \u02c6\u03b2)\n\u02c6s(t|x) = exp[\u2212 \u02c6\u03bb(t|x)].\n\n(18.28)\n\nconfidence intervals for s(t|x) are best derived using general matrix notation\nto obtain an estimate s of the standard error of log[\u02c6\u03bb(t|x)] from the estimated\ninformation matrix of all hazard and regression parameters. a confidence\ninterval for \u02c6s will be of the form\n\n\u02c6s(t|x)exp(\u00b1zs).\n\n(18.29)\n\nthe mles of \u03b2 and of the hazard shape parameters lead directly to mles\nof the expected and median life length. for the weibull model the mle of\nthe median life length given x is\n\n\u02c6t0.5|x = {log 2/[\u02c6\u03b1 exp(x \u02c6\u03b2)]}1/\u02c6\u03b3.\n\n(18.30)\n\nfor the exponential model, the mle of the expected life length for a subject\nhaving predictor values x is given by\n\n\u02c6e(t|x) = [\u02c6\u03bb exp(x \u02c6\u03b2)]\n\n\u22121,\n\n(18.31)\n\nwhere \u02c6\u03bb is the mle of \u03bb.\n\n "}, {"Page_number": 454, "text": "434\n\n18 parametric survival models\n\nx1 =1\n\nx1 =0\n\n\u03b21\n\nt\n\nfig. 18.2 ph model with one binary predictor. y -axis is log \u03bb(t) or log \u03bb(t). for\nlog \u03bb(t), the curves must be non-decreasing. for log \u03bb(t), they may be any shape.\n\n18.2.6 assessment of model fit\n\nthree assumptions of the parametric ph model were listed in section 18.2.2.\nwe now lay out in more detail what relationships need to be satisfied. we\nfirst assume a ph model with a single binary predictor x1. for a general\nunderlying hazard function \u03bb(t), all assumptions of the model are displayed\nin figure 18.2. in this case, the assumptions are ph and a shape for \u03bb(t).\n\nif \u03bb(t) is weibull, the two curves will be linear if log t is plotted instead\nof t on the x-axis. note also that if there is no association between x and\nsurvival (\u03b21 = 0), estimates of the two curves will be close and will intertwine\ndue to random variability. in this case, ph is not an issue.\n\nif the single predictor is continuous, the relationships in figures 18.3\nand 18.4 must hold. here linearity is assumed (unless otherwise specified)\nbesides ph and the form of \u03bb(t). in figure 18.3, the curves must be parallel\nfor any choices of times t1 and t2 as well as each individual curve being lin-\near. also, the difference between ordinates needs to conform to the assumed\ndistribution. this difference is log[\u03bb(t2)/\u03bb(t1)] or log[\u03bb(t2)/\u03bb(t1)].\n\nfigure 18.4 highlights the ph assumption. the relationship between the\ntwo curves must hold for any two values c and d of x1. the shape of the\nfunction for a given value of x1 must conform to the assumed \u03bb(t). for a\nweibull model, the functions should each be linear in log t.\n\nwhen there are multiple predictors, the ph assumption can be displayed in\na way similar to figures 18.2 and 18.4 but with the population additionally\ncross-classified by levels of the other predictors besides x1. if there is one\nbinary predictor x1 and one continuous predictor x2, the relationship in\n\n "}, {"Page_number": 455, "text": "18.2 parametric proportional hazards models\n\n435\n\nt=t2\n\nt=t1\n\nfig. 18.3 ph model with one continuous predictor. y -axis is log \u03bb(t) or log \u03bb(t); for\nlog \u03bb(t), drawn for t2 > t1. the slope of each line is \u03b21.\n\nx1\n\n(d-c) \u03b21\n\nx1= d\n\nx1= c\n\nfig. 18.4 ph model with one continuous predictor. y -axis is log \u03bb(t) or log \u03bb(t). for\nlog \u03bb, the functions need not be monotonic.\n\nt\n\nfigure 18.5 must hold at each time t if linearity is assumed for x2 and there\nis no interaction between x1 and x2. methods for verifying the regression\nassumptions (e.g., splines and residuals) and the ph assumption are covered\nin detail under the cox ph model in chapter 20.\n\nthe method for verifying the assumed shape of s(t) in section 18.1.3 is also\nuseful when there are a limited number of categorical predictors. to validate\n\na weibull ph model one can stratify on x and plot log \u03bbkm(t|x stratum)\n\nagainst log t. this graph simultaneously assesses ph in addition to shape\nassumptions\u2014all curves should be parallel as well as straight. straight but\nnonparallel (non-ph) curves indicate that a series of weibull models with\ndiffering \u03b3 parameters will fit.\n\n "}, {"Page_number": 456, "text": "436\n\n18 parametric survival models\n\nx1 =1\n\nx1 =0\n\n\u03b21\n\nslope = \u03b22\n\nx2\n\nfig. 18.5 regression assumptions, linear additive ph or aft model with two pre-\ndictors. for ph, y -axis is log \u03bb(t) or log \u03bb(t) for a fixed t. for aft, y -axis is log(t ).\n\n18.3 accelerated failure time models\n\n18.3.1 model\n\nbesides modeling the effect of predictors by a multiplicative effect on the\nhazard function, other regression effects can be specified. the accelerated\nfailure time (aft) model is commonly used; it specifies that the predictors\nact multiplicatively on the failure time or additively on the log failure time.\nthe effect of a predictor is to alter the rate at which a subject proceeds along\nthe time axis (i.e., to accelerate the time to failure [331, pp. 33\u201335]). the\nmodel is\n\ns(t|x) = \u03c8((log(t) \u2212 x\u03b2)/\u03c3),\n\n(18.32)\n\nwhere \u03c8 is any standardized survival distribution function. the parameter \u03c3 is\ncalled the scale parameter. the model can also be stated as (log(t )\u2212x\u03b2)/\u03c3 \u223c\n\u03c8 or log(t ) = x\u03b2 + \u03c3\u0001, where \u0001 is a random variable from the distribution\n\u03c8. sometimes the untransformed t is used in place of log(t ). when the log\nform is used, the models are said to be log-normal, log-logistic, and so on.\n\nthe exponential and weibull are the only two distributions that can de-\n\nscribe either a ph or an aft model.\n\n18.3.2 model assumptions and interpretation\n\nof parameters\n\nthe log \u03bb or log \u03bb transformation of the ph model has the following equiva-\nlent for aft models.\n\n2\n\n3\n\n "}, {"Page_number": 457, "text": "18.3 accelerated failure time models\n\n\u22121[s(t|x)] = (log(t) \u2212 x\u03b2)/\u03c3.\n\n\u03c8\n\n437\n\n(18.33)\n\nletting as before \u0001 denote a random variable from the distribution s, the\nmodel is also\n\nlog(t ) = x\u03b2 + \u03c3\u0001.\n\n(18.34)\n\nso the property of the response t of interest for regression modeling is log(t ).\nin the absence of censoring, we could check the model by plotting an x\nagainst log t and checking that the residuals log(t ) \u2212 x \u02c6\u03b2 are distributed as\n\u03c8 to within a scale factor.\n\nthe assumptions of the aft model are thus the following.\n\n1. the true form of \u03c8 (the distributional family) is correctly specified.\n2. in the absence of nonlinear and interaction terms, each xj affects log(t )\n\n\u22121[s(t|x)] linearly.\n\nor \u03c8\n\n3. implicit in these assumptions is that \u03c3 is a constant independent of x.\n\na one-unit change in xj is then most simply understood as a \u03b2j change in\nthe log of the failure time. the one-unit change in xj increases the failure\ntime by a factor of exp(\u03b2j).\nthe median survival time is obtained by solving \u03c8((log(t)\u2212 x\u03b2)/\u03c3) = 0.5\n\ngiving\n\nt0.5|x = exp[x\u03b2 + \u03c3\u03c8\n\n\u22121(0.5)]\n\n(18.35)\n\n18.3.3 specific models\n\ncommon choices for the distribution function \u03c8 in equation 18.32 are the\nextreme value distribution \u03c8(u) = exp(\u2212 exp(u)), the logistic distribution\n\u22121, and the normal distribution \u03c8(u) = 1 \u2212 \u03c6(u). the\n\u03c8(u) = [1 + exp(u)]\naft model equivalent of the weibull model is obtained by using the extreme\nvalue distribution, negating \u03b2, and replacing \u03b3 with 1/\u03c3 in equation 18.24:\n\ns(t|x) = exp[\u2212 exp((log(t) \u2212 x\u03b2)/\u03c3)]\nt0.5|x = [log(2)]\u03c3 exp(x\u03b2).\n\n(18.36)\n\nthe exponential model is obtained by restricting \u03c3 = 1 in the extreme value\ndistribution.\n\nthe log-normal regression model is\n\ns(t|x) = 1 \u2212 \u03c6((log(t) \u2212 x\u03b2)/\u03c3),\n\nand the log-logistic model is\n\ns(t|x) = [1 + exp((log(t) \u2212 x\u03b2)/\u03c3)]\n\n\u22121.\n\n(18.37)\n\n(18.38)\n\n "}, {"Page_number": 458, "text": "438\n\n18 parametric survival models\n\nthe t distribution allows for more flexibility by varying the degrees of free-\ndom. figure 18.6 depicts possible hazard functions for the log t distribution\nfor varying \u03c3 and degrees of freedom. however, this distribution does not\nhave a late increasing hazard phase typical of human survival.\n\nrequire ( rms )\n\nhaz \u2190 s u r v r e g . a u x i n f o $ t $ hazard\ntimes \u2190 c ( seq (0 , .25 , length =100) , seq ( .26 , 2 , length =150))\nhigh \u2190 c (6 , 1 .5 , 1 .5 , 1 .75 )\nlow \u2190 c (0 , 0 , 0 , .25 )\ndfs \u2190 c (1 , 2 , 3 , 5 , 7 , 15 , 500)\ncols \u2190 rep (1 , 7)\nltys \u2190 1:7\ni \u2190 0\n\nfor ( scale in c ( .25 , .6 , 1 , 2)) {\n\ni \u2190 i + 1\n\nplot (0 , 0 , xlim = c (0 ,2) , ylim = c ( low [ i ] , high [ i ]) ,\n\nxlab = expressio n ( t ) , ylab = expression ( lambda ( t )) , type = \" n \" )\n\ncol \u2190 1 .09\nj \u2190 0\n\nfor ( df in dfs ) {\n\nj \u2190 j +1\n## divide by t to get hazard for log t distribution\nlines ( times ,\n\nhaz ( log ( times ) , 0 , c ( log ( scale ) , df )) / times ,\ncol = cols [ j ] , lty = ltys [ j ])\n\nif ( i ==1) text (1 .7 , .23 + haz ( log (1 .7 ) , 0 ,\n\nc ( log ( scale ) , df )) / 1 .7 , format ( df ))\n\n}\ntitle ( paste (\" scale : \" , format ( scale )))\n\n}\n\n# figure 18.6\n\nall three of these parametric survival models have median survival time\n\nt0.5|x = exp(x\u03b2).\n\n18.3.4 estimation\n\nmaximum likelihood estimation is used much the same as in section 18.2.5.\ncare must be taken in the choice of initial values; iterative methods are\nespecially prone to problems in choosing the initial \u02c6\u03c3. estimation works better\nif \u03c3 is parameterized as exp(\u03b4). once \u03b2 and \u03c3 (exp(\u03b4)) are estimated, mles of\nsecondary parameters such as survival probabilities and medians can readily\nbe obtained:\n\n\u02c6s(t|x) = \u03c8((log(t) \u2212 x \u02c6\u03b2)/\u02c6\u03c3)\n\u02c6t0.5|x = exp[x \u02c6\u03b2 + \u02c6\u03c3\u03c8\n\n\u22121(0.5)].\n\n(18.39)\n\n "}, {"Page_number": 459, "text": "18.3 accelerated failure time models\n\n439\n\nscale: 0.25\n\nscale: 0.6\n\n500\n\n15\n\n7\n5\n3\n2\n1\n\n)\n\nt\n\n(\n\u03bb\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n0.0\n\n0.5\n\n1.0\nt\n\n1.5\n\n2.0\n\n0.0\n\n0.5\n\n1.5\n\n2.0\n\n1.0\nt\n\nscale: 1\n\nscale: 2\n\n1.5\n\n1.0\n\n)\n\nt\n\n(\n\u03bb\n\n0.5\n\n6\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n)\n\nt\n\n(\n\u03bb\n\n)\n\nt\n\n(\n\u03bb\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\n2.0\n\n0.0\n\n0.5\n\n1.0\n\n1.5\n\n2.0\n\nt\n\nt\n\nfig. 18.6 log(t ) distribution for \u03c3 = 0.25, 0.6, 1, 2 and for degrees of freedom\n1, 2, 3, 5, 7, 15, 500 (almost log-normal). the top left plot has degrees of freedom writ-\nten in the plot.\n\nfor normal and logistic distributions, \u02c6t0.5|x = exp(x \u02c6\u03b2). the mle of the\neffect on log(t ) of increasing xj by d units is \u02c6\u03b2jd if xj is linear and additive.\nthe delta (statistical differential) method can be used to compute an esti-\nmate of the variance of f = [log(t) \u2212 x \u02c6\u03b2]/\u02c6\u03c3. let ( \u02c6\u03b2, \u02c6\u03b4) denote the estimated\nparameters, and let \u02c6v denote the estimated covariance matrix for these pa-\nrameter estimates. let f denote the vector of derivatives of f with respect to\n(\u03b20, \u03b21, . . . , \u03b2p, \u03b4); that is, f = [\u22121,\u2212x1,\u2212x2, . . . ,\u2212xp,\u2212(log(t) \u2212 x \u02c6\u03b2)]/\u02c6\u03c3.\n\nthe variance of f is then approximately\n\nvar(f ) = f \u02c6v f\n\n(cid:2)\n\n.\n\n(18.40)\n\n "}, {"Page_number": 460, "text": "4\n\n440\n\n18 parametric survival models\n\nletting s be the square root of the variance estimate and z1\u2212\u03b1/2 be the\nnormal critical value, a 1 \u2212 \u03b1 confidence limit for s(t|x) is\n\n\u03c8((log(t) \u2212 x \u02c6\u03b2)/\u02c6\u03c3 \u00b1 z1\u2212\u03b1/2 \u00d7 s).\n\n(18.41)\n\n18.3.5 residuals\n\nfor an aft model, standardized residuals are simply\n\nr = (log(t ) \u2212 x \u02c6\u03b2)/\u03c3.\n\n(18.42)\n\nwhen t is right-censored, r is right-censored. censoring must be taken into\naccount, for example, by displaying kaplan\u2013meier estimates based on groups\nof residuals rather than showing individual residuals. the residuals can be\nused to check for lack of fit as described in the next section. note that exam-\nining individual uncensored residuals is not appropriate, as their distribution\nis conditional on ti < ci, where ci is the censoring time.\n\ncox and snell134 proposed a type of general residuals that also work for\ncensored data. using their method on the cumulative probability scale results\nin the probability integral transformation. if the probability of failure before\ntime t given x is s(t|x), f (t|x) = 1 \u2212 s(t|x) has a uniform [0, 1] distri-\nbution, where t is a subject\u2019s actual failure time. when t is right-censored,\nso is 1 \u2212 s(t|x). substituting \u02c6s for s results in an approximate uniform\n[0, 1] distribution for any value of x. one minus the kaplan\u2013meier estimate\nof 1 \u2212 \u02c6s(t|x) (using combined data for all x) is compared against a 45\n\u25e6\nline to check for goodness of fit. a more stringent assessment is obtained by\nrepeating this process while stratifying on x.\n\n18.3.6 assessment of model fit\n\nfor a single binary predictor, all assumptions of the aft model are depicted\nin figure 18.7. that figure also shows the assumptions for any two values of\na single continuous predictor that behaves linearly. for a single continuous\npredictor, the relationships in figure 18.8 must hold for any two follow-up\ntimes. the regression assumptions are isolated in figure 18.5.\n\nto verify the fit of a log-logistic model with age as the only predictor, one\ncould stratify by quartiles of age and check for linearity and parallelism of the\nfour logit s\u03bb(t) or skm(t) curves over increasing t as in figure 18.7, which\nstresses the distributional assumption (no t by x interaction and linearity vs.\nlog(t)). to stress the linear regression assumption while checking for absence\nof time interactions (part of the distributional assumptions), one could make\n\n "}, {"Page_number": 461, "text": "18.3 accelerated failure time models\n\n441\n\nx1= c\n\nx1= d\n\n(d-c) \u03b21 /\u03c3\n\nfig. 18.7 aft model with one predictor. y -axis is \u03c8\ndrawn for d > c. the slope of the lines is \u03c3\n\n\u22121.\n\n\u22121[s(t|x)] = (log(t)\u2212 x\u03b2)/\u03c3.\n\nlog t\n\nt=t2\n\nt=t1\n\n\u22121[s(t|x)] =\nfig. 18.8 aft model with one continuous predictor. y -axis is \u03c8\n(log(t) \u2212 x\u03b2)/\u03c3. drawn for t2 > t1. the slope of each line is \u03b21/\u03c3 and the difference\nbetween the lines is log(t2/t1)/\u03c3.\n\nx1\n\na plot like figure 18.8. for each decile of age, the logit transformation of the\n1-, 3-, and 5-year survival estimates for that decile would be plotted against\nthe mean age in the decile. this checks for linearity and constancy of the\nage effect over time. regression splines will be a more effective method for\nchecking linearity and determining transformations. this is demonstrated in\nchapter 20 with the cox model, but identical methods apply here.\n\nas an example, consider data from kalbfleisch and prentice [331, pp. 1\u20132],\nwho present data from pike508 on the time from exposure to the carcinogen\ndmba to mortality from vaginal cancer in rats. the rats are divided into\ntwo groups on the basis of a pre-treatment regime. survival times in days\n(with censored times marked +) are found in table 18.2.\n\n "}, {"Page_number": 462, "text": "442\n\n18 parametric survival models\n\ntable 18.2 rat vaginal cancer data from pike508\n\ngroup 1 143 164 188 188 190 192 206 209 213 216\n\n220 227 230 234 246 265 304 216+ 244+\n\ngroup 2 142 156 163 198 205 232 232 233 233 233\n\n233 239 240 261 280 280 296 296 323 204+\n344+\n\ngethdata ( kprats )\n\nkprats $ group \u2190 factor ( kprats $ group , 0:1 , c ( ' group 1 ' , ' group 2 ' ))\ndd \u2190 datadist ( kprats ); options ( datadist = \" dd \" )\ns \u2190 with ( kprats , surv (t , death ))\nf \u2190 npsurv ( s \u223c group , type = \" fleming \" , data = kprats )\nsurvplot (f , n.risk = true , conf = ' none ' ,\n# figure 18.9\n\nlabel.cur ve s = list ( keys = ' lines ' ) , levels.onl y = true )\n\ntitle ( sub = \" nonparame tr i c estimates \" , adj =0 , cex = .7 )\n\n# check fits of weibull , log-logistic, log-normal\nxl \u2190 c (4 .8 , 5 .9 )\n\nsurvplot (f , loglog = true , logt = true , conf = \" none \" , xlim = xl ,\n\nlabel.cur ve s = list ( keys = ' lines ' ) , levels.onl y = true )\n\ntitle ( sub = \" weibull ( extreme value ) \" , adj =0 , cex = .7 )\nsurvplot (f , fun = function ( y ) log ( y / (1 -y )) , ylab = \" logit s ( t ) \" ,\n\nlogt = true , conf = \" none \" , xlim = xl ,\nlabel.cur ve s = list ( keys = ' lines ' ) , levels.onl y = true )\n\ntitle ( sub = \" log-logist i c \" , adj =0 , cex = .7 )\nsurvplot (f , fun = qnorm , ylab = \" inverse normal s ( t ) \" ,\n\nlogt = true , conf = \" none \" ,\nxlim = xl , cex.label = .7 ,\nlabel.cur ve s = list ( keys = ' lines ' ) , levels.onl y = true )\n\ntitle ( sub = \" log-normal \" , adj =0 , cex = .7 )\n\nthe top left plot in figure 18.9 displays nonparametric survival estimates for\nthe two groups, with the number of rats \u201cat risk\u201d at each 30-day mark written\nabove the x-axis. the remaining three plots are for checking assumptions of\nthree models. none of the parametric models presented will completely allow\nfor such a long period with no deaths. neither will any allow for the early\ncrossing of survival curves. log-normal and log-logistic models yield very sim-\nilar results due to the similarity in shapes between \u03c6(z) and [1 + exp(\u2212z)]\n\u22121\nfor non-extreme z. all three transformations show good parallelism after the\nearly crossing. the log-logistic and log-normal transformations are slightly\nmore linear. the fitted models are:\nfw \u2190 psm ( s \u223c group , data = kprats , dist = ' weibull ' )\nfl \u2190 psm ( s \u223c group , data = kprats , dist = ' loglogistic ' ,\nfn \u2190 psm ( s \u223c group , data = kprats , dist = ' lognormal ' )\nlatex ( fw , fi = ' ' )\n\ny = true )\n\n "}, {"Page_number": 463, "text": "18.3 accelerated failure time models\n\n443\n\n1.0\n\n0.8\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\ni\n\n \nl\na\nv\nv\nr\nu\ns\n\n)\nt\n(\n\ns\n\n \nt\ni\n\ng\no\n\nl\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\n4\n\n3\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\ngroup 1\ngroup 2\n\n19\n21\n\n19\n21\n\n19\n21\n\n19\n21\n\n19\n21\n\n17\n18\n\n11\n15\n\n3\n7\n\n1\n6\n\n2\n\ngroup 1\ngroup 2\n\n0 35\n\n105\n\n245\n\n315\n\n175\ns\n\nnonparametric estimates\n\ngroup 1\ngroup 2\n\n4.8\n\n5.2\n\n5.0\nlog survival time in s\n\n5.4\n\n5.6\n\n5.8\n\n6.0\n\n)\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\ni\n\n \nl\na\nv\nv\nr\nu\ns\n \ng\no\n\u2212\n(\ng\no\n\nl\n\nl\n\n)\nt\n(\n\ns\n\n \nl\n\n \n\na\nm\nr\no\nn\ne\ns\nr\ne\nv\nn\n\ni\n\ngroup 1\ngroup 2\n\n4.8\n\n5.2\n\n5.0\nlog survival time in s\n\n5.6\n\n5.4\n\nweibull (extreme value)\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n2.0\n\n1.5\n\n1.0\n\n0.5\n\n0.0\n\n\u22120.5\n\n\u22121.0\n\n\u22121.5\n\n\u22122.0\n\n4.8\n\ngroup 1\ngroup 2\n\n5.2\n\n5.0\nlog survival time in s\n\n5.6\n\n5.4\n\n5.8\n\n5.8\n\nlog\u2212logistic\n\nlog\u2212normal\n\nfig. 18.9 altschuler\u2013nelson\u2013fleming\u2013harrington nonparametric survival estimates\nfor rats treated with dmba,508 along with various transformations of the estimates\nfor checking distributional assumptions of three parametric survival models.\n\nprob{t \u2265 t} = exp[\u2212 exp(\n\nlog(t) \u2212 x\u03b2\n0.1832976\n\n)] where\n\nx \u02c6\u03b2 =\n\n5.450859\n\n+0.131983[group 2]\n\nand [c] = 1 if subject is in group c, 0 otherwise.\nlatex ( fl , fi = ' ' )\n\n "}, {"Page_number": 464, "text": "444\n\n18 parametric survival models\n\ntable 18.3 group effects from three survival models\n\nmodel\n\ngroup 2:1\n\nmedian survival time\n\nfailure time ratio group 1 group 2\n\nextreme value (weibull)\nlog-logistic\nlog-normal\n\n1.14\n1.11\n1.10\n\n217\n217\n217\n\n248\n241\n238\n\nprob{t \u2265 t} = [1 + exp(\n\nlog(t) \u2212 x\u03b2\n0.1159753\n\n\u22121 where\n\n)]\n\nx \u02c6\u03b2 =\n\n5.375675\n\n+0.1051005[group 2]\n\nand [c] = 1 if subject is in group c, 0 otherwise.\nlatex ( fn , fi = ' ' )\n\nprob{t \u2265 t} = 1 \u2212 \u03c6(\n\nlog(t) \u2212 x\u03b2\n0.2100184\n\n) where\n\nx \u02c6\u03b2 =\n\n5.375328\n\n+0.0930606[group 2]\n\nand [c] = 1 if subject is in group c, 0 otherwise.\n\nthe estimated failure time ratios and median failure times for the two\ngroups are given in table 18.3. for example, the effect of going from group 1\nto group 2 is to increase log failure time by 0.132 for the extreme value model,\ngiving a group 2:1 failure time ratio of exp(0.132) = 1.14. this ratio is also\nthe ratio of median survival times. we choose the log-logistic model for its\nsimpler form. the fitted survival curves are plotted with the nonparametric\nestimates in figure 18.10. excellent agreement is seen, except for 150 to 180\ndays for group 2. the standard error of the regression coefficient for group\nin the log-logistic model is 0.0636 giving a wald \u03c72 for group differences of\n(.105/.0636)2 = 2.73, p = 0.1.\n\nsurvplot (f , conf.int = false ,\n\n# f i g u r e 18.10\n\nlevels.only = true , label.curves = list ( keys = ' lines ' ))\nsurvplot ( fl , add = true , label.curves = false , conf.int = false )\n\nthe weibull ph form of the fitted extreme value model, using equa-\n\ntion 18.24, is\n\n "}, {"Page_number": 465, "text": "18.3 accelerated failure time models\n\n445\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\ngroup 1\n\ngroup 2\n\n0\n\n35\n\n70\n\n140\n\n210\n\n280\n\n350\n\ns\n\nfig. 18.10 agreement between fitted log-logistic model and nonparametric survival\nestimates for rat vaginal cancer data.\n\nprob{t \u2265 t} = exp{\u2212t5.456 exp(x \u02c6\u03b2)} where\n\nx \u02c6\u03b2 =\n\u221229.74\n\u22120.72[group 2]\n\nand [c] = 1 if subject is in group c, 0 otherwise.\n\na sensitive graphical verification of the distributional assumptions of the\naft model is obtained by plotting the estimated survival distribution of\nstandardized residuals (equation 18.3.5), censored identically to the way t\nis censored. this distribution is plotted along with the theoretical distri-\nbution \u03c8. the assessment may be made more stringent by stratifying the\nresiduals by important subject characteristics and plotting separate survival\nfunction estimates; they should all have the same standardized distribution\n(e.g., same \u03c3).\nr \u2190 resid ( fl , ' cens ' )\nsurvplot ( npsurv ( r \u223c group , data = kprats ),\n\nconf = ' none ' , xlab = ' residual ' ,\nlabel.curves = list ( keys = ' lines ' ), levels.only = true )\n\nsurvplot ( npsurv ( r \u223c 1) , conf = ' none ' , add = true , col = ' red ' )\nlines (r , lwd =1 , col = ' blue ' )\n\n# f i g u r e 18.11\n\nas an example, figure 18.11 shows the kaplan\u2013meier estimate of the dis-\ntribution of residuals, kaplan\u2013meier estimates stratified by group, and the\nassumed log-logistic distribution.\n\n5\n\n "}, {"Page_number": 466, "text": "446\n\n18 parametric survival models\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\ngroup 1\n\ngroup 2\n\n\u22126\n\n\u22125\n\n\u22124\n\n\u22123\n\n\u22122\n\n\u22121\n\n0\n\n1\n\n2\n\n3\n\n4\n\nresidual\n\nfig. 18.11 kaplan\u2013meier estimates of distribution of standardized censored residu-\nals from the log-logistic model, along with the assumed standard log-logistic distri-\nbution (dashed curve). the step functions in red is the estimated distribution of all\nresiduals, and the step functions in black are the estimated distributions of residuals\nstratified by group, as indicated. the blue curve is the assumed log-logistic distribu-\ntion.\n\nsection 19.2 has a more in-depth example of this approach.\n\n18.3.7 validating the fitted model\n\naft models may be validated for both calibration and discrimination accu-\nracy using the same methods that are presented for the cox model in sec-\ntion 20.11. the methods discussed there for checking calibration are based on\nchoosing a single follow-up time. checking the distributional assumptions of\nthe parametric model is also a check of calibration accuracy in a sense. an-\nother indirect calibration assessment may be obtained from a set of cox\u2013snell\nresiduals (section 18.3.5) or by using ordinary residuals as just described. a\nhigher resolution indirect calibration assessment based on plotting individual\nuncensored failure times is available when the theoretical censoring times for\nthose observations are known. let c denote a subject\u2019s censoring time and f\nthe cumulative distribution of a failure time t . the expected value of f (t|x)\nis 0.5 when t is an actual failure time random variable. the expected value\nfor an event time that is observed because it is uncensored is the expected\nvalue of f (t|t \u2264 c, x) = 0.5f (c|x). a smooth plot (using, say, loess) of\nf (t|x) \u2212 0.5f (c|x) against x \u02c6\u03b2 should be a flat line through y = 0 if the\nmodel is well calibrated. a smooth plot of 2f (t|x)/f (c|x) against x \u02c6\u03b2 (or\nanything else) should be a flat line through y = 1. this method assumes that\nthe model is calibrated well enough that we can substitute 1 \u2212 \u02c6s(c|x) for\nf (c|x).\n\n "}, {"Page_number": 467, "text": "18.8 time-dependent covariates\n\n447\n\n18.4 buckley\u2013james regression model\n\nbuckley and james81 developed a method for estimating regression coeffi-\ncients using least squares after imputing censored residuals. their method\ndoes not assume a distribution for survival time or the residuals, but is aimed\nat estimating expected survival time or expected log survival time given pre-\ndictor variables. this method has been generalized to allow for smooth non-\nlinear effects and interactions in the s bj function in the rms package, written\nby stare and harrell585.\n\n18.5 design formulations\n\nvarious designs can be formulated with survival regression models just as\nwith other regression models. by constructing the proper dummy variables,\nanova and anocova models can easily be specified for testing differences\nin survival time between multiple treatments. interactions and complex non-\nlinear effects may also be modeled.\n\n18.6 test statistics\n\nas discussed previously, likelihood ratio, score, and wald statistics can be\nderived from the maximum likelihood analysis, and the choice of test statistic\ndepends on the circumstance and on computational convenience.\n\n18.7 quantifying predictive ability\n\nsee section 20.10 for a generalized measure of concordance between predicted\nand observed survival time (or probability of survival) for right-censored data.\n\n18.8 time-dependent covariates\n\ntime-dependent covariates (predictors) requires special likelihood functions\nand add significant complexity to analyses in exchange for greater ver-\nsatility and enhanced predictive discrimination604. nicolaie et al.477 and\nd\u2019agostino et al.145 provide useful static covariate approaches to modeling\ntime-dependent predictors using landmark analysis.\n\n "}, {"Page_number": 468, "text": "448\n\n18 parametric survival models\n\n18.9 r functions\n\ntherneau\u2019s survreg function (part of his survival package) can fit regression\nmodels in the aft family with left\u2013, right\u2013, or interval\u2013censoring. the time\nvariable can be untransformed or log-transformed (the default). distributions\nsupported are extreme value (weibull and exponential), normal, logistic, and\nstudent-t. the version of survreg in rms that fits parametric survival models\nin the same framework as lrm, ols, and cph is called psm. psm works with\nprint, coef, formula, specs, summary, anova, predict, predict, fastbw, latex,\nnomogram, validate, calibrate, survest, and survplot functions for obtaining\nand plotting predicted survival probabilities. the dist argument to psm can be\n\"exponential\", \"extreme\", \"gaussian\", \"logistic\", \"loglogistic\", \"lognormal\",\n\"t\", or \"weibull\". to fit a model with no covariables, use the command\npsm ( surv ( d.time , event ) \u223c 1)\n\nto restate a weibull or exponential model in ph form, use the pphsm function.\nan example of how many of the functions are used is found below.\nunits ( d.time ) \u2190 \" year \"\nf \u2190 psm ( surv ( d.time , cdeath ) \u223c lsp ( age ,65) * sex )\n\n# s u m m a r i z e e f f e c t s with d e l t a log t\n# t y p e s e t m a t h . form of f i t t e d m o d e l\n\n# d e f a u l t is w e i b u l l\nanova ( f )\nsummary ( f )\nlatex ( f )\nsurvest (f , times =1) # 1 y s u r v i v a l est. for all s u b j e c t s\nsurvest (f , expand.grid ( sex = \" female \" , age =30:80) , times =1:2)\n# 1 y , 2 y s u r v i v a l e s t i m a t e s vs. age , for f e m a l e s\nsurvest (f , data.frame ( sex = \" female \" , age =50))\n# s u r v i v a l c u r v e for an i n d i v i d u a l s u b j e c t\nsurvplot (f , sex = na , age =50 , n.risk = t )\n# s u r v i v a l c u r v e s for each sex , a d j u s t i n g age to 50\n\nf.ph \u2190 pphsm ( f )\n\nsummary ( f.ph )\n\n# c o n v e r t from aft to ph\n# s u m m a r i z e with h a z a r d r a t i o s\n# i n s t e a d of c h a n g e s in log ( t )\n\nspecial functions work with objects created by psm to create s functions that\ncontain the analytic form for predicted survival probabilities (survival), haz-\nard functions (hazard), quantiles of survival time (quantile), and mean or\nexpected survival time (mean). once the s functions are constructed, they can\nbe used in a variety of contexts. the survplot and survest functions have\na special argument for psm fits: what. the default is what=\"survival\" to esti-\nmate or plot survival probabilities. specifying what=\"hazard\" will plot hazard\nfunctions. predict also has a special argument for psm fits: time. specifying a\nsingle value for time results in survival probability for that time being plotted\ninstead of x \u02c6\u03b2. examples of many of the functions appear below, with the\noutput of the survplot command shown in figure 18.12.\nmed \u2190 quantile ( fl )\nmeant \u2190 mean ( fl )\n\n "}, {"Page_number": 469, "text": "18.9 r functions\nhaz \u2190 hazard ( fl )\nsurv \u2190 survival ( fl )\nlatex ( surv , file = ' ' , type = ' sinput ' )\nsurv \u2190 function ( times = null , lp = null ,\n\nparms = -2.1543777393 31 24 )\n\n{\n\n}\n\n1 / (1 + exp (( logb ( times ) - lp ) / exp ( parms )))\n\n449\n\n# plot e s t i m a t e d h a z a r d f u n c t i o n s and add m e d i a n\n# s u r v i v a l t i m e s to g r a p h\nsurvplot ( fl , group , what = \" hazard \" )\n# c o m p u t e m e d i a n s u r v i v a l time\n\n# f i g u r e 18.12\n\nm \u2190 med ( lp = predict (fl ,\n\ndata.frame ( group = levels ( kprats $ group ))))\n\nm\n\n2\n216.0857 240.0328\n\n1\n\nmed ( lp = range ( fl $ linear.predi ct or s ))\n\n[1] 216.0857 240.0328\n\nm \u2190 format (m , digits =3)\n\ntext (68 , .02 , paste (\" group 1 median : \" , m [1] , \" \\ n \" ,\n\n\" group 2 median : \" , m [2] , sep =\" \" ))\n\n# c o m p u t e s u r v i v a l p r o b a b i l i t y at 210 days\n\nxbeta \u2190 predict ( fl ,\n\ndata.frame ( group = c ( \" group 1 \" ,\" group 2 \" )))\n\nsurv (210 , xbeta )\n\n2\n0 . 5 6 1 2 7 1 8 0 . 7 5 9 9 7 7 6\n\n1\n\nthe s object called survreg.distributions in therneau\u2019s survival package\nand the object survreg.auxinfo in the rms package have detailed information\nfor extreme-value, logistic, normal, and t distributions. for each distribution,\ncomponents include the deviance function, an algorithm for obtaining starting\nparameter estimates, a latex representation of the survival function, and s\nfunctions defining the survival, hazard, quantile functions, and basic survival\ninverse function (which could have been used in figure 18.9). see figure 18.6\nfor examples. rms\u2019s val.surv function is useful for indirect external valida-\ntion of parametric models using cox\u2013snell residuals and other approaches of\nsection 18.3.7. the plot method for an object created by val.surv makes it\neasy to stratify all computations by a variable of interest to more stringently\nvalidate the fit with respect to that variable.\n\nrms\u2019s bj function fits the buckley\u2013james model for right-censored re-\n\nsponses.\n\n "}, {"Page_number": 470, "text": "450\n\n18 parametric survival models\n\ngroup 1 median: 216\ngroup 2 median: 240\n\ngroup 1\n\ngroup 2\n\n0.030\n\n0.025\n\n0.020\n\n0.015\n\n0.010\n\n0.005\n\n0.000\n\nn\no\n\n \n\ni\nt\nc\nn\nu\nf\nd\nr\na\nz\na\nh\n\n0\n\n30 60 90 120\n\n240\n\n300\n\n180\ndays\n\nfig. 18.12 estimated hazard functions for log-logistic fit to rat vaginal cancer data,\nalong with median survival times.\n\nkooperberg et al.\u2019s adaptive linear spline log-hazard model360, 361, 594 has\nbeen implemented in the s function hare. their procedure searches for second-\norder interactions involving predictors (and linear splines of them) and linear\nsplines in follow-up time (allowing for non-proportional hazards). hare is also\nused to estimate calibration curves for parametric survival models (rms func-\ntion calibrate) as it is for cox models.\n\n18.10 further reading\n\n1 wellek657 developed a test statistic for a specified maximum survival difference\n\n2\n\n3\n\n4\n5\n\nafter relating this difference to a hazard ratio.\nhougaard308 compared accelerated failure time models with proportional haz-\nard models.\ngore et al.226 discuss how an aft model (the log-logistic model) gives rise to\nvarying hazard ratios.\nsee hillis293 for other types of residuals and plots that use them.\nsee gore et al.226 and lawless382 for other methods of checking assumptions for\naft models. lawless is an excellent text for in-depth discussion of parametric\nsurvival modeling. kwong and hutton369 present other methods of choosing\nparametric survival models, and discuss the robustness of estimates when fitting\nan incorrectly chosen accelerated failure time model.\n\n "}, {"Page_number": 471, "text": "18.11 problems\n\n18.11 problems\n\n1. for the failure times (in days)\n\n451\n\n1 3 3+ 6+ 7+\n\ncompute mles of the following parameters of an exponential distribution\nby hand: \u03bb, \u03bc, t0.5, and s(3 days). compute 0.95 confidence limits for \u03bb\nand s(3), basing the latter on log[\u03bb(t)].\n\n2. for the same data in problem 1, compute mles of parameters of a weibull\n\ndistribution. also compute the mles of s(3) and t0.5.\n\n "}, {"Page_number": 472, "text": "chapter 19\ncase study in parametric survival\nmodeling and model approximation\n\nconsider the random sample of 1000 patients from the support study,352\ndescribed in section 3.12. in this case study we develop a parametric sur-\nvival time model (accelerated failure time model) for time until death for the\nacute disease subset of support (acute respiratory failure, multiple organ\nsystem failure, coma). we eliminate the chronic disease categories because\nthe shapes of the survival curves are different between acute and chronic dis-\nease categories. to fit both acute and chronic disease classes would require a\nlog-normal model with \u03c3 parameter that is disease-specific.\n\npatients had to survive until day 3 of the study to qualify. the baseline\n\nphysiologic variables were measured during day 3.\n\n19.1 descriptive statistics\n\nfirst we create a variable acute to flag the categories of interest, and print\nunivariable descriptive statistics for the data subset.\n\nrequire ( rms )\n\ngethdata ( support )\n\nacute \u2190 support $ dzclass % in % c ( ' arf / mosf ' , ' coma ' )\nlatex ( describe ( support [ acute ,]) , file = ' ' )\n\n# get data f r a m e from web site\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 19\n\n453\n\n "}, {"Page_number": 473, "text": "454\n\n19 parametric survival modeling and model approximation\n\nsupport[acute, ]\n\n35 variables\n\n537 observations\n\nage : age\n\nn missing unique info mean\n\n.95\n1 60.7 28.49 35.22 47.93 63.67 74.49 81.54 85.56\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\n537\n\n0\n\n529\n\nlowest : 18.04 18.41 19.76 20.30 20.31\nhighest: 91.62 91.82 91.93 92.74 95.51\n\ndeath : death at any time up to ndi date:31dec94\n\nn missing unique info sum mean\n2 0.67 356 0.6629\n\n0\n\n537\n\nsex\n\nn missing unique\n2\n\n0\n\n537\n\nfemale (251, 47%), male (286, 53%)\n\nhospdead : death in hospital\n\nn missing unique info sum mean\n2 0.7 201 0.3743\n\n0\n\n537\n\nslos : days from study entry to discharge\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 23.44 4.0 5.0 9.0 15.0 27.0 47.4 68.2\n\n85\n\n0\n\n537\n\nlowest :\n\n3\n\n4\n\n5\n\n6\n\n7, highest: 145 164 202 236 241\n\nd.time : days of follow-up\n\nn missing unique info mean .05 .10 .25 .50 .75\n\n.95\n6 16 182 724 1421 1742\n\n.90\n\n537\n\n0\n\n340\n\n1 446.1\n\n4\n\nlowest :\n\n3\n\n4\n\n5\n\n6\n\n7, highest: 1977 1979 1982 2011 2022\n\ndzgroup\n\nn missing unique\n3\n\n0\n\n537\n\narf/mosf w/sepsis (391, 73%), coma (60, 11%), mosf w/malig (86, 16%)\n\ndzclass\n\nn missing unique\n2\n\n0\n\n537\n\narf/mosf (477, 89%), coma (60, 11%)\n\nnum.co : number of comorbidities\n\nn missing unique info mean\n7 0.93 1.525\n\n0\n\n537\n\n5 6\nfrequency 111 196 133 51 31 10 5\n%\n2 1\n\n2 3 4\n\n9 6\n\n36\n\n21\n\n25\n\n0\n\n1\n\n "}, {"Page_number": 474, "text": "19.1 descriptive statistics\n\n455\n\nedu : years of education\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n8 10 12 14 16 17\n\n22 0.96 12.03\n\n126\n\n7\n\n411\n\nlowest :\n\n0 1\n\n2 3 4, highest: 17 18 19 20 22\n\nincome\n\nn missing unique\n4\n\n202\n\n335\n\nunder $11k (158, 47%), $11-$25k (79, 24%), $25-$50k (63, 19%)\n>$50k (35, 10%)\n\nscoma : support coma score based on glasgow d3\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n0 37 55 100\n\n11 0.82 19.24\n\n0\n\n0\n\n0\n\n0\n\n537\n\nfrequency 301 50 44 19 17 43 11\n%\n8 2\n\n0 9 26 37 41 44 55 61 89 94 100\n32\n6\n\n6 8 6\n1 1 1\n\n8 4 3\n\n56\n\n9\n\ncharges : hospital charges\n\nn missing unique info mean\n\n.95\n1 86652 11075 15180 27389 51079 100904 205562 283411\n\n.05\n\n.25\n\n.75\n\n.90\n\n.10\n\n.50\n\n517\n\n20\n\n516\n\nlowest :\n5849\nhighest: 504660 538323 543761 706577 740010\n\n4432\n\n4574\n\n5555\n\n3448\n\ntotcst : total rcc cost\n\nn missing unique info mean .05\n\n471\n\n66\n\n471\n\n.95\n1 46360 6359 8449 15412 29308 57028 108927 141569\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\nlowest :\n3325\nhighest: 269057 269131 338955 357919 390460\n\n3191\n\n2071\n\n2522\n\n0\n\ntotmcst : total micro-cost\n\nn missing unique info mean .05\n\n331\n\n206\n\n328\n\n.95\n1 39022 6131 8283 14415 26323 54102 87495 111920\n\n.25\n\n.75\n\n.90\n\n.10\n\n.50\n\n3421\nlowest :\nhighest: 144234 154709 198047 234876 271467\n\n2626\n\n1562\n\n2478\n\n0\n\navtisst : average tiss, days 3\u201325\n.05\n\nn missing unique info mean\n\n536\n\n1\n\n205\n\n.95\n1 29.83 12.46 14.50 19.62 28.00 39.00 47.17 50.37\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\nlowest :\n9.500\nhighest: 58.500 59.000 60.000 61.000 64.000\n\n5.667\n\n8.000\n\n9.000\n\n4.000\n\nrace\n\nn missing unique\n5\n\n2\n\n535\n\nfrequency\n%\n\nwhite black asian other hispanic\n22\n4\n\n417\n78\n\n84\n16\n\n4\n1\n\n8\n1\n\n "}, {"Page_number": 475, "text": "456\n\n19 parametric survival modeling and model approximation\n\nmeanbp : mean arterial blood pressure day 3\n\nn missing unique info mean .05 .10 .25 .50\n\n.95\n1 83.28 41.8 49.0 59.0 73.0 111.0 124.4 135.0\n\n.75\n\n.90\n\n537\n\n0\n\n109\n\nlowest :\n\n0\n\n20\n\n27 30\n\n32, highest: 155 158 161 162 180\n\nwblc : white blood cell count day 3\n.10\n\nn missing unique info mean\n\n.05\n\n532\n\n5\n\n241\n\n.95\n1 14.1 0.8999 4.5000 7.9749 12.3984 18.1992 25.1891 30.1873\n\n.50\n\n.90\n\n.25\n\n.75\n\nlowest :\n0.19998\nhighest: 51.39844 58.19531 61.19531 79.39062 100.00000\n\n0.06999\n\n0.09999\n\n0.14999\n\n0.05000\n\nhrt : heart rate day 3\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n105 51 60 75 111 126 140 155\n\n111\n\n0\n\n1\n\n537\n\nlowest :\n\n0\n\n11\n\n30 36\n\n40, highest: 189 193 199 232 300\n\nresp : respiration rate day 3\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n8 10 12 24 32 39 40\n\n1 23.72\n\n45\n\n0\n\n537\n\nlowest :\n\n0 4\n\n6 7 8, highest: 48 49 52 60 64\n\ntemp : temperature (celcius) day 3\n\nn missing unique info mean\n\n.95\n1 37.52 35.50 35.80 36.40 37.80 38.50 39.09 39.50\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\n537\n\n0\n\n61\n\nlowest : 32.50 34.00 34.09 34.90 35.00\nhighest: 40.20 40.59 40.90 41.00 41.20\n\npafi : pao2/(.01*fio2) day 3\nn missing unique info mean\n\n500\n\n37\n\n357\n\n.95\n1 227.2 86.99 105.08 137.88 202.56 290.00 390.49 433.31\n\n.05\n\n.25\n\n.75\n\n.50\n\n.90\n\n.10\n\nlowest :\n55.00\nhighest: 574.00 595.12 640.00 680.00 869.38\n\n48.00\n\n53.33\n\n54.00\n\n45.00\n\nalb : serum albumin day 3\n\nn missing unique info mean\n\n.95\n1 2.668 1.700 1.900 2.225 2.600 3.100 3.400 3.800\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\n346\n\n191\n\n34\n\nlowest : 1.100 1.200 1.300 1.400 1.500\nhighest: 4.100 4.199 4.500 4.699 4.800\n\nbili : bilirubin day 3\n\nn missing unique info mean\n\n.95\n1 2.678 0.3000 0.4000 0.6000 0.8999 2.0000 6.5996 13.1743\n\n.05\n\n.90\n\n.25\n\n.75\n\n.10\n\n.50\n\n386\n\n151\n\n88\n\nlowest :\n0.09999 0.19998 0.29999 0.39996 0.50000\nhighest: 22.59766 30.00000 31.50000 35.00000 39.29688\n\ncrea : serum creatinine day 3\n\nn missing unique info mean\n\n.95\n1 2.232 0.6000 0.7000 0.8999 1.3999 2.5996 5.2395 7.3197\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n537\n\n0\n\n84\n\nlowest :\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7, highest: 10.4 10.6 11.2 11.6 11.8\n\n "}, {"Page_number": 476, "text": "19.1 descriptive statistics\n\n457\n\nsod : serum sodium day 3\n\nn missing unique info mean .05 .10 .25 .50 .75 .90 .95\n1 138.1 129 131 134 137 142 147 150\n\n38\n\n0\n\n537\n\nlowest : 118 120 121 126 127, highest: 156 157 158 168 175\n\nph : serum ph (arterial) day 3\n\nn missing unique info mean\n\n.95\n1 7.416 7.270 7.319 7.380 7.420 7.470 7.510 7.529\n\n.05\n\n.25\n\n.75\n\n.90\n\n.50\n\n.10\n\n500\n\n37\n\n49\n\nlowest : 6.960 6.989 7.069 7.119 7.130\nhighest: 7.560 7.569 7.590 7.600 7.659\n\nglucose : glucose day 3\n\nn missing unique info mean .05 .10\n\n.95\n1 167.7 76.0 89.0 106.0 141.0 200.0 292.4 347.2\n\n.25\n\n.75\n\n.50\n\n.90\n\n297\n\n240\n\n179\n\nlowest :\n\n30\n\n42\n\n52 55\n\n68, highest: 446 468 492 576 598\n\nbun : bun day 3\n\nn missing unique info mean .05\n\n.95\n1 38.91 8.00 11.00 16.75 30.00 56.00 79.70 100.70\n\n.75\n\n.25\n\n.10\n\n.90\n\n.50\n\n304\n\n233\n\n100\n\nlowest :\n\n1\n\n3\n\n4\n\n5\n\n6, highest: 123 124 125 128 146\n\nurine : urine output day 3\n\nn missing unique info mean .05\n\n.95\n1 2095 20.3 364.0 1156.5 1870.0 2795.0 4008.6 4817.5\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n303\n\n234\n\n262\n\nlowest :\n\n0\n\n5\n\n8\n\n15\n\n20, highest: 6865 6920 7360 7560 7750\n\nadlp : adl patient day 3\n\nn missing unique info mean\n8 0.87 1.577\n\n433\n\n104\n\n1 2 3 4 5 6 7\nfrequency 51 19 7 6 4 7 8 2\n%\n49 18 7 6 4 7 8 2\n\n0\n\nadls : adl surrogate day 3\n\nn missing unique info mean\n8 0.89 1.86\n\n145\n\n392\n\n7\nfrequency 185 68 22 18 17 20 39 23\n%\n6\n\n6 5 4\n\n2 3 4\n\n47 17\n\n0 1\n\n5 6\n\n5 10\n\nsfdm2\n\nn missing unique\n5\n\n69\n\n468\n\nno(m2 and sip pres) (134, 29%), adl>=4 (>=5 if sur) (78, 17%)\nsip>=30 (30, 6%), coma or intub (5, 1%), <2 mo. follow-up (221, 47%)\n\n "}, {"Page_number": 477, "text": "458\n\n19 parametric survival modeling and model approximation\n\nadlsc : imputed adl calibrated to surrogate\n\nn missing unique info mean\n\n.95\n144 0.96 2.119 0.000 0.000 0.000 1.839 3.375 6.000 6.000\n\n.05\n\n.25\n\n.75\n\n.10\n\n.50\n\n.90\n\n537\n\n0\n\nlowest : 0.0000 0.4948 0.4948 1.0000 1.1667\nhighest: 5.7832 6.0000 6.3398 6.4658 7.0000\n\nnext, patterns of missing data are displayed.\n\nplot ( naclus ( support [ acute ,]))\n\n# f i g u r e 19.1\n\nthe hmisc varclus function is used to quantify and depict associations between\npredictors, allowing for general nonmonotonic relationships. this is done by\nusing hoeffding\u2019s d as a similarity measure for all possible pairs of predictors\ninstead of the default similarity, spearman\u2019s \u03c1.\nac \u2190 support [ acute ,]\nac $ dzgroup \u2190 ac $ dzgroup [ drop = true ]\nlabel ( ac $ dzgroup ) \u2190 ' disease group '\nvc \u2190 varclus (\u223c age + sex + dzgroup + num.co + edu + income +\n\n# remove unused levels\n\nattach ( ac )\n\nscoma + race + meanbp + wblc + hrt + resp +\ntemp + pafi + alb + bili + crea + sod + ph +\nglucose + bun + urine + adlsc , sim = ' hoeffding ' )\n\nplot ( vc )\n\n# figure 19.2\n\n19.2 checking adequacy of log-normal accelerated\n\nfailure time model\n\nlet us check whether a parametric survival time model will fit the data, with\nrespect to the key prognostic factors. first, kaplan\u2013meier estimates stratified\nby disease group are computed, and plotted after inverse normal transforma-\ntion, against log t. parallelism and linearity indicate goodness of fit to the\nlog normal distribution for disease group. then a more stringent assessment\nis made by fitting an initial model and computing right-censored residuals.\nthese residuals, after dividing by \u02c6\u03c3, should all have a normal distribution\nif the model holds. we compute kaplan\u2013meier estimates of the distribution\nof the residuals and overlay the estimated survival distribution with the the-\noretical gaussian one. this is done overall, and then to get more stringent\nassessments of fit, residuals are stratified by key predictors and plots are\nproduced that contain multiple kaplan\u2013meier curves along with a single the-\noretical normal curve. all curves should hover about the normal distribution.\nto gauge the natural variability of stratified residual distribution estimates,\nthe residuals are also stratified by a random number that has no bearing on\nthe goodness of fit.\ndd \u2190 datadist ( ac )\n\n# d e s c r i b e d i s t r i b u t i o n s of v a r i a b l e s to rms\n\n "}, {"Page_number": 478, "text": "19.2 checking adequacy of log-normal model\n\n459\n\n0.0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\ni\n\ng\nn\ns\ns\nm\nn\no\n\n \n\ni\n\ni\nt\nc\na\nr\nf\n\nl\n\nc\ns\nd\na\n\nd\no\ns\n\na\ne\nr\nc\n\np\nm\ne\n\np\ns\ne\nr\n\nt\nr\nh\n\nt\n\ne\nc\na\nr\n\nl\n\nc\nb\nw\n\nt\ns\ns\ni\nt\nv\na\n\np\nb\nn\na\ne\nm\n\na\nm\no\nc\ns\n\nt\ns\nc\nt\n\no\n\nt\n\ns\ne\ng\nr\na\nh\nc\n\n2\nm\nd\n\nf\ns\n\nh\np\n\ni\nf\n\na\np\n\ns\no\ns\n\nl\n\no\nc\n.\nm\nu\nn\n\ns\ns\na\nc\nz\nd\n\nl\n\np\nu\no\nr\ng\nz\nd\n\ne\nm\n\ni\nt\n.\n\nd\n\nd\na\ne\nd\np\ns\no\nh\n\nx\ne\ns\n\ne\ng\na\n\nh\n\nt\n\na\ne\nd\n\nb\na\n\nl\n\ni\nl\ni\n\nb\n\nl\n\ns\nd\na\n\nu\nd\ne\n\ne\nm\no\nc\nn\n\ni\n\nt\ns\nc\nm\no\n\nt\n\nt\n\nl\n\np\nd\na\n\nn\nu\nb\n\ne\nn\ni\nr\nu\n\ne\ns\no\nc\nu\ng\n\nl\n\nfig. 19.1 cluster analysis showing which predictors tend to be missing on the same\npatients\n\n \n\nd\ng\nn\nd\n\ni\n\nf\nf\n\ne\no\nh\n \n*\n \n\n0\n3\n\ni\n\nn\na\ns\na\ne\nc\na\nr\n\nr\ne\nh\n\nt\n\no\ne\nc\na\nr\n\n 0.00\n\n 0.05\n\n 0.10\n\n 0.15\n\n 0.20\n\ni\n\nc\nn\na\np\ns\nh\ne\nc\na\nr\n\ni\n\nl\n\nk\nc\na\nb\ne\nc\na\nr\n\ne\nn\ni\nr\nu\n\nn\nu\nb\n\ne\ns\no\nc\nu\ng\n\nl\n\np\ns\ne\nr\n\nl\n\nc\ns\nd\na\n\no\nc\n.\nm\nu\nn\n\nt\nr\nh\n\np\nm\ne\n\nt\n\np\nb\nn\na\ne\nm\n\nh\np\n\ni\nf\n\na\np\n\nb\na\n\nl\n\ni\nl\ni\n\nb\n\ne\ng\na\n\na\ne\nr\nc\n\nu\nd\ne\n\nd\no\ns\n\nl\n\ne\na\nm\nx\ne\ns\n\na\nm\no\nc\ns\n\na\nm\no\nc\np\nu\no\nr\ng\nz\nd\n\nk\n0\n5\n$\n>\ne\nm\no\nc\nn\n\ni\n\nk\n5\n2\n$\n\u2212\n1\n1\n$\ne\nm\no\nc\nn\n\ni\n\nk\n0\n5\n$\n\u2212\n5\n2\n$\ne\nm\no\nc\nn\n\ni\n\ng\n\ni\nl\n\n/\n\n \n\na\nm\nw\nf\ns\no\nm\np\nu\no\nr\ng\nz\nd\n\nl\n\nc\nb\nw\n\nfig. 19.2 hierarchical clustering of potential predictors using hoeffding d as a\nsimilarity measure. categorical predictors are automatically expanded into dummy\nvariables.\n\noptions ( datadist = ' dd ' )\n\n# g e n e r a t e r i g h t - c e n s o r e d s u r v i v a l time v a r i a b l e\n\nyears \u2190 d.time / 365 .25\nunits ( years ) \u2190 ' year '\ns \u2190 surv ( years , death )\n\n# show n o r m a l i n v e r s e k a p l a n - m e i e r e s t i m a t e s\n# s t r a t i f i e d by d z g r o u p\n\nsurvplot ( npsurv ( s \u223c dzgroup ), conf = ' none ' ,\n\nfun = qnorm , logt = true )\n\n# f i g u r e 19.3\n\n "}, {"Page_number": 479, "text": "460\n\n19 parametric survival modeling and model approximation\n\nf \u2190 psm ( s \u223c dzgroup + rcs ( age ,5) + rcs ( meanbp ,5) ,\nr \u2190 resid (f )\n\ndist = ' lognormal ' , y = true )\n\nsurvplot (r , dzgroup , label.curv e = false )\nlabel.curv e = false )\nsurvplot (r , age ,\nsurvplot (r , meanbp ,\nlabel.curv e = false )\n\nrandom \u2190 runif ( length ( age )); label ( random ) \u2190 ' random number '\n\nsurvplot (r , random , label.cur v e = false )\n\n# fig. 19.4\n\nnow remove from consideration predictors that are missing in more than 0.2\nof patients. many of these were collected only for the second half of sup-\nport. of those variables to be included in the model, find which ones have\nenough potential predictive power to justify allowing for nonlinear relation-\nships or multiple categories, which spend more d.f. for each variable compute\nspearman \u03c12 based on multiple linear regression of rank(x), rank(x)2, and the\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\ndzgroup=mosf w/malig\n\ndzgroup=arf/mosf w/sepsis\n\ndzgroup=coma\n\n\u22121\n\n\u22122\n1\nlog survival time in years\n\n0\n\n2\n\n\u22121(skm (t)) stratified by dzgroup. linearity and semi-parallelism indi-\nfig. 19.3 \u03c6\ncate a reasonable fit to the log-normal accelerated failure time model with respect to\none predictor.\n\nsurvival time, truncating survival time at the shortest follow-up for survivors\n(356 days; see section 4.1).\nshortest.fo ll o w. up \u2190 min ( d.time [ death ==0] , na.rm = true )\nd.timet \u2190 pmin ( d.time , shortest.fol lo w. up )\nw \u2190 spearman2 ( d.timet \u223c age + num.co + scoma + meanbp +\n\nhrt + resp + temp + crea + sod + adlsc +\nwblc + pafi + ph + dzgroup + race , p =2)\n\nplot (w , main = ' ' )\n\n# f i g u r e 19.5\n\n "}, {"Page_number": 480, "text": "19.2 checking adequacy of log-normal model\n\n461\n\na better approach is to use the complete information in the failure and censor-\ning times by computing somers\u2019 dxy rank correlation allowing for censoring.\n\nw \u2190 rcorrcens ( s \u223c age + num.co + scoma + meanbp + hrt + resp +\n\ntemp + crea + sod + adlsc + wblc + pafi + ph +\ndzgroup + race )\n\nplot (w , main = ' ' )\n\n# figure 19.6\n\nremaining missing values are imputed using the \u201cmost normal\u201d values, a\nprocedure found to work adequately for this particular study. race is imputed\nusing the modal category.\n\n# c o m p u t e n u m b e r of m i s s i n g v a l u e s per v a r i a b l e\nsapply ( llist ( age , num.co , scoma , meanbp , hrt , resp , temp , crea , sod ,\nadlsc , wblc , pafi , ph ), function ( x ) sum ( is.na ( x )))\n\nage num . co\n0\npafi\n37\n\n0\nwblc\n5\n\nscoma meanbp\n0\n\n0\nph\n37\n\nhrt\n0\n\nresp\n0\n\ntemp\n0\n\ncrea\n0\n\nsod\n0\n\nadlsc\n0\n\ndisease group\n\nage\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n0.8\n0.6\n0.4\n0.2\n0.0\n\n1.0\n0.8\n0.6\n0.4\n0.2\n0.0\n\n\u22123.0\n\n\u22122.0\n\n0.0 0.5 1.0 1.5 2.0\n\n\u22121.0\nresidual\n\nmean arterial blood pressure day 3\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n0.8\n0.6\n0.4\n0.2\n0.0\n\n1.0\n0.8\n0.6\n0.4\n0.2\n0.0\n\n\u22123.0\n\n\u22122.0\n\n0.0 0.5 1.0 1.5 2.0\n\n\u22121.0\nresidual\n\nrandom number\n\n\u22123.0\n\n\u22122.0\n\n0.0 0.5 1.0 1.5 2.0\n\n\u22121.0\nresidual\n\n\u22123.0\n\n\u22122.0\n\n0.0 0.5 1.0 1.5 2.0\n\n\u22121.0\nresidual\n\nfig. 19.4 kaplan-meier estimates of distributions of normalized, right-censored\nresiduals from the fitted log-normal survival model. residuals are stratified by im-\nportant variables in the model (by quartiles of continuous variables), plus a random\nvariable to depict the natural variability (in the lower right plot). theoretical standard\ngaussian distributions of residuals are shown with a thick solid line.\n\n "}, {"Page_number": 481, "text": "462\n\n19 parametric survival modeling and model approximation\n\nscoma\nmeanbp\ndzgroup\ncrea\npafi\nph\nsod\nhrt\nadlsc\ntemp\nwblc\nnum.co\nage\nresp\nrace\n\nn  df\n537 2\n537 2\n537 2\n537 2\n500 2\n500 2\n537 2\n537 2\n537 2\n537 2\n532 2\n537 2\n537 2\n537 2\n535 4\n\n0.00\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\n0.10\n\n0.12\n\nadjusted \u03c12\n\nfig. 19.5 generalized spearman \u03c12 rank correlation between predictors and trun-\ncated survival time\n\nmeanbp\ncrea\ndzgroup\nscoma\npafi\nph\nadlsc\nage\nnum.co\nhrt\nresp\nrace\nsod\nwblc\ntemp\n\nn\n537\n537\n537\n537\n500\n500\n537\n537\n537\n537\n537\n535\n537\n532\n537\n\n0.00\n\n0.05\n\n0.15\n\n0.20\n\n0.10\n| dxy|\n\nfig. 19.6 somers\u2019 dxy rank correlation between predictors and original survival\ntime. for dzgroup or race, the correlation coefficient is the maximum correlation from\nusing a dummy variable to represent the most frequent or one to represent the second\nmost frequent category.\u2019,scap=\u2019somers\u2019 dxy rank correlation between predictors and\noriginal survival time\n\n "}, {"Page_number": 482, "text": "19.2 checking adequacy of log-normal model\n\n463\n\n# can also do n a p l o t ( n a c l u s ( s u p p o r t [ acute ,]))\n# can also use the h m i s c n a c l u s and n a p l o t f u n c t i o n s\n# i m p u t e m i s s i n g v a l u e s with n o r m a l or m o d a l v a l u e s\n\n\u2190 impute ( ph ,\n\nwblc.i \u2190 impute ( wblc , 9)\npafi.i \u2190 impute ( pafi , 333 .3 )\nrace2 \u2190 race\nlevels ( race2 ) \u2190 list ( white = ' white ' , other = levels ( race )[ -1 ])\nrace2 [ is.na ( race2 )] \u2190 ' white '\ndd \u2190 datadist ( dd , wblc.i , pafi.i , ph.i , race2 )\n\n7 .4 )\n\nph.i\n\nnow that missing values have been imputed, a formal multivariable redun-\ndancy analysis can be undertaken. the hmisc package\u2019s redun function goes\nfarther than the varclus pairwise correlation approach and allows for non-\nmonotonic transformations in predicting each predictor from all the others.\nredun (\u223c crea + age + sex + dzgroup + num.co + scoma + adlsc +\n\nrace2 + meanbp + hrt + resp + temp + sod + wblc.i +\npafi.i + ph.i , nk =4)\n\nr e d u n d a n c y analysis\n\nredun ( formula = \u223ccrea + age + sex + dzgroup + num . co + scoma +\n\nadlsc + race2 + meanbp + hrt + resp + temp + sod + wblc . i +\npafi . i + ph .i , nk = 4)\n\nn : 537\n\np : 16\n\nnk : 4\n\nnumber of nas :\n\n0\n\nt r a n s f o r m a t i o n of target v a r i a b l e s forced to be linear\n\nr2 cutoff : 0.9\n\ntype : ordinary\n\nr2 with which each variable can be p r e d i c t e d from all other v a r i a b l e s:\n\ncrea\n0.133\nhrt\n0.258\n\nage\n0.246\nresp\n0.131\n\nsex dzgroup\n0.451\nsod\n0.135\n\n0.132\ntemp\n0.197\n\nnum . co\n0.147\nwblc . i\n0.093\n\nscoma\n0.418\npafi . i\n0.143\n\nadlsc\n0.153\nph . i\n0.171\n\nrace2\n0.151\n\nmeanbp\n0.178\n\nno r e d u n d a n t v a r i a b l e s\n\nnow turn to a more efficient approach for gauging the potential of each\npredictor, one that makes maximal use of failure time and censored data is to\nall continuous variables to have a maximum number of knots in a log-normal\nsurvival model. this approach must use imputation to have an adequate\nsample size. a semi-saturated main effects additive log-normal model is fitted.\nit is necessary to limit restricted cubic splines to 4 knots, force scoma to be\nlinear, and to omit ph.i in order to avoid a singular covariance matrix in\nthe fit.\nk \u2190 4\nf \u2190 psm ( s \u223c rcs ( age , k )+ sex + dzgroup + pol ( num.co ,2)+ scoma +\n\npol ( adlsc ,2)+ race + rcs ( meanbp , k )+ rcs ( hrt , k )+\n\n "}, {"Page_number": 483, "text": "464\n\n19 parametric survival modeling and model approximation\n\nrcs ( resp , k )+ rcs ( temp , k )+ rcs ( crea ,3)+ rcs ( sod , k )+\nrcs ( wblc.i ,k )+ rcs ( pafi.i , k ), dist = ' lognormal ' )\n\nplot ( anova ( f ))\n\n# f i g u r e 19.7\n\nfigure 19.7 properly blinds the analyst to the form of effects (tests of lin-\nearity). next fit a log-normal survival model with number of parameters\ncorresponding to nonlinear effects determined from the partial \u03c72 tests in\nfigure 19.7. for the most promising predictors, five knots can be allocated,\nas there are fewer singularity problems once less promising predictors are\nsimplified.\n\nsex\ntemp\nrace\nsod\nnum.co\nhrt\nwblc.i\nadlsc\nresp\nscoma\npafi.i\nage\nmeanbp\ncrea\ndzgroup\n\n0\n\n10\n\n20\n\n30\n\n\u03c72 \u2212 df\n\nfig. 19.7 partial \u03c72 statistics for association of each predictor with response from\nsaturated main effects model, penalized for d.f.\n\nf \u2190 psm ( s \u223c rcs ( age ,5)+ sex + dzgroup + num.co +\n\nscoma + pol ( adlsc ,2)+ race2 + rcs ( meanbp ,5)+\nrcs ( hrt ,3)+ rcs ( resp ,3)+ temp +\nrcs ( crea ,4)+ sod + rcs ( wblc.i ,3)+ rcs ( pafi.i ,4) ,\n\ndist = ' lognormal ' )\n\nprint (f , latex = true , coefs = false )\n\nparametric survival model: log normal distribution\n\npsm(formula = s ~ rcs(age, 5) + sex + dzgroup + num.co + scoma +\n\npol(adlsc, 2) + race2 + rcs(meanbp, 5) + rcs(hrt, 3) + rcs(resp,\n3) + temp + rcs(crea, 4) + sod + rcs(wblc.i, 3) + rcs(pafi.i,\n4), dist = \"lognormal\")\n\n "}, {"Page_number": 484, "text": "19.2 checking adequacy of log-normal model\n\n465\n\nmodel likelihood discrimination\n\nratio test\n\nindexes\n\n537 lr \u03c72\n\nobs\nevents 356 d.f.\n\u03c3 2.230782 pr(> \u03c72) < 0.0001 g\ngr\n\n236.83 r2\n30 dxy\n\n0.594\n0.485\n0.033\n1.959\n\na \u2190 anova ( f )\n\ntable 19.1 wald statistics for s\n\nhrt\n\nage\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nrace2\nmeanbp\n\nsex\ndzgroup\nnum.co\nscoma\nadlsc\n\np\nd.f.\n0.0030\n4\n0.9722\n3\n1\n0.7354\n2 < 0.0001\n1\n0.0255\n0.0011\n1\n0.0159\n2\n1\n0.0691\n1\n0.2624\n4 < 0.0001\n0.0147\n3\n0.0027\n2\n1\n0.3090\n0.0039\n2\n0.0034\n1\n1\n0.5308\n3 < 0.0001\n2 < 0.0001\n0.7792\n1\n0.0649\n2\n1\n0.0195\n0.0015\n3\n2\n0.0307\ntotal nonlinear 60.48 14 < 0.0001\n261.47 30 < 0.0001\ntotal\n\n\u03c72\n15.99\n0.23\n0.11\n45.69\n4.99\n10.58\n8.28\n3.31\n1.26\n27.62\n10.51\n11.83\n1.04\n11.10\n8.56\n0.39\n33.63\n21.27\n0.08\n5.47\n5.46\n15.37\n6.97\n\nsod\nwblc.i\n\ntemp\ncrea\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\npafi.i\n\nresp\n\n "}, {"Page_number": 485, "text": "466\n\n19 parametric survival modeling and model approximation\n\n19.3 summarizing the fitted model\n\nfirst let\u2019s plot the shape of the effect of each predictor on log survival time.\nall effects are centered so that they can be placed on a common scale. this\nallows the relative strength of various predictors to be judged. then wald\n\u03c72 statistics, penalized for d.f., are plotted in descending order. next, rela-\ntive effects of varying predictors over reasonable ranges (survival time ratios\nvarying continuous predictors from the first to the third quartile) are charted.\n\nggplot ( predict (f , ref.zero = true ), vnames = ' names ' ,\n\nsepdiscrete = ' vertical ' , anova = a )\n\n# f i g u r e 19.8\n\nlatex (a , file = ' ' , label = ' tab : support-anova t ' ) # t a b l e 19.1\n\nplot ( a )\n\n# f i g u r e 19.9\n\noptions ( digits =3)\nplot ( summary ( f ), log = true , main = ' ' )\n\n# f i g u r e 19.10\n\n19.4 internal validation of the fitted model\n\nusing the bootstrap\n\nlet us decide whether there was significant overfitting during the development\nof this model, using the bootstrap.\n\nfrom the data\n\n# f i r s t add data to m o d e l fit so b o o t s t r a p can r e - s a m p l e\n#\n\ng \u2190 update (f , x = true , y = true )\nset.seed (717)\nlatex ( validate (g , b =300) , digits =2 , size = ' ssize ' )\n\nindex\n\ndxy\nr2\nintercept\nslope\nd\nu\nq\ng\n\nindex\n\noriginal training test optimism corrected n\nsample sample sample\n0.51\n0.46\n0.66\n0.54\n0.00 \u22120.05\n1.00\n0.90\n0.55\n0.42\n0.00 \u22120.01\n0.43\n0.56\n1.87\n2.05\n\n0.43 300\n0.47 300\n\u22120.05 300\n0.90 300\n0.35 300\n\u22120.01 300\n0.36 300\n1.77 300\n\n0.49\n0.59\n0.00\n1.00\n0.48\n0.00\n0.48\n1.96\n\n0.05\n0.12\n0.05\n0.10\n0.13\n0.01\n0.12\n0.19\n\n "}, {"Page_number": 486, "text": "19.4 internal validation of the fitted model using the bootstrap\n\n467\n\nadlsc\n2 = 8.3\n2\n\n\u03c7\n\nage\n\ncrea\n\nhrt\n\n\u03c7\n\n2 = 16\n4\n\n0\n\n2\n\n4\n\n6\n\n20\n\n40\n\nmeanbp\n\u03c7\n2 = 27.6\n4\n\n80\n\n2.5\n\n60\nnum.co\n\u03c7\n2 = 5\n1\n\n\u03c7\n\n2 = 33.6\n3\n\n5.0\npafi.i\n2 = 15.4\n3\n\n\u03c7\n\n7.5\n\n50\n\n\u03c7\n\n2 = 11.8\n2\n\n150\n\n100\nresp\n\u03c7\n2 = 11.1\n2\n\n30\n\n60\n\n90\n\n120 1500\n\n2\n\n4\n\n6 100 200 300 400 500\n\n10\n\nscoma\n2 = 10.6\n1\n\n\u03c7\n\nsod\n2 = 0.1\n1\n\n\u03c7\n\ntemp\n\u03c7\n2 = 0.4\n1\n\n40\n\n20\n\n30\nwblc.i\n\u03c7\n2 = 5.5\n2\n\n)\nt\n(\ng\no\n\nl\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n2\n\n1\n\n0\n\n\u22121\n\n\u22122\n\n\u22123\n\n0\n\n25\n\n50\n\n75 100 130 135 140 145 150155 35 36 37 38 39 40 0\n\n10\n\n20\n\n30\n\n40\n\ndzgroup\n\nrace2\n\nmosf w/malig\ncoma\narf/mosf w/sepsis\n\nl\n\nl\n\n\u03c7\n\n2= 45.7\n2\n\nl\n\nother\nwhite\n\nl\u03c7\n2 = 1.3\n1\nl\n\nmale\nfemale\n\nsex\nl\u03c7\n2 = 0.1\n1\nl\n\n\u22123 \u22122 \u22121 0\n\n1\n\n2\n\n\u22123 \u22122 \u22121 0\nlog(t)\n\n1\n\n2\n\n\u22123 \u22122 \u22121 0\n\n1\n\n2\n\nfig. 19.8 effect of each predictor on log survival time. predicted values have been\ncentered so that predictions at predictor reference values are zero. pointwise 0.95\nconfidence bands are also shown. as all y-axes have the same scale, it is easy to see\nwhich predictors are strongest.\n\njudging from dxy and r2 there is a moderate amount of overfitting. the\nslope shrinkage factor (0.9) is not troublesome, however. an almost unbiased\nestimate of future predictive discrimination on similar patients is given by\nthe corrected dxy of 0.43. this index equals the difference between the prob-\nability of concordance and the probability of discordance of pairs of predicted\nsurvival times and pairs of observed survival times, accounting for censoring.\nnext, a bootstrap overfitting-corrected calibration curve is estimated. pa-\ntients are stratified by the predicted probability of surviving one year, such\nthat there are at least 60 patients in each group.\n\n "}, {"Page_number": 487, "text": "468\n\n19 parametric survival modeling and model approximation\n\nsod\nsex\ntemp\nrace2\nwblc.i\nnum.co\nadlsc\nresp\nscoma\nhrt\nage\npafi.i\nmeanbp\ncrea\ndzgroup\n\n0\n\n10\n\n20\n\u03c72 \u2212 df\n\n30\n\n40\n\nfig. 19.9 contribution of variables in predicting survival time in log-normal model\n\n0.10\n\n0.50\n\n1.00\n\n2.00 3.50\n\nage \u2212 74.5:47.9\nnum.co \u2212 2:1\nscoma \u2212 37:0\nadlsc \u2212 3.38:0\nmeanbp \u2212 111:59\nhrt \u2212 126:75\nresp \u2212 32:12\ntemp \u2212 38.5:36.4\ncrea \u2212 2.6:0.9\nsod \u2212 142:134\nwblc.i \u2212 18.2:8.1\npafi.i \u2212 323:142\nsex \u2212 female:male\ndzgroup \u2212 coma:arf/mosf w/sepsis\ndzgroup \u2212 mosf w/malig:arf/mosf w/sepsis\nrace2 \u2212 other:white\n\nfig. 19.10 estimated survival time ratios for default settings of predictors. for\nexample, when age changes from its lower quartile to the upper quartile (47.9y to\n74.5y), median survival time decreases by more than half. different shaded areas of\nbars indicate different confidence levels (.9, 0.95, 0.99).\n\nset.seed (717)\n\ncal \u2190 calibrate (g , u =1 , b =300)\ncal \u2190 calibrate (g , cmethod = ' km ' , u =1 , m =60 , b =120 , pr = false )\n\nplot ( cal , subtitles = false )\n\nplot ( cal , add = true )\n\n# f i g u r e 19.11\n\n "}, {"Page_number": 488, "text": "19.5 approximating the full model\n\n469\n\n0.8\n\n0.6\n\n0.4\n\n \n\n \n\ns\nr\na\ne\ny\n1\ng\nn\nv\nv\nr\nu\ns\nn\no\n\n \n\ni\n\ni\n\ni\nt\nc\na\nr\nf\n\n0.2\n\n0.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\npredicted  1 year survival\n\nfig. 19.11 bootstrap validation of calibration curve. dots represent apparent cali-\nbration accuracy; \u00d7 are bootstrap estimates corrected for overfitting, based on bin-\nning predicted survival probabilities and computing kaplan-meier estimates. black\ncurve is the estimated observed relationship using hare and the blue curve is the\noverfitting-corrected hare estimate. the gray-scale line depicts the ideal relationship.\n\n19.5 approximating the full model\n\nthe fitted log-normal model is perhaps too complex for routine use and for\nroutine data collection. let us develop a simplified model that can predict\nthe predicted values of the full model with high accuracy (r2 = 0.967). the\nsimplification is done using a fast backward step-down against the full model\npredicted values.\nz \u2190 predict ( f )\na \u2190 ols ( z \u223c rcs ( age ,5)+ sex + dzgroup + num.co +\n\n# x * beta hat\n\nscoma + pol ( adlsc ,2)+ race2 +\nrcs ( meanbp ,5)+ rcs ( hrt ,3)+ rcs ( resp ,3)+\ntemp + rcs ( crea ,4)+ sod + rcs ( wblc.i ,3)+\nrcs ( pafi.i ,4) , sigma =1)\n\n# s i g m a =1 is used to p r e v e n t s i g m a hat from b e i n g zero when\n# r2 =1 .0 s i n c e we s t a r t out by a p p r o x i m a t i n g z with all\n#\nfastbw (a , aics =10000)\n\n# fast b a c k w a r d s t e p d o w n\n\nc o m p o n e n t v a r i a b l e s\n\ndeleted chi - sq d . f . p\nsod\nsex\ntemp\nrace2\nwblc . i\n\n0.43 1\n0.57 1\n2.20 1\n6.81 1\n29.52 2\n\n0.512\n0.451\n0.138\n0.009\n0.000\n\nresidual d . f . p\n\naic\n\nr2\n\n0.43\n1.00\n3.20\n10.01\n39.53\n\n1\n2\n3\n4\n6\n\n0.5117\n0.6073\n0.3621\n0.0402\n0.0000\n\n-1.57 1.000\n-3.00 0.999\n-2.80 0.998\n2.01 0.994\n27.53 0.976\n\n "}, {"Page_number": 489, "text": "470\n\n19 parametric survival modeling and model approximation\n\n30.84 1\nnum . co\n54.18 2\nresp\n52.46 2\nadlsc\n66.78 3\npafi . i\n78.07 1\nscoma\n83.17 2\nhrt\n68.08 4\nage\n314.47 3\ncrea\nmeanbp\n403.04 4\ndzgroup 441.28 2\n\n70.36\n0.000\n124.55\n0.000\n177.00\n0.000\n243.79\n0.000\n321.86\n0.000\n405.02\n0.000\n473.10\n0.000\n0.000\n787.57\n0.000 1190.61\n0.000 1631.89\n\n7\n9\n11\n14\n15\n17\n21\n24\n28\n30\n\n56.36 0.957\n0.0000\n106.55 0.924\n0.0000\n155.00 0.892\n0.0000\n215.79 0.851\n0.0000\n291.86 0.803\n0.0000\n371.02 0.752\n0.0000\n431.10 0.710\n0.0000\n0.0000\n739.57 0.517\n0.0000 1134.61 0.270\n0.0000 1571.89 0.000\n\na p p r o x i m a t e e s t i m a t e s after deleting factors\n\ns . e . wald z p\n[1 ,] -0.5928 0.04315 -13.74 0\n\ncoef\n\nfactors in final model\n\nnone\n\nf.approx \u2190 ols ( z \u223c dzgroup + rcs ( meanbp ,5) + rcs ( crea ,4) +\n\nrcs ( age ,5) + rcs ( hrt ,3) + scoma +\nrcs ( pafi.i ,4) + pol ( adlsc ,2)+\nrcs ( resp ,3) , x = true )\n\nf.approx $ stats\n\n537.000\n\nn model l . r .\n1688.225\n\nd . f .\n23.000\n\nr2\n0.957\n\ng\n1.915\n\nsigma\n0.370\n\nwe can estimate the variance\u2013covariance matrix of the coefficients of the\nreduced model using equation 5.2 in section 5.5.2. the computations below\nresult in a covariance matrix that does not include elements related to the\nscale parameter. in the code x is the matrix t in section 5.5.2.\nv \u2190 vcov (f , regcoef.only = true )\nx \u2190 cbind ( intercept =1 , g $ x)\nx \u2190 cbind ( intercept =1 , f.approx $ x ) # a p p r o x . m o d e l d e s i g n\nw \u2190 solve ( t ( x ) % * % x , t (x )) % * % x\nv \u2190 w % * % v % * % t ( w)\n\n# var ( full m o d e l )\n# full m o d e l d e s i g n\n\n# c o n t r a s t m a t r i x\n\nlet\u2019s compare the variance estimates (diagonals of v) with variance estimates\nfrom a reduced model that is fitted against the actual outcomes.\nf.sub \u2190 psm ( s \u223c dzgroup + rcs ( meanbp ,5) + rcs ( crea ,4) +\n\nrcs ( age ,5) + rcs ( hrt ,3) + scoma + rcs ( pafi.i ,4) +\npol ( adlsc ,2)+ rcs ( resp ,3) , dist = ' lognormal ' )\n\ndiag ( v ) / diag ( vcov ( f.sub , r e g c o e f . o n l y = true ))\n\ni n t e r c e p t\n0.981\nmeanbp\n0.977\nmeanbp ' ' '\n0.979\ncrea ' '\n0.979\nage ' '\n0.981\n\ndzgroup = coma dzgroup = mosf w / malig\n0.979\nmeanbp ' '\n0.979\ncrea '\n0.979\nage '\n0.981\nhrt\n0.978\n\n0.979\nmeanbp '\n0.979\ncrea\n0.979\nage\n0.982\nage ' ' '\n0.980\n\n "}, {"Page_number": 490, "text": "19.5 approximating the full model\n\n471\n\nhrt '\n0.976\npafi .i '\n0.980\n\u2227\n2\n0.981\n\nadlsc\n\nscoma\n0.979\npafi .i ' '\n0.980\nresp\n0.978\n\npafi . i\n0.980\nadlsc\n0.981\nresp '\n0.977\n\nr \u2190 diag ( v ) / diag ( vcov ( f.sub , regcoef.only = true ))\n\nr [ c ( which.min ( r ), which.max ( r ))]\n\nhrt '\nage\n0.976 0.982\n\nthe estimated variances from the reduced model are actually slightly smaller\nthan those that would have been obtained from stepwise variable selection\nin this case, had variable selection used a stopping rule that resulted in the\nsame set of variables being selected. now let us compute wald statistics for\nthe reduced model.\nf.approx $ var \u2190 v\nlatex ( anova ( f.approx , test = ' chisq ' , ss = false ), file = ' ' ,\n\nlabel = ' tab : support-anovaa ' )\n\nthe results are shown in table 19.2. note the similarity of the statistics\nto those found in the table for the full model. this would not be the case had\ndeleted variables been very collinear with retained variables.\n\nthe equation for the simplified model follows. the model is also depicted\ngraphically in figure 19.12. the nomogram allows one to calculate mean and\nmedian survival time. survival probabilities could have easily been added as\nadditional axes.\n\n# t y p e s e t m a t h e m a t i c a l form of a p p r o x i m a t e m o d e l\nlatex ( f.approx , file = ' ' )\n\ne(z) = x\u03b2, where\n\n\u22125(meanbp \u2212 73)3\n\nx \u02c6\u03b2 =\n\u22122.51\n\u22121.94[coma] \u2212 1.75[mosf w/malig]\n+0.068meanbp \u2212 3.08\u00d710\n\u22124.91\u00d710\n\u22120.553crea \u2212 0.229(crea \u2212 0.6)3\n+0.0131(crea \u2212 7.32)3\n\u22120.0165age \u2212 1.13\u00d710\n\u22122.15\u00d710\n\u22120.0136hrt + 6.09\u00d710\n\u22120.0135 scoma\n+0.0161pafi.i \u2212 4.77\u00d710\n\n\u22125(age \u2212 28.5)3\n\u2212 2.68\u00d710\n\u22127(hrt \u2212 60)3\n\n\u22125(age \u2212 63.7)3\n\n+\n\n+\n\n+\n\n\u22125(meanbp \u2212 41.8)3\n+ + 2.61\u00d710\n\n+ + 7.9\u00d710\n\n\u22125(meanbp \u2212 61)3\n\n+\n\n\u22126(meanbp \u2212 109)3\n\n\u2212 1.7\u00d710\n\n\u22126(meanbp \u2212 135)3\n\n+\n\n+\n\n+ + 0.45(crea \u2212 1.1)3\n\n+\n\n\u2212 0.233(crea \u2212 1.94)3\n\n+\n\n+ + 4.05\u00d710\n\u22125(age \u2212 72.7)3\n\u2212 1.68\u00d710\n\n\u22125(age \u2212 49.5)3\n+ + 1.9\u00d710\n\u22126(hrt \u2212 111)3\n\n+\n\n\u22125(age \u2212 85.6)3\n\n+\n\n+ + 1.07\u00d710\n\n\u22126(hrt \u2212 140)3\n\n+\n\n\u22127(pafi.i \u2212 88)3\n\n+ + 9.11\u00d710\n\n\u22127(pafi.i \u2212 167)3\n\n+\n\n "}, {"Page_number": 491, "text": "472\n\n19 parametric survival modeling and model approximation\n\ntable 19.2 wald statistics for z\n\nhrt\n\nage\n\ncrea\n\nd.f.\n\np\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\ndzgroup\nmeanbp\n\n\u03c72\n55.94\n29.87\n9.84\n39.04\n24.37\n18.12\n0.34\n9.87\n0.40\n9.85\n14.01\n6.66\n9.71\n2.87\n9.65\n7.13\n\n2 < 0.0001\n4 < 0.0001\n3\n0.0200\n3 < 0.0001\n2 < 0.0001\n0.0012\n4\n3\n0.9517\n0.0072\n2\n0.5289\n1\n0.0017\n1\n3\n0.0029\n0.0357\n2\n0.0078\n2\n0.0904\n1\n2\n0.0080\n0.0076\n1\ntotal nonlinear 58.08 13 < 0.0001\ntotal\n252.32 23 < 0.0001\n\nscoma\npafi.i\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nadlsc\n\nresp\n\n\u22127(pafi.i \u2212 276)3\n\n\u22125.02\u00d710\n+0.0394resp \u2212 9.11\u00d710\n\n+ + 6.76\u00d710\n\u22125(resp \u2212 10)3\n\n\u22128(pafi.i \u2212 426)3\n+ + 0.000176(resp \u2212 24)3\n\n+\n\n+\n\n\u2212 0.369 adlsc + 0.0409 adlsc2\n\n\u2212 8.5\u00d710\n\n\u22125(resp \u2212 39)3\n\n+\n\nand [c] = 1 if subject is in group c, 0 otherwise; (x)+ = x if x > 0, 0\notherwise.\n\n# d e r i v e s f u n c t i o n s that e x p r e s s mean and q u a n t i l e s\n# of s u r v i v a l time for s p e c i f i c l i n e a r p r e d i c t o r s\n# a n a l y t i c a l l y\n\nexpected.surv \u2190 mean ( f )\nquantile.surv \u2190 quantile ( f )\nlatex ( expected.surv , file = ' ' , type = ' sinput ' )\nexpected.surv \u2190 function ( lp = null ,\n\nparms = 0 .80235203760 64 88 )\n\nnames ( parms ) \u2190 null\n\nexp ( lp + exp (2 * parms ) / 2)\n\n{\n\n}\n\nlatex ( quantile.surv , file = ' ' , type = ' sinput ' )\nquantile.surv \u2190 function ( q = 0 .5 , lp = null ,\n\nparms = 0 .80235203760 64 88 )\n\n "}, {"Page_number": 492, "text": "19.6 problems\n\n473\n\nnames ( parms ) \u2190 null\nf \u2190 function ( lp , q , parms ) lp + exp ( parms ) * qnorm ( q )\nnames ( q ) \u2190 format ( q )\n\ndrop ( exp ( outer ( lp , q , fun = f , parms = parms )))\n\n{\n\n}\n\nmedian.surv\n\n\u2190 function (x ) quantile.surv ( lp = x )\n\n# improve variable labels for the nomogram\nf.approx \u2190 newlabels ( f.approx , c ( ' disease group ' ,\n\n' mean arterial bp ' , ' creatinin e ' , ' age ' , ' heart rate ' ,\n' support coma score ' , ' pao2 / ( .01 * fio2 ) ' , ' adl ' ,\n' resp. rate ' ))\n\nnom \u2190\n\nnomogram ( f.approx ,\n\npafi.i = c (0 , 50 , 100 , 200 , 300 , 500 , 600 , 700 , 800 ,\n\n900) ,\n\nfun = list ( ' median survival time ' = median.surv ,\n\n' mean survival time '\n\n= e x p e c t e d . s u r v ) ,\n\nfun.at = c (.1 , .25 , .5 ,1 ,2 ,5 ,10 ,20 ,40))\n\nplot ( nom , cex.var =1 , cex.axis = .75 , lmgp = .25 )\n# figure 19.12\n\n19.6 problems\n\nanalyze the mayo clinic pbc dataset.\n\n1. graphically assess whether weibull (extreme value), exponential,\n\nlog-\nlogistic, or log-normal distributions will fit the data, using a few apparently\nimportant stratification factors.\n\n2. for the best fitting parametric model from among the four examined,\nfit a model containing several sensible covariables, both categorical and\ncontinuous. do a wald test for whether each factor in the model has an\nassociation with survival time, and a likelihood ratio test for the simulta-\nneous contribution of all predictors. for classification factors having more\nthan two levels, be sure that the wald test has the appropriate degrees\nof freedom. for continuous factors, verify or relax linearity assumptions.\nif using a weibull model, test whether a simpler exponential model would\nbe appropriate. interpret all estimated coefficients in the model. write the\nfull survival model in mathematical form. generate a predicted survival\ncurve for a patient with a given set of characteristics.\n\nsee [361] for an analysis of this dataset using linear splines in time and in the\ncovariables.\n\n "}, {"Page_number": 493, "text": "474\n\npoints\n\ndisease group\n\nmean arterial bp\n\ncreatinine\n\nage\n\nheart rate\n\nsupport coma\nscore\n\npao2/(.01*fio2)\n\nadl\n\nresp. rate\n\ntotal points\n\n19 parametric survival modeling and model approximation\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\nmosf w/malig\n\ncoma\n\narf/mosf w/sepsis\n\n0\n\n5\n\n6\n\n7\n\n8\n\n9\n\n20\n10\n\n11\n\n12\n\n3\n\n2\n\n1\n\n0\n\n100\n\n70\n\n60\n\n50\n\n30\n\n10\n\n40\n\n60\n\n80 120\n\n300\n\n200\n\n100\n\n50\n\n0\n\n100\n\n70 50 30 10\n\n300\n\n0\n5\n\n7\n\n50\n\n100\n\n200\n\n500\n\n700\n\n900\n\n4.5 2\n65\n\n60\n\n1\n\n0\n\n55\n\n50\n\n45\n\n40\n\n35\n\n30\n\n0 5\n\n15\n\n0\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\n350\n\n400\n\n450\n\nlinear predictor\n\nmedian survival time\n\nmean survival time\n\n\u22127\n\n\u22125\n\n\u22123\n\n\u22121\n\n1 2 3 4\n\n0.10.25 0.51 2 5 1020 40\n\n0.1 0.250.51 2 5 102040\n\nfig. 19.12 nomogram for predicting median and mean survival time, based on ap-\nproximation of full model\n\n "}, {"Page_number": 494, "text": "chapter 20\ncox proportional hazards regression\nmodel\n\n20.1 model\n\n20.1.1 preliminaries\n\n1\n\nthe cox proportional hazards model132 is the most popular model for the\nanalysis of survival data. it is a semiparametric model; it makes a parametric\nassumption concerning the effect of the predictors on the hazard function,\nbut makes no assumption regarding the nature of the hazard function \u03bb(t)\nitself. the cox ph model assumes that predictors act multiplicatively on the\nhazard function but does not assume that the hazard function is constant (i.e.,\nexponential model), weibull, or any other particular form. the regression\nportion of the model is fully parametric; that is, the regressors are linearly\nrelated to log hazard or log cumulative hazard. in many situations, either\nthe form of the true hazard function is unknown or it is complex, so the\ncox model has definite advantages. also, one is usually more interested in\nthe effects of the predictors than in the shape of \u03bb(t), and the cox approach\nallows the analyst to essentially ignore \u03bb(t), which is often not of primary\ninterest.\n\nthe cox ph model uses only the rank ordering of the failure and censoring\ntimes and thus is less affected by outliers in the failure times than fully\nparametric methods. the model contains as a special case the popular log-\nrank test for comparing survival of two groups. for estimating and testing\nregression coefficients, the cox model is as efficient as parametric models\n(e.g., weibull model with ph) even when all assumptions of the parametric\nmodel are satisfied.171\n\nwhen a parametric model\u2019s assumptions are not true (e.g., when a weibull\nmodel is used and the population is not from a weibull survival distribution\nso that the choice of model is incorrect), the cox analysis is more efficient\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 20\n\n475\n\n "}, {"Page_number": 495, "text": "476\n\n20 cox proportional hazards regression model\n\nthan the parametric analysis. as shown below, diagnostics for checking cox\nmodel assumptions are very well developed.\n\n20.1.2 model definition\n\nthe cox ph model is most often stated in terms of the hazard function:\n\n\u03bb(t|x) = \u03bb(t) exp(x\u03b2).\n\n(20.1)\n\nwe do not include an intercept parameter in x\u03b2 here. note that this is\nidentical to the parametric ph model stated earlier. there is an important\ndifference, however, in that now we do not assume any specific shape for \u03bb(t).\nfor the moment, we are not even interested in estimating \u03bb(t). the reason\nfor this departure from the fully parametric approach is due to an ingenious\nconditional argument by cox.132 cox argued that when the ph model holds,\ninformation about \u03bb(t) is not very useful in estimating the parameters of\nprimary interest, \u03b2. by special conditioning in formulating the log likelihood\nfunction, cox showed how to derive a valid estimate of \u03b2 that does not require\nestimation of \u03bb(t) as \u03bb(t) dropped out of the new likelihood function. cox\u2019s\nderivation focuses on using the information in the data that relates to the\nrelative hazard function exp(x\u03b2).\n\n20.1.3 estimation of \u03b2\n\ncox\u2019s derivation of an estimator of \u03b2 can be loosely described as follows. let\nt1 < t2 < . . . < tk represent the unique ordered failure times in the sample of\nn subjects; assume for now that there are no tied failure times (tied censoring\ntimes are allowed) so that k = n. consider the set of individuals at risk of\nfailing an instant before failure time ti. this set of individuals is called the\nrisk set at time ti, and we use ri to denote this risk set. ri is the set of\nsubjects j such that the subject had not failed or been censored by time ti;\nthat is, the risk set ri includes subjects with failure/censoring time yj \u2265 ti.\nthe conditional probability that individual i is the one that failed at ti,\ngiven that the subjects in the set ri are at risk of failing, and given further\nthat exactly one failure occurs at ti, is\n\nprob{subject i fails at ti|ri and one failure at ti} =\n\nprob{subject i fails at ti|ri}\nprob{ one failure at ti|ri}\n\n(20.2)\n\n(cid:2)\n\nusing the rules of conditional probability. this conditional probability equals\n\n\u03bb(ti) exp(xi\u03b2)\nj\u2208ri \u03bb(ti) exp(xj\u03b2)\n\n=\n\nexp(xi\u03b2)\nj\u2208ri exp(xj\u03b2)\n\n=\n\nexp(xi\u03b2)\n\nyj\u2265ti exp(xj\u03b2)\n\n(20.3)\n\n(cid:2)\n\n(cid:2)\n\n "}, {"Page_number": 496, "text": "(cid:8)\n\n(cid:2)\n\n20.1 model\n\n477\n\nindependent of \u03bb(t). to understand this likelihood, consider a special case\nwhere the predictors have no effect; that is, \u03b2 = 0 [93, pp. 48\u201349]. then\nexp(xi\u03b2) = exp(xj\u03b2) = 1 and prob{subject i is the subject that failed at\nti|ri and one failure occurred at ti} is 1/ni where ni is the number of subjects\nat risk at time ti.\n\nby arguing that these conditional probabilities are themselves condition-\nally independent across the different failure times, a total likelihood can be\ncomputed by multiplying these individual likelihoods over all failure times.\ncox termed this a partial likelihood for \u03b2:\n\nl(\u03b2) =\n\nyi uncensored\n\nexp(xi\u03b2)\n\nyj\u2265yi exp(xj\u03b2)\n\n.\n\n(20.4)\n\nthe log partial likelihood is\n\n(cid:3)\n\nlog l(\u03b2) =\n\n{xi\u03b2 \u2212 log[\n\nyi uncensored\n\n(cid:3)\n\nyj\u2265yi\n\nexp(xj\u03b2)]}.\n\n(20.5)\n\ncox and others have shown that this partial log likelihood can be treated as\nan ordinary log likelihood to derive valid (partial) mles of \u03b2. note that this\nlog likelihood is unaffected by the addition of a constant to any or all of the\nxs. this is consistent with the fact that an intercept term is unnecessary and\ncannot be estimated since the cox model is a model for the relative hazard\nand does not directly estimate the underlying hazard \u03bb(t).\n\nwhen there are tied failure times in the sample, the true partial log likeli-\nhood function involves permutations so it can be time-consuming to compute.\nwhen the number of ties is not large, breslow70 has derived a satisfactory\napproximate log likelihood function. the formula given above, when applied\nwithout modification to samples containing ties, actually uses breslow\u2019s ap-\nproximation. if there are ties so that k < n and t1, . . . , tk denote the unique\nfailure times as we originally intended, breslow\u2019s approximation is written as\n\nk(cid:3)\n\nlog l(\u03b2) =\n\ni=1\n\n(cid:2)\n\n(cid:3)\n\nyj\u2265ti\n\n{si\u03b2 \u2212 di log[\n\nexp(xj\u03b2)]},\n\n(20.6)\n\nwhere si =\nti, and di is the number of failures at ti.\n\nj\u2208di xj, di is the set of indexes j for subjects failing at time\n\nefron171 derived another approximation to the true likelihood that is sig-\nnificantly more accurate than the breslow approximation and often yields\nestimates that are very close to those from the more cumbersome permuta-\ntion likelihood:288\n\nlog l(\u03b2) =\n\n(cid:3)\n\nk(cid:3)\n\n{si\u03b2 \u2212 di(cid:3)\n(cid:3)\n\nj=1\n\ni=1\n\n\u2212 j \u2212 1\n\ndi\n\nl\u2208di\n\nlog[\n\nyj\u2265ti\nexp(xl\u03b2)]}.\n\nexp(xj\u03b2)\n\n(20.7)\n\n "}, {"Page_number": 497, "text": "478\n\n20 cox proportional hazards regression model\n\nin the special case when all tied failure times are from subjects with iden-\ntical xi\u03b2, the efron approximation yields the exact (permutation) marginal\nlikelihood (therneau, personal communication, 1993).\n\nkalbfleisch and prentice330 showed that cox\u2019s partial likelihood, in the\nabsence of predictors that are functions of time, is a marginal distribution of\nthe ranks of the failure/censoring times.\n\nsee therneau and grambsch604 and huang and harrington310 for descrip-\ntions of penalized partial likelihood estimation methods for improving mean\nsquared error of estimates of \u03b2 in a similar fashion to what was discussed in\nsection 9.10.\n\n20.1.4 model assumptions and interpretation\n\nof parameters\n\nthe cox ph regression model has the same assumptions as the parametric\nph model except that no assumption is made regarding the shape of the\nunderlying hazard or survival functions \u03bb(t) and s(t). the cox ph model\nassumes, in its most basic form, linearity and additivity of the predictors\nwith respect to log hazard or log cumulative hazard. it also assumes the ph\nassumption of no time by predictor interactions; that is, the predictors have\nthe same effect on the hazard function at all values of t. the relative hazard\nfunction exp(x\u03b2) is constant through time and the survival functions for\nsubjects with different values of x are powers of each other. if, for example,\nthe hazard of death at time t for treated patients is half that of control\npatients at time t, this same hazard ratio is in effect at any other time point.\nin other words, treated patients have a consistently better hazard of death\nover all follow-up time.\n\nthe regression parameters are interpreted the same as in the parametric\nph model. the only difference is the absence of hazard shape parameters\nin the model, since the hazard shape is not estimated in the cox partial\nlikelihood procedure.\n\n20.1.5 example\n\nconsider again the rat vaginal cancer data from section 18.3.6. figure 20.1\ndisplays the nonparametric survival estimates for the two groups along with\nestimates derived from the cox model (by a method discussed later).\n\nrequire ( rms )\n\n "}, {"Page_number": 498, "text": "20.1 model\n\n479\n\ngroup \u2190 c ( rep ( ' group 1 ' ,19) , rep ( ' group 2 ' ,21))\ngroup \u2190 factor ( group )\ndays \u2190\n\n\u2190 datadist ( group ); options ( datadist = ' dd ' )\n\ndd\n\nc (143 ,164 ,188 ,188 ,190 ,192 ,206 ,209 ,213 ,216 ,220 ,227 ,230 ,\n234 ,246 ,265 ,304 ,216 ,244 ,142 ,156 ,163 ,198 ,205 ,232 ,232 ,\n233 ,233 ,233 ,233 ,239 ,240 ,261 ,280 ,280 ,296 ,296 ,323 ,204 ,344)\n\ndeath \u2190 rep (1 ,40)\ndeath [ c (18 ,19 ,39 ,40)] \u2190 0\nunits ( days ) \u2190 ' day '\ndf \u2190 data.frame ( days , death , group )\ns \u2190 surv ( days , death )\nf \u2190 npsurv ( s \u223c group , type = ' fleming ' )\nfor ( meth in c ( ' exact ' , ' breslow ' , ' efron ' )) {\n\ng \u2190 cph ( s \u223c group , method = meth , surv = true , x = true , y = true )\n\n# p r i n t ( g ) to see r e s u l t s\n\n}\n\nf.exp \u2190 psm ( s \u223c group , dist = ' exponential ' )\nphform \u2190 pphsm ( fw )\n\n\u2190 psm ( s \u223c group , dist = ' weibull ' )\n\nfw\n\nco \u2190 gray ( c (0 , .8 ))\n\nsurvplot (f , lty = c (1 , 1) , lwd = c (1 , 3) , col = co ,\n\nl a b e l . c u r v e s = false , conf = ' none ' )\n\nsurvplot (g , lty = c (3 , 3) , lwd = c (1 , 3) , col = co ,\n\n# efron approx.\n\nadd = true , l a b e l . c u r v e s = false , conf.type = ' none ' )\n\nlegend ( c (2 , 160) , c ( .38 , .54 ) ,\n\nc ( ' n o n p a r a m e t r i c estimates ' , ' cox-breslo w estimates ' ) ,\nlty = c (1 , 3) , cex = .8 , bty = ' n ' )\n\nlegend ( c (2 , 160) , c ( .18 , .34 ) , cex = .8 ,\n\nc ( ' group 1 ' , ' group 2 ' ) , lwd = c (1 ,3) , col = co , bty = ' n ' )\n\nthe predicted survival curves from the fitted cox model are in good agree-\nment with the nonparametric estimates, again verifying the ph assumption\nfor these data. the estimates of the group effect from a cox model (using the\nexact likelihood since there are ties, along with both efron\u2019s and breslow\u2019s\napproximations) as well as from a weibull model and an exponential model\nare shown in table 20.1. the exponential model, with its constant hazard,\ncannot accommodate the long early period with no failures. the group pre-\ndictor was coded as x1 = 0 and x1 = 1 for groups 1 and 2, respectively. for\nthis example, the breslow likelihood approximation resulted in \u02c6\u03b2 closer to\nthat from maximizing the exact likelihood. note how the group effect (47%\nreduction in hazard of death by the exact cox model) is underestimated by\nthe exponential model (9% reduction in hazard). the hazard ratio from the\nweibull fit agrees with the cox fit.\n\n "}, {"Page_number": 499, "text": "480\n\n20 cox proportional hazards regression model\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.0\n\n0.8\n\n0.6\n\n0.4\n\n0.2\n\n0.0\n\nnonparametric estimates\ncox\u2212breslow estimates\n\ngroup 1\ngroup 2\n\n0\n\n30\n\n60\n\n90 120 150 180 210 240 270 300 330\n\ndays\n\nfig. 20.1 altschuler\u2013nelson\u2013fleming\u2013harrington nonparametric survival estimates\nand cox-breslow estimates for rat data508\n\ntable 20.1 group effects using three versions of the partial likelihood and three\nparametric models\n\nmodel\n\ngroup regression s.e. wald\n\ngroup 2:1\n\ncox (exact)\ncox (efron)\ncox (breslow)\nexponential\nweibull (aft)\nweibull (ph)\n\ncoefficient\n\u22120.629\n\u22120.569\n\u22120.596\n\u22120.093\n0.132\n\u22120.721\n\np -value hazard ratio\n\n0.361\n0.347\n0.348\n0.334\n0.061\n\n\u2013\n\n0.08\n0.10\n0.09\n0.78\n0.03\n\u2013\n\n0.533\n0.566\n0.551\n0.911\n\u2013\n0.486\n\n20.1.6 design formulations\n\ndesigns are no different for the cox ph model than for other models except\nfor one minor distinction. since the cox model does not have an intercept\nparameter, the group omitted from x in an anova model will go into the\nunderlying hazard function. as an example, consider a three-group model for\ntreatments a, b, and c. we use the two dummy variables\n\nx1 = 1 if treatment is a, 0 otherwise, and\nx2 = 1 if treatment is b, 0 otherwise.\n\n "}, {"Page_number": 500, "text": "20.1 model\n\n481\n\nthe parameter \u03b21 is the a : c log hazard ratio or difference in hazards at\nany time t between treatment a and treatment c. \u03b22 is the b : c log hazard\nratio (exp(\u03b22) is the b : c hazard ratio, etc.). since there is no intercept\nparameter, there is no direct estimate of the hazard function for treatment\nc or any other treatment; only relative hazards are modeled.\n\nas with all regression models, a wald, score, or likelihood ratio test for\ndifferences between any treatments is conducted by testing h0 : \u03b21 = \u03b22 = 0\nwith 2 d.f.\n\n20.1.7 extending the model by stratification\n\na unique feature of the cox ph model is its ability to adjust for factors that\nare not modeled. such factors usually take the form of polytomous stratifi-\ncation factors that either are too difficult to model or do not satisfy the ph\nassumption. for example, a subject\u2019s occupation or clinical study site may\ntake on dozens of levels and the sample size may not be large enough to\nmodel this nominal variable with dozens of dummy variables. also, one may\nknow that a certain predictor (either a polytomous one or a continuous one\nthat is grouped) may not satisfy ph and it may be too complex to model the\nhazard ratio for that predictor as a function of time.\n\nthe idea behind the stratified cox ph model is to allow the form of the\nunderlying hazard function to vary across levels of the stratification factors.\na stratified cox analysis ranks the failure times separately within strata.\nsuppose that there are b strata indexed by j = 1, 2, . . . , b. let c denote the\nstratum identification. for example, c = 1 or 2 may stand for the female and\nmale strata, respectively. the stratified ph model is\n\u03bb(t|x, c = j) = \u03bbj(t) exp(x\u03b2),\ns(t|x, c = j) = sj(t)exp(x\u03b2).\n\n(20.8)\n\nor\n\nhere \u03bbj(t) and sj(t) are, respectively, the underlying hazard and survival\nfunctions for the jth stratum. the model does not assume any connection\nbetween the shapes of these functions for different strata.\n\nin this stratified analysis, the data are stratified by c but, by default, a\ncommon vector of regression coefficients is fitted across strata. these common\nregression coefficients can be thought of as \u201cpooled\u201d estimates. for example,\na cox model with age as a (modeled) predictor and sex as a stratification\nvariable essentially estimates the common slope of age by pooling information\nabout the age effect over the two sexes. the effect of age is adjusted by sex\ndifferences, but no assumption is made about how sex affects survival. there\nis no ph assumption for sex. levels of the stratification factor c can represent\nmultiple stratification factors that are cross-classified. since these factors are\nnot modeled, no assumption is made regarding interactions among them.\n\n "}, {"Page_number": 501, "text": "482\n\n20 cox proportional hazards regression model\n\nat first glance it appears that stratification causes a loss of efficiency.\nhowever, in most cases the loss is small as long as the number of strata is not\ntoo large with regard to the total number of events. a stratum that contains\nno events contributes no information to the analysis, so such a situation\nshould be avoided if possible.\n\nthe stratified or \u201cpooled\u201d cox model is fitted by formulating a separate\nlog likelihood function for each stratum, but with each log likelihood having a\ncommon \u03b2 vector. if different strata are made up of independent subjects, the\nstrata are independent and the likelihood functions are multiplied together\nto form a joint likelihood over strata. log likelihood functions are thus added\nover strata. this total log likelihood function is maximized once to derive a\npooled or stratified estimate of \u03b2 and to make an inference about \u03b2. no infer-\nence can be made about the stratification factors. they are merely \u201cadjusted\nfor.\u201d\n\nstratification is useful for checking the ph and linearity assumptions for\none or more predictors. predicted cox survival curves (section 20.2) can\nbe derived by modeling the predictors in the usual way, and then stratified\nsurvival curves can be estimated by using those predictors as stratification\nfactors. other factors for which ph is assumed can be modeled in both in-\nstances. by comparing the modeled versus stratified survival estimates, a\ngraphical check of the assumptions can be made. figure 20.1 demonstrates\nthis method although there are no other factors being adjusted for and strat-\nified cox estimates are km estimates. the stratified survival estimates are\nderived by stratifying the dataset to obtain a separate underlying survival\ncurve for each stratum, while pooling information across strata to estimate\ncoefficients of factors that are modeled.\n\nbesides allowing a factor to be adjusted for without modeling its effect,\na stratified cox ph model can also allow a modeled factor to interact with\nstrata.143, 180, 603 for the age\u2013sex example, consider the following model with\nx1 denoting age and c = 1, 2 denoting females and males, respectively.\n\n\u03bb(t|x1, c = 1) = \u03bb1(t) exp(\u03b21x1)\n\u03bb(t|x1, c = 2) = \u03bb2(t) exp(\u03b21x1 + \u03b22x1).\n\nthis model can be simplified to\n\n\u03bb(t|x1, c = j) = \u03bbj(t) exp(\u03b21x1 + \u03b22x2)\n\n(20.9)\n\n(20.10)\n\nif x2 is a product interaction term equal to 0 for females and x1 for males.\nthe \u03b22 parameter quantifies the interaction between age and sex: it is the\ndifference in the age slope between males and females. thus the interaction\nbetween age and sex can be quantified and tested, even though the effect of\nsex is not modeled!\n\nthe stratified cox model is commonly used to adjust for hospital differ-\nences in a multicenter randomized trial. with this method, one can allow\n\n "}, {"Page_number": 502, "text": "20.2 survival probability and secondary parameters\n\n483\n\nfor differences in outcome between q hospitals without estimating q \u2212 1 pa-\nrameters. treatment \u00d7 hospital interactions can be tested efficiently without\ncomputational problems by estimating only the treatment main effect, after\nstratifying on hospital. the score statistic (with q \u2212 1 d.f.) for testing q \u2212 1\ntreatment \u00d7 hospital interaction terms is then computed (\u201cresidual \u03c72\u201d in a\nstepwise procedure with treatment \u00d7 hospital terms as candidate predictors).\nthe stratified cox model turns out to be a generalization of the condi-\ntional logistic model for analyzing matched set (e.g., case-control) data.71\neach stratum represents a set, and the number of \u201cfailures\u201d in the set is the\nnumber of \u201ccases\u201d in that set. for r : 1 matching (r may vary across sets), the\nbreslow70 likelihood may be used to fit the conditional logistic model exactly.\nfor r : m matching, an exact cox likelihood must be computed.\n\n20.2 estimation of survival probability and secondary\n\nparameters\n\nas discussed above, once a partial log likelihood function is derived, it is\nused as if it were an ordinary log likelihood function to estimate \u03b2, estimate\nstandard errors of \u03b2, obtain confidence limits, and make statistical tests. point\nand interval estimates of hazard ratios are obtained in the same fashion as\nwith parametric ph models discussed earlier.\nthe cox model and parametric survival models differ markedly in how one\nestimates s(t|x). since the cox model does not depend on a choice of the\nunderlying survival function s(t), fitting a cox model does not result directly\nin an estimate of s(t|x). however, several authors have derived secondary\nestimates of s(t|x). one method is the discrete hazard model of kalbfleisch\nand prentice [331, pp. 36\u201337, 84\u201387]. their estimator has two advantages: it\nis an extension of the kaplan\u2013meier estimator and is identical to skm if the\nestimated value of \u03b2 happened to be zero or there are no covariables being\nmodeled; and it is not affected by the choice of what constitutes a \u201cstandard\u201d\nsubject having the underlying survival function s(t). in other words, it would\nnot matter whether the standard subject is one having age equal to the mean\nage in the sample or the median age in the sample; the estimate of s(t|x)\nas a function of x = age would be the same (this is also true of another\nestimator which follows).\n\nlet t1, t2, . . . , tk denote the unique failure times in the sample. the discrete\nhazard model assumes that the probability of failure is greater than zero only\nat observed failure times. the probability of failure at time tj given that the\nsubject has not failed before that time is also the hazard of failure at time\ntj since the model is discrete. the hazard at tj for the standard subject is\nwritten \u03bbj. letting \u03b1j = 1 \u2212 \u03bbj, the underlying survival function can be\nwritten\n\n "}, {"Page_number": 503, "text": "(cid:3)\n\nym\u2265yj\n\n(cid:8)\n\n484\n\ni\u22121(cid:8)\n\n20 cox proportional hazards regression model\n\ns(ti) =\n\n\u03b1j, i = 1, 2, . . . , k\n\n(\u03b10 = 1).\n\n(20.11)\n\nj=0\n\na separate equation can be solved using the newton\u2013raphson method to\nestimate each \u03b1j. if there is only one failure at time ti, there is a closed-form\nsolution for the maximum likelihood estimate of \u03b1i, ai, letting j denote the\nsubject who failed at ti. \u02c6\u03b2 denotes the partial mle of \u03b2.\n\n\u02c6\u03b1i = [1 \u2212 exp(xj \u02c6\u03b2)/\n\nexp(xm \u02c6\u03b2)]exp(\u2212xj \u02c6\u03b2).\n\n(20.12)\n\nif \u02c6\u03b2 = 0, this formula reduces to a conditional probability component of the\nproduct-limit estimator, 1 \u2212 (1/number at risk).\n\nthe estimator of the underlying survival function is\n\n\u02c6s(t) =\n\n\u02c6\u03b1j,\n\nj:tj\u2264t\n\n(20.13)\n\nand the estimate of the probability of survival past time t for a subject with\npredictor values x is\n\n\u02c6s(t|x) = \u02c6s(t)exp(x \u02c6\u03b2).\n\n(20.14)\n\nwhen the model is stratified, estimation of the \u03b1j and s is carried out sep-\narately within each stratum once \u02c6\u03b2 is obtained by pooling over strata. the\nstratified survival function estimates can be thought of as stratified kaplan\u2013\nmeier estimates adjusted for x, with the adjustment made by assuming ph\nand linearity. as mentioned previously, these stratified adjusted survival es-\ntimates are useful for checking model assumptions and for providing a simple\nway to incorporate factors that violate ph.\n\nthe stratified estimates are also useful in themselves as descriptive statis-\ntics without making assumptions about a major factor. for example, in a\nstudy from califf et al.88 to compare medical therapy with coronary artery\nbypass grafting (cabg), the model was stratified by treatment but adjusted\nfor a variety of baseline characteristics by modeling. these adjusted survival\nestimates do not assume a form for the effect of surgery. figure 20.2 displays\nunadjusted (kaplan\u2013meier) and adjusted survival curves, with baseline pre-\ndictors adjusted to their mean levels in the combined sample. notice that\nvalid adjusted survival estimates are obtained even though the curves cross\n(i.e., ph is violated for the treatment variable). these curves are essentially\nproduct limit estimates with respect to treatment and cox ph estimates with\nrespect to the baseline descriptor variables.\n\nthe kalbfleisch\u2013prentice discrete underlying hazard model estimates of\nthe \u03b1j are one minus estimates of the hazard function at the discrete failure\ntimes. however, these estimated hazard functions are usually too \u201cnoisy\u201d to\nbe useful unless the sample size is very large or the failure times have been\ngrouped (say by rounding).\n\n "}, {"Page_number": 504, "text": "20.2 survival probability and secondary parameters\n\n485\n\nunadjusted\n\nadjusted\n\ntreatment\n\nsurgical\nmedical\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\n0\n\n5\n\n10\n\n0\n\n5\n\n10\n\nyears of followup\n\nfig. 20.2 unadjusted (kaplan\u2013meier) and adjusted (cox\u2013kalbfleisch\u2013prentice) es-\ntimates of survival. left, kaplan\u2013meier estimates for patients treated medically and\nsurgically at duke university medical center from november 1969 through december\n1984. these survival curves are not adjusted for baseline prognostic factors. right,\nsurvival curves for patients treated medically or surgically after adjusting for all\nknown important baseline prognostic characteristics.88\n\njust as kalbfleisch and prentice have generalized the kaplan\u2013meier es-\ntimator to allow for covariables, breslow70 has generalized the altschuler\u2013\nnelson\u2013aalen\u2013fleming\u2013harrington estimator to allow for covariables. using\nthe notation in section 20.1.3, breslow\u2019s estimate is derived through an esti-\nmate of the cumulative hazard function:\n\n(cid:3)\n\n(cid:2)\n\n\u02c6\u03bb(t) =\n\ndi\n\ni:ti<t\n\nyi\u2265ti exp(xi \u02c6\u03b2)\n\n.\n\n(20.15)\n\nfor any x, the estimates of \u03bb and s are\n\n\u02c6\u03bb(t|x) = \u02c6\u03bb(t) exp(x \u02c6\u03b2)\n\u02c6s(t|x) = exp[\u2212 \u02c6\u03bb(t) exp(x \u02c6\u03b2)].\n\n(20.16)\n\nmore asymptotic theory has been derived from the breslow estimator than\nfor the kalbfleisch\u2013prentice estimator. another advantage of the breslow\nestimator is that it does not require iterative computations for di > 1. law-\nless [382, p. 362] states that the two survival function estimators differ little\nexcept in the right-hand tail when all dis are unity. like the kalbfleisch\u2013\nprentice estimator, the breslow estimator is invariant under different choices\nof \u201cstandard subjects\u201d for the underlying survival s(t).\nof \u02c6s(t|x).615\n\nsomewhat complex formulas are available for computing confidence limits\n\n2\n\n3\n\n "}, {"Page_number": 505, "text": "486\n\n20 cox proportional hazards regression model\n\n20.3 sample size considerations\n\none way of estimating the minimum sample size for a cox model analy-\nsis aimed at estimating survival probabilities is to consider the simplest case\nwhere there are no covariates. thus the problem reduces to using the kaplan-\nmeier estimate to estimate s(t). let\u2019s further simplify things to assume there\nis no censoring. then the kaplan-meier estimate is just one minus the em-\npirical cumulative distribution function. by the dvoretzky-kiefer-wolfowitz\ninequality, the maximum absolute error in an empirical distribution function\nestimate of the true continuous distribution function is less than or equal to\n\u0001 with probability of at least 1 \u2212 2e\n. for the probability to be at least\n0.95, n = 184. thus in the case of no censoring, one needs 184 subjects to\nestimate the survival curve to within a margin of error of 0.1 everywhere.\nto estimate the subject-specific survival curves (s(t|x)) will require greater\nsample sizes, as will having censored data. it is a fair approximation to think\nof 184 as the needed number of subjects suffering the event or being censored\n\u201clate.\u201d\n\n\u22122n\u00012\n\nturning to estimation of a hazard ratio for a single binary predictor x\nthat has equal numbers of x = 0 and x = 1, if the total sample size is n\nand the number of events in the two categories are respectively e0 and e1,\nthe variance of the log hazard ratio is approximately v = 1\n+ 1\n. letting z\ndenote the 1 \u2212 \u03b1/2 standard normal critical value, the multiplicative margin\ne0\ne1\n\u221a\nof error (mmoe) with confidence 1 \u2212 \u03b1 is given by exp(z\nv). to achieve\na mmoe of 1.2 in estimating e \u02c6\u03b2 with equal numbers of events in the two\ngroups and \u03b1 = 0.05 requires a total of 462 events.\n\n20.4 test statistics\n\nwald, score, and likelihood ratio statistics are useful and valid for drawing\ninferences about \u03b2 in the cox model. the score test deserves special mention\nhere. if there is a single binary predictor in the model that describes two\ngroups, the score test for assessing the importance of the binary predictor\nis virtually identical to the mantel\u2013haenszel log-rank test for comparing the\ntwo groups. if the analysis is stratified for other (nonmodeled) factors, the\nscore test from a stratified cox model is equivalent to the corresponding\nstratified log-rank test. of course, the likelihood ratio or wald tests could\nalso be used in this situation, and in fact the likelihood ratio test may be\nbetter than the score test (i.e., type i errors by treating the likelihood ratio\ntest statistic as having a \u03c72 distribution may be more accurate than using\nthe log-rank statistic).\n\nthe cox model can be thought of as a generalization of the log-rank pro-\ncedure since it allows one to test continuous predictors, perform simultaneous\n\n "}, {"Page_number": 506, "text": "20.6 assessment of model fit\n\n487\n\ntests of various predictors, and adjust for other continuous factors without\ngrouping them. although a stratified log-rank test does not make assump-\ntions regarding the effect of the adjustment (stratifying) factors, it makes the\nsame assumption (i.e., ph) as the cox model regarding the treatment effect\nfor the statistical test of no difference in survival between groups.\n\n20.5 residuals\n\ntherneau et al.605 discussed four types of residuals from the cox model:\nmartingale, score, schoenfeld, and deviance. the first three have been proven\nto be very useful, as indicated in table 20.2.\n\n4\n\ntable 20.2 types of residuals for the cox model\n\nresidual\n\npurposes\n\nmartingale assessing adequacy of a hypothesized predictor\n\nscore\n\ntransformation. graphing an estimate of a\npredictor transformation (section 20.6.1).\ndetecting overly influential observations\n(section 20.9). robust estimate of\ncovariance matrix of \u02c6\u03b2 (section 9.5).410\nschoenfeld testing ph assumption (section 20.6.2).\n\ngraphing estimate of hazard ratio function\n(section 20.6.2).\n\n20.6 assessment of model fit\n\nas stated before, the cox model makes the same assumptions as the para-\nmetric ph model except that it does not assume a given shape for \u03bb(t) or\ns(t). because the cox ph model is so widely used, methods of assessing its fit\nare dealt with in more detail than was done with the parametric ph models.\n\n20.6.1 regression assumptions\n\nregression assumptions (linearity, additivity) for the ph model are displayed\nin figures 18.3 and 18.5. as mentioned earlier, the regression assumptions can\n\nbe verified by stratifying by x and examining log \u02c6\u03bb(t|x) or log[\u03bbkm(t|x)]\n\nestimates as a function of x at fixed time t. however, as was pointed out\n\n "}, {"Page_number": 507, "text": "488\n\n20 cox proportional hazards regression model\n\nin logistic regression, the stratification method is prone to problems of high\nvariability of estimates. the sample size must be moderately large before\nestimates are precise enough to observe trends through the \u201cnoise.\u201d if one\nwished to divide the sample by quintiles of age and 15 events were thought to\nbe needed in each stratum to derive a reliable estimate of log[\u03bbkm(2 years)],\nthere would need to be 75 events in the entire sample. if the kaplan\u2013meier\nestimates were needed to be adjusted for another factor that was binary, twice\nas many events would be needed to allow the sample to be stratified by that\nfactor.\n\nfigure 20.3 displays kaplan\u2013meier three-year log cumulative hazard esti-\nmates stratified by sex and decile of age. the simulated sample consists of\n2000 hypothetical subjects (389 of whom had events), with 1174 males (146\ndeaths) and 826 females (243 deaths). the sample was drawn from a pop-\nulation with a known survival distribution that is exponential with hazard\nfunction\n\n\u03bb(t|x1, x2) = .02 exp[.8x1 + .04(x2 \u2212 50)],\n\n(20.17)\n\nset.seed (3)\n\nwhere x1 represents the sex group (0 = male, 1 = female) and x2 age in\nyears, and censoring is uniform. thus for this population ph, linearity, and\nadditivity hold. notice the amount of variability and wide confidence limits\nin the stratified nonparametric survival estimates.\nn \u2190 2000\nage \u2190 50 + 12 * rnorm (n )\nlabel ( age ) \u2190 ' age '\nsex \u2190 factor (1 + ( runif (n ) \u2264 .4 ), 1:2 , c ( ' male ' , ' female ' ))\ncens \u2190 15 * runif ( n)\nh \u2190 .02 * exp ( .04 * ( age - 50) + .8 * ( sex == ' female ' ))\nft \u2190 -log ( runif ( n )) / h\ne \u2190 ifelse ( ft \u2264 cens , 1, 0)\n\nprint ( table ( e ))\n\ne\n\n0\n1611\n\n1\n389\n\nft \u2190 pmin (ft , cens )\nunits ( ft ) \u2190 ' year '\nsrv \u2190 surv ( ft , e )\nage.dec \u2190 cut2 ( age , g =10 , levels.mea n = true )\nlabel ( age.dec ) \u2190 ' age '\ndd \u2190 datadist ( age , sex , age.dec );\noptions ( datadist = ' dd ' )\nf.np \u2190 cph ( srv \u223c strat ( age.dec ) + strat ( sex ) , surv = true )\n# surv = true speeds up computations , and confidence limits when\n# there are no covariables are still accurate.\np \u2190 predict ( f.np , age.dec , sex , time =3 , loglog = true )\n# treat age.dec as a numeric variable (means within deciles)\np $ age.dec \u2190 as.numeric ( a s . c h a r a c t e r ( p $ age.dec ))\n\nggplot (p , ylim = c (-5 , -.5 ))\n\n "}, {"Page_number": 508, "text": "20.6 assessment of model fit\n\n489\n\n \n\n]\n)\n3\n(\ns\ng\no\n\u2212\ng\no\n\n[\n\nl\n\nl\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n\u22125\n\nsex\n\nmale\n\nfemale\n\n30\n\n40\n\n50\nage\n\n60\n\n70\n\nfig. 20.3 kaplan\u2013meier log \u03bb estimates by sex and deciles of age, with 0.95 confi-\ndence limits. solid line is for males, dashed line for females.\n\nas with the logistic model and other regression models, the restricted cubic\nspline function is an excellent tool for modeling the regression relationship\nwith very few assumptions. a four-knot spline cox ph model in two variables\n\n(x1, x2) that assumes linearity in x1 and no x1 \u00d7 x2 interaction is given by\n\n\u03bb(t|x) = \u03bb(t) exp(\u03b21x1 + \u03b22x2 + \u03b23x\n\n(cid:2)\n2 + \u03b24x\n\n(cid:2)(cid:2)\n2 ),\n\n= \u03bb(t) exp(\u03b21x1 + f (x2)),\n\n(20.18)\n\nwhere x\nf (x2) is the spline function or spline transformation of x2 given by\n\n(cid:2)(cid:2)\n2 are spline component variables as described earlier and\n\n(cid:2)\n2 and x\n\nf (x2) = \u03b22x2 + \u03b23x\n\n(cid:2)\n2 + \u03b24x\n\n(cid:2)(cid:2)\n2 .\n\nin linear form the cox model without assuming linearity in x2 is\n\nlog \u03bb(t|x) = log \u03bb(t) + \u03b21x1 + f (x2).\n\n(20.19)\n\n(20.20)\n\nby computing partial mles of \u03b22, \u03b23, and \u03b24, one obtains the estimated\ntransformation of x2 that yields linearity in log hazard or log cumulative\nhazard.\n\na similar model that does not assume ph in x1 is the cox model stratified\n\non x1. letting the stratification factor be c = x1, this model is\n\n "}, {"Page_number": 509, "text": "490\n\n20 cox proportional hazards regression model\n\nlog \u03bb(t|x2, c = j) = log \u03bbj (t) + \u03b21x2 + \u03b22x\n\n(cid:2)\n2 + \u03b23x\n\n(cid:2)(cid:2)\n2\n\n= log \u03bbj (t) + f (x2).\nthis model does assume no x1 \u00d7 x2 interaction.\n\n(20.21)\n\nfigure 20.4 displays the estimated spline function relating age and sex to\nlog[\u03bb(3)] in the simulated dataset, using the additive model stratified on sex.\nf.noia \u2190 cph ( srv \u223c rcs ( age ,4) + strat ( sex ), x = true , y = true )\n\n# get a c c u r a t e c.l. for any age by s p e c i f y i n g x = true y = true\n# note : for e v a l u a t i n g s h a p e of r e g r e s s i o n , we w o u l d not\n# o r d i n a r i l y b o t h e r to get 3 - y e a r s u r v i v a l p r o b a b i l i t i e s -\n# w o u l d just use x * beta\n# we do so here to use same s c a l e as n o n p a r a m e t r i c e s t i m a t e s\n\nw \u2190 latex ( f.noia , inline = true , digits =3)\nlatex ( anova ( f.noia ), table.env = false , file = ' ' )\n\n\u03c72 d.f.\n\np\n\nage\n\n72.33\nnonlinear 0.69\n72.33\n\ntotal\n\n3 < 0.0001\n2\n0.7067\n3 < 0.0001\n\np \u2190 predict ( f.noia , age , sex , time =3 , loglog = true )\n\nggplot (p , ylim = c ( -5 , -.5 ))\n\n \n\n]\n)\n3\n(\ns\ng\no\n\u2212\ng\no\n\n[\n\nl\n\nl\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n\u22125\n\nsex\n\nmale\n\nfemale\n\n20\n\n40\n\n60\n\n80\n\nage\n\nfig. 20.4 cox ph model stratified on sex, using spline function for age, no inter-\naction. 0.95 confidence limits also shown. solid line is for males, dashed line is for\nfemales.\n\n "}, {"Page_number": 510, "text": "20.6 assessment of model fit\n\n491\n\n+ + 9.73\u00d7 10\n\n\u22125(age\u2212 30.3)3\u2212 0.000101(age\u2212 45.1)3\n\u22125(age \u2212 69.6)3\n\na formal test of the linearity assumption of the cox ph model in the\nabove example is obtained by testing h0 : \u03b22 = \u03b23 = 0. the \u03c72 statistic with\n2 d.f. is 0.69, p = 0.7. the fitted equation, after simplifying the restricted\ncubic spline to simpler (unrestricted) form, is x \u02c6\u03b2 = \u22121.46 + 0.0255age +\n\u2212\n2.59\u00d7 10\n2.22 \u00d7 10\n+. notice that the spline estimates are closer to the\ntrue linear relationships than were the kaplan\u2013meier estimates, and the con-\nfidence limits are much tighter. the spline estimates impose a smoothness\non the relationship and also use more information from the data by treating\nage as a continuous ordered variable. also, unlike the stratified kaplan\u2013meier\nestimates, the modeled estimates can make the assumption of no age \u00d7 sex\ninteraction. when this assumption is true, modeling effectively boosts the\nsample size in estimating a common function for age across both sex groups.\nof course, this assumption can be tested and interactions can be modeled if\nnecessary.\n\n\u22125(age\u2212 54.6)3\n\n+\n\na cox model that still does not assume ph for x1 = c but which allows\n\nfor an x1 \u00d7 x2 interaction is\n\nlog \u03bb(t|x2, c = j) = log \u03bbj(t) + \u03b21x2 + \u03b22x\n\n(cid:2)\n2 + \u03b23x\n\n(cid:2)(cid:2)\n2\n\n(20.22)\n\n(cid:2)\n2\n\n+ \u03b24x1x2 + \u03b25x1x\n+ \u03b26x1x\n\n(cid:2)(cid:2)\n2 .\n\nthis model allows the relationship between x2 and log hazard to be a smooth\nnonlinear function and the shape of the x2 effect to be completely different\nfor each level of x1 if x1 is dichotomous. figure 20.5 displays a fit of this\nmodel at t = 3 years for the simulated dataset.\nf.ia \u2190 cph ( srv \u223c rcs ( age ,4) * strat ( sex ), x = true , y = true ,\nw \u2190 latex ( f.ia , inline = true , digits =3)\nlatex ( anova ( f.ia ), table.env = false , file = ' ' )\n\nsurv = true )\n\n\u03c72 d.f.\n\np\n\nage (factor+higher order factors)\n\n72.82\nall interactions\n1.05\nnonlinear (factor+higher order factors) 1.80\nage \u00d7 sex (factor+higher order factors)\n1.05\n1.05\nnonlinear\nnonlinear interaction : f(a,b) vs. ab\n1.05\ntotal nonlinear\n1.80\ntotal nonlinear + interaction 1.80\ntotal\n72.82\n\n6 < 0.0001\n0.7886\n3\n0.7728\n4\n0.7886\n3\n0.5911\n2\n2\n0.5911\n0.7728\n4\n5\n0.8763\n6 < 0.0001\n\np \u2190 predict ( f.ia , age , sex , time =3 , loglog = true )\n\nggplot (p , ylim = c ( -5 , -.5 ))\n\n "}, {"Page_number": 511, "text": "492\n\n20 cox proportional hazards regression model\n\n \n\n]\n)\n3\n(\ns\ng\no\n\u2212\ng\no\n\n[\n\nl\n\nl\n\n\u22121\n\n\u22122\n\n\u22123\n\n\u22124\n\n\u22125\n\nsex\n\nmale\nfemale\n\n20\n\n40\n\n60\n\n80\n\nage\n\nfig. 20.5 cox ph model stratified on sex, with interaction between age spline and\nsex. 0.95 confidence limits are also shown. solid line is for males, dashed line for\nfemales.\n\n\u22125(age\u221245.1)3\n\u22125(age\u2212 54.6)3\n\n\u22125(age\u221254.6)3\n\u22125(age \u2212 30.3)3\n\u22127(age\u2212 69.6)3\n\n\u2212\n\u22126(age\u2212 30.3)3\nthe fitted equation is x \u02c6\u03b2 = \u22121.8 + 0.0493age\u2212 2.15\u00d7 10\n2.82\u00d710\n\u22122.15\u00d710\n\u22125(age\u221269.6)3\n++5.18\u00d710\n+\n++\n[female][\u22120.0366age + 4.29 \u00d7 10\n\u2212 0.00011(age \u2212 45.1)3\n+ +\n\u2212 2.32\u00d7 10\n6.74\u00d7 10\n+]. the test for interaction\nyielded \u03c72 = 1.05 with 3 d.f., p = 0.8. the simultaneous test for linearity\nand additivity yielded \u03c72 = 1.8 with 5 d.f., p = 0.9. note that allowing the\nmodel to be very flexible (not assuming linearity in age, additivity between\nage and sex, and ph for sex) still resulted in estimated regression functions\nthat are very close to the true functions. however, confidence limits in this\nunrestricted model are much wider.\n\n+\n\n+\n\n+\n\nfigure 20.6 displays the estimated relationship between left ventricular\nejection fraction (lvef) and log hazard ratio for cardiovascular death in a\nsample of patients with significant coronary artery disease. the relationship\nis estimated using three knots placed at quantiles 0.05, 0.5, and 0.95 of lvef.\nhere there is significant nonlinearity (wald \u03c72 = 9.6 with 1 d.f.). the graphs\nleads to a transformation of lvef that better satisfies the linearity assump-\ntion: min(lvef, 0.5). this transformation has the best log likelihood \u201cfor the\nmoney\u201d as judged by the akaike information criterion (aic = \u22122 log l.r.\n\u22122\u00d7 no. parameters = 127). the aics for 3, 4, 5, and 6-knot spline fits were,\nrespectively, 126, 124, 122, and 120.\n\nhad the suggested transformation been more complicated than a trunca-\ntion, a tentative transformation could have been checked for adequacy by\nexpanding the new transformed variable into a new spline function and test-\ning it for linearity.\n\n "}, {"Page_number": 512, "text": "20.6 assessment of model fit\n\n493\n\nd\nr\na\nz\na\nh\n \ne\nv\ni\nt\na\nl\ne\nr\n \ng\no\nl\n\n0\n.\n1\n-\n\n5\n.\n1\n-\n\n0\n.\n2\n-\n\n5\n.\n2\n-\n\n0\n.\n3\n-\n\n5\n.\n3\n-\n\n0\n.\n4\n-\n\ncox regression model, n=979 events=198\n    statistic        x2  df\nmodel        l.r.  129.92 2  aic= 125.92\nassociation  wald  157.45 2  p=  0.000\nlinearity    wald    9.59 1  p=  0.002\n\n0.2\n\n0.4\n\nlvef\n\n0.6\n\n0.8\n\nfig. 20.6 restricted cubic spline estimate of relationship between lvef and relative\nlog hazard from a sample of 979 patients and 198 cardiovascular deaths. data from\nthe duke cardiovascular disease databank.\n\nother methods based on smoothed residual plots are also valuable tools\nfor selecting predictor transformations. therneau et al.605 describe residuals\nbased on martingale theory that can estimate transformations of any number\nof predictors omitted from a cox model fit, after adjusting for other vari-\nables included in the fit. figure 20.7 used various smoothing methods on the\npoints (lvef, residual). first, the r loess function96 was used to obtain a\nsmoothed scatterplot fit and approximate 0.95 confidence bars. second, an\nordinary least squares model, representing lvef as a restricted cubic spline\nwith five default knots, was fitted. ideally, both fits should have used weighted\nregression as the residuals do not have equal variance. predicted values from\nthis fit along with 0.95 confidence limits are shown. the loess and spline-\nlinear regression agree extremely well. third, cleveland\u2019s lowess scatterplot\nsmoother111 was used on the martingale residuals against lvef. the sug-\ngested transformation from all three is very similar to that of figure 20.6. for\nsmaller sample sizes, the raw residuals should also be displayed. there is one\nvector of martingale residuals that is plotted against all of the predictors.\nwhen correlations among predictors are mild, plots of estimated predictor\ntransformations without adjustment for other predictors (i.e., marginal trans-\nformations) may be useful. martingale residuals may be obtained quickly by\nfixing \u02c6\u03b2 = 0 for all predictors. then smoothed plots of predictor against\nresidual may be made for all predictors. table 20.3 summarizes some of the\n\n5\n\n "}, {"Page_number": 513, "text": "494\n\n20 cox proportional hazards regression model\n\nloess fit and 0.95 confidence bars\nols spline fit and 0.95 confidence limits\nlowess smoother\n\nl\na\nu\nd\ni\ns\ne\nr\n \ne\nl\na\ng\nn\ni\nt\nr\na\nm\n\n0\n.\n1\n\n5\n.\n0\n\n0\n.\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nlvef\n\nfig. 20.7 three smoothed estimates relating martingale residuals605 to lvef.\n\ntable 20.3 uses of martingale residuals for estimating predictor transformations\n\npurpose\n\nmethod\n\nforce \u02c6\u03b21 = 0 and compute\nresiduals from the null regression\n\nestimate transformation for\na single variable\ncheck linearity assumption for compute \u02c6\u03b21 and compute\na single variable\nestimate marginal\ntransformations for p variables residuals from the global null model\nestimate transformation for\nvariable i adjusted for other compute residuals from mixed\np \u2212 1 variables\n\nresiduals from the linear regression\nforce \u02c6\u03b21, . . . , \u02c6\u03b2p = 0 and compute\nestimate p \u2212 1 \u03b2s, forcing \u02c6\u03b2i = 0\n\nglobal/null model\n\n6\n\nways martingale residuals may be used. see section 10.5 for more information\non checking the regression assumptions. the methods for examining interac-\ntion surfaces described there apply without modification to the cox model\n(except that the nonparametric regression surface does not apply because of\ncensoring).\n\n20.6.2 proportional hazards assumption\n\neven though assessment of fit of the regression part of the cox ph model\ncorresponds with other regression models such as the logistic model, the cox\nmodel has its own distributional assumption in need of validation. here, of\ncourse, the distributional assumption is not as stringent as with other survival\n\n "}, {"Page_number": 514, "text": "20.6 assessment of model fit\n\n495\n\nmodels, but we do need to validate how the survival or hazard functions\nfor various subjects are connected. there are many graphical and analyti-\ncal methods of verifying the ph assumption. two of the methods have al-\nready been discussed: a graphical examination of parallelism of log \u03bb plots,\nand a comparison of stratified with unstratified models (as in figure 20.1).\nmuenz467 suggested a simple modification that will make nonproportional\nhazards more apparent: plot \u03bbkm1 (t)/\u03bbkm2 (t) against t and check for flat-\nness. the points on this curve can be passed through a smoother. one can also\nplot differences in log(\u2212 log s(t)) against t.143 arjas29 developed a graphical\nmethod based on plotting the estimated cumulative hazard versus the cumu-\nlative number of events in a stratum as t progresses.\n\nthere are other methods for assessing whether ph holds that may be more\ndirect. gore et al.,226 harrell and lee,266 and kay340 (see also anderson and\nsenthilselvan27) describe a method for allowing the log hazard ratio (cox\nregression coefficient) for a predictor to be a function of time by fitting spe-\ncially stratified cox models. their method assumes that the predictor being\nexamined for ph already satisfies the linear regression assumption. follow-\nup time is stratified into intervals and a separate model is fitted to compute\nthe regression coefficient within each interval, assuming that the effect of the\npredictor is constant only within that small interval. it is recommended that\nintervals be constructed so that there is roughly an equal number of events\nin each. the number of intervals should allow at least 10 or 20 events per\ninterval.\n\nthe interval-specific log hazard ratio is estimated by excluding all subjects\nwith event/censoring time before the start of the interval and censoring all\nevents that occur after the end of the interval. this process is repeated for\nall desired time intervals. by plotting the log hazard ratio and its confidence\nlimits versus the interval, one can assess the importance of a predictor as\na function of follow-up time and learn how to model non-ph using more\ncomplicated models containing predictor by time interactions. if the hazard\nratio is approximately constant within broad time intervals, the time strat-\nification method can be used for fitting and testing the predictor \u00d7 time\ninteraction [266, p. 827]; [98].\n\nconsider as an example the rat vaginal cancer data used in figures 18.9,\n18.10, and 20.1. recall that the ph assumption appeared to be satisfied for\nthe two groups although figure 18.9 demonstrated some non-weibullness.\nfigure 20.8 contains a \u03bb ratio plot.467\nf \u2190 cph ( s \u223c strat ( group ), surv = true )\ntimes \u2190 sort ( unique ( days [ death == 1]))\nest \u2190 survest (f , data.frame ( group = levels ( group )) ,\ncumhaz \u2190 - log ( est )\n\n# for both strata , e v a l . s ( t ) at c o m b i n e d set of d e a t h t i m e s\n\ntimes = times , conf.type = \" none \" ) $ surv\n\nplot ( times , cumhaz [2 ,] / cumhaz [1 ,] , xlab = \" days \" ,\n\nylab = \" cumulative hazard ratio \" , type = \" s \" )\n\nabline ( h =1 , col = gray ( .80 ))\n\n "}, {"Page_number": 515, "text": "496\n\n20 cox proportional hazards regression model\n\no\n\ni\nt\n\n \n\na\nr\nd\nr\na\nz\na\nh\ne\nv\ni\nt\n\n \n\nl\n\na\nu\nm\nu\nc\n\n2.5\n\n2.0\n\n1.5\n\n1.0\n\n0.5\n\n150\n\n200\n\n250\n\n300\n\ndays\n\nfig. 20.8 estimate of \u03bb2/\u03bb1 based on \u2212 log of altschuler\u2013nelson\u2013fleming\u2013\nharrington nonparametric survival estimates.\n\ntable 20.4 interval-specific group effects from rat data by artificial censoring\n\ntime\ninterval\n[0, 209)\n[209, 234)\n234 +\n\nobservations deaths log hazard standard\n\n40\n27\n14\n\n12\n12\n12\n\nratio\n\u22120.47\n\u22120.72\n\u22120.50\n\nerror\n0.59\n0.58\n0.64\n\nhazard.rati o. pl ot ( g $x , g $y , e =12 , pr = true )\n\nthe number of observations is declining over time because computations in\neach interval were based on animals followed at least to the start of that\ninterval. the overall cox regression coefficient was \u22120.57 with a standard\nerror of 0.35. there does not appear to be any trend in the hazard ratio over\ntime, indicating a constant hazard ratio or proportional hazards (table 20.4).\nnow consider the veterans administration lung cancer dataset [331, pp.\n60, 223\u20134]. log \u03bb plots indicated that the four cell types did not satisfy\nph. to simplify the problem, omit patients with \u201clarge\u201d cell type and let\nthe binary predictor be 1 if the cell type is \u201csquamous\u201d and 0 if it is \u201csmall\u201d\nor \u201cadeno.\u201d we are assessing whether survival patterns for the two groups\n\u201csquamous\u201d versus \u201csmall\u201d or \u201cadeno\u201d have ph. interval-specific estimates of\nthe squamous : small,adeno log hazard ratios (using efron\u2019s likelihood) are\nfound in table 20.5. times are in days.\n\n "}, {"Page_number": 516, "text": "20.6 assessment of model fit\n\n497\n\ntable 20.5 interval-specific effects of squamous cell cancer in va lung cancer data\n\ntime\ninterval\n[0, 21)\n[21, 52)\n[52, 118)\n118 +\n\nobservations deaths log hazard standard\n\n110\n84\n59\n28\n\n26\n26\n26\n26\n\nratio\n\u22120.46\n\u22120.90\n\u22121.35\n\u22121.04\n\nerror\n0.47\n0.50\n0.50\n0.45\n\ntable 20.6 interval-specific effects of performance status in va lung cancer data\n\ntime\ninterval\n[0, 19]\n[19, 49)\n[49, 99)\n99 +\n\nobservations deaths log hazard standard\n\n137\n112\n85\n28\n\nratio\n\u22120.053\n\u22120.047\n\u22120.036\n\u22120.012\n\nerror\n0.010\n0.009\n0.012\n0.014\n\n27\n26\n27\n26\n\ngethdata ( valung )\nwith ( valung , {\n\nhazard.ratio . pl ot (1 * ( cell == ' squamous ' ), surv (t , dead ),\n\ne =25 , subset = cell ! = ' large ' ,\npr = true , pl = false )\n\nhazard.ratio . pl ot (1 * kps , surv (t , dead ), e =25 ,\n\npr = true , pl = false ) })\n\nthere is evidence of a trend of a decreasing hazard ratio over time which\nis consistent with the observation that squamous cell patients had equal or\nworse survival in the early period but decidedly better survival in the late\nphase.\n\nfrom the same dataset now examine the ph assumption for karnofsky\nperformance status using data from all subjects, if the linearity assumption is\nsatisfied. interval-specific regression coefficients for this predictor are given in\ntable 20.6. there is good evidence that the importance of performance status\nis decreasing over time and that it is not a prognostic factor after roughly\n99 days. in other words, once a patient survives 99 days, the performance\nstatus does not contain much information concerning whether the patient will\nsurvive 120 days. this non-ph would be more difficult to detect from kaplan\u2013\nmeier plots stratified on performance status unless performance status was\nstratified carefully.\n\nfigure 20.9 displays a log hazard ratio plot for a larger dataset in which\nmore time strata can be formed. in 3299 patients with coronary artery disease,\n827 suffered cardiovascular death or nonfatal myocardial infarction. time\n\n7\n\n "}, {"Page_number": 517, "text": "498\n\n20 cox proportional hazards regression model\n\nsubset estimate\n0.95 c.l.\nsmoothed\n\no\ni\nt\na\nr\n \nd\nr\na\nz\na\nh\n \ng\no\nl\n\n2\n.\n0\n\n1\n.\n0\n\n0\n.\n0\n\n1\n.\n0\n-\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\nt\n\npredictor:pain/ischemia index\n\nevent:cdeathmi\n\nfig. 20.9 stratified hazard ratios for pain/ischemia index over time. data from the\nduke cardiovascular disease databank.\n\nwas stratified into intervals containing approximately 30 events, and within\neach interval the cox regression coefficient for an index of anginal pain and\nischemia was estimated. the pain/ischemia index, one component of which is\nunstable angina, is seen to have a strong effect for only six months. after that,\nsurvivors have stabilized and knowledge of the angina status in the previous\nsix months is not informative.\n\nanother method for graphically assessing the log hazard ratio over time is\nbased on schoenfeld\u2019s partial residuals503, 557 with respect to each predictor in\nthe fitted model. the residual is the contribution of the first derivative of the\nlog likelihood function with respect to the predictor\u2019s regression coefficient,\ncomputed separately at each risk set or unique failure time. in figure 20.10\nthe \u201cloess-smoothed\u201d96 (with approximate 0.95 confidence bars) and \u201csuper-\nsmoothed\u201d207 relationship between the residual and unique failure time is\nshown for the same data as figure 20.9. for smaller n, the raw residuals\nshould also be displayed to convey the proper sense of variability. the agree-\nment with the pattern in figure 20.9 is evident.\n\npettitt and bin daud503 suggest scaling the partial residuals by the infor-\nmation matrix components. they also propose a score test for ph based on\nthe schoenfeld residuals. grambsch and therneau233 found that the pettitt\u2013\nbin daud standardization is sometimes misleading in that non-ph in one\nvariable may cause the residual plot for another variable to display non-\nph. the grambsch\u2013therneau weighted residual solves this problem and also\nyields a residual that is on the same scale as the log relative hazard ratio.\ntheir residual is\n\n\u02c6\u03b2 + dr \u02c6v ,\n\n(20.23)\n\n "}, {"Page_number": 518, "text": "20.6 assessment of model fit\n\n499\n\nloess smoother, span=0.5, 0.95 c.l.\nsuper smoother\n\nl\na\nu\nd\ni\ns\ne\nr\n \nd\nl\ne\nf\nn\ne\no\nh\nc\ns\n \nd\ne\nl\na\nc\ns\n\n2\n.\n0\n\n1\n.\n0\n\n0\n.\n0\n\n1\n.\n0\n-\n\n0\n\n2\n\n4\n\n6\nt\n\n8\n\n10\n\n12\n\nfig. 20.10 smoothed weighted233 schoenfeld557 residuals for the same data in fig-\nure 20.9. test for ph based on the correlation (\u03c1) between the individual weighted\nschoenfeld residuals and the rank of failure time yielded \u03c1 = \u22120.23, z = \u22126.73, p =\n2 \u00d7 10\n\n\u221211.\n\nwhere d is the total number of events, r is the n \u00d7 p matrix of schoenfeld\nresiduals, and \u02c6v is the estimated covariance matrix for \u02c6\u03b2. this new residual\ncan also be the basis for tests for ph, by correlating a user-specified function\nof unique failure times with the weighted residuals.\n\nthe residual plot is computationally very attractive since the score residual\ncomponents are byproducts of cox maximum likelihood estimation. another\nattractive feature is the lack of need to categorize the time axis. unless ap-\nproximate confidence intervals are derived from smoothing techniques, a lack\nof confidence intervals from most software is one disadvantage of the method.\n\nformal tests for ph can be based on time-stratified cox regression esti-\nmates.27, 266 alternatively, more complex (and probably more efficient) formal\ntests for ph can be derived by specifying a form for the time by predictor in-\nteraction (using what is called a time-dependent covariable in the cox model)\nand testing coefficients of such interactions for significance. the obsolete ver-\nsion 5 sas phglm procedure used a computationally fast procedure based on\nan approximate score statistic that tests for linear correlation between the\nrank order of the failure times in the sample and schoenfeld\u2019s partial resid-\nuals.258, 266 this test is available in r (for both weighted and unweighted\nresiduals) using therneau\u2019s cox.zph function in the survival package. for the\nresults in figure 20.10, the test for ph is highly significant (correlation coef-\nficient = \u22120.23, normal deviate z = \u22126.73). since there is only one regression\nparameter, the weighted residuals are a constant multiple of the unweighted\nones, and have the same correlation coefficient.\n\n8\n\n9\n\n10\n\n11\n\n "}, {"Page_number": 519, "text": "500\n\n20 cox proportional hazards regression model\n\ntable 20.7 time-specific hazard ratio estimates of squamous cell cancer effect in va\nlung cancer data, by fitting two weibull distributions with unequal shape parameters\n\nt\n\nlog hazard\n\nratio\n\u22120.36\n10\n\u22120.64\n36\n83.5 \u22120.83\n\u22121.02\n200\n\n12\n\nanother method for checking the ph assumption which is especially ap-\nplicable to a polytomous predictor involves taking ratios of parametrically\nestimated hazard functions estimated separately for each level of the predic-\ntor. for example, suppose that a risk factor x is either present (x = 1) or\nabsent (x = 0), and suppose that separate weibull distributions adequately\nfit the survival pattern of each group. if there are no other predictors to ad-\njust for, define the hazard function for x = 0 as \u03b1\u03b3t\u03b3\u22121 and the hazard for\nx = 1 as \u03b4\u03b8t\u03b8\u22121. the x = 1 : x = 0 hazard ratio is\n\n\u03b1\u03b3t\u03b3\u22121\n\u03b4\u03b8t\u03b8\u22121 =\n\nt\u03b3\u2212\u03b8.\n\n\u03b1\u03b3\n\u03b4\u03b8\n\n(20.24)\n\nthe hazard ratio is constant if the two weibull shape parameters (\u03b3 and \u03b8)\nare equal. these weibull parameters can be estimated separately and a wald\ntest statistic of h0 : \u03b3 = \u03b8 can be computed by dividing the square of their\ndifference by the sum of the squares of their estimated standard errors, or\nbetter by a likelihood ratio test. a plot of the estimate of the hazard ratio\nabove as a function of t may also be informative.\n\nin the va lung cancer data, the mles of the weibull shape parameters\nfor squamous cell cancer is 0.77 and for the combined small + adeno is 0.99.\nestimates of the reciprocals of these parameters, provided by some software\npackages, are 1.293 and 1.012 with respective standard errors of 0.183 and\n0.0912. a wald test for differences in these reciprocals provides a rough test\nfor a difference in the shape estimates. the wald \u03c72 is 1.89 with 1 d.f. indi-\ncating slight evidence for non-ph.\n\nthe fitted weibull hazard function for squamous cell cancer is .0167t0.23\n\u22120.01. the estimated hazard ratio is then\nand for adeno + small is 0.0144t\n\u22120.22 and the log hazard ratio is 0.148 \u2212 0.22 log t. by evaluating this\n1.16t\nweibull log hazard ratio at interval midpoints (arbitrarily using t = 200\nfor the last (open) interval) we obtain log hazard ratios that are in good\nagreement with those obtained by time-stratifying the cox model (table 20.5)\nas shown in table 20.7.\n\nthere are many methods of assessing ph using time-dependent covari-\nables in the cox model.226, 583 gray237, 238 mentions a flexible and efficient\nmethod of estimating the hazard ratio function using time-dependent covari-\nables that are x \u00d7 spline term interactions. gray\u2019s method uses b-splines and\n\n "}, {"Page_number": 520, "text": "20.7 what to do when ph fails\n\n501\n\nrequires one to maximize a penalized log-likelihood function. verweij and van\nhouwelingen641 developed a more nonparametric version of this approach.\nhess289 uses simple restricted cubic splines to model the time-dependent co-\nvariable effects (see also [4, 287, 398, 498]). suppose that k = 4 knots are used\nand that a covariable x is already transformed correctly. the model is\n\nlog \u03bb(t|x) = log \u03bb(t) + \u03b21x + \u03b22xt + \u03b23xt\n(cid:2)\n\n(cid:2)(cid:2)\n\n(cid:2)\n\n+ \u03b24xt\n\n(cid:2)(cid:2)\n\n,\n\n(20.25)\n\n, t\n\nwhere t\nlog hazard ratio function is estimated by\n\nare constructed spline variables (equation 2.25). the x + 1 : x\n\n\u02c6\u03b21 + \u02c6\u03b22t + \u02c6\u03b23t\n\n(cid:2)\n\n+ \u02c6\u03b24t\n\n(cid:2)(cid:2)\n\n.\n\n(20.26)\n\nthis method can be generalized to allow for simultaneous estimation of the\nshape of the x effect and x \u00d7 t interaction using spline surfaces in (x, t)\ninstead of (x1, x2) (section 2.7.2).\n\ntable 20.8 summarizes many facets of verifying assumptions for ph mod-\nels. the trade-offs of the various methods for assessing proportional hazards\nare given in table 20.9.\n\n13\n\n14\n\n20.7 what to do when ph fails\n\nwhen a factor violates the ph assumption and a test of association is not\nneeded, the factor can be adjusted for through stratification as mentioned\nearlier. this is especially attractive if the factor is categorical. for continuous\npredictors, one may want to stratify into quantile groups. the continuous\nversion of the predictor can still be adjusted for as a covariable to account\nfor any residual linearity within strata.\n\nwhen a test of significance is needed and the p -value is impressive, the\n\u201cprinciple of conservatism\u201d could be invoked, as the p -value would likely\nhave been more impressive had the factor been modeled correctly. predicted\nsurvival probabilities using this approach will be erroneous in certain time\nintervals.\n\nan efficient test of association can be done using time-dependent covari-\n\nables [444, pp. 208\u2013217]. for example, in the model\n\n\u03bb(t|x) = \u03bb0(t) exp(\u03b21x + \u03b22x \u00d7 log(t + 1))\n\n(20.27)\n\none tests h0 : \u03b21 = \u03b22 = 0 with 2 d.f. this is similar to the approach used\nby [72]. stratification on time intervals can also be used:27, 226, 266\n\n\u03bb(t|x) = \u03bb0(t) exp(\u03b21x + \u03b22x \u00d7 [t > c]).\n\n(20.28)\n\n "}, {"Page_number": 521, "text": "502\n\n20 cox proportional hazards regression model\n\ntable 20.8 assumptions of the proportional hazards model\n\nvariables\n\nassumptions\n\nverification\n\nresponse variable t\ntime until event\n\nshape of \u03bb(t|x) for fixed x\nas t \u2191\ncox: none\nweibull: t\u03b8\n\nshape of skm(t)\n\n\u2022 categorical x:\n\ninteraction between x\nand t\n\nproportional hazards\u2014effect\nof x does not depend on t\n(e.g., treatment effect is con-\nstant over time)\n\nindividual predictors x\n\nshape of \u03bb(t|x) for fixed t as\nx \u2191\nlinear:\nlog \u03bb(t|x) = log \u03bb(t) + \u03b2x\nnonlinear: log \u03bb(t|x) =\nlog \u03bb(t) + f (x)\n\ntio plots\n\ncheck parallelism of strati-\nfied log[\u2212 log s(t)] plots as\nt \u2191\n\u2022 muenz467 cum. hazard ra-\n\u2022 arjas29 cum. hazard plots\n\u2022 check agreement of strati-\nfied and modeled estimates\n\u2022 hazard ratio plots\n\u2022 smoothed schoenfeld resid-\nual plots and correlation\ntest (time vs. residual)\ntime-dependent\nco-\nvariable such as x \u00d7 log(t +\n1)\n\u2022 ratio of parametrically es-\n\n\u2022 test\n\ntimated \u03bb(t)\n\n\u2022 k-level ordinal x :\n\nlinear\nterm + k \u2212 2 dummy vari-\nables\n\u2022 continuous x: polynom-\nfunctions,\nmartingale\n\nials,\nsmoothed\nresidual plots\n\nspline\n\ninteraction between x1\nand x2\n\nadditive effects: effect of x1\non log \u03bb is independent of x2\nand vice versa\n\ntest nonadditive terms (e.g.,\nproducts)\n\nif this step-function model holds, and if a sufficient number of subjects have\nlate follow-up, you can also fit a model for early outcomes and a separate\none for late outcomes using interval-specific censoring as discussed in section\n20.6.2. the dual model approach provides easy to interpret models, assuming\nthat proportional hazards is satisfied within each interval.\n\nkronborg and aaby367 and dabrowska et al.143 provide tests for differences\nin \u03bb(t) at specific t based on stratified ph models. these can also be used\nto test for treatment effects when ph is violated for treatment but not for\n\n "}, {"Page_number": 522, "text": "20.8 collinearity\n\n503\n\nadjustment variables. differences in mean restricted life length (differences in\nareas under survival curves up to a fixed finite time) can also be useful for\ncomparing therapies when ph fails.335\n\ntable 20.9 comparison of methods for checking the proportional hazards assump-\ntion and for allowing for non-proportional hazards\n\nrequires requires computa- yields\ngrouping grouping\n\ntional\n\nt\n\nefficiency test\n\nformal estimate of fitting 2\n\u03bb2(t)/\u03bb1(t) models\n\nyields\n\nrequires must choose\n\nmethod\n\nlog[\u2212 log],\nmuenz,\narjas plots\n\ndabrowska\n\nlog \u02c6\u03bb\ndifference\nplots\n\nstratified vs.\n\nmodeled\nestimates\n\nhazard ratio\n\nplot\n\nschoenfeld\n\nresidual\nplot\n\nschoenfeld\n\nresidual\ncorrelation\ntest\n\nfit time-\n\ndependent\ncovariables\n\nratio of\n\nparametric\nestimates\nof \u03bb(t)\n\nx\nx\n\nx\n\nx\n\nx\n\nsmoothing\nparameter\n\n?\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\n?\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nx\n\nparametric models that assume an effect other than ph, for example, the\nlog-logistic model,226 can be used to allow a predictor to have a constantly\nincreasing or decreasing effect over time. if one predictor satisfies ph but\nanother does not, this approach will not work.\n\n15\n\n20.8 collinearity\n\nsee section 4.6 for the general approach using variance inflation factors.\n\n "}, {"Page_number": 523, "text": "504\n\n20 cox proportional hazards regression model\n\n20.9 overly influential observations\n\ntherneau et al.605 describe the use of score residuals for assessing influence in\ncox and related regression models. they show that the infinitesimal jackknife\n, where v is the\nestimate of the influence of observation i on \u03b2 equals v s\nestimated variance\u2013covariance matrix of the p regression estimates b and s =\n(si1, si2, . . . , sip) is the vector of score residuals for the p regression coefficients\nfor the ith observation. let sn\u00d7p denote the matrix of score residuals over\nall observations. then an approximation to the unstandardized change in b\n(dfbeta) is sv . standardizing by the standard errors of b found from the\ndiagonals of v , e = (v11, v22, . . . , vpp)1/2, yields\n\n(cid:2)\n\ndfbetas = sv diag(e)\n\n\u22121,\n\n(20.29)\n\nwhere diag(e) is a diagonal matrix containing the estimated standard errors.\nas discussed in section 20.13, identification of overly influential observa-\ntions is facilitated by printing, for each predictor, the list of observations\ncontaining dfbetas > u for any parameter associated with that predictor.\nthe choice of cutoff u depends on the sample size among other things. a\ntypical choice might be u = 0.2 indicating a change in a regression coefficient\nof 0.2 standard errors.\n\n20.10 quantifying predictive ability\n\nto obtain a unitless measure of predictive ability for a cox ph model we\ncan use the r index described in section 9.8.3, which is the square root of\nthe fraction of log likelihood explained by the model of the log likelihood\nthat could be explained by a perfect model, penalized for the complexity of\nthe model. the lowest (best) possible \u22122 log likelihood for the cox model is\nzero, which occurs when the predictors can perfectly rank order the survival\n\u2217\ntimes. therefore, as was the case with the logistic model, the quantity l\nfrom section 9.8.3 is zero and an r index that is penalized for the number of\nparameters in the model is given by\n\nr2 = (lr \u2212 2p)/l0,\n\n(20.30)\nwhere p is the number of parameters estimated and l0 is the \u22122 log likelihood\nwhen \u03b2 is restricted to be zero (i.e., there are no predictors in the model). r\nwill be near one for a perfectly predictive model and near zero for a model\nthat does not discriminate between short and long survival times. the r\nindex does not take into account any stratification factors. if stratification\nfactors are present, r will be near one if survival times can be perfectly ranked\nwithin strata even though there is overlap between strata.\n\n "}, {"Page_number": 524, "text": "20.10 quantifying predictive ability\n\n505\n\nschemper546 and korn and simon365 have reported that r2 is too sen-\nsitive to the distribution of censoring times and have suggested alterna-\ntives based on the distance between estimated cox survival probabilities\n(using predictors) and kaplan\u2013meier estimates (ignoring predictors). kent\nand o\u2019quigley345 also report problems with r2 and suggest a more complex\nmeasure. schemper548 investigated the maddala\u2013magee431, 432 index r2\nlr de-\nscribed in section 9.8.3, applied to cox regression:\n\nlr = 1 \u2212 exp(\u2212lr/n)\nr2\n\n= 1 \u2212 \u03c92/n,\n\n(20.31)\n\nfor many situations, r2\n\nwhere \u03c9 is the null model likelihood divided by the fitted model likelihood.\nlr performed as well as schemper\u2019s more complex\nmeasure546, 549 and hence it is preferred because of its ease of calculation\n(assuming that ph holds). ironically, schemper548 demonstrated that the n\nin the formula for this index is the total number of observations, not the\nnumber of events (but see o\u2019quigley, xu, and stare481). to make the r2\nindex have a maximum value of 1.0, we use the nagelkerke471 r2\nn discussed\nin section 9.8.3.\n\nan easily interpretable index of discrimination for survival models is de-\nrived from kendall\u2019s \u03c4 and somers\u2019 dxy rank correlation,579 the gehan\u2013\nwilcoxon statistic for comparing two samples for survival differences, and\nthe brown\u2013hollander\u2013korwar nonparametric test of association for censored\ndata.76, 170, 262, 268 this index, c, is a generalization of the area under the roc\ncurve discussed under the logistic model, in that it applies to a continuous\nresponse variable that can be censored. the c index is the proportion of all\npairs of subjects whose survival time can be ordered such that the subject\nwith the higher predicted survival is the one who survived longer. two sub-\njects\u2019 survival times cannot be ordered if both subjects are censored or if one\nhas failed and the follow-up time of the other is less than the failure time\nof the first. the c index is a probability of concordance between predicted\nand observed survival, with c = 0.5 for random predictions and c = 1 for a\nperfectly discriminating model. the c index is mildly affected by the amount\nof censoring. dxy is obtained from 2(c \u2212 0.5). while c (and dxy) is a good\nmeasure of pure discrimination ability of a single model, it is not sensitive\nenough to allow multiple models to be compared447.\n\nsince high hazard means short survival time, when the linear predictor\nx \u02c6\u03b2 from a cox model is compared with observed survival time, dxy will be\nnegative. some analysts may want to negate reported values of dxy.\n\n16\n\n17\n\n "}, {"Page_number": 525, "text": "506\n\n20 cox proportional hazards regression model\n\n20.11 validating the fitted model\n\nseparate bootstrap or cross-validation assessments can be made for calibra-\ntion and discrimination of cox model survival and log relative hazard esti-\nmates.\n\n18\n\n20.11.1 validation of model calibration\n\none approach to validation of the calibration of predictions is to obtain un-\nbiased estimates of the difference between cox predicted and kaplan\u2013meier\nsurvival estimates at a fixed time u. here is one sequence of steps.\n\n1. obtain cutpoints (e.g., deciles) of predicted survival at time u so as to\nhave a given number of subjects (e.g., 50) in each interval of predicted\nsurvival. these cutpoints are based on the distribution of \u02c6s(u|x) in the\nwhole sample for the\u201cfinal\u201dmodel (for data-splitting, instead use the model\ndeveloped in the training sample). let k denote the number of intervals\nused.\n\n2. compute the average \u02c6s(u|x) in each interval.\n3. compare this with the kaplan\u2013meier survival estimates at time u, strat-\nified by intervals of \u02c6s(u|x). let the differences be denoted by d =\n(d1, . . . , dk).\n\n4. use bootstrapping or cross-validation to estimate the overoptimism in d\nand then to correct d to get a more fair assessment of these differences.\nfor each repetition, repeat any stepwise variable selection or stagewise\nsignificance testing using the same stopping rules as were used to derive\nthe \u201cfinal\u201d model. no more than b = 200 replications are needed to obtain\naccurate estimates.\n\n5. if desired, the bias-corrected d can be added to the original stratified\n\nkaplan\u2013meier estimates to obtain a bias-corrected calibration curve.\n\nhowever, any statistical method that uses binning of continuous variables\n(here, the predicted risk), is arbitrary and has lower precision than smooth\nestimates that allow for interpolation. a far better approach to estimating\ncalibration curves for survival models is to use the flexible adaptive hazard\nregression approach of kooperberg et al.361 as discussed on p. 450. their\nmethod does not assume linearity or proportional hazards. hazard regres-\nsion can be used to estimate the relationship between (suitably transformed)\npredicted survival probabilities and observed outcomes, i.e., to derive a cali-\nbration curve. the bootstrap is used to de-bias the estimates to correct for\noverfitting, allowing estimation of the likely future calibration performance\nof the fitted model.\n\nas an example, consider a dataset of 20 random uniformly distributed\npredictors for a sample of size 200. let the failure time be another random\n\n "}, {"Page_number": 526, "text": "20.11 validating the fitted model\n\n507\n\nuniform variable that is independent of all the predictors, and censor half of\nthe failure times at random. due to fitting 20 predictors to 100 events, there\nwill apparently be fair agreement between predicted and observed survival\nover all strata (smooth black curve from hazard regression in figure 20.11).\nhowever, the bias-corrected calibration (blue curve from hazard regression)\ngives a more truthful answer: examining the xs across levels of predicted\nsurvival demonstrate that predicted and observed survival are weekly related,\nin more agreement with how the data were generated. for the more arbitrary\nkaplan-meier approach, we divide the observations into quintiles of predicted\n0.5-year survival, so that there are 40 observations per stratum.\nn \u2190 200\np \u2190 20\nxx \u2190 matrix ( rnorm ( n * p ), nrow =n , ncol = p )\ny \u2190 runif ( n )\nunits ( y ) \u2190 \" year \"\ne \u2190 c ( rep (0 , n / 2) , rep (1 , n / 2))\nf \u2190 cph ( surv (y , e) \u223c xx , x = true , y = true ,\ncal \u2190 calibrate (f , u = .5 , b =200)\n\ntime.inc =.5 , surv = true )\n\nset.seed (6)\n\nusing cox survival e s t i m a t e s at 0.5 years\n\nplot ( cal , ylim = c ( .4 , 1) , subtitles = false )\n\ncalkm \u2190 calibrate (f , u = .5 , m =40 ,\n\ncmethod = ' km ' , b =200)\n\nusing cox survival e s t i m a t e s at 0.5 years\n\nplot ( calkm , add = true )\n\n# f i g u r e 20.11\n\n20.11.2 validation of discrimination and other\n\nstatistical indexes\n\nhere bootstrapping and cross-validation are used as for logistic models (sec-\ntion 10.9). we can obtain bootstrap bias-corrected estimates of c or equiv-\nalently dxy. to instead obtain a measure of relative calibration or slope\nshrinkage, we can bootstrap the apparent estimate of \u03b3 = 1 in the model\n\n\u03bb(t|x) = \u03bb(t) exp(\u03b3xb).\n\n(20.32)\n\nbesides being a measure of calibration in itself, the bootstrap estimate of\n\u03b3 also leads to an unreliability index u which measures how far the model\nmaximum log likelihood (which allows for an overall slope correction) is from\nthe log likelihood evaluated at\u201cfrozen\u201dregression coefficients (\u03b3 = 1) (see [267]\nand section 10.9).\n\n "}, {"Page_number": 527, "text": "508\n\n20 cox proportional hazards regression model\n\nr\na\ne\ny\n5\n\n \n\n.\n\n0\n\n \n\ni\n\ni\n\ng\nn\nv\nv\nr\nu\ns\nn\no\n\n \n\ni\nt\nc\na\nr\nf\n\n1.0\n\n0.9\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.50 0.55 0.60 0.65 0.70 0.75 0.80 0.85\n\npredicted  0.5 year survival\n\nfig. 20.11 calibration of random predictions using efron\u2019s bootstrap with b = 200\nresamples. dataset has n = 200, 100 uncensored observations, 20 random predic-\ntors, model \u03c72\n20 = 19. the smooth black line is the apparent calibration estimated\nby adaptive linear spline hazard regression361, and the blue line is the bootstrap\nbias\u2013 (overfitting\u2013) corrected calibration curve estimated also by hazard regression.\nthe gray scale line is the line of identity representing perfect calibration. black dots\nrepresent apparent calibration accuracy obtained by stratifying into intervals of pre-\ndicted 0.5y survival containing 40 events per interval and plotting the mean predicted\nvalue within the interval against the stratum\u2019s kaplan-meier estimate. the blue \u00d7\nrepresent bootstrap bias-corrected kaplan-meier estimates.\n\nlr(\u02c6\u03b3xb) \u2212 lr(xb)\n\nu =\n\n(20.33)\nwhere l0 is the \u22122 log likelihood for the null model (section 9.8.3). similarly,\na discrimination index d267 can be derived from the \u22122 log likelihood at the\nshrunken linear predictor, penalized for estimating one parameter (\u03b3) (see\nalso [633, p. 1318] and [123]):\n\nl0\n\n,\n\nlr(\u02c6\u03b3xb) \u2212 1\n\nl0\n\n.\n\nd =\n\n(20.34)\n\nd is the same as r2 discussed above when p = 1 (indicating only one reesti-\nmated parameter, \u03b3), the penalized proportion of explainable log likelihood\nthat was explained by the model. because of the remark of schemper,546 all\nof these indexes may unfortunately be functions of the censoring pattern.\n\nan index of overall quality that penalizes discrimination for unreliability is\n\nq = d \u2212 u =\n\nlr(xb) \u2212 1\n\nl0\n\n.\n\n(20.35)\n\n "}, {"Page_number": 528, "text": "20.12 describing the fitted model\n\n509\n\nq is a normalized and penalized \u22122 log likelihood that is evaluated at the\nuncorrected linear predictor.\n\nfor the random predictions used in figure 20.11, the bootstrap estimates\n\nwith b = 200 resamples are found in table 20.10.\nlatex ( validate (f , b =200) , digits =3 , file = ' ' , caption = ' ' ,\n\ntable.env = true , label = ' tab : cox-val-random ' )\n\ntable 20.10 bootstrap validation of a cox model with random predictors\n\nindex original training test optimism corrected n\n\nsample sample sample\n0.213\n0.335\n0.147\n0.092\n0.191\n0.042\n1.000\n1.000\n0.389\n0.048\n0.021\n0.009\n\u22120.002 \u22120.002\n0.028\n0.050 \u22120.020\n0.023\n0.339\n0.878\n0.516\n\ndxy\nr2\nslope\nd\nu\nq\ng\n\nindex\n\n0.188\n0.025 200\n0.150 \u22120.058 200\n0.611\n0.389 200\n0.039 \u22120.019 200\n\u22120.031\n0.028 200\n0.070 \u22120.047 200\n0.539 \u22120.023 200\n\nit can be seen that the apparent correlation (dxy = \u22120.21) does not hold\nup after correcting for overfitting (dxy = \u22120.02). also, the slope shrinkage\n(0.39) indicates extreme overfitting.\n\nsee [633, section 6] and [640] and section 18.3.7 for still more useful meth-\n\nods for validating the cox model.\n\n20.12 describing the fitted model\n\nas with logistic modeling, once a cox ph model has been fitted and all\nits assumptions verified, the final model needs to be presented and inter-\npreted. the fastest way to describe the model is to interpret each effect in\nit. for each predictor the change in log hazard per desired units of change\nin the predictor value may be computed, or the antilog of this quantity,\nexp(\u03b2j \u00d7 change in xj), may be used to estimate the hazard ratio holding\nall other factors constant. when xj is a nonlinear factor, changes in predicted\nx\u03b2 for sensible values of xj such as quartiles can be used as described in\nsection 10.10. of course for nonmodeled stratification factors, this method is\nof no help. figure 20.12 depicts a way to display estimated surgical : medical\nhazard ratios in the presence of a significant treatment by disease severity\ninteraction and a secular trend in the benefit of surgical therapy (treatment\nby year of diagnosis interaction).\n\noften, the use of predicted survival probabilities may make the model\nmore interpretable. if the effect of only one factor is being displayed and\n\n "}, {"Page_number": 529, "text": "510\n\n20 cox proportional hazards regression model\n\n1\u2212vessel disease\n2\u2212vessel disease\n3\u2212vessel disease\n75% left main\n95% left main\n\n1\u2212vessel disease\n2\u2212vessel disease\n3\u2212vessel disease\n75% left main\n95% left main\n\n1\u2212vessel disease\n2\u2212vessel disease\n3\u2212vessel disease\n75% left main\n95% left main\n\n1\n9\n7\n0\n\n1\n9\n7\n7\n\n1\n9\n8\n4\n\n0.125\n\n0.25\n\n0.5\n\n1.0\n\n1.5 2.0 2.5\n\nhazard ratio\n\nfig. 20.12 a display of an interaction between treatment and extent of disease, and\nbetween treatment and calendar year of start of treatment. comparison of medical and\nsurgical average hazard ratios for patients treated in 1970, 1977, and 1984 according\nto coronary disease severity. circles represent point estimates; bars represent 0.95\nconfidence limits of hazard ratios. ratios less than 1.0 indicate that coronary bypass\nsurgery is more effective.88\n\nthat factor is polytomous or predictions are made for specific levels, survival\ncurves (with or without adjustment for other factors not shown) can be drawn\nfor each level of the predictor of interest, with follow-up time on the x-axis.\nfigure 20.2 demonstrated this for a factor which was a stratification factor.\nfigure 20.13 extends this by displaying survival estimates stratified by treat-\nment but adjusted to various levels of two modeled factors, one of which, year\nof diagnosis, interacted with treatment.\n\nwhen a continuous predictor is of interest, it is usually more informative\nto display that factor on the x-axis with estimated survival at one or more\ntime points on the y-axis. when the model contains only one predictor, even\nif that predictor is represented by multiple terms such as a spline expansion,\none may simply plot that factor against the predicted survival. figure 20.14\ndepicts the relationship between treadmill exercise score, which is a weighted\nlinear combination of several predictors in a cox model, and the probability\nof surviving five years.\n\nwhen displaying the effect of a single factor after adjusting for multiple\npredictors which are not displayed, care only need be taken for the values\nto which the predictors are adjusted (e.g., grand means). when instead the\ndesire is to display the effect of multiple predictors simultaneously, an im-\nportant continuous predictor can be displayed on the x-axis while separate\n\n "}, {"Page_number": 530, "text": "20.12 describing the fitted model\n\n511\n\ncurves or graphs are made for levels of other factors. figure 20.15, which\ncorresponds to the log \u03bb plots in figure 20.5, displays the joint effects of age\nand sex on the three-year survival probability. age is modeled with a cubic\nspline function, and the model includes terms for an age \u00d7 sex interaction.\np \u2190 predict ( f.ia , age , sex , time =3)\n\nggplot ( p )\n\n1970\n\n1977\n\n1984\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n1.00\n\n0.75\n\n0.50\n\n0.25\n\n0.00\n\nl\nv\ne\nf\n=\n0\n\n.\n\n4\n\nl\nv\ne\nf\n=\n0\n\n.\n\n6\n\ntreatment\n\nsurgical\n\nmedical\n\n0 1 2 3 4 5 0 1 2 3 4 5 0 1 2 3 4 5\n\nyears of followup\n\nfig. 20.13 cox\u2013kalbfleisch\u2013prentice survival estimates stratifying on treatment and\nadjusting for several predictors, showing a secular trend in the efficacy of coronary\nartery bypass surgery. estimates are for patients with left main disease and normal\n(lvef=0.6) or impaired (lvef=0.4) ventricular function.516\n\nbesides making graphs of survival probabilities estimated for given levels\nof the predictors, nomograms have some utility in specifying a fitted cox\nmodel. a nomogram can be used to compute x \u02c6\u03b2, the estimated log hazard for\na subject with a set of predictor values x relative to the \u201cstandard\u201d subject.\nthe central line in the nomogram will be on this linear scale unlike the logistic\nmodel nomograms given in section 10.10 which further transformed x \u02c6\u03b2 into\n[1 + exp(\u2212x \u02c6\u03b2)]\n\u22121. alternatively, the central line could be on the nonlinear\nexp(x \u02c6\u03b2) hazard ratio scale or survival at fixed t.\n\na graph of the estimated underlying survival function \u02c6s(t) as a function\nof t can be coupled with the nomogram used to compute x \u02c6\u03b2. the survival\nfor a specific subject, \u02c6s(t|x) is obtained from \u02c6s(t)exp(x \u02c6\u03b2). alternatively, one\ncould graph \u02c6s(t)exp(x \u02c6\u03b2) for various values of x \u02c6\u03b2 (e.g., x \u02c6\u03b2 = \u22122,\u22121, 0, 1, 2)\n\n19\n\n "}, {"Page_number": 531, "text": "512\n\n20 cox proportional hazards regression model\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n \nr\na\ne\ny\n\u2212\n5\n\n1.0\n\n0.9\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\n\u221220\n\n\u221215\n\n\u221210\n\n\u22125\n\n0\n\n5\n\n10\n\n15\n\ntreadmill score\n\nfig. 20.14 cox model predictions with respect to a continuous variable. x-axis\nshows the range of the treadmill score seen in clinical practice and y -axis shows the\ncorresponding five-year survival probability predicted by the cox regression model\nfor the 2842 study patients.440\n\ny\nt\ni\nl\ni\n\nb\na\nb\no\nr\np\n\n \nl\n\ni\n\na\nv\nv\nr\nu\ns\n\n \nr\na\ne\ny\n3\n\n \n\n1.0\n\n0.9\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\nsex\n\nmale\nfemale\n\n20\n\n40\n\n60\n\n80\n\nage\n\nfig. 20.15 survival estimates for model stratified on sex, with interaction.\n\nso that the desired survival curve could be read directly, at least to the nearest\ntabulated x \u02c6\u03b2. for estimating survival at a fixed time, say two years, one only\nneed to provide the constant \u02c6s(t). the nomogram could even be adapted to\ninclude a nonlinear scale \u02c6s(2)exp(x \u02c6\u03b2) to allow direct computation of two-year\nsurvival.\n\n "}, {"Page_number": 532, "text": "20.13 r functions\n\n20.13 r functions\n\n513\n\nharrell\u2019s cpower, spower, and ciapower (in the hmisc package) perform power\ncalculations for cox tests in follow-up studies. cpower computes power for\na two-sample cox (log-rank) test with random patient entry over a fixed\nduration and a given length of minimum follow-up. the expected number of\nevents in each group is estimated by assuming exponential survival. cpower\nuses a slight modification of the method of schoenfeld558 (see [501]). separate\nspecification of noncompliance in the active treatment arm and \u201cdrop-in\u201dfrom\nthe control arm into the active arm are allowed, using the method of lachin\nand foulkes.370 the ciapower function computes power of the cox interaction\ntest in a 2 \u00d7 2 setup using the method of peterson and george.501 it does\nnot take noncompliance into account. the spower function simulates power\nfor two-sample tests (the log-rank test by default) allowing for very complex\nconditions such as continuously varying treatment effect and noncompliance\nprobabilities.\n\nthe rms package cph function is a slight modification of the coxph func-\ntion written by terry therneau (in his survival package to work in the rms\nframework. cph computes mles of cox and stratified cox ph models, overall\nscore and likelihood ratio \u03c72 statistics for the model, martingale residuals, the\nlinear predictor (x \u02c6\u03b2 centered to have mean 0), and collinearity diagnostics.\nefron, breslow, and exact partial likelihoods are supported (although the\nexact likelihood is very computationally intensive if ties are frequent). the\nfunction also fits the andersen\u2013gill23 generalization of the cox ph model.\nthis model allows for predictor values to change over time in the form of step\nfunctions as well as allowing time-dependent stratification (subjects can jump\nto different hazard function shapes). the andersen\u2013gill formulation allows\nmultiple events per subject and permits subjects to move in and out of risk at\nany desired time points. the latter feature allows time zero to have a more\ngeneral definition. (see section 9.5 for methods of adjusting the variance\u2013\ncovariance matrix of \u02c6\u03b2 for dependence in the events per subject.) the print-\ning function corresponding to cph prints the nagelkerke index r2\nn described\nin section 20.10, and has a latex option for better output. cph works in con-\njunction with the generic functions such as specs, predict, summary, anova,\nfastbw, which.influence, latex, residuals, coef, nomogram, and predict de-\nscribed in section 20.13, the same as the logistic regression function lrm does.\nfor the purpose of plotting predicted survival at a single time, predict has an\nadditional argument time for plotting cph fits. it also has an argument loglog\nwhich if true causes instead log-log survival to be plotted on the y-axis. cph\nhas all the arguments described in section 20.13 and some that are specific\nto it.\n\nsimilar to functions for psm, there are survival, quantile, and mean functions\nwhich create other r functions to evaluate survival probabilities and perform\nother calculations, based on a cph fit with surv=true. these functions, un-\nlike all the others, allow polygon (linear interpolation) estimation of survival\n\n "}, {"Page_number": 533, "text": "514\n\n20 cox proportional hazards regression model\n\nprobabilities, quantiles, and mean survival time as an option. quantile is the\nonly automatic way for obtaining survival quantiles with cph. quantile esti-\nmates will be missing when the survival curve does not extend long enough.\nlikewise, survival estimates will be missing for t > maximum follow-up time,\nwhen the last event time is censored. mean computes the mean survival time\nif the last failure time in each stratum is uncensored. otherwise, mean may\nbe used to compute restricted mean lifetime using a user-specified trunca-\ntion point.334 quantile and mean are especially useful with plot and nomogram.\nsurvival is useful with nomogram.\n\nthe r program below demonstrates how several cph-related functions work\nwell with the nomogram function. here predicted three-year survival probabil-\nities and median survival time (when defined) are displayed against age and\nsex from the previously simulated dataset. the fact that a nonlinear effect\ninteracts with a stratified factor is taken into account.\n\n\u2190 survival ( f.ia )\n\nsurv\n\nquant\nmed.f\nmed.m\n\nsurv.f \u2190 function ( lp ) surv (3 , lp , stratum = ' sex = female ' )\nsurv.m \u2190 function ( lp ) surv (3 , lp , stratum = ' sex = male ' )\n\n\u2190 quantile ( f.ia )\n\u2190 function ( lp ) quant ( .5 , lp , stratum = ' sex = female ' )\n\u2190 function ( lp ) quant ( .5 , lp , stratum = ' sex = male ' )\n\nat.surv \u2190 c ( .01 , .05 , seq (.1 , .9 , by = .1 ), .95 , .98 , .99 , .999 )\nat.med \u2190 c (0 , .5 , 1, 1 .5 , seq (2 , 14 , by =2))\nn \u2190 nomogram ( f.ia , fun = list ( surv.m , surv.f , med.m , med.f ),\n\nfunlabel = c ( ' s (3 | male ) ' , ' s (3 | female ) ' ,\n\n' median ( male ) ' , ' median ( female ) ' ),\n\nfun.at = list ( c (.8 , .9 , .95 , .98 , .99 ),\n\nc (.1 , .3 , .5 , .7 , .8 , .9 , .95 , .98 ),\nc (8 ,10 ,12) , c (1 ,2 ,4 ,8 ,12)))\n\nplot (n , col.grid = false , lmgp = .2 )\nlatex ( f.ia , file = ' ' , digits =3)\n\nprob{t \u2265 t | sex = i} = si(t)ex\u03b2\n\n, where\n\nx \u02c6\u03b2 =\n\u22121.8\n+0.0493age \u2212 2.15\u00d710\n+5.18\u00d710\n+[female][\u22120.0366age + 4.29\u00d710\n+6.74\u00d710\n\n\u22125(age \u2212 54.6)3\n\n\u22125(age \u2212 54.6)3\n\n\u22126(age \u2212 30.3)3\n\u2212 2.15\u00d710\n\n\u2212 2.32\u00d710\n\n+\n\n+\n\n\u2212 2.82\u00d710\n\u22125(age \u2212 69.6)3\n\n+\n\n\u22125(age \u2212 45.1)3\n\n+\n\n+\n\n\u22125(age \u2212 30.3)3\n\n\u2212 0.00011(age \u2212 45.1)3\n\u22127(age \u2212 69.6)3\n+]\n\n+\n\n+\n\nand [c] = 1 if subject is in group c, 0 otherwise; (x)+ = x if x > 0, 0\notherwise.\n\n "}, {"Page_number": 534, "text": "20.13 r functions\n\n515\n\nt smale(t) sf emale(t)\n1.000\n0\n0.902\n1\n0.825\n2\n3\n0.725\n0.648\n4\n0.576\n5\n0.520\n6\n7\n0.481\n0.432\n8\n0.395\n9\n0.358\n10\n11\n0.314\n0.268\n12\n0.223\n13\n14\n0.203\n\n1.000\n0.993\n0.984\n0.975\n0.967\n0.956\n0.947\n0.938\n0.928\n0.920\n0.909\n0.904\n0.892\n0.886\n0.877\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n10\n\n10\n\n30\n\n20\n\n50\n\n30\n\n40\n\n50\n\n60\n\n70\n\n90\n\n60\n\n70\n\n80\n\n90\n\n100\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\npoints\n\nage (sex=male)\n\nage (sex=female)\n\ntotal points\n\nlinear predictor\n\ns(3 | male)\n\ns(3 | female)\n\nmedian (male)\n\nmedian (female)\n\n\u22122\n\n\u22121.5\n\n\u22121\n\n\u22120.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n0.99\n\n0.98\n\n0.95\n\n0.9\n\n0.95\n\n0.9\n\n0.8\n\n0.7\n\n0.5\n\n0.3\n\n0.1\n\n12\n\n8\n\n4\n\n2\n\n1\n\n12\n\n10\n\nfig. 20.16 nomogram from a fitted stratified cox model that allowed for interaction\nbetween age and sex, and nonlinearity in age. the axis for median survival time is\ntruncated on the left where the median is beyond the last follow-up time.\n\nrcspline.plot ( lvef , d.time , event = cdeath , nk =3)\n\nthe corresponding smoothed martingale residual plot for lvef in figure 20.7\nwas created with\n\n "}, {"Page_number": 535, "text": "516\n\n20 cox proportional hazards regression model\n\ncox \u2190 cph ( surv ( d.time , cdeath ) \u223c lvef , iter.max =0)\nres \u2190 resid ( cox )\ng \u223c loess ( res \u223c lvef )\n\nplot (g , coverage =0 .95 , confidence =7 , xlab = \" lvef \" ,\n\nylab = \" martingale residual \" )\n\ng \u2190 ols ( res \u223c rcs ( lvef ,5))\n\nplot (g , lvef = na , add =t , lty =2)\nlines ( lowess ( lvef , res , iter =0) , lty =3)\nlegend ( .3 , 1 .15 , c ( \" loess fit and 0 .95 confidence bars \" ,\n\n\" ols spline fit and 0 .95 confidence limits \" ,\n\" lowess smoother \" ) , lty =1:3 , bty = \" n \" )\n\nbecause we desired residuals with respect to the omitted predictor lvef,\nthe parameter iter.max=0 had to be given to make cph stop the estimation\nprocess at the starting parameter estimates (default of zero). the effect of this\nis to ignore the predictors when computing the residuals; that is, to compute\nresiduals from a flat line rather than the usual residuals from a fitted straight\nline.\n\nthe residuals function is a slight modification of therneau\u2019s residuals.-\ncoxph function to obtain martingale, schoenfeld, score, deviance residuals, or\napproximate dfbeta or dfbetas. since martingale residuals are always\nstored by cph (assuming there are covariables present), residuals merely has\nto pick them off the fit object and reinsert rows that were deleted due to\nmissing values. for other residuals, you must have stored the design matrix\nand surv object with the fit by using ..., x=true, y=true. storing the design\nmatrix with x=true ensures that the same transformation parameters (e.g.,\nknots) are used in evaluating the model as were used in fitting it. to use\nresiduals you can use the abbreviation resid. see the help file for residuals\nfor an example of how martingale residuals may be used to quickly plot\nunivariable (unadjusted) relationships for several predictors.\n\nfigure 20.10, which used smoothed scaled schoenfeld partial residuals557\nto estimate the form of a predictor\u2019s log hazard ratio over time, was made\nwith\nsrv \u2190 surv ( dm.time , cdeathmi )\ncox \u2190 cph ( srv \u223c pi , x =t , y = t )\nres \u2190 resid ( cox , \" scaledsch \" )\ntime \u2190 as.numeri c ( names ( res ))\n# use dimnames(res )[[1]] if more than one predictor\nf \u2190 loess ( res \u223c time , span =0 .50 )\n\n# test for ph for each column of x\n\ncox.zph ( cox , \" rank \" )\n\nplot (f , coverage =0 .95 , confidence =7 , xlab = \" t \" ,\n\nylab = \" scaled schoenfeld residual \" , ylim = c ( -.1 , .25 ))\n\nlines ( supsmu ( time , res ) , lty =2)\nlegend (1 .1 , .21 , c (\" loess smoother with span =0 .50 and 0 .95 c.l. \" ,\n\n\" super smoother \" ) , lty =1:2 , bty = \" n \" )\n\nthe computation and plotting of scaled schoenfeld residuals could have been\ndone automatically in this case by using the single command plot(cox.zph\n(cox)), although cox.zph defaults to plotting against the kaplan\u2013meier trans-\nformation of follow-up time.\n\n "}, {"Page_number": 536, "text": "20.14 further reading\n\n517\n\nthe hazard.ratio.plot function in rms repeatedly estimates cox regression\ncoefficients and confidence limits within time intervals. the log hazard ra-\ntios are plotted against the mean failure/censoring time within the interval.\nfigure 20.9 was created with\n\nhazard.rati o. pl ot ( pi , s )\n\n# s was surv ( dm.time , ... )\n\nif you have multiple degree of freedom factors, you may want to score them\ninto linear predictors before using hazard.ratio.plot. the predict function\nwith argument type=\"terms\" will produce a matrix with one column per factor\nto do this (section 20.13).\n\ntherneau\u2019s cox.zph function implements harrell\u2019s schoenfeld residual cor-\nrelation test for ph. this function also stores results that can easily be passed\nto a plotting method for cox.zph to automatically plot smoothed residuals\nthat estimate the effect of each predictor over time.\ntherneau has also written an r function survdiff that compares two or\nmore survival curves using the g \u2212 \u03c1 family of rank tests (harrington and\nfleming273).\n\nthe rcorr.cens function in the hmisc library computes the c index and the\ncorresponding generalization of somers\u2019 dxy rank correlation for a censored\nresponse variable. rcorr.cens also works for uncensored and binary responses\n(see roc area in section 10.8), although its use of all possible pairings makes\nit slow for this purpose. the survival package\u2019s survconcordance has an ex-\ntremely fast algorithm for the c index and a fairly accurate estimator of its\nstandard error.\n\nthe calibrate function for cph constructs a bootstrap or cross-validation\noptimism-corrected calibration curve for a single time point by resampling\nthe differences between average cox predicted survival and kaplan\u2013meier es-\ntimates (see section 20.11.1). but more precise is calibrate\u2019s default method\nbased on adaptive semiparametric regression discussed in the same section.\nfigure 20.11 is an example.\n\nthe validate function for cph fits validates several statistics describing cox\nmodel fits\u2014slope shrinkage, r2\nn, d, u, q, and dxy. the val.surv function\ncan also be of use in externally validating a cox model using the methods\npresented in section 18.3.7.\n\n20.14 further reading\n\n1\n\n2\n\n3\n\ngood general texts for the cox ph model include cox and oakes,133 kalbfleisch\nand prentice,331 lawless,382 collett,114 marubini and valsecchi,444 and klein\nand moeschberger.350 therneau and grambsch604 describe the many ways the\nstandard cox model may be extended.\ncupples et al.141 and marubini and valsecchi [444, pp. 201\u2013206] present good\ndescription of various methods of computing \u201cadjusted survival curves.\u201d\nsee altman and andersen15 for simpler approximate formulas. cheng et al.103\nderived methods for obtaining pointwise and simultaneous confidence bands for\n\n20\n\n "}, {"Page_number": 537, "text": "518\n\n20 cox proportional hazards regression model\n\ns(t) for future subjects, and henderson282 has a comprehensive discussion of\nthe use of cox models to estimate survival time for individual subjects.\naalen2 and valsecchi et al.625 discuss other residuals useful in graphically check-\ning survival model assumptions. le\u00b4on and tsai400 derived residuals for estimat-\ning covariate transformations that are different from martingale residuals.\n[411] has other methods for generating confidence intervals for martingale resid-\nual plots.\nlin et al.411 describe other methods of checking transformations using cumu-\nlative martingale residuals.\na parametric analysis of the va dataset using linear splines and incorporating\nx \u00d7 t interactions is found in [361].\n\n4\n\n5\n\n6\n\n7\n\n8 winnett and sasieni671 show how to use scaled schoenfeld residuals in an iter-\n\n9\n\n10\n\n11\n\native fashion to actually model effects that are not in proportional hazards.\nsee [233, 503] for some methods for obtaining confidence bands for schoen-\nfeld residual plots. winnett and sasieni670 discuss conditions in which the\ngrambsch\u2013therneau scaling of the schoenfeld residuals does not perform ade-\nquately for estimating \u03b2(t).\n[475, 519] compared the power of the test for ph based on the correlation be-\ntween failure time and schoenfeld residuals with the power of several other\ntests.\nsee lin et al.411 for another approach to deriving a formal test of ph using\nresiduals. other graphical methods for examining the ph assumption are due\nto gray,236 who used hazard smoothing to estimate hazard ratios as a function\nof time, and thaler,602 who developed a nonparametric estimator of the hazard\nratio over time for time-dependent covariables. see valsecchi et al.625 for other\nuseful graphical assessments of ph.\n\n12 a related test of constancy of hazard ratios may be found in [519]. also, see\n\n15\n\nschemper547 for related methods.\nsee [547] for a variation of the standard cox likelihood to allow for non-ph.\n\n13\n14 an excellent review of graphical methods for assessing ph may be found in\nhess.290. sahoo and sengupta537 provide some new graphical methods for as-\nsessing ph irrespective of satisfaction of the other model assumptions.\nschemper547 provides a way to determine the effect of falsely assuming ph by\ncomparing the cox regression coefficient with a well-described average log haz-\nard ratio. zucker691 shows how dependent a weighted log-rank test is on the true\nhazard ratio function, when the weights are derived from a hypothesized hazard\nratio function. valsecchi et al.625 proposed a method that is robust to non-ph\nthat occurs in the late follow-up period. their method uses down-weighting of\ncertain types of \u201coutliers.\u201d see herndon and harrell287 for a flexible paramet-\nric ph model with time-dependent covariables, which uses the restricted cubic\nspline function to specify \u03bb(t). putter et al.518 and muggeo and tagliavia468\nhave nice approaches that use time-dependent covariates to model time inter-\nactions to allow non-proportional hazards. perperoglou et al.498, 499 developed\na systematic approach that allows one to continuously vary the amount of non\nph allowed, through the use of a structure matrix that connects predictors\nwith functions of time. schuabel et al.543 have a good exposition of internal\ntime-dependent covariates.\nsee van houwelingen and le cessie [633, eq. 61] and verweij and van houwelin-\ngen640 for an interesting index of cross-validated predictive accuracy. schemper\nand henderson552 relate explained variation to predictive accuracy in cox mod-\nels. hielscher et al.291 compares and illustrates several measures of explained\nvariation as does choodari-oskooei et al.106. choodari-oskooei et al.105 stud-\nied explained randomness and predictive accuracy measures.\nsee similar indexes in schemper544 and a related idea in [633, eq. 63]. man-\ndel, galai, and simchen436 presented a time-varying c index. see korn and\n\n16\n\n17\n\n "}, {"Page_number": 538, "text": "20.14 further reading\n\n519\n\nsimon,365 schemper and stare,554 and henderson282 for nice comparisons of\nvarious measures. pencina and d\u2019agostino489 provide more details about the c\nindex and derived new interval estimates. they also discussed the relationship\nbetween c and a version of kendall\u2019s \u03c4 . pencina et al.491 found advantages of c.\nuno et al.618 described exactly how c depends on the amount of censoring and\nproposed a new index, requiring one to choose a time cutoff, that is invariant to\nthe amount of censoring. henderson et al.283 discussed the benefits of using the\nprobability of a serious prognostication error (e.g., being off by a factor of 2.0\nor worse on the time scale) as an accuracy measure. schemper550 shows that\nmodels with very important predictors can have very low absolute prediction\nability, and he discusses measures of predictive accuracy from a general stand-\npoint. lawless and yuan386 present prediction error estimators and confidence\nlimits, focusing on such measures as error in predicted median or mean survival\ntime. schmid and potapov555 studied the bias of several variations on the c in-\ndex under non-proportional hazards and/or nonrandom censoring. g\u00a8onen and\nheller223 developed a c-index that is censoring-independent.\n\n18 altman and royston18 have a good discussion of validation of prognostic models\nand present several examples of validation using a simple discrimination index.\nthomas gerds has an r package pec that provides many validation methods\nand accuracy indexes.\n\n19 kattan et al.338 describe how to make nomograms for deriving predicted sur-\n\nvival probabilities when there are competing risks.\n\n20 hielscher et al.291 provides an overview of software for computing accuracy\n\nindexes with censored data.\n\n "}, {"Page_number": 539, "text": "chapter 21\ncase study in cox regression\n\n21.1 choosing the number of parameters and fitting\n\nthe model\n\nconsider the randomized trial of estrogen for treatment of prostate cancer87\ndescribed in chapter 8. let us now develop a model for time until death\n(of any cause). there are 354 deaths among the 502 patients. to be able\nto efficiently estimate treatment benefit, to test for differential treatment\neffect, or to estimate prognosis or absolute treatment benefit for individual\npatients, we need a multivariable survival model. in this case study we do not\nmake use of data reductions obtained in chapter 8 but show simpler (partial)\napproaches to data reduction. we do use the transcan results for imputation.\nfirst let\u2019s assess the wisdom of fitting a full additive model that does not\nassume linearity of effect for any predictor. categorical predictors are ex-\npanded using dummy variables. for pf we could lump the last two categories\nas before since the last category has only two patients. likewise, we could\ncombine the last two levels of ekg. continuous predictors are expanded by\nfitting four-knot restricted cubic spline functions, which contain two nonlin-\near terms and thus have a total of three d.f. table 21.1 defines the candidate\npredictors and lists their d.f. the variable stage is not listed as it can be\npredicted with high accuracy from sz,sg,ap,bm (stage could have been used\nas a predictor for imputing missing values on sz, sg). there are a total of 36\ncandidate d.f. that should not be artificially reduced by \u201cunivariable screen-\ning\u201d or graphical assessments of association with death. this is about 1/10\nas many predictor d.f. as there are deaths, so there is some hope that a fitted\nmodel may validate. let us also examine this issue by estimating the amount\nof shrinkage using equation 4.3. we first use transcan impute missing data.\n\nrequire ( rms )\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7 21\n\n521\n\n "}, {"Page_number": 540, "text": "522\n\n21 case study in cox regression\n\ntable 21.1 initial allocation of degrees of freedom\n\npredictor\ndose of estrogen\n\nname d.f. original levels\nrx\n\n3 placebo, 0.2, 1.0, 5.0 mg\n\nage in years\nweight index: wt(kg)\u2212ht(cm)+200 wt\nperformance rating\n\npf\n\nage\n\nhistory of cardiovascular disease\nsystolic blood pressure/10\ndiastolic blood pressure/10\nelectrocardiogram code\n\nhx\n\nsbp\n\ndbp\n\nekg\n\nserum hemoglobin (g/100ml)\ntumor size (cm2)\nsz\nstage/histologic grade combination sg\nserum prostatic acid phosphatase\nap\nbone metastasis\n\nhg\n\nbm\n\nestrogen\n\n3\n3\n2 normal, in bed < 50% of\n\ntime, in bed > 50%, in\nbed always\n\n1 present/absent\n3\n3\n5 normal, benign, rhythm\n\ndisturb., block, strain,\nold myocardial infarction,\nnew mi\n\n3\n3\n3\n3\n1 present/absent\n\ngethdata ( prostate )\nlevels ( prostate $ ekg )[ levels ( prostate $ ekg ) % in %\n\nc ( ' old mi ' , ' recent mi ' )] \u2190 ' mi '\n\n# c o m b i n e s last 2 l e v e l s and uses a new name , mi\n\nprostate $ pf.coded \u2190 as.integer ( prostate $ pf )\nlevels ( prostate $ pf ) \u2190 c ( levels ( prostate $ pf )[1:3] ,\n\n# save o r i g i n a l pf , r e - c o d e to 1 -4\n\nlevels ( prostate $ pf )[3])\n\n# c o m b i n e last 2 l e v e l s\n\nw \u2190 transcan (\u223c sz + sg + ap + sbp + dbp + age +\n\nwt + hg + ekg + pf + bm + hx , imputed = true ,\ndata = prostate , pl = false , pr = false )\n\nattach ( prostate )\n\nsz \u2190 impute (w , sz , data = prostate )\nsg \u2190 impute (w , sg , data = prostate )\nage \u2190 impute (w , age , data = prostate )\nwt \u2190 impute (w , wt , data = prostate )\nekg \u2190 impute (w , ekg , data = prostate )\ndd \u2190 datadist ( prostate ); options ( datadist = ' dd ' )\n\n "}, {"Page_number": 541, "text": "21.1 choosing number of parameters/fitting the model\nunits ( dtime ) \u2190 ' month '\ns \u2190 surv ( dtime , status ! = ' alive ' )\nf \u2190 cph ( s \u223c rx + rcs ( age ,4) + rcs ( wt ,4) + pf + hx +\n\nrcs ( sbp ,4) + rcs ( dbp ,4) + ekg + rcs ( hg ,4) +\nrcs ( sg ,4) + rcs ( sz ,4) + rcs ( log ( ap ) ,4) + bm )\n\n523\n\nprint (f , latex = true , coefs = false )\n\ncox proportional hazards model\n\ncph(formula = s ~ rx + rcs(age, 4) + rcs(wt, 4) + pf + hx\n\n+ rcs(sbp, 4) + rcs(dbp, 4) + ekg + rcs(hg, 4)\n+ rcs(sg, 4) + rcs(sz, 4) + rcs(log(ap), 4) + bm)\n\nmodel tests discrimination\n\nindexes\n\n502 lr \u03c72\n354 d.f.\n\nobs\nevents\ncenter -2.9933 pr(> \u03c72) 0.0000 g\nscore \u03c72 143.62 gr\npr(> \u03c72) 0.0000\n\n136.22 r2\n36 dxy\n\n0.238\n0.333\n0.787\n2.196\n\nthe likelihood ratio \u03c72 statistic is 136.2 with 36 d.f. this test is highly\nsignificant so some modeling is warranted. the aic value (on the \u03c72 scale) is\n136.2\u22122\u00d736 = 64.2. the rough shrinkage estimate is 0.74 (100.2/136.2) so we\nestimate that 0.26 of the model fitting will be noise, especially with regard to\ncalibration accuracy. the approach of spiegelhalter582 is to fit this full model\nand to shrink predicted values. we instead try to do data reduction (blinded\nto individual \u03c72 statistics from the above model fit) to see if a reliable model\ncan be obtained without shrinkage. a good approach at this point might\nbe to do a variable clustering analysis followed by single degree of freedom\nscoring for individual predictors or for clusters of predictors. instead we do\nan informal data reduction. the strategy is described in table 21.2. for ap,\nmore exploration is desired to be able to model the shape of effect with such a\nhighly skewed distribution. since we expect the tumor variables to be strong\nprognostic factors we retain them as separate variables. no assumption is\nmade for the dose-response shape for estrogen, as there is reason to expect a\nnon-monotonic effect due to competing risks for cardiovascular death.\nheart \u2190 hx + ekg % nin % c ( ' normal ' , ' benign ' )\nlabel ( heart ) \u2190 ' heart disease code '\nmap \u2190 (2 * dbp + sbp ) / 3\nlabel ( map ) \u2190 ' mean arterial pressure / 10 '\ndd \u2190 datadist ( dd , heart , map )\nf \u2190 cph ( s \u223c rx + rcs ( age ,4) + rcs ( wt ,3) + pf.coded +\n\n "}, {"Page_number": 542, "text": "524\n\n21 case study in cox regression\n\ntable 21.2 final allocation of degrees of freedom\n\nreductions\n\nvariables\nwt\n\nassume variable not important enough\nfor 4 knots; use 3 knots\nassume linearity\n\npf\nhx,ekg make new 0,1,2 variable and assume\nlinearity: 2 = hx and ekg not normal\nor benign, 1 = either, 0 = none\n\nsg\n\nsbp,dbp combine into mean arterial bp and\nuse 3 knots: map = (2 dbp + sbp)/3\nuse 3 knots\nuse 3 knots\nlook at shape of effect of ap in detail,\nand take log before expanding as spline\nto achieve numerical stability: add 1 knots\n\nsz\n\nap\n\nd.f. saved\n1\n\n1\n5\n\n4\n\n1\n1\n\u22121\n\nheart + rcs ( map ,3) + rcs ( hg ,4) +\nrcs ( sg ,3) + rcs ( sz ,3) + rcs ( log ( ap ) ,5) + bm ,\nx = true , y = true , surv = true , time.inc =5 * 12)\n\nprint (f , latex = true , coefs =3)\n\ncox proportional hazards model\n\ncph(formula = s ~ rx + rcs(age, 4) + rcs(wt, 3) + pf.coded +\n\nheart + rcs(map, 3) + rcs(hg, 4) + rcs(sg, 3) +\nrcs(sz, 3) + rcs(log(ap), 5) + bm, x = true, y = true,\nsurv = true, time.inc = 5 * 12)\n\nmodel tests discrimination\n\nindexes\n\n502 lr \u03c72\n354 d.f.\n\nobs\nevents\ncenter -2.4307 pr(> \u03c72) 0.0000 g\nscore \u03c72 125.58 gr\npr(> \u03c72) 0.0000\n\n118.37 r2\n24 dxy\n\n0.210\n0.321\n0.717\n2.049\n\ncoef\n\nrx=0.2 mg estrogen -0.0002 0.1493\nrx=1.0 mg estrogen -0.4160 0.1657\nrx=5.0 mg estrogen -0.1107 0.1571\n. . .\n\ns.e. wald z pr(> |z|)\n0.9987\n0.0121\n0.4812\n\n0.00\n-2.51\n-0.70\n\n "}, {"Page_number": 543, "text": "21.2 checking proportional hazards\n\n525\n\ntable 21.3 wald statistics for s\n\nwt\n\nrx\nage\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\npf.coded\nheart\nmap\n\np\nd.f.\n0.0459\n3\n0.0031\n3\n0.0108\n2\n0.0165\n2\n0.1110\n1\n1\n0.0517\n1 < 0.0001\n0.9779\n2\n0.8345\n1\n0.0058\n3\n2\n0.0162\n0.4406\n2\n0.8304\n1\n0.0017\n2\n1\n0.7990\n0.1639\n4\n0.1012\n3\n0.8670\nbm\n1\ntotal nonlinear 23.81 11\n0.0136\n119.09 24 < 0.0001\ntotal\n\n\u03c72\n8.01\n13.84\n9.06\n8.21\n2.54\n3.79\n23.51\n0.04\n0.04\n12.52\n8.25\n1.64\n0.05\n12.73\n0.06\n6.51\n6.22\n0.03\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nnonlinear\n\nap\n\nhg\n\nsg\n\nsz\n\n# x, y for predict , validate , calibrate;\n# surv , time.inc for calibrate\nlatex ( anova ( f ) , file = ' ' , label = ' tab : c o x c a s e - a n o v a 1 ' )# table 21.3\n\nthe total savings is thus 12 d.f. the likelihood ratio \u03c72 is 118 with 24 d.f.,\nwith a slightly improved aic of 70. the rough shrinkage estimate is slightly\nbetter at 0.80, but still worrisome. a further data reduction could be done,\nsuch as using the transcan transformations determined from self-consistency\nof predictors, but we stop here and use this model.\n\nfrom table 21.3 there are 11 parameters associated with nonlinear effects,\nand the overall test of linearity indicates the strong presence of nonlinearity\nfor at least one of the variables age,wt,map,hg,sz,sg,ap. there is no strong\nevidence for a difference in survival time between doses of estrogen.\n\n21.2 checking proportional hazards\n\nnow that we have a tentative model, let us examine the model\u2019s distributional\nassumptions using smoothed scaled schoenfeld residuals. a messy detail is\nhow to handle multiple regression coefficients per predictor. here we do an\n\n "}, {"Page_number": 544, "text": "526\n\n21 case study in cox regression\n\napproximate analysis in which each predictor is scored by adding up all that\npredictor\u2019s terms in the model, to transform that predictor to optimally relate\nto the log hazard (at least if the shape of the effect does not change with\ntime). in doing this we are temporarily ignoring the fact that the individual\nregression coefficients were estimated from the data. for dose of estrogen,\nfor example, we code the effect as 0 (placebo), \u22120.00025 (0.2 mg), \u22120.416\n(1.0 mg), and \u22120.111 (5.0 mg), and age is transformed using its fitted spline\nfunction. in the rms package the predict function easily summarizes multiple\nterms and produces a matrix (here, z) containing the total effects for each\npredictor. matrix factors can easily be included in model formulas.\nz \u2190 predict (f , type = ' terms ' )\nf.short \u2190 cph ( s \u223c z , x = true , y = true )\n\n# r e q u i r e d x = t a b o v e to s t o r e d e s i g n m a t r i x\n\n# s t o r e raw x , y so can get r e s i d u a l s\n\nthe fit f.short based on the matrix of single d.f. predictors z has the\nsame lr \u03c72 of 118 as the fit f, but with a falsely low 11 d.f. all regression\ncoefficients are unity.\n\nnow we compute scaled schoenfeld residuals separately for each predictor\nand test the ph assumption using the \u201ccorrelation with time\u201d test. also plot\nsmoothed trends in the residuals. the plot method for cox.zph objects uses\ncubic splines to smooth the relationship.\nphtest \u2190 cox.zph ( f.short , transform = ' identity ' )\n\nphtest\n\nrho\n\nchisq\n\np\n0.10232 4.00823 0.0453\nrx\n-0.05483 1.05850 0.3036\nage\nwt\n0.01838 0.11632 0.7331\npf . coded -0.03429 0.41884 0.5175\n0.02650 0.30052 0.5836\nheart\n0.02055 0.14135 0.7069\nmap\nhg\n-0.00362 0.00511 0.9430\n-0.05137 0.94589 0.3308\nsg\n-0.01554 0.08330 0.7729\nsz\n0.01720 0.11858 0.7306\nap\n0.04957 0.95354 0.3288\nbm\nglobal\nna 7.18985 0.7835\n\nplot ( phtest , var = ' rx ' )\n\n# f i g u r e 21.1\n\nperhaps only the drug effect significantly changes over time (p = 0.05 for\ntesting the correlation rho between the scaled schoenfeld residual and time),\nbut when a global test of ph is done penalizing for 11 d.f., the p value is\n0.78. a graphical examination of the trends doesn\u2019t find anything interesting\nfor the last 10 variables. a residual plot is drawn for rx alone and is shown in\nfigure 21.1. we ignore the possible increase in effect of estrogen over time. if\nthis non-ph is real, a more accurate model might be obtained by stratifying\non rx or by using a time \u00d7 rx interaction as a time-dependent covariable.\n\n "}, {"Page_number": 545, "text": "21.4 describing predictor effects\n\n527\n\n10\n\n5\n\n0\n\n\u22125\n\n\u221210\n\n\u221215\n\nx\nr\n \nr\no\n\nf\n \n)\nt\n(\na\ne\nb\n\nt\n\nl\n\nl\n\nl\n\nl\n\nl\n\nl\nl\n\nl\nl\nl\nll\nl\nl\nl\nll\nl\nl\nl\nl\nll\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nlll\nl\nl\nl\nl\nl\nl\nl\nl\nll\nl\nl\nl\nl\nl\nll\nl\nl\nl\nl\nl\nll\nlll\nl\nllll\nl\nl\nll\nl\nl\nl\nl\nl\nl\nl\nl\nlll\nll\nll\nl\nl\nl\nl\nl\nl\nl\nl\nll\nll\nll\nl\nll\nll\nl\nl\nl\nl\nl\nl\nl\nl\nll\nl\nl\nl\nll\nl\nl\nl\nll\nl\nl\nl\nl\nl\nl\nll\nl\nl\nl\nll\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nllll\nll\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nll\nll\nl\nl\nl\nl\nl\nl\nl\nl\nl\nll\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nll\nl\nl\nll\nl\nl\nl\nl\nl\nl\nl\nl\n\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\nl\n\nll\nl\nl\nl\n\nl\nl\nl\nl\n\nl\nl\nl\nl\n\nl\nl\nl\n\nl\nl\n\nll\n\nl\nl\n\nl\n\nl\n\nl\n\nl\n\nl\n\nl\n\nl\nl\nl\n\nl\n\nl\n\nl\nl\n\nl\n\nl\nl\n\nl\nl\n\nl\n\nl\n\nll\nl\nl\n\nl\nl\nll\nl\nl\nl\nl\nll\nl\nl\nll\nl\nl\n\nl\nl\n\nl\nl\nl\nl\n\nl\n\n0\n\nl\n\nl\n\nl\n\nl\n\nl\n\nl\nl\nl\nl\nl\n\nl\nl\n\nl\nl\nl\nl\nll\nl\nl\nl\nl\n\nl\nl\n\nl\n\nl\n\nl\nl\nl\nl\n\nl\n\nl\n\n20\n\n40\ntime\n\nl\n\nl\nl\n\nl\n\nl\n\nl\n\n60\n\nfig. 21.1 raw and spline-smoothed scaled schoenfeld residuals for dose of estrogen,\nnonlinearly coded from the cox model fit, with \u00b1 2 standard errors.\n\n21.3 testing interactions\n\nnote that the model has several\ninsignificant predictors. these are not\ndeleted, as that would not improve predictive accuracy and it would make\naccurate confidence intervals hard to obtain. at this point it would be rea-\nsonable to test prespecified interactions. here we test all interactions with\ndose. since the multiple terms for many of the predictors (and for rx) make\nfor a great number of d.f. for testing interaction (and a loss of power), we do\napproximate tests on the data-driven coding of predictors. p -values for these\ntests are likely to be somewhat anti-conservative.\nz.dose \u2190 z [, \" rx \" ]\nz.other \u2190 z [, -1 ]\nf.ia \u2190 cph ( s \u223c z.dose * z.other )\nlatex ( anova ( f.ia ), file = ' ' , label = ' tab : coxcase-anova2 ' )\n\n# same as s a y i n g z [ ,1] - get f i r s t c o l u m n\n# all but the f i r s t c o l u m n of z\n\n# f i g u r e 21.4:\n\nthe global test of additivity in table 21.4 has p = 0.27, so we ignore the\ninteractions (and also forget to penalize for having looked for them below!).\n\n21.4 describing predictor effects\n\nlet us plot how each predictor is related to the log hazard of death, including\n0.95 confidence bands. note in figure 21.2 that due to a peculiarity of the\ncox model the standard error of the predicted x \u02c6\u03b2 is zero at the reference\nvalues (medians here, for continuous predictors).\n\n "}, {"Page_number": 546, "text": "528\n\n21 case study in cox regression\n\ntable 21.4 wald statistics for s\n\nz.dose (factor+higher order factors)\n\nall interactions\n\nz.other (factor+higher order factors)\nall interactions\n12.17 10\nz.dose \u00d7 z.other (factor+higher order factors) 12.17 10\ntotal\n\n\u03c72\nd.f.\n18.74 11\n12.17 10\n\np\n0.0660\n0.2738\n125.89 20 < 0.0001\n0.2738\n0.2738\n129.10 21 < 0.0001\n\nage\n\nap\n\n60\n\n70\n\nmap\n\n80\n\n0\n\n50\n\nsg\n\n100\n\n9\n\n11\n\nhg\n\n13\nsz\n\n15\n\n17\n\n8\n\n12\n\n10\n\nwt\n\n7.5\n\n10.0\n\n12.5\n\n15.0 0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n1.0\n0.5\n0.0\n\u22120.5\n\u22121.0\n\u22121.5\n\n1.0\n0.5\n0.0\n\u22120.5\n\u22121.0\n\u22121.5\n\n1.0\n0.5\n0.0\n\u22120.5\n\u22121.0\n\u22121.5\n\n80\n\n90 100 110 120 130\n\nbm\n\nl\n\nl\n\npf.coded\n\nl\n\nl\n\nl\n\nl\n\n2\n1\n0\n\n5.0 mg estrogen\n1.0 mg estrogen\n0.2 mg estrogen\nplacebo\n\nheart\n\nl\n\nl\n\nl\n\nrx\n\nl\n\nl\n\nl\n\nl\n\nd\nr\na\nz\na\nh\ne\nv\ni\nt\n\n \n\nl\n\na\ne\nr\ng\no\n\n \n\nl\n\n1\n0\n\n4\n3\n2\n1\n\n\u22121.5\n\n\u22121.0\n\n\u22120.5\n\n0.0\n\n0.5\n\n1.0\n\n\u22121.5\n\n\u22121.0\n\n\u22120.5\n\n0.0\n\n0.5\n\n1.0\n\nlog relative hazard\n\nfig. 21.2 shape of each predictor on log hazard of death. y -axis shows x \u02c6\u03b2, but\nthe predictors not plotted are set to reference values. note the highly non-monotonic\nrelationship with ap, and the increased slope after age 70 which occurs in outcome\nmodels for various diseases.\n\n "}, {"Page_number": 547, "text": "21.5 validating the model\n\n529\n\nggplot ( predict ( f ), sepdiscrete = ' vertical ' , nlevels =4 ,\n\nvnames = ' names ' )\n\n# f i g u r e 21.2\n\n21.5 validating the model\n\nwe first validate this model for somers\u2019 dxy rank correlation between pre-\ndicted log hazard and observed survival time, and for slope shrinkage. the\nbootstrap is used (with 300 resamples) to penalize for possible overfitting, as\ndiscussed in section 5.3.\n\nset.seed (1)\n\nv \u2190 validate (f , b =300)\n\n# so can r e p r o d u c e r e s u l t s\n\ndivergence or singularity in 83 samples\n\nlatex (v , file = ' ' )\n\nindex original training test optimism corrected n\n\nsample sample sample\n0.3454 0.2954\n0.2439 0.1754\n1.0000 0.7941\n0.0348 0.0238\n\n0.3208\n0.0500\n0.2101\n0.0685\n1.0000\n0.2059\n0.0292\n0.0110\n\u22120.0005 \u22120.0005 0.0023 \u22120.0028\n0.0138\n0.0297\n0.7174\n0.1645\n\n0.0353 0.0216\n0.7918 0.6273\n\ndxy\nr2\nslope\nd\nu\nq\ng\n\nindex\n\n0.2708 217\n0.1417 217\n0.7941 217\n0.0182 217\n0.0023 217\n0.0159 217\n0.5529 217\n\nhere \u201ctraining\u201d refers to accuracy when evaluated on the bootstrap sample\nused to fit the model, and \u201ctest\u201d refers to the accuracy when this model is\napplied without modification to the original sample. the apparent dxy is\n0.32, but a better estimate of how well the model will discriminate prognoses\nin the future is dxy = 0.27. the bootstrap estimate of slope shrinkage is 0.79,\nclose to the simple heuristic estimate. the shrinkage coefficient could easily\nbe used to shrink predictions to yield better calibration.\n\nfinally, we validate the model (without using the shrinkage coefficient) for\ncalibration accuracy in predicting the probability of surviving five years. the\nbootstrap is used to estimate the optimism in how well predicted five-year\nsurvival from the final cox model tracks flexible smooth estimates, with-\nout any binning of predicted survival probabilities or assuming proportional\nhazards.\n\n "}, {"Page_number": 548, "text": "530\n\n21 case study in cox regression\n\ncal \u2190 calibrate (f , b =300 , u =5 * 12 , maxdim =4)\n\nusing cox survival e s t i m a t e s at 60 months\n\nplot ( cal , subtitles = false )\n\n# f i g u r e 21.3\n\nh\n\nt\n\nn\no\nm\n0\n6\n\n \n\n \n\ni\n\ni\n\ng\nn\nv\nv\nr\nu\ns\nn\no\n\n \n\ni\nt\nc\na\nr\nf\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\n0.2\n\n0.1\n\n0.0\n\n0.0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\npredicted  60 month survival\n\nfig. 21.3 bootstrap estimate of calibration accuracy for 5-year estimates from the\nfinal cox model, using adaptive linear spline hazard regression361. the line nearer the\nideal line corresponds to apparent predictive accuracy. the blue curve corresponds to\nbootstrap-corrected estimates.\n\nthe estimated calibration curves are shown in figure 21.3, similar to what\nwas done in figure 19.11. bootstrap calibration demonstrates some overfit-\nting, consistent with regression to the mean. the absolute error is appreciable\nfor 5-year survival predicted to be very low or high.\n\n21.6 presenting the model\n\nto present point and interval estimates of predictor effects we draw a hazard\nratio chart (figure 21.4), and to make a final presentation of the model\nwe draw a nomogram having multiple \u201cpredicted value\u201d axes. since the ap\nrelationship is so non-monotonic, use a 20 : 1 hazard ratio for this variable.\nplot ( summary (f , ap = c (1 ,20)) , log = true , main = ' ' )\n\n# figure 21.4\n\n "}, {"Page_number": 549, "text": "21.7 problems\n\n531\n\n0.50\n\n1.00\n\n2.00\n\n3.50 5.50\n\nage \u2212 76:70\nwt \u2212 107:90\npf.coded \u2212 4:1\nheart \u2212 2:0\nmap \u2212 11:9.333333\nhg \u2212 14.69922:12.29883\nsg \u2212 11:9\nsz \u2212 21:5\nap \u2212 20:1\nbm \u2212 1:0\nrx \u2212 0.2 mg estrogen:placebo\nrx \u2212 1.0 mg estrogen:placebo\nrx \u2212 5.0 mg estrogen:placebo\n\nfig. 21.4 hazard ratios and multi-level confidence bars for effects of predictors in\nmodel, using default ranges except for ap\n\nthe ultimate graphical display for this model will be a nomogram relating\nthe predictors to x \u02c6\u03b2, estimated three\u2013 and five-year survival probabilities\nand median survival time. it is easy to add as many \u201coutput\u201d axes as desired\nto a nomogram.\nsurv \u2190 survival ( f )\nsurv3 \u2190 function ( x ) surv (3 * 12 , lp = x )\nsurv5 \u2190 function ( x ) surv (5 * 12 , lp = x )\nquan \u2190 quantile ( f )\nmed \u2190 function ( x ) quan ( lp = x ) / 12\n\n\u2190 c ( .05 , .1 , .2 , .3 , .4 , .5 , .6 , .7 , .8 , .9 , .95 )\n\nss\n\nnom \u2190 nomogram (f , ap = c ( .1 , .5 ,1 ,2 ,3 ,4 ,5 ,10 ,20 ,30 ,40) ,\n\nfun = list ( surv3 , surv5 , med ) ,\nfunlabel = c ( ' 3 -year survival ' , ' 5 -year survival ' ,\n\n' median survival time ( years ) ' ) ,\n\nplot ( nom , xfrac = .65 , lmgp = .35 )\n\n# figure 21.5\n\nfun.at = list ( ss , ss , c ( .5 ,1:6)))\n\n21.7 problems\n\nperform cox regression analyses of survival time using the mayo clinic pbc\ndataset described in section 8.9. provide model descriptions, parameter esti-\nmates, and conclusions.\n\n1. assess the nature of the association of several predictors of your choice.\nfor polytomous predictors, perform a log-rank-type score test (or k-sample\nanova extension if there are more than two levels). for continuous pre-\ndictors, plot a smooth curve that estimates the relationship between the\npredictor and the log hazard or log\u2013log survival. use both parametric\nand nonparametric (using martingale residuals) approaches. make a test\nof h0 : predictor is not associated with outcome versus ha : predictor\n\n "}, {"Page_number": 550, "text": "532\n\npoints\n\nrx\n\nage in years\n\nweight index = wt(kg)\u2212ht(cm)+200\n\npf.coded\n\nheart disease code\n\nmean arterial pressure/10\n\nserum hemoglobin (g/100ml)\n\ncombined index of stage and hist.\ngrade\n\nsize of primary tumor (cm^2)\n\nserum prostatic acid phosphatase\n\nbone metastases\n\ntotal points\n\nlinear predictor\n\n3\u2212year survival\n\n5\u2212year survival\n\n21 case study in cox regression\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n5.0 mg estrogen\n\n1.0 mg estrogen\n\n75\n\n0.2 mg estrogen\n\n80\n\n85\n\n90\n\n50\n\n70\n120\n\n110\n\n1\n\n0\n22 12\n\n4 8\n\n14\n\n90\n2\n\n16\n\n12\n\n80\n\n3\n\n1\n\n70\n4\n\n60\n\n2\n\n18\n\n20\n\n10\n\n8\n\n6\n\n22\n\n4\n\n5 6 7 8\n\n10 12\n\n15\n\n0 5\n1\n\n15\n\n3 5\n\n2\n\n25 30 35 40 45 50 55 60 65 70\n\n0.5\n1\n\n0\n\n0\n\n40\n\n0.1\n\n20\n\n40\n\n60\n\n80 100\n\n140\n\n180\n\n220\n\n260\n\n\u22122\n\n\u22121.5\n\n\u22121\n\n\u22120.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n0.9\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\n0.2\n\n0.1\n\n0.05\n\n0.8\n\n0.7\n\n0.6\n\n0.5\n\n0.4\n\n0.3\n\n0.2\n\n0.1\n\n0.05\n\nmedian survival time (years)\n\n56\n\n4\n\n3\n\n2\n\n1\n\n0.5\n\nfig. 21.5 nomogram for predicting death in prostate cancer trial\n\nis associated (by a smooth function). the test should have more than 1\nd.f. if there is no evidence that the predictor is associated with outcome.\nmake a formal test of linearity of each remaining continuous predictor.\nuse restricted cubic spline functions with four knots. if you feel that you\ncan\u2019t narrow down the number of candidate predictors without examining\nthe outcomes, and the number is too great to be able to derive a reliable\nmodel, use a data reduction technique and combine many of the variables\ninto a summary index.\n\n "}, {"Page_number": 551, "text": "21.7 problems\n\n533\n\n2. for factors that remain, assess the ph assumption using at least two meth-\nods, after ensuring that continuous predictors are transformed to be as\nlinear as possible. in addition, for polytomous predictors, derive log cu-\nmulative hazard estimates adjusted for continuous predictors that do not\nassume anything about the relationship between the polytomous factor\nand survival.\n\n3. derive a final cox ph model. stratify on polytomous factors that do not\nsatisfy the ph assumption. decide whether to categorize and stratify on\ncontinuous factors that may strongly violate ph. remember that in this\ncase you can still model the continuous factor to account for any residual\nregression after adjusting for strata intervals. include an interaction be-\ntween two predictors of your choosing. interpret the parameters in the final\nmodel. also interpret the final model by providing some predicted survival\ncurves in which an important continuous predictor is on the x-axis, pre-\ndicted survival is on the y-axis, separate curves are drawn for levels of\nanother factor, and any other factors in the model are adjusted to speci-\nfied constants or to the grand mean. the estimated survival probabilities\nshould be computed at t = 730 days.\n\n4. verify, in an unbiased fashion, your \u201cfinal\u201d model, for either calibration or\ndiscrimination. validate intermediate steps, not just the final parameter\nestimates.\n\n "}, {"Page_number": 552, "text": "appendix a\ndatasets, r packages, and internet\nresources\n\ncentral web site and datasets\n\nthe web site for information related to this book is biostat.mc.vanderbilt.\nedu/rms, and a related web site for a full-semester course based on the book is\nhttp://biostat.mc.vanderbilt.edu/coursebios330. the main site con-\ntains links to several other web sites and a link to the dataset repository that\nholds most of the datasets mentioned in the text for downloading. these\ndatasets are in fully annotated r save (.sav suffixes) filesa; some of these\nare also available in other formats. the datasets were selected because of\nthe variety of types of response and predictor variables, sample size, and\nnumbers of missing values. in r they may be read using the load function,\nload(url()) to read directly from the web, or by using the hmisc package\u2019s\ngethdata function to do the same (as is done in code in the case studies).\nfrom the web site there are links to other useful dataset sources. links to\npresentations and technical reports related to the text are also found on this\nsite, as is information for instructors for obtaining quizzes and answer sheets,\nextra problems, and solutions to these and to many of the problems in the\ntext. details about short courses based on the text are also found there. the\nmain site also has chapter 7 from the first edition, which is a case study in\nordinary least squares modeling.\n\nr packages\n\nthe rms package written by the author maintains detailed information about\na model\u2019s design matrix so that many analyses using the model fit are au-\ntomated. rms is a large package of r functions. most of the functions in rms\nanalyze model fits, validate them, or make presentation graphics from them,\n\na by convention these should have had .rda suffixes.\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7\n\n535\n\n "}, {"Page_number": 553, "text": "536\n\na datasets, r packages, and internet resources\n\nbut the packages also contain special model\u2013fitting functions for binary and\nordinal logistic regression (optionally using penalized maximum likelihood),\nunpenalized ordinal regression with a variety of link functions, penalized and\nunpenalized least squares, and parametric and semiparametric survival mod-\nels. in addition, rms handles quantile regression and longitudinal analysis\nusing generalized least squares. the rms package pays special attention to\ncomputing predicted values in that design matrix attributes (e.g., knots for\nsplines, categories for categorical predictors) are \u201cremembered\u201d so that pre-\ndictors are properly transformed while predictions are being generated. the\nfunctions makes extensive use of a wealth of survival analysis software writ-\nten by terry therneau of the mayo foundation. this survival package is a\nstandard part of r.\n\nthe author\u2019s hmisc package contains other miscellaneous functions used\nin the text. these are functions that do not operate on model fits that used\nthe enhanced design attributes stored by the rms package. functions in hmisc\ninclude facilities for data reduction, imputation, power and sample size calcu-\nlation, advanced table making, recoding variables, translating sas datasets\ninto r data frames while preserving all data attributes (including variable\nand value labels and special missing values), drawing and annotating plots,\nand converting certain r objects to latex371 typeset form. the latter capa-\nbility, provided by a family of latex functions, completes the conversion to\nlatex of many of the objects created by rms. the packages contain several\nlatex methods that create latex code for typesetting model fits in algebraic\nnotation, for printing anova and regression effect (e.g., odds ratio) tables,\nand other applications. the latex methods were used extensively in the text,\nespecially for writing restricted cubic spline function fits in simplest notation.\nthe latest version of the rms package is available from cran (see below).\nit is necessary to install the hmisc package in order to use rms package. the\nweb site also contains more in-depth overviews of the packages, which run on\nunix, linux, mac, and microsoft windows systems. the packages may be\nautomatically downloaded and installed using r\u2019s install.packages function\nor using menus under r graphical user interfaces.\n\nr-help, cran, and discussion boards\n\nto subscribe to the highly informative and helpful r-help e-mail group, see the\nweb site. r-help is appropriate for asking general questions about r including\nthose about finding or writing functions to do specific analyses (for questions\nspecific to a package, contact the author of that package). another resource\nis the cran repository at www.r-project.org. another excellent resource\nfor askings questions about r is stackoverflow.com/questions/tagged/r.\nthere is a google group regmod devoted to the book and courses.\n\n "}, {"Page_number": 554, "text": "a datasets, r packages, and internet resources\n\n537\n\nmultiple imputation\n\nthe impute e-mail list maintained by juned siddique of northwestern univer-\nsity is an invaluable source of information regarding missing data problems.\nto subscribe to this list, see the web site. other excellent sources of on-\nline information are joseph schafer\u2019s \u201cmultiple imputation frequently asked\nquestions\u201d site and stef van buuren and karin oudshoorn\u2019s \u201cmultiple im-\nputation online\u201d site, for which links exist on the main web site.\n\nbibliography\n\nan extensive annotated bibliography containing all the references in this text\nas well as other references concerning predictive methods, survival analysis,\nlogistic regression, prognosis, diagnosis, modeling strategies, model valida-\ntion, practical bayesian methods, clinical trials, graphical methods, papers\nfor teaching statistical methods, the bootstrap, and many other areas may\nbe found at http://www.citeulike.org/user/harrelfe.\n\nsas\n\nsas macros for fitting restricted cubic splines and for other basic operations\nare freely available from the main web site. the web site also has notes on\nsas usage for some of the methods presented in the text.\n\n "}, {"Page_number": 555, "text": "references\n\nnumbers following (cid:12) are page numbers of citations.\n\n1. o. o. aalen. nonparametric inference in connection with multiple decrement\n\n2. o. o. aalen. further results on the non-parametric linear regression model in\n\nmodels. scan j stat, 3:15\u201327, 1976. (cid:11)413\nsurvival analysis. stat med, 12:1569\u20131588, 1993. (cid:11)518\napplied to lifetimes of amalgam fillings. stat med, 14:1819\u20131829, 1995. (cid:11)421\n\n3. o. o. aalen, e. bjertness, and t. s\u00f8nju. analysis of dependent survival data\n\n6. a. agresti. categorical data analysis. wiley, hoboken, nj, second edition, 2002.\n\n5. a. agresti. a survey of models for repeated ordered categorical response data.\n\n4. m. abrahamowicz, t. mackenzie, and j. m. esdaile. time-dependent haz-\nard ratio: modeling and hypothesis testing with applications in lupus nephritis.\njama, 91:1432\u20131439, 1996. (cid:11)501\nstat med, 8:1209\u20131224, 1989. (cid:11)324\n(cid:11)271\nbiometrics, 50:471\u2013485, 1994. (cid:11)41, 178\nof multiple responses. biometrika, 44:131\u2013140, 1957. (cid:11)324\n\n8. j. aitchison and s. d. silvey. the generalization of probit analysis to the case\n\n7. h. ahn and w. loh. tree-structured proportional hazards regression modeling.\n\n9. k. akazawa, t. nakamura, and y. palesch. power of logrank test and cox\nregression model in clinical trials with heterogeneous samples. stat med, 16:583\u2013\n597, 1997. (cid:11)4\n\n10. o. o. al-radi, f. e. harrell, c. a. caldarone, b. w. mccrindle, j. p. jacobs,\nm. g. williams, g. s. van arsdell, and w. g. williams. case complexity\nscores in congenital heart surgery: a comparative study of the aristotal basic\ncomplexity score and the risk adjustment in congenital heart surg (rachs-\n1) system. j thorac cardiovasc surg, 133:865\u2013874, 2007. (cid:11)215\n11. j. m. alho. on the computation of likelihood ratio and score test based con-\nfidence intervals in generalized linear models. stat med, 11:923\u2013930, 1992. (cid:11)\n214\n12. p. d. allison. missing data. sage university papers series on quantitative\napplications in the social sciences, 07-136. sage, thousand oaks ca, 2001. (cid:11)\n49, 58\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7\n\n539\n\n "}, {"Page_number": 556, "text": "540\n\nreferences\n\n13. d. g. altman. categorising continuous covariates (letter to the editor). brit j\n\n14. d. g. altman. suboptimal analysis using \u2018optimal\u2019 cutpoints. brit j cancer,\n\ncancer, 64:975, 1991. (cid:11)11, 19\n78:556\u2013557, 1998. (cid:11)19\n\n15. d. g. altman and p. k. andersen. a note on the uncertainty of a survival\nprobability estimated from cox\u2019s regression model. biometrika, 73:722\u2013724,\n1986. (cid:11)11, 517\ncox regression model. stat med, 8:771\u2013783, 1989. (cid:11)68, 70, 341\n\n16. d. g. altman and p. k. andersen. bootstrap investigation of the stability of a\n\n18. d. g. altman and p. royston. what do we mean by validating a prognostic\n\n17. d. g. altman, b. lausen, w. sauerbrei, and m. schumacher. dangers of using\n\u2018optimal\u2019 cutpoints in the evaluation of prognostic factors. j nat cancer inst,\n86:829\u2013835, 1994. (cid:11)11, 19, 20\nmodel? stat med, 19:453\u2013473, 2000. (cid:11)6, 122, 519\niments. math biosci, 6:1\u201311, 1970. (cid:11)413\nlibraries, 2006. electronic book, 310 pages. (cid:11)129\n\n19. b. altschuler. theory for the measurement of competing risks in animal exper-\n\n20. c. f. alzola and f. e. harrell. an introduction to s and the hmisc and design\n\n23. p. k. andersen and r. d. gill. cox\u2019s regression model for counting processes:\n\n21. g. ambler, a. r. brady, and p. royston. simplifying a prognostic model: a\nsimulation study based on clinical data. stat med, 21(24):3803\u20133822, dec. 2002.\n(cid:11)121\n22. f. ambrogi, e. biganzoli, and p. boracchi. estimates of clinically useful mea-\nsures in competing risks survival analysis. stat med, 27:6407\u20136425, 2008. (cid:11)\n421\na large sample study. ann stat, 10:1100\u20131120, 1982. (cid:11)418, 513\nhazards regression. biometrika, 82:527\u2013541, 1995. (cid:11)4\nb, 46:1\u201330, 1984. (cid:11)324\nmodels for ordered categorical variables. appl stat, 30:22\u201331, 1981. (cid:11)324\nfunctions. appl stat, 31:44\u201351, 1982. (cid:11)495, 499, 501\n\n27. j. a. anderson and a. senthilselvan. a two-step regression model for hazard\n28. d. f. andrews and a. m. herzberg. data. springer-verlag, new york, 1985. (cid:11)\n\n26. j. a. anderson and p. r. philips. regression, discrimination and measurement\n\n24. g. l. anderson and t. r. fleming. model misspecification in proportional\n\n25. j. a. anderson. regression and ordered categorical variables. j roy stat soc\n\n29. e. arjas. a graphical method for assessing goodness of fit in cox\u2019s proportional\n\n161\nhazards model. j am stat assoc, 83:204\u2013212, 1988. (cid:11)420, 495, 502\n\n30. h. r. arkes, n. v. dawson, t. speroff, f. e. harrell, c. alzola, r. phillips,\nn. desbiens, r. k. oye, w. knaus, a. f. connors, and t. investigators. the\ncovariance decomposition of the probability score and its use in evaluating prog-\nnostic estimates. med decis mak, 15:120\u2013131, 1995. (cid:11)257\n31. b. g. armstrong and m. sloan. ordinal regression models for epidemiologic\ndata. am j epi, 129:191\u2013204, 1989. see letter to editor by peterson. (cid:11)319, 320,\n321, 324\n\n32. d. ashby, c. r. west, and d. ames. the ordered logistic regression model\nin psychiatry: rising prevalence of dementia in old people\u2019s homes. stat med,\n8:1317\u20131326, 1989. (cid:11)324\nmodel. biometrika, 67:413\u2013418, 1980. (cid:11)69, 204\n\n33. a. c. atkinson. a note on the generalized information criterion for choice of a\n\n34. p. c. austin. a comparison of regression trees, logistic regression, generalized\nadditive models, and multivariate adaptive regression splines for predicting ami\nmortality. stat med, 26:2937\u20132957, 2007. (cid:11)41\n\n "}, {"Page_number": 557, "text": "references\n\n541\n\n35. p. c. austin. bootstrap model selection had similar performance for select-\ning authentic and noise variables compared to backward variable elimination: a\nsimulation study. j clin epi, 61:1009\u20131017, 2008. (cid:11)70\n\n36. p. c. austin and e. w. steyerberg. events per variable (epv) and the relative\nperformance of different strategies for estimating the out-of-sample validity of\nlogistic regression models. statistical methods in medical research, nov. 2014. (cid:11)\n112\n\n37. p. c. austin and e. w. steyerberg. graphical assessment of internal and exter-\nnal calibration of logistic regression models by using loess smoothers. stat med,\n33(3):517\u2013535, feb. 2014. (cid:11)105\n\n38. p. c. austin, j. v. tu, p. a. daly, and d. a. alter. tutorial in biostatistics:the\nuse of quantile regression in health care research: a case study examining gender\ndifferences in the timeliness of thrombolytic therapy. stat med, 24:791\u2013816,\n2005. (cid:11)392\n\n40. j. banks. nomograms. in s. kotz and n. l. johnson, editors, encyclopedia of\n\n39. d. bamber. the area above the ordinal dominance graph and the area below\nthe receiver operating characteristic graph. j mathe psych, 12:387\u2013415, 1975.\n(cid:11)257\nstat scis, volume 6. wiley, new york, 1985. (cid:11)104, 267\nimputation. biometrika, 86:948\u2013955, 1999. (cid:11)58\nin small sample clinical trials. stat med, 25:233\u2013245, 2006. (cid:11)47, 58\n\n42. s. a. barnes, s. r. lindborg, and j. w. seaman. multiple imputation techniques\n\n41. j. barnard and d. b. rubin. small-sample degrees of freedom with multiple\n\n44. r. a. becker, j. m. chambers, and a. r. wilks. the new s language.\n\n45. h. belcher. the concept of residual confounding in regression models and some\n\n46. d. a. belsley. conditioning diagnostics: collinearity and weak data in re-\n\n43. f. barzi and m. woodward. imputations of missing values in practice: results\nfrom imputations of serum cholesterol in 28 cohort studies. am j epi, 160:34\u201345,\n2004. (cid:11)50, 58\nwadsworth and brooks/cole, pacific grove, ca, 1988. (cid:11)127\napplications. stat med, 11:1747\u20131758, 1992. (cid:11)11, 19\ngression. wiley, new york, 1991. (cid:11)101\ninfluential data and sources of collinearity. wiley, new york, 1980. (cid:11)91\ns-plus. biometrical j, 42:677\u2013699, 2000. (cid:11)324\n49. j. k. benedetti, p. liu, h. n. sather, j. seinfeld, and m. a. epton. effective\nsample size for tests of censored survival data. biometrika, 69:343\u2013349, 1982. (cid:11)\n73\n\n48. r. bender and a. benner. calculating ordinal regression models in sas and\n\n47. d. a. belsley, e. kuh, and r. e. welsch. regression diagnostics: identifying\n\n52. d. m. berridge and j. whitehead. analysis of failure time data with ordinal\n\n51. k. n. berk and d. e. booth. seeing a curve in multiple regression. technomet-\n\n50. k. berhane, m. hauptmann, and b. langholz. using tensor product splines\nin modeling exposure\u2013time\u2013response relationships: application to the colorado\nplateau uranium miners cohort. stat med, 27:5484\u20135496, 2008. (cid:11)37\nrics, 37:385\u2013398, 1995. (cid:11)272\ncategories of response. stat med, 10:1703\u20131710, 1991. (cid:11)319, 320, 324, 417\nscales. stat med, 13:823\u2013838, 1994. (cid:11)401\ntest for randomly truncated data. biometrics, 52:10\u201320, 1996. (cid:11)420\nbiometrika, 79:139\u2013147, 1992. (cid:11)213, 215\n\n54. w. b. bilker and m. wang. a semiparametric extension of the mann-whitney\n\n53. c. berzuini and d. clayton. bayesian analysis of survival on multiple time\n\n55. d. a. binder. fitting cox\u2019s proportional hazards models from survey data.\n\n56. c. binquet, m. abrahamowicz, a. mahboubi, v. jooste, j. faivre, c. bonithon-\nkopp, and c. quantin. empirical study of the dependence of the results of\nmultivariable flexible survival analyses on model selection strategy. stat med,\n27:6470\u20136488, 2008. (cid:11)420\n\n "}, {"Page_number": 558, "text": "542\n\nreferences\n\n57. e. h. blackstone. analysis of death (survival analysis) and other time-related\nevents. in f. j. macartney, editor, current status of clinical cardiology, pages\n55\u2013101. mtp press limited, lancaster, uk, 1986. (cid:11)420\n\n58. s. e. bleeker, h. a. moll, e. w. steyerberg, a. r. t. donders, g. derkson-\nlubsen, d. e. grobbee, and k. g. m. moons. external validation is necessary\nin prediction research: a clinical example. j clin epi, 56:826\u2013832, 2003. (cid:11)122\n59. m. blettner and w. sauerbrei.\ninfluence of model-building strategies on the\nresults of a case-control study. stat med, 12:1325\u20131338, 1993. (cid:11)123\n60. d. d. boos. on generalized score tests. ann math stat, 46:327\u2013333, 1992. (cid:11)213\n61. j. g. booth and s. sarkar. monte carlo approximation of bootstrap variances.\n\n62. r. bordley. statistical decisionmaking without math. chance, 20(3):39\u201344,\n\nam statistician, 52:354\u2013357, 1998. (cid:11)122\n2007. (cid:11)5\nlogistic regression. biometrics, 46:1171\u20131178, 1990. (cid:11)324\n\n63. r. brant. assessing proportionality in the proportional odds model for ordinal\n\n65. a. r. brazzale and a. c. davison. accurate parametric inference for small\n\n64. s. r. brazer, f. s. pancotto, t. t. long iii, f. e. harrell, k. l. lee, m. p. tyor,\nand d. b. pryor. using ordinal logistic regression to estimate the likelihood of\ncolorectal neoplasia. j clin epi, 44:1263\u20131270, 1991. (cid:11)324\nsamples. statistical sci, 23(4):465\u2013484, 2008. (cid:11)214\n66. l. breiman. the little bootstrap and other methods for dimensionality selection\nin regression: x-fixed prediction error. j am stat assoc, 87:738\u2013754, 1992. (cid:11)\n69, 100, 112, 114, 123, 204\nsci, 16:199\u2013231, 2001. (cid:11)11\n\n67. l. breiman. statistical modeling: the two cultures (with discussion). statistical\n\n68. l. breiman and j. h. friedman. estimating optimal transformations for multiple\nregression and correlation (with discussion). j am stat assoc, 80:580\u2013619, 1985.\n(cid:11)82, 176, 390\n69. l. breiman, j. h. friedman, r. a. olshen, and c. j. stone. classification and\nregression trees. wadsworth and brooks/cole, pacific grove, ca, 1984. (cid:11)30,\n41, 142\n99, 1974. (cid:11)477, 483, 485\n\n70. n. e. breslow. covariance analysis of censored survival data. biometrics, 30:89\u2013\n\n72. n. e. breslow, l. edler, and j. berger. a two-sample censored-data rank test\n\n71. n. e. breslow, n. e. day, k. t. halvorsen, r. l. prentice, and c. sabai. esti-\nmation of multiple relative risk functions in matched case-control studies. am\nj epi, 108:299\u2013307, 1978. (cid:11)483\nfor acceleration. biometrics, 40:1049\u20131062, 1984. (cid:11)501\nweather rev, 78:1\u20133, 1950. (cid:11)257\n\n73. g. w. brier. verification of forecasts expressed in terms of probability. monthly\n\n74. w. m. briggs and r. zaretzki. the skill plot: a graphical technique for evaluat-\ning continuous diagnostic tests (with discussion). biometrics, 64:250\u2013261, 2008.\n(cid:11)5, 11\n\n75. g. bron. the loss of the \u201ctitanic\u201d. the sphere, 49:103, may 1912. the results\nanalysed and shown in a special \u201csphere\u201d diagram drawn from the official figures\ngiven in the house of commons. (cid:11)291\n\n76. b. w. brown, m. hollander, and r. m. korwar. nonparametric tests of inde-\npendence for censored data, with applications to heart transplant studies. in\nf. proschan and r. j. serfling, editors, reliability and biometry, pages 327\u2013354.\nsiam, philadelphia, 1974. (cid:11)505\n\n77. d. brownstone. regression strategies. in proceedings of the 20th symposium\non the interface between computer science and statistics, pages 74\u201379, wash-\nington, dc, 1988. american statistical association. (cid:11)116\nfunctions. biometrics, 69:182\u2013190, 2004. (cid:11)420\n\n78. j. bryant and j. j. dignam. semiparametric models for cumulative incidence\n\n "}, {"Page_number": 559, "text": "references\n\n543\n\n80. s. t. buckland, k. p. burnham, and n. h. augustin. model selection: an\n\n79. s. f. buck. a method of estimation of missing values in multivariate data\nsuitable for use with an electronic computer. j roy stat soc b, 22:302\u2013307,\n1960. (cid:11)52\nintegral part of inference. biometrics, 53:603\u2013618, 1997. (cid:11)10, 11, 214\n66:429\u201336, 1979. (cid:11)447\n\n81. j. buckley and i. james. linear regression with censored data. biometrika,\n\n82. p. buettner, c. garbe, and i. guggenmoos-holzmann. problems in defining\ncutoff points of continuous prognostic factors: example of tumor thickness in\nprimary cutaneous melanoma. j clin epi, 50:1201\u20131210, 1997. (cid:11)11, 19\nmed, 16:1041\u20131074, 1997. (cid:11)399, 401, 420\n\n83. k. bull and d. spiegelhalter. survival analysis in observational studies. stat\n\n84. k. p. burnham and d. r. anderson. model selection and multimodel inference:\na practical information-theoretic approach. springer, 2nd edition, dec. 2003.\n(cid:11)69\nraton, fl, 2012. (cid:11)54, 55, 58, 304\n\n85. s. buuren. flexible imputation of missing data. chapman & hall/crc, boca\n\n86. m. buyse. r2: a useful measure of model performance when predicting a di-\nchotomous outcome. stat med, 19:271\u2013274, 2000. letter to the editor regarding\nstat med 18:375\u2013384; 1999. (cid:11)272\n\n87. d. p. byar and s. b. green. the choice of treatment for cancer patients based on\ncovariate information: application to prostate cancer. bulletin cancer, paris,\n67:477\u2013488, 1980. (cid:11)161, 275, 521\n\n88. r. m. califf, f. e. harrell, k. l. lee, j. s. rankin, and others. the evolution of\nmedical and surgical therapy for coronary artery disease. jama, 261:2077\u20132086,\n1989. (cid:11)484, 485, 510\njeopardy score. j am college cardiol, 5:1055\u20131063, 1985. (cid:11)207\n\n89. r. m. califf, h. r. phillips, and others. prognostic value of a coronary artery\n\n91. a. j. canty, a. c. davison, d. v. hinkley, and v. venture. bootstrap diagnostics\n\n90. r. m. califf, l. h. woodlief, f. e. harrell, k. l. lee, h. d. white, a. guerci,\ng. i. barbash, r. simes, w. weaver, m. l. simoons, e. j. topol, and t. inves-\ntigators. selection of thrombolytic therapy for individual patients: development\nof a clinical model. am heart j, 133:630\u2013639, 1997. (cid:11)4\nand remedies. can j stat, 34:5\u201327, 2006. (cid:11)122\n92. j. carpenter and j. bithell. bootstrap confidence intervals: when, which, what?\na practical guide for medical statisticians. stat med, 19:1141\u20131164, 2000. (cid:11)122,\n214\n93. w. h. carter, g. l. wampler, and d. m. stablein. regression analysis of\nsurvival data in cancer chemotherapy. marcel dekker, new york, 1983. (cid:11)477\n94. centers for disease control and prevention cdc. national center for health\nstatistics nchs. national health and nutrition examination survey, 2010. (cid:11)\n365\n\n95. m. s. cepeda, r. boston, j. t. farrar, and b. l. strom. comparison of logistic\nregression versus propensity score when the number of events is low and there\nare multiple confounders. am j epi, 158:280\u2013287, 2003. (cid:11)272\n96. j. m. chambers and t. j. hastie, editors. statistical models in s. wadsworth\nand brooks/cole, pacific grove, ca, 1992. (cid:11)x, 29, 41, 128, 142, 245, 269, 493,\n498\n\n97. l. e. chambless and k. e. boyle. maximum likelihood methods for com-\nplex sample data: logistic regression and discrete proportional hazards models.\ncomm stat a, 14:1377\u20131392, 1985. (cid:11)215\nproportionality. biometrika, 79:199\u2013201, 1992. (cid:11)495\n6:240\u2013268, 1991. (cid:11)91\n\n98. r. chappell. a note on linear rank tests and gill and schumacher\u2019s tests of\n\n99. c. chatfield. avoiding statistical pitfalls (with discussion). statistical sci,\n\n "}, {"Page_number": 560, "text": "544\n\nreferences\n\n100. c. chatfield. model uncertainty, data mining and statistical inference (with\ndiscussion). j roy stat soc a, 158:419\u2013466, 1995. (cid:11)vii, 9, 10, 11, 68, 100, 123,\n204\nyork, fifth edition, 2012. (cid:11)78, 101\n\n101. s. chatterjee and a. s. hadi. regression analysis by example. wiley, new\n\n102. s. c. cheng, j. p. fine, and l. j. wei. prediction of cumulative incidence\nfunction under the proportional hazards model. biometrics, 54:219\u2013228, 1998.\n(cid:11)415\n103. s. c. cheng, l. j. wei, and z. ying. predicting survival probabilities with\nsemiparametric transformation models. jasa, 92(437):227\u2013235, mar. 1997. (cid:11)\n517\nregressions with categorical predictors. appl stat, 30:475\u2013497, 2002. (cid:11)101\n\n104. f. chiaromonte, r. d. cook, and b. li. sufficient dimension reduction in\n\n105. b. choodari-oskooei, p. royston, and m. k. b. parmar. a simulation study\nof predictive ability measures in a survival model ii: explained randomness and\npredictive accuracy. stat med, 31(23):2644\u20132659, 2012. (cid:11)518\n\n106. b. choodari-oskooei, p. royston, and m. k. b. parmar. a simulation study of\npredictive ability measures in a survival model i: explained variation measures.\nstat med, 31(23):2627\u20132643, 2012. (cid:11)518\nsurvival data and the cox model. j clin epi, 48:675\u2013689, 1995. (cid:11)41\n\n107. a. ciampi, a. negassa, and z. lou. tree-structured prediction for censored\n\n108. a. ciampi, j. thiffault, j. p. nakache, and b. asselain. stratification by stepwise\nregression, correspondence analysis and recursive partition. comp stat data\nanalysis, 1986:185\u2013204, 1986. (cid:11)41, 81\n\n109. l. a. clark and d. pregibon. tree-based models. in j. m. chambers and t. j.\nhastie, editors, statistical models in s, chapter 9, pages 377\u2013419. wadsworth\nand brooks/cole, pacific grove, ca, 1992. (cid:11)41\n110. t. g. clark and d. g. altman. developing a prognostic model in the presence\nof missing data: an ovarian cancer case study. j clin epi, 56:28\u201337, 2003. (cid:11)57\n111. w. s. cleveland. robust locally weighted regression and smoothing scatterplots.\nj am stat assoc, 74:829\u2013836, 1979. (cid:11)29, 141, 238, 315, 356, 493\nstat med, 8:1255\u20131268, 1989. (cid:11)401, 420\n\n112. a. cnaan and l. ryan. survival analysis in natural history studies of disease.\n\n113. t. j. cole, c. j. morley, a. j. thornton, m. a. fowler, and p. h. hewson. a\nscoring system to quantify illness in babies under 6 months of age. j roy stat\nsoc a, 154:287\u2013304, 1991. (cid:11)324\nlondon, 1994. (cid:11)420, 517\n2002. (cid:11)213, 272, 315\n\n115. d. collett. modelling binary data. chapman and hall, london, second edition,\n\n114. d. collett. modelling survival data in medical research. chapman and hall,\n\n116. a. f. connors, t. speroff, n. v. dawson, c. thomas, f. e. harrell, d. wagner,\nn. desbiens, l. goldman, a. w. wu, r. m. califf, w. j. fulkerson, h. vidaillet,\ns. broste, p. bellamy, j. lynn, w. a. knaus, and t. s. investigators. the effec-\ntiveness of right heart catheterization in the initial care of critically ill patients.\njama, 276:889\u2013897, 1996. (cid:11)3\n\n118. n. r. cook. use and misues of the receiver operating characteristic curve in\n\n117. e. f. cook and l. goldman. asymmetric stratification: an outline for an effi-\ncient method for controlling confounding in cohort studies. am j epi, 127:626\u2013\n639, 1988. (cid:11)31, 231\nrisk prediction. circulation, 115:928\u2013935, 2007. (cid:11)93, 101, 273\n22:1\u201326, 2007. (cid:11)101\nin regression. statistical sci, 23(4):485\u2013501, 2008. (cid:11)101\n\n120. r. d. cook and l. forzani. principal fitted components for dimension reduction\n\n119. r. d. cook. fisher lecture:dimension reduction in regression. statistical sci,\n\n "}, {"Page_number": 561, "text": "references\n\n545\n\n121. j. copas. the effectiveness of risk scores: the logit rank plot. appl stat, 48:165\u2013\n\n122. j. b. copas. regression, prediction and shrinkage (with discussion). j roy stat\n\n123. j. b. copas. cross-validation shrinkage of regression predictors. j roy stat soc\n\n183, 1999. (cid:11)273\nsoc b, 45:311\u2013354, 1983. (cid:11)100, 101\nb, 49:175\u2013183, 1987. (cid:11)115, 123, 273, 508\n80, 1989. (cid:11)236\nsion with variable selection. the statistician, 40:51\u201359, 1991. (cid:11)68\nnon-linear model approach. stat med, 14:1191\u20131203, 1995. (cid:11)324\nanalysis. stat med, 27:4301\u20134313, 2008. (cid:11)424\n\n124. j. b. copas. unweighted sum of squares tests for proportions. appl stat, 38:71\u2013\n\n125. j. b. copas and t. long. estimating the residual variance in orthogonal regres-\n\n126. c. cox. location-scale cumulative odds models for ordinal data: a generalized\n\n127. c. cox. the generalized f distribution: an umbrella for parametric survival\n\nfor binary regression.\n\n130. d. r. cox. two further applications of a model\n\n131. d. r. cox. further results on tests of separate families of hypotheses. j roy\n\n129. d. r. cox. the regression analysis of binary sequences (with discussion). j roy\n\n132. d. r. cox. regression models and life-tables (with discussion). j roy stat soc\n\n128. c. cox, h. chu, m. f. schneider, and a. mu\u02dcnoz. parametric survival analysis\nand taxonomy of hazard functions for the generalized gamma distribution. stat\nmed, 26:4352\u20134374, 2007. (cid:11)424\nstat soc b, 20:215\u2013242, 1958. (cid:11)14, 220\nbiometrika, 45(3/4):562\u2013565, 1958. (cid:11)259\nstat soc b, 24:406\u2013424, 1962. (cid:11)205\nb, 34:187\u2013220, 1972. (cid:11)39, 41, 172, 207, 213, 314, 418, 428, 475, 476\n1984. (cid:11)401, 420, 517\nroy stat soc b, 30:248\u2013275, 1968. (cid:11)440\nlondon, second edition, 1989. (cid:11)206\nbinary responses. am statistician, 46:1\u20134, 1992. (cid:11)206, 256\neconomics, 3:386\u2013406, 1970. (cid:11)206, 256\n\n133. d. r. cox and d. oakes. analysis of survival data. chapman and hall, london,\n\n134. d. r. cox and e. j. snell. a general definition of residuals (with discussion). j\n\n136. d. r. cox and n. wermuth. a comment on the coefficient of determination for\n\n137. j. g. cragg and r. uhler. the demand for automobiles. canadian journal of\n\n135. d. r. cox and e. j. snell. the analysis of binary data. chapman and hall,\n\n138. s. l. crawford, s. l. tennstedt, and j. b. mckinlay. a comparison of analytic\nmethods for non-random missingness of outcome data. j clin epi, 48:209\u2013219,\n1995. (cid:11)58\nfor indicants for clinical diagnosis. stat med, 8:1351\u20131362, 1989. (cid:11)81\nis cart useful? stat med, 16:717\u2013727, 1997. (cid:11)41\n\n139. n. j. crichton and j. p. hinde. correspondence analysis as a screening method\n\n140. n. j. crichton, j. p. hinde, and j. marchini. models for diagnosing chest pain:\n\n141. l. a. cupples, d. r. gagnon, r. ramaswamy, and r. b. d\u2019agostino. age-\nadjusted survival curves with application in the framingham study. stat med,\n14:1731\u20131744, 1995. (cid:11)517\nerlbaum, hillsdale, nj, 1983. (cid:11)81, 87, 101\n\n142. e. e. cureton and r. b. d\u2019agostino. factor analysis, an applied approach.\n\n143. d. m. dabrowska, k. a. doksum, n. j. feduska, r. husing, and p. neville.\nmethods for comparing cumulative hazard functions in a semi-proportional haz-\nard model. stat med, 11:1465\u20131476, 1992. (cid:11)482, 495, 502\n\n144. r. b. d\u2019agostino, a. j. belanger, e. w. markson, m. kelly-hayes, and p. a.\nwolf. development of health risk appraisal functions in the presence of multiple\nindicators: the framingham study nursing home institutionalization model.\nstat med, 14:1757\u20131770, 1995. (cid:11)81, 101\n\n "}, {"Page_number": 562, "text": "546\n\nreferences\n\n145. r. b. d\u2019agostino, m. l. lee, a. j. belanger, and l. a. cupples. relation\nof pooled logistic regression to time dependent cox regression analysis: the\nframingham heart study. stat med, 9:1501\u20131515, 1990. (cid:11)447\npartially missing data. j am stat assoc, 95:749\u2013759, 2000. (cid:11)58\n\n146. d\u2019agostino, jr and d. b. rubin. estimating and using propensity scores with\n\n148. c. s. davis. statistical methods for the analysis of repeated measurements.\n\n147. c. e. davis, j. e. hyde, s. i. bangdiwala, and j. j. nelson. an example of depen-\ndencies among variables in a conditional logistic regression. in s. h. moolgavkar\nand r. l. prentice, editors, modern statistical methods in chronic disease epi,\npages 140\u2013147. wiley, new york, 1986. (cid:11)79, 138, 255\nspringer, new york, 2002. (cid:11)143, 149\n961, 1989. (cid:11)41\ncambridge university press, cambridge, 1997. (cid:11)70, 106, 109, 122\n\n150. a. c. davison and d. v. hinkley. bootstrap methods and their application.\n\n149. r. b. davis and j. r. anderson. exponential survival trees. stat med, 8:947\u2013\n\n152. c. de boor. a practical guide to splines. springer-verlag, new york, revised\n\n151. r. j. m. dawson. the \u2018unusual episode\u2019 data revisited. j stat edu, 3(3),\n1995. online journal at www.amstat.org/publications/jse/v3n3/datasets.-\ndawson.html. (cid:11)291\nedition, 2001. (cid:11)23, 40\nhomals. j stat software, 31(4):1\u201321, aug. 2009. (cid:11)101\n\n153. j. de leeuw and p. mair. gifi methods for optimal scaling in r: the package\n\n154. e. r. delong, c. l. nelson, j. b. wong, d. b. pryor, e. d. peterson, k. l.\nlee, d. b. mark, r. m. califf, and s. g. pauker. using observational data to\nestimate prognosis: an example using a coronary artery disease registry. stat\nmed, 20:2505\u20132532, 2001. (cid:11)420\n\n155. s. derksen and h. j. keselman. backward, forward and stepwise automated sub-\nset selection algorithms: frequency of obtaining authentic and noise variables.\nbritish j math stat psych, 45:265\u2013282, 1992. (cid:11)68\n\n156. t. f. devlin and b. j. weeks. spline functions for logistic regression modeling. in\nproceedings of the eleventh annual sas users group international conference,\npages 646\u2013651, cary, nc, 1986. sas institute, inc. (cid:11)21, 24\nfamilies. biometrika, 79:231\u2013245, 1992. (cid:11)214\n\n157. t. diciccio and b. efron. more accurate confidence intervals in exponential\n\n159. p. j. diggle, p. heagerty, k.-y. liang, and s. l. zeger. analysis of longitudinal\n\n158. e. r. dickson, p. m. grambsch, t. r. fleming, l. d. fisher, and a. langworthy.\nprognosis in primary biliary cirrhosis: model for decision making. hepatology,\n10:1\u20137, 1989. (cid:11)178\ndata. oxford university press, oxford uk, second edition, 2002. (cid:11)143, 147\n160. n. doganaksoy and j. schmee. comparisons of approximate confidence intervals\nfor distributions used in life-data analysis. technometrics, 35:175\u2013184, 1993. (cid:11)\n198, 214\n\n161. donders, g. j. m. g. van der heijden, t. stijnen, and k. g. m. moons. review:\na gentle introduction to imputation of missing values. j clin epi, 59:1087\u20131091,\n2006. (cid:11)49, 58\n\n162. a. donner. the relative effectiveness of procedures commonly used in multiple\nregression analysis for dealing with missing values. am statistician, 36:378\u2013381,\n1982. (cid:11)48, 52\nj roy stat soc b, 57:45\u201397, 1995. (cid:11)10, 11\n\n163. d. draper. assessment and propagation of model uncertainty (with discussion).\n\n164. m. drum and p. mccullagh. comment on regression models for discrete lon-\ngitudinal responses by g. m. fitzmaurice, n. m. laird, and a. g. rotnitzky.\nstat sci, 8:300\u2013301, 1993. (cid:11)197\nstat assoc, 78:605\u2013610, 1983. (cid:11)392\n\n165. n. duan. smearing estimate: a nonparametric retransformation method. j am\n\n "}, {"Page_number": 563, "text": "references\n\n547\n\n166. j. a. dubin, h. m\u00a8uller, and j. wang. event history graphs for censored data.\n\nstat med, 20:2951\u20132964, 2001. (cid:11)418, 420\n\n167. r. dudley, f. e. harrell, l. smith, d. b. mark, r. m. califf, d. b. pryor,\nd. glower, j. lipscomb, and m. hlatky. comparison of analytic models for\nestimating the effect of clinical factors on the cost of coronary artery bypass\ngraft surgery. j clin epi, 46:261\u2013271, 1993. (cid:11)x\nmed, 8:551\u2013561, 1989. (cid:11)40\nnew york, second edition, 1995. (cid:11)291\n\n168. s. durrleman and r. simon. flexible regression models with cubic splines. stat\n\n169. j. p. eaton and c. a. haas. titanic: triumph and tragedy. w. w. norton,\n\n171. b. efron. the efficiency of cox\u2019s likelihood function for censored data. j am\n\n170. b. efron. the two sample problem with censored data. in proceedings of the\nfifth berkeley symposium on mathematical statistics and probability, volume 4,\npages 831\u2013853. 1967. (cid:11)505\nstat assoc, 72:557\u2013565, 1977. (cid:11)475, 477\n172. b. efron. estimating the error rate of a prediction rule: improvement on cross-\nvalidation. j am stat assoc, 78:316\u2013331, 1983. (cid:11)70, 113, 114, 115, 116, 123,\n259\nassoc, 81:461\u2013470, 1986. (cid:11)101, 114\nstat assoc, 89:463\u2013479, 1994. (cid:11)52, 54\ncross-validation. am statistician, 37:36\u201348, 1983. (cid:11)114\n1977. (cid:11)77\n\n175. b. efron and g. gong. a leisurely look at the bootstrap, the jackknife, and\n\n174. b. efron. missing data, imputation, and the bootstrap (with discussion). j am\n\n176. b. efron and c. morris. stein\u2019s paradox in statistics. sci am, 236(5):119\u2013127,\n\n173. b. efron. how biased is the apparent error rate of a prediction rule? j am stat\n\n178. b. efron and r. tibshirani. an introduction to the bootstrap. chapman and\n\n177. b. efron and r. tibshirani. bootstrap methods for standard errors, confidence\nintervals, and other measures of statistical accuracy. statistical sci, 1:54\u201377,\n1986. (cid:11)70, 106, 114, 197\nhall, new york, 1993. (cid:11)70, 106, 114, 115, 122, 197, 199\nstrap method. j am stat assoc, 92:548\u2013560, 1997. (cid:11)123, 124\nrevisited: practical reparameterizations. stat med, 15:1771\u20131777, 1996. (cid:11)482\n\n180. g. e. eide, e. omenaas, and a. gulsvik. the semi-proportional hazards model\n\n179. b. efron and r. tibshirani. improvements on cross-validation: the .632+ boot-\n\n181. c. faes, g. molenberghs, m. aerts, g. verbeke, and m. g. kenward. the\neffective sample size and an alternative small-sample degrees-of-freedom method.\nam statistician, 63(4):389\u2013399, 2009. (cid:11)148\nodds regression model. stat med, 32(13):2235\u20132249, 2013. (cid:11)317\nbayes. chance, 20(3):26\u201332, 2007. (cid:11)5\n\n183. j. fan and r. a. levine. to amnio or not to amnio: that is the decision for\n\n182. m. w. fagerland and d. w. hosmer. a goodness-of-fit test for the proportional\n\n184. d. faraggi, m. leblanc, and j. crowley. understanding neural networks using\nregression trees: an application to multiple myeloma survival data. stat med,\n20:2965\u20132976, 2001. (cid:11)120\n\n186. j. j. faraway. the cost of data analysis. j comp graph stat, 1:213\u2013229, 1992.\n\n185. d. faraggi and r. simon. a simulation study of cross-validation for selecting an\noptimal cutpoint in univariate survival analysis. stat med, 15:2203\u20132213, 1996.\n(cid:11)11, 19\n(cid:11)10, 11, 97, 100, 115, 116, 322, 393, 396\npharm stat, 8:50\u201361, 2009. (cid:11)5, 19\n188. z. feng, d. mclerran, and j. grizzle. a comparison of statistical methods for\nclustered data analysis with gaussian error. stat med, 15:1793\u20131806, 1996. (cid:11)\n197, 213\n\n187. v. fedorov, f. mannino, and r. zhang. consequences of dichotomization.\n\n "}, {"Page_number": 564, "text": "548\n\nreferences\n\n189. l. ferr\u00b4e. determining the dimension in sliced inverse regression and related\n\n190. s. e. fienberg. the analysis of cross-classified categorical data. springer,\n\nmethods. j am stat assoc, 93:132\u2013149, 1998. (cid:11)101\nnew york, second edition, 2007. (cid:11)311, 319\nsuit, 2012. r package version 1.9\u201348. (cid:11)175\nof a competing risk. j am stat assoc, 94:496\u2013509, 1999. (cid:11)420\nmeasures in clinical trials. stat med, 18:1341\u20131354, 1999. (cid:11)420\n\n191. p. filzmoser, h. fritz, and k. kalcher. pcapp: robust pca by projection pur-\n\n192. j. p. fine and r. j. gray. a proportional hazards model for the subdistribution\n\n193. d. m. finkelstein and d. a. schoenfeld. combining mortality and longitudinal\n\n198. i. ford, j. norrie, and s. ahmadi. model inconsistency, illustrated by the cox\n\n195. g. m. fitzmaurice. a caveat concerning independence estimating equations\n\n197. t. r. fleming and d. p. harrington. counting processes & survival analysis.\n\n194. m. fiocco, h. putter, and h. c. van houwelingen. reduced-rank proportional\nhazards regression and simulation-based predictino for multi-state models. stat\nmed, 27:4340\u20134358, 2008. (cid:11)420\nwith multivariate binary data. biometrics, 51:309\u2013317, 1995. (cid:11)214\n196. t. r. fleming and d. p. harrington. nonparametric estimation of the survival\ndistribution in censored data. comm stat th meth, 13(20):2469\u20132486, 1984. (cid:11)\n413\nwiley, new york, 1991. (cid:11)178, 420\nproportional hazards model. stat med, 14:735\u2013746, 1995. (cid:11)4\nbiometrika, 74:503\u2013515, 1987. (cid:11)272\nsage publications, thousand oaks, ca, 1997. (cid:11)viii\ntions, thousand oaks, ca, 2002. (cid:11)viii\npublications, thousand oaks, ca, second edition, 2008. (cid:11)121\nplus companion to applied regression, 2002. (cid:11)202\n159:301\u2013308, 1996. (cid:11)421\n\n200. j. fox. applied regression analysis, linear models, and related methods.\n\n202. j. fox. applied regression analysis and generalized linear models. sage\n\n201. j. fox. an r and s-plus companion to applied regression. sage publica-\n\n203. fox, john. bootstrapping regression models: an appendix to an r and s-\n\n204. b. francis and m. fuller. visualization of event histories. j roy stat soc a,\n\n199. e. b. fowlkes. some diagnostics for binary logistic regression via smoothing.\n\n205. d. freedman, w. navidi, and s. peters. on the impact of variable selection\nin fitting regression equations, pages 1\u201316. lecture notes in economics and\nmathematical systems. springer-verlag, new york, 1988. (cid:11)115\nstandard errors\u201d. am statistician, 60:299\u2013302, 2006. (cid:11)213\n\n206. d. a. freedman. on the so-called \u201chuber sandwich estimator\u201d and \u201crobust\n\n208. l. friedman and m. wall. graphical views of suppression and multicollinearity\n\n207. j. h. friedman. a variable span smoother. technical report 5, laboratory for\ncomputational statistics, department of statistics, stanford university, 1984.\n(cid:11)29, 82, 141, 210, 273, 498\nin multiple linear regression. am statistician, 59:127\u2013136, 2005. (cid:11)101\nmed, 76:815\u2013817, 1972. (cid:11)401\nrisk. biostatistics, 6(2):227\u2013239, 2005. (cid:11)5\ngee: what are the differences? stat med, 28:221\u2013239, 2009. (cid:11)160\n\n210. m. h. gail and r. m. pfeiffer. on criteria for evaluating models of absolute\n\n211. j. c. gardiner, z. luo, and l. a. roman. fixed effects, random effects and\n\n209. m. h. gail. does cardiac transplantation prolong life? a reassessment. ann int\n\n212. j. j. gaynor, e. j. feuer, c. c. tan, d. h. wu, c. r. little, d. j. straus,\nd. d. clarkson, and m. f. brennan. on the use of cause-specific failure and\nconditional failure probabilities: examples from clinical oncology data. j am\nstat assoc, 88:400\u2013409, 1993. (cid:11)414, 415\n\n "}, {"Page_number": 565, "text": "references\n\n549\n\n213. a. gelman. scaling regression inputs by dividing by two standard deviations.\n\nstat med, 27:2865\u20132873, 2008. (cid:11)121\n\n214. r. b. geskus. cause-specific cumulative incidence estimation and the fine\nand gray model under both left truncation and right censoring. biometrics,\n67(1):39\u201349, 2011. (cid:11)420\n\n215. a. giannoni, r. baruah, t. leong, m. b. rehman, l. e. pastormerlo, f. e.\nharrell, a. j. coats, and d. p. francis. do optimal prognostic thresholds in\ncontinuous physiological variables really exist? analysis of origin of apparent\nthresholds, with systematic review for peak oxygen consumption, ejection frac-\ntion and bnp. plos one, 9(1), 2014. (cid:11)19, 20\n\n218. m. glasser. exponential survival with covariance. j am stat assoc, 62:561\u2013568,\n\n220. a. i. goldman. eventcharts: visualizing survival and other timed-events\n\n219. t. gneiting and a. e. raftery. strictly proper scoring rules, prediction, and\n\n217. s. a. glantz and b. k. slinker. primer of applied regression and analysis of\n\n216. j. h. giudice, j. r. fieberg, and m. s. lenarz. spending degrees of freedom\nin a poor economy: a case study of building a sightability model for moose in\nnortheastern minnesota. j wildlife manage, 2011. (cid:11)100\nvariance. mcgraw-hill, new york, 1990. (cid:11)78\n1967. (cid:11)431\nestimation. j am stat assoc, 102:359\u2013378, 2007. (cid:11)4, 5, 273\ndata. am statistician, 46:13\u201318, 1992. (cid:11)420\nbiometrika, 76(3):622\u2013623, 1989. (cid:11)146, 147\n34:215\u2013234, 1994. (cid:11)215\n223. m. g\u00a8onen and g. heller. concordance probability and discriminatory power in\nproportional hazards regression. biometrika, 92(4):965\u2013970, dec. 2005. (cid:11)122,\n519\n224. g. gong. cross-validation, the jackknife, and the bootstrap: excess error es-\ntimation in forward logistic regression. j am stat assoc, 81:108\u2013113, 1986. (cid:11)\n114\n\n221. h. goldstein. restricted unbiased iterative generalized least-squares estimation.\n\n222. r. goldstein. the comparison of models in discrimination cases. jurimetrics j,\n\n225. t. a. gooley, w. leisenring, j. crowley, and b. e. storer. estimation of fail-\nure probabilities in the presence of competing risks: new representations of old\nestimators. stat med, 18:695\u2013706, 1999. (cid:11)414\n\n226. s. m. gore, s. j. pocock, and g. r. kerr. regression models and non-\nproportional hazards in the analysis of breast cancer survival. appl stat, 33:176\u2013\n195, 1984. (cid:11)450, 495, 500, 501, 503\n\n227. h. h. h. g\u00a8oring, j. d. terwilliger, and j. blangero. large upward bias in\nestimation of locus-specific effects from genomewide scans. am j hum gen,\n69:1357\u20131369, 2001. (cid:11)100\n\n228. w. gould. confidence intervals in logit and probit models. stata tech bull,\nhttp://www.stata.com/products/stb/journals/\n\nstb-14:26\u201328, july 1993.\nstb14.pdf. (cid:11)186\n\n229. u. s. govindarajulu, h. lin, k. l. lunetta, and r. b. d\u2019agostino. frailty\nmodels: applications to biomedical and genetic studies. stat med, 30(22):2754\u2013\n2764, 2011. (cid:11)420\n\n230. u. s. govindarajulu, d. spiegelman, s. w. thurston, b. ganguli, and e. a.\neisen. comparing smoothing techniques in cox models for exposure-response\nrelationships. stat med, 26:3735\u20133752, 2007. (cid:11)40\nroy stat soc a, 166:217\u2013223, 2003. (cid:11)122\n\n231. i. m. graham and e. clavel. communicating risk \u2014 coronary risk scores. j\n\n232. j. w. graham, a. e. olchowski, and t. d. gilreath. how many imputations\nare really needed? some practical clarifications of multiple imputation theory.\nprev sci, 8:206\u2013213, 2007. (cid:11)54\n\n "}, {"Page_number": 566, "text": "550\n\nreferences\n\n235. b. i. graubard and e. l. korn. regression analysis with clustered data. stat\n\n236. r. j. gray. some diagnostic methods for cox regression models through hazard\n\n233. p. grambsch and t. therneau. proportional hazards tests and diagnostics\nbased on weighted residuals. biometrika, 81:515\u2013526, 1994. amendment and\ncorrections in 82: 668 (1995). (cid:11)314, 498, 499, 518\n234. p. m. grambsch and p. c. o\u2019brien. the effects of transformations and prelim-\ninary tests for non-linearity in regression. stat med, 10:697\u2013709, 1991. (cid:11)32, 36,\n68\nmed, 13:509\u2013522, 1994. (cid:11)214\nsmoothing. biometrics, 46:93\u2013102, 1990. (cid:11)518\n237. r. j. gray. flexible methods for analyzing survival data using splines, with\napplications to breast cancer prognosis. j am stat assoc, 87:942\u2013951, 1992. (cid:11)\n30, 41, 77, 209, 210, 211, 345, 346, 500\n(cid:11)30, 41, 500\nweighted least-squares. biometrika, 75:457\u2013467, 1988. (cid:11)81\n13:1665\u20131677, 1994. (cid:11)324\nbiometrics, 56:915\u2013921, 2000. (cid:11)68, 100, 215\n\n239. m. j. greenacre. correspondence analysis of multivariate categorical data by\n\n241. s. greenland. when should epidemiologic regressions use random coefficients?\n\n238. r. j. gray. spline-based tests in survival analysis. biometrics, 50:640\u2013652, 1994.\n\n240. s. greenland. alternative models for ordinal logistic regression. stat med,\n\n242. s. greenland and w. d. finkle. a critical look at methods for handling missing\ncovariates in epidemiologic regression analyses. am j epi, 142:1255\u20131264, 1995.\n(cid:11)46, 59\nthe biomedical sciences. wiley, new york, 1975. (cid:11)408\n\n243. a. j. gross and v. a. clark. survival distributions: reliability applications in\n\n244. s. t. gross and t. l. lai. nonparametric estimation and regression analysis\nwith left-truncated and right-censored data. j am stat assoc, 91:1166\u20131180,\n1996. (cid:11)420\nveg sci, 11:617\u2013626, 2000. (cid:11)324\n\n245. a. guisan and f. e. harrell. ordinal response regression models in ecology. j\n\n248. p. gustafson. bayesian regression modeling with interactions and smooth effects.\n\n247. m. j. gurka, l. j. edwards, and k. e. muller. avoiding bias in mixed model\n\n246. j. guo, g. james, e. levina, g. michailidis, and j. zhu. principal component\nanalysis with sparse fused loadings. j comp graph stat, 19(4):930\u2013946, 2011.\n(cid:11)101\ninference for fixed effects. stat med, 30(22):2696\u20132707, 2011. (cid:11)160\nj am stat assoc, 95:795\u2013806, 2000. (cid:11)41\n249. p. hall and h. miller. using generalized correlation to effect variable selection\nin very high dimensional problems. j comp graph stat, 18(3):533\u2013550, 2009. (cid:11)\n100\nempirical ranking. ann stat, 37(6b):3929\u20133959, 2009. (cid:11)117\n\n250. p. hall and h. miller. using the bootstrap to quantify the authority of an\n\n252. d. hand and m. crowder. practical longitudinal data analysis. chapman &\n\n251. m. halperin, w. c. blackwelder, and j. i. verter. estimation of the multivariate\nlogistic risk function: a comparison of the discriminant function and maximum\nlikelihood approaches. j chron dis, 24:125\u2013158, 1971. (cid:11)272\nhall, london, 1996. (cid:11)143\nester, 1997. (cid:11)273\n\n253. d. j. hand. construction and assessment of classification rules. wiley, chich-\n254. t. l. hankins. blood, dirt, and nomograms. chance, 13(1):26\u201337, 2000. (cid:11)104,\n\n255. j. a. hanley and b. j. mcneil. the meaning and use of the area under a receiver\n\n122, 267\noperating characteristic (roc) curve. radiology, 143:29\u201336, 1982. (cid:11)257\n\n "}, {"Page_number": 567, "text": "references\n\n551\n\n256. o. harel and x. zhou. multiple imputation: review of theory, implementation\n\nand software. stat med, 26:3057\u20133077, 2007. (cid:11)46, 50, 58\n257. f. e. harrell. the logist procedure. in sugi supplemental library users\nguide, pages 269\u2013293. sas institute, inc., cary, nc, version 5 edition, 1986. (cid:11)\n69\n258. f. e. harrell. the phglm procedure. in sugi supplemental library users\nguide, pages 437\u2013466. sas institute, inc., cary, nc, version 5 edition, 1986. (cid:11)\n499\nmodels. unpublished manuscript, 1991. (cid:11)115, 259\n\n259. f. e. harrell. comparison of strategies for validating binary logistic regression\n\n260. f. e. harrell. semiparametric modeling of health care cost and resource uti-\nlization. available from hesweb1.med.virginia.edu/biostat/presentations,\n1999. (cid:11)x\n\n261. f. e. harrell. rms: r functions for biostatistical/epidemiologic modeling, testing,\nestimation, validation, graphics, prediction, and typesetting by storing enhanced\nmodel design attributes in the fit, 2013.\nimplements methods in regression\nmodeling strategies, new york:springer, 2001. (cid:11)127\nthe yield of medical tests. jama, 247:2543\u20132546, 1982. (cid:11)505\n\n262. f. e. harrell, r. m. califf, d. b. pryor, k. l. lee, and r. a. rosati. evaluating\n\n263. f. e. harrell and r. goldstein. a survey of microcomputer survival analysis\nsoftware: the need for an integrated framework. am statistician, 51:360\u2013373,\n1997. (cid:11)142\n\n264. f. e. harrell and k. l. lee. a comparison of the discrimination of discriminant\nanalysis and logistic regression under multivariate normality.\nin p. k. sen,\neditor, biostatistics: statistics in biomedical, public health, and environmental\nsciences. the bernard g. greenberg volume, pages 333\u2013343. north-holland,\namsterdam, 1985. (cid:11)205, 207, 258, 272\n\n265. f. e. harrell and k. l. lee. the practical value of logistic regression.\n\nin\nproceedings of the tenth annual sas users group international conference,\npages 1031\u20131036, 1985. (cid:11)237\n\n266. f. e. harrell and k. l. lee. verifying assumptions of the cox proportional\nhazards model. in proceedings of the eleventh annual sas users group inter-\nnational conference, pages 823\u2013828, cary, nc, 1986. sas institute, inc. (cid:11)495,\n499, 501\n267. f. e. harrell and k. l. lee. using logistic model calibration to assess the quality\nof probability predictions. unpublished manuscript, 1987. (cid:11)259, 269, 507, 508\n268. f. e. harrell, k. l. lee, r. m. califf, d. b. pryor, and r. a. rosati. regression\nmodeling strategies for improved prognostic prediction. stat med, 3:143\u2013152,\n1984. (cid:11)72, 101, 332, 505\n\n269. f. e. harrell, k. l. lee, and d. b. mark. multivariable prognostic models: issues\nin developing models, evaluating assumptions and adequacy, and measuring and\nreducing errors. stat med, 15:361\u2013387, 1996. (cid:11)xi, 100\n\n270. f. e. harrell, k. l. lee, d. b. matchar, and t. a. reichert. regression models\nfor prognostic prediction: advantages, problems, and suggested solutions. ca\ntrt rep, 69:1071\u20131077, 1985. (cid:11)41, 72\n\n271. f. e. harrell, k. l. lee, and b. g. pollock. regression models in clinical studies:\ndetermining relationships between predictors and response. j nat cancer inst,\n80:1198\u20131202, 1988. (cid:11)30, 40\n\n272. f. e. harrell, p. a. margolis, s. gove, k. e. mason, e. k. mulholland,\nd. lehmann, l. muhe, s. gatchalian, and h. f. eichenwald. development of a\nclinical prediction model for an ordinal outcome: the world health organiza-\ntion ari multicentre study of clinical signs and etiologic agents of pneumonia,\nsepsis, and meningitis in young infants. stat med, 17:909\u2013944, 1998. (cid:11)xi, 77, 96,\n327\n\n "}, {"Page_number": 568, "text": "552\n\nreferences\n\n273. d. p. harrington and t. r. fleming. a class of rank test procedures for censored\n\nsurvival data. biometrika, 69:553\u2013566, 1982. (cid:11)517\n\n276. t. j. hastie, j. l. botha, and c. m. schnitzler. regression with an ordered\n\n275. t. hastie and r. tibshirani. generalized additive models. chapman and hall,\n\n274. t. hastie. discussion of \u201cthe use of polynomial splines and their tensor products\nin multivariate function estimation\u201d by c. j. stone. appl stat, 22:177\u2013179, 1994.\n(cid:11)37\nlondon, 1990. (cid:11)29, 41, 142, 390\ncategorical response. stat med, 8:785\u2013794, 1989. (cid:11)324\nhall/crc, boca raton, fl, 1990. isbn 9780412343902. (cid:11)90, 359\nanalysis. j am stat assoc, 72:851\u2013863, 1977. (cid:11)193, 234\n84:474\u2013481, 1997. (cid:11)82\n\n277. t. j. hastie and r. j. tibshirani. generalized additive models. chapman &\n\n278. w. w. hauck and a. donner. wald\u2019s test as applied to hypotheses in logit\n\n279. x. he and l. shen. linear regression after spline transformation. biometrika,\n\n281. g. heinze and m. schemper. a solution to the problem of separation in logistic\n\n280. y. he and a. m. zaslavsky. diagnosing imputation models by applying target\nanalyses to posterior replicates of completed data. stat med, 31(1):1\u201318, 2012.\n(cid:11)59\nregression. stat med, 21(16):2409\u20132419, 2002. (cid:11)203\n14:161\u2013184, 1995. (cid:11)420, 518, 519\nanalysis. stat med, 20:3083\u20133096, 2001. (cid:11)519\n\n282. r. henderson. problems and prediction in survival-data analysis. stat med,\n\n283. r. henderson, m. jones, and j. stare. accuracy of point predictions in survival\n\n284. a. v. hern\u00b4andez, m. j. eijkemans, and e. w. steyerberg. randomized con-\ntrolled trials with time-to-event outcomes: how much does prespecified covariate\nadjustment increase power? annals of epidemiology, 16(1):41\u201348, jan. 2006. (cid:11)\n231\n\n285. a. v. hern\u00b4andez, e. w. steyerberg, and j. d. f. habbema. covariate ad-\njustment in randomized controlled trials with dichotomous outcomes increases\nstatistical power and reduces sample size requirements. j clin epi, 57:454\u2013460,\n2004. (cid:11)231\ncomm stat th meth, 19:639\u2013663, 1990. (cid:11)408, 409, 424\n\n286. j. e. herndon and f. e. harrell. the restricted cubic spline hazard model.\n\n287. j. e. herndon and f. e. harrell. the restricted cubic spline as baseline hazard in\nthe proportional hazards model with step function time-dependent covariables.\nstat med, 14:2119\u20132129, 1995. (cid:11)408, 424, 501, 518\n\n288. i. hertz-picciotto and b. rockhill. validity and efficiency of approximation\nmethods for tied survival times in cox regression. biometrics, 53:1151\u20131156,\n1997. (cid:11)477\n289. k. r. hess. assessing time-by-covariate interactions in proportional hazards\nregression models using cubic spline functions. stat med, 13:1045\u20131062, 1994. (cid:11)\n501\nhazards assumption in cox regression. stat med, 14:1707\u20131723, 1995. (cid:11)518\n\n290. k. r. hess. graphical methods for assessing violations of the proportional\n\n291. t. hielscher, m. zucknick, w. werft, and a. benner. on the prognostic value\nof survival models with application to gene expression signatures. stat med,\n29:818\u2013829, 2010. (cid:11)518, 519\n\n292. j. hilden and t. a. gerds. a note on the evaluation of novel biomarkers: do not\nrely on integrated discrimination improvement and net reclassification index.\nstatist. med., 33(19):3405\u20133414, aug. 2014. (cid:11)101\nmed, 14:2023\u20132036, 1995. (cid:11)450\nselected cutpoints. stat med, 15:103\u2013112, 1996. (cid:11)11, 19\n\n294. s. g. hilsenbeck and g. m. clark. practical p-value adjustment for optimally\n\n293. s. l. hillis. residual plots for the censored data linear regression model. stat\n\n "}, {"Page_number": 569, "text": "references\n\n553\n\n295. w. hoeffding. a non-parametric test of independence. ann math stat, 19:546\u2013\n\n557, 1948. (cid:11)81, 166\n\n296. h. hofmann. simpson on board the titanic? interactive methods for dealing\nwith multivariate categorical data. stat comp graphics news asa, 9(2):16\u201319,\n1999. http://stat-computing.org/newsletter/issues/scgn-09-2.pdf. (cid:11)291\n297. j. w. hogan and n. m. laird. mixture models for the joint distribution of\nrepeated measures and event times. stat med, 16:239\u2013257, 1997. (cid:11)420\nlongitudinal and failure time data. stat med, 16:259\u2013272, 1997. (cid:11)420\nbands for survival functions. j am stat assoc, 92:215\u2013226, 1997. (cid:11)420\n\n299. m. hollander, i. w. mckeague, and j. yang. likelihood ratio-based confidence\n\n298. j. w. hogan and n. m. laird. model-based approaches to analysing incomplete\n\n300. n. holl\u00a8ander, w. sauerbrei, and m. schumacher. confidence intervals for the\neffect of a prognostic factor after selection of an \u2018optimal\u2019 cutpoint. stat med,\n23:1701\u20131713, 2004. (cid:11)19, 20\n\n301. n. j. horton and k. p. kleinman. much ado about nothing: a comparison of\nmissing data methods and software to fit incomplete data regression models.\nam statistician, 61(1):79\u201390, 2007. (cid:11)59\n\n302. n. j. horton and s. r. lipsitz. multiple imputation in practice: comparison of\nsoftware packages for regression models with missing variables. am statistician,\n55:244\u2013254, 2001. (cid:11)54\n\n303. d. w. hosmer, t. hosmer, s. le cessie, and s. lemeshow. a comparison of\ngoodness-of-fit tests for the logistic regression model. stat med, 16:965\u2013980,\n1997. (cid:11)236\nregression model. comm stat th meth, 9:1043\u20131069, 1980. (cid:11)236\n1989. (cid:11)255, 272\n\n305. d. w. hosmer and s. lemeshow. applied logistic regression. wiley, new york,\n\n304. d. w. hosmer and s. lemeshow. goodness-of-fit tests for the multiple logistic\n\n306. d. w. hosmer and s. lemeshow. confidence interval estimates of an index of\nquality performance based on logistic regression models. stat med, 14:2161\u2013\n2172, 1995. see letter to editor 16:1301-3,1997. (cid:11)272\nmetric models. biometrical j, 50(3):346\u2013363, 2008. (cid:11)xii, 199, 202\n\n307. t. hothorn, f. bretz, and p. westfall. simultaneous inference in general para-\n308. p. hougaard. fundamentals of survival data. biometrics, 55:13\u201322, 1999. (cid:11)400,\n\n309. b. hu, m. palta, and j. shao. properties of r2 statistics for logistic regression.\n\n420, 450\nstat med, 25:1383\u20131395, 2006. (cid:11)272\n\n310. j. huang and d. harrington. penalized partial likelihood regression for right-\ncensored data with bootstrap selection of the penalty parameter. biometrics,\n58:781\u2013791, 2002. (cid:11)215, 478\nand inference. j am stat assoc, 98:663\u2013670, 2003. (cid:11)420\n\n311. y. huang and m. wang. frequency of recurrent events at failure times: modeling\n\n312. p. j. huber. the behavior of maximum likelihood estimates under nonstandard\nconditions. in proceedings of the fifth berkeley symposium on mathematical\nstatistics and probability, volume 1: statistics, pages 221\u2013233. university of\ncalifornia press, berkeley, ca, 1967. (cid:11)196\n\n314. c. m. hurvich and c. tsai. regression and time series model selection in small\n\n313. s. hunsberger, d. murray, c. davis, and r. r. fabsitz. imputation strategies\nfor missing data in a school-based multi-center study: the pathways study. stat\nmed, 20:305\u2013316, 2001. (cid:11)59\nsamples. biometrika, 76:297\u2013307, 1989. (cid:11)214, 215\nin small samples. biometrics, 51:1077\u20131084, 1995. (cid:11)214\nlinear regression. am statistician, 44:214\u2013217, 1990. (cid:11)100\n\n316. c. m. hurvich and c. l. tsai. the impact of model selection on inference in\n\n315. c. m. hurvich and c. tsai. model selection for extended quasi-likelihood models\n\n "}, {"Page_number": 570, "text": "554\n\nreferences\n\n317. l. i. iezzoni. dimensions of risk.\n\n318. r. ihaka and r. gentleman. r: a language for data analysis and graphics. j\n\nin l. i. iezzoni, editor, risk adjustment\nfor measuring health outcomes, chapter 2, pages 29\u2013118. foundation of the\namerican college of healthcare executives, ann arbor, mi, 1994. (cid:11)7\ncomp graph stat, 5:299\u2013314, 1996. (cid:11)127\nanalysis and development. j comp graph stat, 17(4):892\u2013913, 2008. (cid:11)142\n1991. (cid:11)101\n\n320. j. e. jackson. a user\u2019s guide to principal components. wiley, new york,\n\n319. k. imai, g. king, and o. lau. towards a common framework for statistical\n\n321. k. j. janssen, a. r. donders, f. e. harrell, y. vergouwe, q. chen, d. e.\ngrobbee, and k. g. moons. missing covariate data in medical research: to\nimpute is better than to ignore. j clin epi, 63:721\u2013727, 2010. (cid:11)54\n\n322. h. jiang, r. chapell, and j. p. fine. estimating the distribution of nonterminal\nevent time in the presence of mortality or informative dropout. controlled clin\ntrials, 24:135\u2013146, 2003. (cid:11)421\n\n324. i. t. jolliffe. discarding variables in a principal component analysis. i. artificial\n\n323. n. l. johnson, s. kotz, and n. balakrishnan. distributions in statistics: contin-\nuous univariate distributions, volume 1. wiley-interscience, new york, second\nedition, 1994. (cid:11)408\ndata. appl stat, 21:160\u2013173, 1972. (cid:11)101\nedition, 2010. (cid:11)101, 172\n326. m. p. jones. indicator and stratification methods for missing explanatory vari-\nables in multiple linear regression. j am stat assoc, 91:222\u2013230, 1996. (cid:11)49,\n58\n\n325. i. t. jolliffe. principal component analysis. springer-verlag, new york, second\n\n330. j. d. kalbfleisch and r. l. prentice. marginal likelihood based on cox\u2019s regres-\n\n329. a. c. justice, k. e. covinsky, and j. a. berlin. assessing the generalizability\n\n328. m. julien and j. a. hanley. profile-specific survival estimates: making reports\n\n327. l. joseph, p. belisle, h. tamim, and j. s. sampalis. selection bias found in\ninterpreting analyses with missing data for the prehospital index for trauma. j\nclin epi, 57:147\u2013153, 2004. (cid:11)58\nof clinical trials more patient-relevant. ct, 5:107\u2013115, 2008. (cid:11)122\nof prognostic information. ann int med, 130:515\u2013524, 1999. (cid:11)122\nsion and life model. biometrika, 60:267\u2013278, 1973. (cid:11)375, 478\ndata. wiley, new york, 1980. (cid:11)411, 412, 414, 420, 436, 441, 483, 496, 517\n12:1\u201316, 1986. (cid:11)58\nvations. j am stat assoc, 53:457\u2013481, 1958. (cid:11)410\nassoc, 82:1169\u20131176, 1987. (cid:11)406, 514\n\n332. g. kalton and d. kasprzyk. the treatment of missing survey data. surv meth,\n\n333. e. l. kaplan and p. meier. nonparametric estimation from incomplete obser-\n\n331. j. d. kalbfleisch and r. l. prentice. the statistical analysis of failure time\n\n334. t. karrison. restricted mean life with adjustment for covariates. j am stat\n\n335. t. g. karrison. use of irwin\u2019s restricted mean as an index for comparing sur-\nvival in different treatment groups\u2014interpretation and power considerations.\ncontrolled clin trials, 18:151\u2013167, 1997. (cid:11)406, 503\nmodel. stat med, 28:1957\u20131966, 2009. (cid:11)104\n1995. (cid:11)71, 214\n\n336. j. karvanen and f. e. harrell. visualizing covariates in proportional hazards\n\n337. r. e. kass and a. e. raftery. bayes factors. j am stat assoc, 90:773\u2013795,\n\n338. m. w. kattan, g. heller, and m. f. brennan. a competing-risks nomogram\nfor sarcoma-specific death following local recurrence. stat med, 22:3515\u20133525,\n2003. (cid:11)519\n23\u201326, feb. 2010. (cid:11)104, 122\n\n339. m. w. kattan and j. marasco. what is a real nomogram? sem onc, 37(1):\n\n "}, {"Page_number": 571, "text": "references\n\n555\n\n340. r. kay. treatment effects in competing-risks analysis of prostate cancer data.\n\n342. s. kele\u00b8s and m. r. segal. residual-based tree-structured survival analysis. stat\n\nbiometrics, 42:203\u2013211, 1986. (cid:11)276, 414, 495\n341. r. kay and s. little. assessing the fit of the logistic model: a case study of\nchildren with the haemolytic uraemic syndrome. appl stat, 35:16\u201330, 1986. (cid:11)\n272\nmed, 21:313\u2013326, 2002. (cid:11)41\nto childhood infectious diseases. stat med, 19:13\u201333, 2000. (cid:11)421\ntrials to individual patients. jama, 298:1209\u20131212, 2007. (cid:11)4\nbiometrika, 75:525\u2013534, 1988. (cid:11)505\n\n344. d. m. kent and r. hayward. limitations of applying summary results of clinical\n\n345. j. t. kent and j. o\u2019quigley. measures of dependence for censored survival data.\n\n343. p. j. kelly and l. lim. survival analysis for recurrent event data: an application\n\n346. m. g. kenward, i. r. white, and j. r. carpener. should baseline be a covariate\nor dependent variable in analyses of change from baseline in clinical trials? (letter\nto the editor). stat med, 29:1455\u20131456, 2010. (cid:11)160\n\n347. h. j. keselman, j. algina, r. k. kowalchuk, and r. d. wolfinger. a comparison\nof two approaches for selecting covariance structures in the analysis of repeated\nmeasurements. comm stat - sim comp, 27:591\u2013604, 1998. (cid:11)69, 160\n\n348. v. kipnis. relevancy criterion for discriminating among alternative model spec-\nifications. in k. berk and l. malone, editors, proceedings of the 21st sympo-\nsium on the interface between computer science and statistics, pages 376\u2013381,\nalexandria, va, 1989. american statistical association. (cid:11)123\n\n349. j. p. klein, n. keiding, and e. a. copelan. plotting summary predictions in\nmultistate survival models: probabilities of relapse and death in remission for\nbone marrow transplantation patients. stat med, 12:2314\u20132332, 1993. (cid:11)415\nand truncated data. springer, new york, 1997. (cid:11)420, 517\n\n350. j. p. klein and m. l. moeschberger. survival analysis: techniques for censored\n\n351. w. a. knaus, f. e. harrell, c. j. fisher, d. p. wagner, s. m. opan, j. c.\nsadoff, e. a. draper, c. a. walawander, k. conboy, and t. h. grasela. the\nclinical evaluation of new drugs for sepsis: a prospective study design based on\nsurvival analysis. jama, 270:1233\u20131241, 1993. (cid:11)4\n\n352. w. a. knaus, f. e. harrell, j. lynn, l. goldman, r. s. phillips, a. f. connors,\nn. v. dawson, w. j. fulkerson, r. m. califf, n. desbiens, p. layde, r. k. oye,\np. e. bellamy, r. b. hakim, and d. p. wagner. the support prognostic\nmodel: objective estimates of survival for seriously ill hospitalized adults. ann\nint med, 122:191\u2013203, 1995. (cid:11)59, 84, 86, 453\n\n353. m. j. knol, k. j. m. janssen, r. t. donders, a. c. g. egberts, e. r. heerding,\nd. e. grobbee, k. g. m. moons, and m. i. geerlings. unpredictable bias\nwhen using the missing indicator method or complete case analysis for missing\nconfounder values: an empirical example. j clin epi, 63:728\u2013736, 2010. (cid:11)47, 49\n354. g. g. koch, i. a. amara, and j. m. singer. a two-stage procedure for the\nanalysis of ordinal categorical data.\nin p. k. sen, editor, biostatistics:\nstatistics in biomedical, public health and environmental sciences. elsevier\nscience publishers b. v. (north-holland), amsterdam, 1985. (cid:11)324\nisbn-10: 0-521-60827-9; isbn-13: 978-0-521-60827-5. (cid:11)360\n\n355. r. koenker. quantile regression. cambridge university press, new york, 2005.\n356. r. koenker. quantreg: quantile regression, 2009. r package version 4.38. (cid:11)\n\n357. r. koenker and g. bassett. regression quantiles. econometrica, 46:33\u201350, 1978.\n\n131, 360\n(cid:11)131, 360, 392\n\n358. m. t. koller, h. raatz, e. w. steyerberg, and m. wolbers. competing risks\nand the clinical community: irrelevance or ignorance? stat med, 31(11\u201312):1089\u2013\n1097, 2012. (cid:11)420\n\n "}, {"Page_number": 572, "text": "556\n\nreferences\n\n359. s. konishi and g. kitagawa.\n\ninformation criteria and statistical modeling.\n\n361. c. kooperberg, c. j. stone, and y. k. truong. hazard regression. j am stat\n\n362. e. l. korn and f. j. dorey. applications of crude incidence curves. stat med,\n\n363. e. l. korn and b. i. graubard. analysis of large health surveys: accounting\n\n360. c. kooperberg and d. b. clarkson. hazard regression with interval-censored\n\nspringer, new york, 2008. isbn 978-0-387-71886-6. (cid:11)204\ndata. biometrics, 53:1485\u20131494, 1997. (cid:11)420, 450\nassoc, 90:78\u201394, 1995. (cid:11)178, 419, 420, 422, 424, 450, 473, 506, 508, 518, 530\n11:813\u2013829, 1992. (cid:11)416\nfor the sampling design. j roy stat soc a, 158:263\u2013295, 1995. (cid:11)208\nestimates from a sample survey. am statistician, 49:291\u2013295, 1995. (cid:11)208\nstat med, 9:487\u2013503, 1990. (cid:11)206, 215, 505, 519\ngoodness of fit. am statistician, 45:201\u2013206, 1991. (cid:11)206, 215, 273\nfied proportional hazards models. biometrics, 46:375\u2013380, 1990. (cid:11)502\nsas publishing, cary, nc, second edition, 2009. (cid:11)82, 167\n\n367. d. kronborg and p. aaby. piecewise comparison of survival functions in strati-\n\n365. e. l. korn and r. simon. measures of explained variation for survival data.\n\n364. e. l. korn and b. i. graubard. examples of differing weighted and unweighted\n\n366. e. l. korn and r. simon. explained residual variation, explained risk, and\n\n368. w. f. kuhfeld. the prinqual procedure. in sas/stat 9.2 user\u2019s guide.\n\n369. g. p. s. kwong and j. l. hutton. choice of parametric models in survival\nanalysis: applications to monotherapy for epilepsy and cerebral palsy. appl\nstat, 52:153\u2013168, 2003. (cid:11)450\n\n370. j. m. lachin and m. a. foulkes. evaluation of sample size and power for analyses\nof survival with allowance for nonuniform patient entry, losses to follow-up,\nnoncompliance, and stratification. biometrics, 42:507\u2013519, 1986. (cid:11)513\nma, second edition, 1994. (cid:11)536\n\n371. l. lamport. latex: a document preparation system. addison-wesley, reading,\n\n372. r. lancar, a. kramar, and c. haie-meder. non-parametric methods for\nanalysing recurrent complications of varying severity. stat med, 14:2701\u20132712,\n1995. (cid:11)421\n\n373. j. m. landwehr, d. pregibon, and a. c. shoemaker. graphical methods for\nassessing logistic regression models (with discussion). j am stat assoc, 79:61\u2013\n83, 1984. (cid:11)272, 315\nregression. am statistician, 48:315\u2013321, 1994. (cid:11)199\n\n374. t. p. lane and w. h. dumouchel. simultaneous confidence intervals in multiple\n\n376. m. g. larson and g. e. dinse. a mixture model for the regression analysis of\n\n375. k. larsen and j. merlo. appropriate assessment of neighborhood effects on\nindividual health: integrating random and fixed effects in multilevel logistic re-\ngression. american journal of epidemiology, 161(1):81\u201388, jan. 2005. (cid:11)122\ncompeting risks data. appl stat, 34:201\u2013211, 1985. (cid:11)276, 414\n57:247\u2013262, 1995. (cid:11)214\n\n377. p. w. laud and j. g. ibrahim. predictive model selection. j roy stat soc b,\n\n378. a. laupacis, n. sekar, and i. g. stiell. clinical prediction rules: a review\nand suggested modifications of methodological standards. jama, 277:488\u2013494,\n1997. (cid:11)x, 6\n\n379. b. lausen and m. schumacher. evaluating the effect of optimized cutoff values\nin the assessment of prognostic factors. comp stat data analysis, 21(3):307\u2013\n326, 1996. (cid:11)11, 19\n\n380. p. w. lavori, r. dawson, and t. b. mueller. causal estimation of time-varying\ntreatment effects in observational studies: application to depressive disorder.\nstat med, 13:1089\u20131100, 1994. (cid:11)231\n381. p. w. lavori, r. dawson, and d. shera. a multiple imputation strategy for\nclinical trials with truncation of patient data. stat med, 14:1913\u20131925, 1995. (cid:11)\n47\n\n "}, {"Page_number": 573, "text": "references\n\n557\n\n382. j. f. lawless. statistical models and methods for lifetime data. wiley, new\n\n383. j. f. lawless. the analysis of recurrent events for multiple subjects. appl stat,\n\n384. j. f. lawless and c. nadeau. some simple robust methods for the analysis of\n\n386. j. f. lawless and y. yuan. estimation of prediction error for survival models.\n\n385. j. f. lawless and k. singhal. efficient screening of nonnormal regression models.\n\nyork, 1982. (cid:11)420, 450, 485, 517\n44:487\u2013498, 1995. (cid:11)421\nrecurrent events. technometrics, 37:158\u2013168, 1995. (cid:11)420, 421\nbiometrics, 34:318\u2013327, 1978. (cid:11)70, 137\nstat med, 29:262\u2013274, 2010. (cid:11)519\n387. s. le cessie and j. c. van houwelingen. a goodness-of-fit test for binary regres-\nsion models, based on smoothing methods. biometrics, 47:1267\u20131282, 1991. (cid:11)\n236\nappl stat, 41:191\u2013201, 1992. (cid:11)77, 209\n88:457\u2013467, 1993. (cid:11)41\n89:53\u201364, 1994. (cid:11)101\n\n388. s. le cessie and j. c. van houwelingen. ridge estimators in logistic regression.\n\n389. m. leblanc and j. crowley. survival trees by goodness of fit. j am stat assoc,\n\n390. m. leblanc and r. tibshirani. adaptive principal surfaces. j am stat assoc,\n\n391. a. leclerc, d. luce, f. lert, j. f. chastang, and p. logeay. correspondence\nanalysis and logistic modelling: complementary use in the analysis of a health\nsurvey among nurses. stat med, 7:983\u2013995, 1988. (cid:11)81\npublications, belmont, ca, second edition, 1980. (cid:11)420\n\n392. e. t. lee. statistical methods for survival data analysis. lifetime learning\n\n393. e. w. lee, l. j. wei, and d. a. amato. cox-type regression analysis for large\nnumbers of small groups of correlated failure time observations. in j. p. klein\nand p. k. goel, editors, survival analysis: state of the art, nato asi, pages\n237\u2013247. kluwer academic, boston, 1992. (cid:11)197\ncharts. am statistician, 54:63\u201370, 2000. (cid:11)418, 420\n\n394. j. j. lee, k. r. hess, and j. a. dubin. extensions and applications of event\n\n396. s. lee, j. z. huang, and j. hu. sparse logistic principal components analysis\n\n395. k. l. lee, d. b. pryor, f. e. harrell, r. m. califf, v. s. behar, w. l. floyd, j. j.\nmorris, r. a. waugh, r. e. whalen, and r. a. rosati. predicting outcome in\ncoronary disease: statistical models versus expert clinicians. am j med, 80:553\u2013\n560, 1986. (cid:11)205\nfor binary data. ann appl stat, 4(3):1579\u20131601, 2010. (cid:11)101\ndevelopments. statistical sci, 5:160\u2013168, 1990. (cid:11)8, 10\nthe cox model. stat med, 26:2686\u20132698, 2007. (cid:11)501\n\n398. s. lehr and m. schemper. parsimonious analysis of time-dependent effects in\n\n397. e. l. lehmann. model specification: the views of fisher and neyman and later\n\n399. f. leisch. sweave: dynamic generation of statistical reports using literate\ndata analysis. in w. h\u00a8ardle and b. r\u00a8onz, editors, compstat 2002 \u2014 proceed-\nings in computational statistics, pages 575\u2013580. physica verlag, heidelberg,\n2002. isbn 3-7908-1517-9. (cid:11)138\nhazards model. biometrics, 60:75\u201384, 2004. (cid:11)518\n\n400. l. f. le\u00b4on and c. tsai. functional form diagnostics for cox\u2019s proportional\n\n402. c. li and b. e. shepherd. a new residual for ordinal outcomes. biometrika,\n\n401. m. a. h. levine, a. i. el-nahas, and b. asa. relative risk and odds ratio data\nare still portrayed with inappropriate scales in the medical literature. j clin\nepi, 63:1045\u20131047, 2010. (cid:11)122\n99(2):473\u2013480, 2012. (cid:11)315\nann stat, 27:1\u201323, 1999. (cid:11)101\n86:316\u2013327, 1991. (cid:11)101\n\n403. k. li, j. wang, and c. chen. dimension reduction for censored regression data.\n\n404. k. c. li. sliced inverse regression for dimension reduction. j am stat assoc,\n\n "}, {"Page_number": 574, "text": "558\n\nreferences\n\n405. k.-y. liang and s. l. zeger. longitudinal data analysis of continuous and\n\n407. d. y. lin. cox regression analysis of multivariate failure time data: the marginal\n\n408. d. y. lin. non-parametric inference for cumulative incidence functions in com-\n\n406. j. g. liao and d. mcgee. adjusted coefficients of determination for logistic\n\n409. d. y. lin. on fitting cox\u2019s proportional hazards models to survey data.\n\ndiscrete responses for pre-post designs. sankhy\u00afa, 62:134\u2013148, 2000. (cid:11)160\nregression. am statistician, 57:161\u2013165, 2003. (cid:11)273\napproach. stat med, 13:2233\u20132247, 1994. (cid:11)197, 213, 417, 418\npeting risks studies. stat med, 16:901\u2013910, 1997. (cid:11)415\nbiometrika, 87:37\u201347, 2000. (cid:11)215\nmodel. j am stat assoc, 84:1074\u20131078, 1989. (cid:11)197, 213, 487\nsums of martingale-based residuals. biometrika, 80:557\u2013572, 1993. (cid:11)518\nwith informative drop-outs. biostatistics, 4:385\u2013398, 2003. (cid:11)47\ncensored data. stat med, 17:219\u2013238, 1998. (cid:11)420\n\n413. j. c. lindsey and l. m. ryan. tutorial in biostatistics: methods for interval-\n414. j. k. lindsey. models for repeated measurements. clarendon press, 1997. (cid:11)143\n415. j. k. lindsey and b. jones. choosing among generalized linear models applied\n\n411. d. y. lin, l. j. wei, and z. ying. checking the cox model with cumulative\n\n412. d. y. lin and z. ying. semiparametric regression analysis of longitudinal data\n\n410. d. y. lin and l. j. wei. the robust inference for the cox proportional hazards\n\n418. r. little and h. an. robust likelihood-based analysis of multivariate data with\n\n417. s. r. lipsitz, l. p. zhao, and g. molenberghs. a semiparametric method of\n\n416. k. linnet. assessing diagnostic tests by a strictly proper scoring rule. stat med,\n\nto medical data. stat med, 17:59\u201368, 1998. (cid:11)11\n8:609\u2013618, 1989. (cid:11)114, 123, 257, 258\nmultiple imputation. j roy stat soc b, 60:127\u2013144, 1998. (cid:11)54\nmissing values. statistica sinica, 14:949\u2013968, 2004. (cid:11)57, 59\nnew york, 1998. (cid:11)59\n6:287\u2013296, 1988. (cid:11)51\n87:1227\u20131237, 1992. (cid:11)50, 51, 54\nnew york, second edition, 2002. (cid:11)48, 52, 54, 59\n\n420. r. j. a. little. missing-data adjustments in large surveys. j bus econ stat,\n\n421. r. j. a. little. regression with missing x\u2019s: a review. j am stat assoc,\n\n422. r. j. a. little and d. b. rubin. statistical analysis with missing data. wiley,\n\n419. r. j. little. missing data. in ency of biostatistics, pages 2622\u20132635. wiley,\n\n423. g. f. liu, k. lu, r. mogg, m. mallick, and d. v. mehrotra. should baseline be\na covariate or dependent variable in analyses of change from baseline in clinical\ntrials? stat med, 28:2509\u20132530, 2009. (cid:11)160\n\n426. j. s. long and l. h. ervin. using heteroscedasticity consistent standard errors\n\n425. r. lockhart, j. taylor, r. j. tibshirani, and r. tibshirani. a significance test\n\n424. k. liu and a. r. dyer. a rank statistic for assessing the amount of variation\nexplained by risk factors in epidemiologic studies. am j epi, 109:597\u2013606, 1979.\n(cid:11)206, 256\nfor the lasso. technical report, arxiv, 2013. (cid:11)68\nin the linear regression model. am statistician, 54:217\u2013224, 2000. (cid:11)213\n427. j. lubsen, j. pool, and e. van der does. a practical device for the application\nof a diagnostic or prognostic function. meth info med, 17:127\u2013129, 1978. (cid:11)104\n428. d. j. lunn, j. wakefield, and a. racine-poon. cumulative logit models for\nordinal data: a case study involving allergic rhinitis severity scores. stat med,\n20:2261\u20132285, 2001. (cid:11)324\nrics, 51:524\u2013532, 1995. (cid:11)420\nby adding noise. technometrics, 48:165\u2013175, 2006. (cid:11)11, 100\n\n429. m. lunn and d. mcneil. applying cox regression to competing risks. biomet-\n\n430. x. luo, l. a. stfanski, and d. d. boos. tuning variable selection procedures\n\n "}, {"Page_number": 575, "text": "references\n\n559\n\n431. g. s. maddala. limited-dependent and qualitative variables in econometrics.\n\n432. l. magee. r2 measures based on wald and likelihood ratio joint significance\n\ncambridge university press, cambridge, uk, 1983. (cid:11)206, 256, 505\ntests. am statistician, 44:250\u2013253, 1990. (cid:11)206, 256, 505\n22, 1998. (cid:11)21\n\n433. l. magee. nonlocal behavior in polynomial regressions. am statistician, 52:20\u2013\n434. c. mallows. the zeroth problem. am statistician, 52:1\u20139, 1998. (cid:11)11\n435. m. mandel. censoring and truncation\u2014highlighting the differences. am statis-\n\n436. m. mandel, n. galae, and e. simchen. evaluating survival model performance:\n\ntician, 61(4):321\u2013324, 2007. (cid:11)420\na graphical approach. stat med, 24:1933\u20131945, 2005. (cid:11)518\n12:621\u2013625, 1970. (cid:11)70\n\n437. n. mantel. why stepdown procedures in variable selection. technometrics,\n\n438. n. mantel and d. p. byar. evaluation of response-time data involving transient\nstates: an illustration using heart-transplant data. j am stat assoc, 69:81\u201386,\n1974. (cid:11)401, 420\n\n439. p. margolis, e. k. mulholland, f. e. harrell, s. gove, and the who young\ninfants study group. clinical prediction of serious bacterial infections in young\ninfants in developing countries. pediatr infect dis j, 18s:s23\u2013s31, 1999. (cid:11)327\n440. d. b. mark, m. a. hlatky, f. e. harrell, k. l. lee, r. m. califf, and d. b. pryor.\nexercise treadmill score for predicting prognosis in coronary artery disease. ann\nint med, 106:793\u2013800, 1987. (cid:11)512\n\n442. g. marshall, b. warner, s. mawhinney, and k. hammermeister. prospective\n\n441. g. marshall, f. l. grover, w. g. henderson, and k. e. hammermeister. as-\nsessment of predictive models for binary outcomes: an empirical approach using\noperative death from cardiac surgery. stat med, 13:1501\u20131511, 1994. (cid:11)101\nprediction in the presence of missing data. stat med, 21:561\u2013570, 2002. (cid:11)57\nology. j clin epi, 54:603\u2013609, 2001. (cid:11)41\n444. e. marubini and m. g. valsecchi. analyzing survival data from clinical trials\nand observational studies. wiley, chichester, 1995. (cid:11)213, 214, 415, 420, 501,\n517\n\n443. r. j. marshall. the use of classification and regression trees in clinical epidemi-\n\n445. j. m. massaro. battery reduction. 2005. (cid:11)87\n446. s. e. maxwell and h. d. delaney. bivariate median splits and spurious statistical\n\nsignificance. psych bull, 113:181\u2013190, 1993. (cid:11)19\n\n447. m. may, p. royston, m. egger, a. c. justice, and j. a. c. sterne. develop-\nment and validation of a prognostic model for survival time data: application\nto prognosis of hiv positive patients treated with antiretroviral therapy. stat\nmed, 23:2375\u20132398, 2004. (cid:11)505\n\n448. g. p. mccabe. principal variables. technometrics, 26:137\u2013144, 1984. (cid:11)101\n449. p. mccullagh. regression models for ordinal data. j roy stat soc b, 42:109\u2013\n\n450. p. mccullagh and j. a. nelder. generalized linear models. chapman and\n\n142, 1980. (cid:11)313, 324\nhall/crc, second edition, aug. 1989. (cid:11)viii\ndata. demography, 14:245\u2013252, 1977. (cid:11)40\n\n451. d. r. mcneil, j. trussell, and j. c. turner. spline interpolation of demographic\n\n453. n. meinshausen. hierarchical testing of variable importance. biometrika,\n\n452. w. q. meeker and l. a. escobar. teaching about approximate confidence\nregions based on maximum likelihood estimation. am statistician, 49:48\u201353,\n1995. (cid:11)214\n95(2):265\u2013278, 2008. (cid:11)101\nam statistician, 54:17\u201324, 2000. (cid:11)215, 272\nstat sci, 9:538\u2013558, 1994. (cid:11)58\n\n454. s. menard. coefficients of determination for multiple logistic regression analysis.\n\n455. x. meng. multiple-imputation inferences with uncongenial sources of input.\n\n "}, {"Page_number": 576, "text": "560\n\nreferences\n\n456. g. michailidis and j. de leeuw. the gifi system of descriptive multivariate\n\nanalysis. statistical sci, 13:307\u2013336, 1998. (cid:11)81\nregression models. stat med, 10:1213\u20131226, 1991. (cid:11)259\n\n457. m. e. miller, s. l. hui, and w. m. tierney. validation techniques for logistic\n\n458. m. e. miller, t. m. morgan, m. a. espeland, and s. s. emerson. group com-\nparisons involving missing data in clinical trials: a comparison of estimates and\npower (size) for some simple approaches. stat med, 20:2383\u20132397, 2001. (cid:11)58\n459. r. g. miller. what price kaplan\u2013meier? biometrics, 39:1077\u20131081, 1983. (cid:11)420\n460. s. minkin. profile-likelihood-based confidence intervals. appl stat, 39:125\u2013126,\n\n1990. (cid:11)214\nmed, 15:1987\u20131997, 1996. (cid:11)215, 273\n\n461. m. mittlb\u00a8ock and m. schemper. explained variation for logistic regression. stat\n\n462. k. g. m. moons, donders, e. w. steyerberg, and f. e. harrell. penalized max-\nimum likelihood estimation to directly adjust diagnostic and prognostic predic-\ntion models for overoptimism: a clinical example. j clin epi, 57:1262\u20131270,\n2004. (cid:11)215, 273, 356\n\n464. b. j. t. morgan, k. j. palmer, and m. s. ridout. negative score test statistic\n\n463. k. g. m. moons, r. a. r. t. donders, t. stijnen, and f. e. harrell. using the\noutcome for imputation of missing predictor values was preferred. j clin epi,\n59:1092\u20131101, 2006. (cid:11)54, 55, 59\n(with discussion). am statistician, 61(4):285\u2013295, 2007. (cid:11)213\nwithout dichotomizing. stat med, 23:1843\u20131860, 2004. (cid:11)19\n\n465. b. k. moser and l. p. coombs. odds ratios for a continuous outcome variable\n\n466. g. s. mudholkar, d. k. srivastava, and g. d. kollia. a generalization of the\nweibull distribution with application to the analysis of survival data. j am stat\nassoc, 91:1575\u20131583, 1996. (cid:11)420\nii. ca invest, 1:537\u2013545, 1983. (cid:11)495, 502\nproblem. stat med, 29:1947\u20131957, 2010. (cid:11)518\n\n467. l. r. muenz. comparing survival distributions: a review for nonstatisticians.\n\n468. v. m. r. muggeo and m. tagliavia. a flexible approach to the crossing hazards\n\n470. r. h. myers. classical and modern regression with applications. pws-kent,\n\n469. h. murad, a. fleischman, s. sadetzki, o. geyer, and l. s. freedman. small\nsamples and ordered logistic regression: does it help to collapse categories of\noutcome? am statistician, 57:155\u2013160, 2003. (cid:11)324\nboston, 1990. (cid:11)78\nmination. biometrika, 78:691\u2013692, 1991. (cid:11)206, 256, 505\ndata. technometrics, 14:945\u2013965, 1972. (cid:11)413\n\n471. n. j. d. nagelkerke. a note on a general definition of the coefficient of deter-\n\n472. w. b. nelson. theory and applications of hazard plotting for censored failure\n\n473. r. newson. parameters behind \u201cnonparametric\u201d statistics: kendall\u2019s tau,\nsomers\u2019 d and median differences. stata journal, 2(1), 2002. http://www.\nstata-journal.com/article.html?article=st0007. (cid:11)273\nstata j, 6(3):309\u2013334, 2006. (cid:11)273\n\n474. r. newson. confidence intervals for rank statistics: somers\u2019 d and extensions.\n\n475. n. h. ng\u2019andu. an empirical comparison of statistical tests for assessing the\nproportional hazards assumption of cox\u2019s model. stat med, 16:611\u2013626, 1997.\n(cid:11)518\n\n476. t. g. nick and j. m. hardin. regression modeling strategies: an illustrative\ncase study from medical rehabilitation outcomes research. am j occ ther,\n53:459\u2013470, 1999. (cid:11)viii, 100\n\n477. m. a. nicolaie, h. c. van houwelingen, t. m. de witte, and h. putter. dynamic\nprediction by landmarking in competing risks. stat med, 32(12):2031\u20132047,\n2013. (cid:11)447\nevents under informative censoring. stat med, 25:3981\u20134003, 2006. (cid:11)420\n\n478. m. nishikawa, t. tango, and m. ogawa. non-parametric inference of adverse\n\n "}, {"Page_number": 577, "text": "references\n\n561\n\n479. p. c. o\u2019brien. comparing two samples: extensions of the t, rank-sum, and\n\n481. j. o\u2019quigley, r. xu, and j. stare. explained randomness in proportional hazards\n\nlog-rank test. j am stat assoc, 83:52\u201361, 1988. (cid:11)231\n480. p. c. o\u2019brien, d. zhang, and k. r. bailey. semi-parametric and non-parametric\nmethods for clinical trials with incomplete data. stat med, 24:341\u2013358, 2005. (cid:11)\n47\nmodels. stat med, 24(3):479\u2013489, 2005. (cid:11)505\nr package version 2.37-7. (cid:11)131\nteractions. biostat, 9(1):30\u201350, 2008. (cid:11)215\nwiley, chichester, 1995. (cid:11)420\n\n482. w. original. survival: survival analysis, including penalised likelihood, 2009.\n\n483. m. y. park and t. hastie. penalized logistic regression for detecting gene in-\n\n484. m. k. b. parmar and d. machin. survival analysis: a practical approach.\n\n485. d. paul, e. bair, t. hastie, and r. tibshirani. \u201cpreconditioning\u201d for feature\nselection and regression in high-dimensional problems. ann stat, 36(4):1595\u2013\n1619, 2008. (cid:11)121\n\n486. p. peduzzi, j. concato, a. r. feinstein, and t. r. holford.\n\nimportance of\nevents per independent variable in proportional hazards regression analysis. ii.\naccuracy and precision of regression estimates. j clin epi, 48:1503\u20131510, 1995.\n(cid:11)100\n\n487. p. peduzzi, j. concato, e. kemper, t. r. holford, and a. r. feinstein. a simu-\nlation study of the number of events per variable in logistic regression analysis.\nj clin epi, 49:1373\u20131379, 1996. (cid:11)73, 100\n\n488. n. peek, d. g. t. arts, r. j. bosman, p. h. j. van der voort, and n. f.\nde keizer. external validation of prognostic models for critically ill patients\nrequired substantial sample sizes. j clin epi, 60:491\u2013501, 2007. (cid:11)93\n\n489. m. j. pencina and r. b. d\u2019agostino. overall c as a measure of discrimination\nin survival analysis: model specific population value and confidence interval\nestimation. stat med, 23:2109\u20132123, 2004. (cid:11)519\n\n490. m. j. pencina, r. b. d\u2019agostino, and o. v. demler. novel metrics for eval-\nuating improvement in discrimination: net reclassification and integrated dis-\ncrimination improvement for normal variables and nested models. stat med,\n31(2):101\u2013113, 2012. (cid:11)101, 142, 273\n\n491. m. j. pencina, r. b. d\u2019agostino, and l. song. quantifying discrimination\nof framingham risk functions with different survival c statistics. stat med,\n31(15):1543\u20131553, 2012. (cid:11)519\n\n492. m. j. pencina, r. b. d\u2019agostino, and e. w. steyerberg. extensions of net re-\nclassification improvement calculations to measure usefulness of new biomarkers.\nstat med, 30:11\u201321, 2011. (cid:11)101, 142\n\n493. m. j. pencina, r. b. d\u2019agostino sr, r. b. d\u2019agostino jr, and r. s. vasan.\nevaluating the added predictive ability of a new marker: from area under the\nroc curve to reclassification and beyond. stat med, 27:157\u2013172, 2008. (cid:11)93,\n101, 142, 273\n494. m. s. pepe.\nstudies. j am stat assoc, 86:770\u2013778, 1991. (cid:11)415\n\ninference for events with dependent risks in multiple endpoint\n\n495. m. s. pepe and j. cai. some graphical displays and marginal regression analyses\nfor recurrent failure times and time dependent covariates. j am stat assoc,\n88:811\u2013820, 1993. (cid:11)417\n\n496. m. s. pepe, g. longton, and m. thornquist. a qualifier q for the survival\nfunction to describe the prevalence of a transient condition. stat med, 10:\n413\u2013421, 1991. (cid:11)415\n\n497. m. s. pepe and m. mori. kaplan\u2013meier, marginal or conditional probabil-\nity curves in summarizing competing risks failure time data? stat med, 12:\n737\u2013751, 1993. (cid:11)415\n\n "}, {"Page_number": 578, "text": "562\n\nreferences\n\n498. a. perperoglou, a. keramopoullos, and h. c. van houwelingen. approaches\nin modelling long-term survival: an application to breast cancer. stat med,\n26:2666\u20132685, 2007. (cid:11)501, 518\n\n499. a. perperoglou, s. le cessie, and h. c. van houwelingen. reduced-rank hazard\nregression for modelling non-proportional hazards. stat med, 25:2831\u20132845,\n2006. (cid:11)518\n\n500. s. a. peters, m. l. bots, h. m. den ruijter, m. k. palmer, d. e. grobbee, j. r.\ncrouse, d. h. o\u2019leary, g. w. evans, j. s. raichlen, k. g. moons, h. koffijberg,\nand meteor study group. multiple imputation of missing repeated outcome\nmeasurements did not add to linear mixed-effects models. j clin epi, 65(6):686\u2013\n695, 2012. (cid:11)160\n501. b. peterson and s. l. george. sample size requirements and length of study for\ntesting interaction in a 1\u00d7k factorial design when time-to-failure is the outcome.\ncontrolled clin trials, 14:511\u2013522, 1993. (cid:11)513\nresponse variables. appl stat, 39:205\u2013217, 1990. (cid:11)315, 321, 324\ntional hazards model. appl stat, 39:313\u2013329, 1990. (cid:11)498, 518\n\n502. b. peterson and f. e. harrell. partial proportional odds models for ordinal\n\n503. a. n. pettitt and i. bin daud. investigating time dependence in cox\u2019s propor-\n\n505. r. r. picard and k. n. berk. data splitting. am statistician, 44:140\u2013147, 1990.\n\n506. r. r. picard and r. d. cook. cross-validation of regression models. j am stat\n\n504. a. n. phillips, s. g. thompson, and s. j. pocock. prognostic scores for detecting\na high risk group: estimating the sensitivity when applied to new data. stat\nmed, 9:1189\u20131198, 1990. (cid:11)100, 101\n(cid:11)122\nassoc, 79:575\u2013583, 1984. (cid:11)123\nment. stat comp graphics news asa, 2(2):6\u201315, nov. 1991. (cid:11)213\nesis. biometrics, 22:142\u2013161, 1966. (cid:11)441, 442, 443, 480\nspringer, new york, 2000. (cid:11)131, 143, 146, 147, 148\n\n509. j. c. pinheiro and d. m. bates. mixed-effects models in s and s-plus.\n\n507. l. w. pickle. maximum likelihood estimation in the new computing environ-\n\n508. m. c. pike. a method of analysis of certain class of experiments in carcinogen-\n\n510. r. f. potthoff and s. n. roy. a generalized multivariate analysis of variance\nmodel useful especially for growth curve problems. biometrika, 51:313\u2013326,\n1964. (cid:11)146\n511. d. pregibon. logistic regression diagnostics. ann stat, 9:705\u2013724, 1981. (cid:11)255\n512. d. pregibon. resistant fits for some commonly used logistic models with medical\n\napplications. biometrics, 38:485\u2013498, 1982. (cid:11)272\n\n513. r. l. prentice, j. d. kalbfleisch, a. v. peterson, n. flournoy, v. t. farewell,\nand n. e. breslow. the analysis of failure times in the presence of competing\nrisks. biometrics, 34:541\u2013554, 1978. (cid:11)414\nanalysis. j am stat assoc, 73:699\u2013705, 1978. (cid:11)272\n\n514. s. j. press and s. wilson. choosing between logistic regression and discriminant\n\n515. d. b. pryor, f. e. harrell, k. l. lee, r. m. califf, and r. a. rosati. estimating\nthe likelihood of significant coronary artery disease. am j med, 75:771\u2013780,\n1983. (cid:11)273\n\n516. d. b. pryor, f. e. harrell, j. s. rankin, k. l. lee, l. h. muhlbaier, h. n. old-\nham, m. a. hlatky, d. b. mark, j. g. reves, and r. m. califf. the changing\nsurvival benefits of coronary revascularization over time. circulation (supple-\nment v), 76:13\u201321, 1987. (cid:11)511\nrisks and multi-state models. stat med, 26:2389\u20132430, 2007. (cid:11)420\n\n517. h. putter, m. fiocco, and r. b. geskus. tutorial in biostatistics: competing\n\n518. h. putter, m. sasako, h. h. hartgrink, c. j. h. van de velde, and j. c. van\nhouwelingen. long-term survival with non-proportional hazards: results from\nthe dutch gastric cancer trial. stat med, 24:2807\u20132821, 2005. (cid:11)518\n\n "}, {"Page_number": 579, "text": "references\n\n563\n\n519. c. quantin, t. moreau, b. asselain, j. maccaria, and j. lellouch. a regression\nsurvival model for testing the proportional hazards assumption. biometrics,\n52:874\u2013885, 1996. (cid:11)518\n520. r development core team. r: a language and environment for statistical\ncomputing. r foundation for statistical computing, vienna, austria, 2013. (cid:11)\n127\n\n521. d. r. ragland. dichotomizing continuous outcome variables: dependence of the\nmagnitude of association and statistical power on the cutpoint. epi, 3:434\u2013440,\n1992. see letters to editor may 1993 p. 274-, vol 4 no. 3. (cid:11)11, 19\n\n523. m. reilly and m. pepe. the relationship between hot-deck multiple imputation\n\n522. b. m. reilly and a. t. evans. translating clinical research into clinical practice:\nimpact of using prediction rules to make decisions. ann int med, 144:201\u2013209,\n2006. (cid:11)6\nand weighted likelihood. stat med, 16:5\u201319, 1997. (cid:11)59\nbiometrics, 51:373\u2013374, 1995. (cid:11)420\n\n524. b. d. ripley and p. j. solomon. statistical models for prevalent cohort data.\n\n525. j. s. roberts and g. m. capalbo. a sas macro for estimating missing values\nin multivariate data. in proceedings of the twelfth annual sas users group\ninternational conference, pages 939\u2013941, cary, nc, 1987. sas institute, inc. (cid:11)\n52\n\n526. j. m. robins, s. d. mark, and w. k. newey. estimating exposure effects by\nmodeling the expectation of exposure conditional on confounders. biometrics,\n48:479\u2013495, 1992. (cid:11)231\njustment in logistic regression models. int stat rev, 59:227\u2013240, 1991. (cid:11)231\ntechnometrics, 33:459\u2013468, 1991. (cid:11)100, 112\n\n527. l. d. robinson and n. p. jewell. some surprising results about covariate ad-\n\n528. e. b. roecker. prediction error and its estimation for subset-selected models.\n\n529. w. h. rogers. regression standard errors in clustered samples. stata tech bull,\nhttp://www.stata.com/products/stb/journals/\n\nstb-13:19\u201323, may 1993.\nstb13.pdf. (cid:11)197\nobservational studies for causal effects. biometrika, 70:41\u201355, 1983. (cid:11)3, 231\n\n530. p. r. rosenbaum and d. rubin. the central role of the propensity score in\n\n531. p. r. rosenbaum and d. b. rubin. assessing sensitivity to an unobserved\nbinary covariate in an observational study with binary outcome. j roy stat soc\nb, 45:212\u2013218, 1983. (cid:11)231\n\n533. p. royston, d. g. altman, and w. sauerbrei. dichotomizing continuous pre-\n\n534. p. royston and s. g. thompson. comparing non-nested regression models.\n\n532. p. royston and d. g. altman. regression using fractional polynomials of con-\ntinuous covariates: parsimonious parametric modelling. applstat, 43:429\u2013453,\n1994. discussion pp. 453\u2013467. (cid:11)40\ndictors in multiple regression: a bad idea. stat med, 25:127\u2013141, 2006. (cid:11)19\nbiometrics, 51:114\u2013127, 1995. (cid:11)215\noverview and some applications. stat med, 10:585\u2013598, 1991. (cid:11)46, 50, 59\nyork, 1987. (cid:11)54, 59\n\n536. d. b. rubin. multiple imputation for nonresponse in surveys. wiley, new\n\n535. d. rubin and n. schenker. multiple imputation in health-care data bases: an\n\n537. s. sahoo and d. sengupta. some diagnostic plots and corrective adjustments for\nthe proportional hazards regression model. j comp graph stat, 20(2):375\u2013394,\n2011. (cid:11)518\n(cid:11)215\n\n538. s. sardy. on the practice of rescaling covariates. int stat rev, 76:285\u2013297, 2008.\n\n539. w. sarle. the varclus procedure. in sas/stat user\u2019s guide, volume 2,\nchapter 43, pages 1641\u20131659. sas institute, inc., cary, nc, fourth edition, 1990.\n(cid:11)79, 81, 101\n\n "}, {"Page_number": 580, "text": "564\n\nreferences\n\n540. sas institute, inc. sas/stat user\u2019s guide, volume 2. sas institute, inc.,\n\ncary nc, fourth edition, 1990. (cid:11)315\n\n541. w. sauerbrei and m. schumacher. a bootstrap resampling procedure for model\nbuilding: application to the cox regression model. stat med, 11:2093\u20132109,\n1992. (cid:11)70, 113, 177\npsych meth, 7:147\u2013177, 2002. (cid:11)58\n\n542. j. l. schafer and j. w. graham. missing data: our view of the state of the art.\n\n543. d. e. schaubel, r. a. wolfe, and r. m. merion. estimating the effect of a\ntime-dependent treatment by levels of an internal time-dependent covariate:\napplication to the contrast between liver wait-list and posttransplant mortality.\nj am stat assoc, 104(485):49\u201359, 2009. (cid:11)518\n\n547. m. schemper. cox analysis of survival data with non-proportional hazard func-\n\n545. m. schemper. non-parametric analysis of treatment-covariate interaction in the\n\n548. m. schemper. further results on the explained variation in proportional hazards\n\n546. m. schemper. the explained variation in proportional hazards regression\n\n544. m. schemper. analyses of associations with censored data by generalized mantel\nand breslow tests and generalized kendall correlation. biometrical j, 26:309\u2013\n318, 1984. (cid:11)518\npresence of censoring. stat med, 7:1257\u20131266, 1988. (cid:11)41\n(correction in 81:631, 1994). biometrika, 77:216\u2013218, 1990. (cid:11)505, 508\ntions. the statistician, 41:445\u2013455, 1992. (cid:11)518\nregression. biometrika, 79:202\u2013204, 1992. (cid:11)505\nvival. stat med, 12:2377\u20132382, 1993. (cid:11)215, 505\n2308, 2003. (cid:11)519\nfactor studies. stat med, 16:73\u201380, 1997. (cid:11)52, 177\ncox regression. biometrics, 56:249\u2013255, 2000. (cid:11)518\npresence of missing covariate values. stat med, 9:777\u2013784, 1990. (cid:11)52\n15:1999\u20132012, 1996. (cid:11)215, 519\n\n550. m. schemper. predictive accuracy and explained variation. stat med, 22:2299\u2013\n\n551. m. schemper and g. heinze. probability imputation revisited for prognostic\n\n553. m. schemper and t. l. smith. efficient evaluation of treatment effects in the\n\n552. m. schemper and r. henderson. predictive accuracy and explained variation in\n\n554. m. schemper and j. stare. explained variation in survival analysis. stat med,\n\n549. m. schemper. the relative importance of prognostic factors in studies of sur-\n\n555. m. schmid and s. potapov. a comparison of estimators to evaluate the dis-\ncriminatory power of time-to-event models. stat med, 31(23):2588\u20132609, 2012.\n(cid:11)519\n\n558. d. a. schoenfeld. sample size formulae for the proportional hazards regression\n\n557. d. schoenfeld. partial residuals for the proportional hazards regression model.\n\n556. c. schmoor, k. ulm, and m. schumacher. comparison of the cox model and\nthe regression tree procedure in analysing a randomized clinical trial. stat med,\n12:2351\u20132366, 1993. (cid:11)41\nbiometrika, 69:239\u2013241, 1982. (cid:11)314, 498, 499, 516\nmodel. biometrics, 39:499\u2013503, 1983. (cid:11)513\npoints in quantitative exposure. am j epi, 120:172\u2013184, 1994. (cid:11)19, 20\n(cid:11)214\noutcomes in comparative studies. j clin epi, 50:45\u201355, 1997. (cid:11)324\n\n561. s. c. scott, m. s. goldberg, and n. e. mayo. statistical assessment of ordinal\n562. m. r. segal. regression trees for censored data. biometrics, 44:35\u201347, 1988. (cid:11)\n\n559. g. schulgen, b. lausen, j. olsen, and m. schumacher. outcome-oriented cut-\n\n560. g. schwarz. estimating the dimension of a model. ann stat, 6:461\u2013464, 1978.\n\n563. s. senn. change from baseline and analysis of covariance revisited. stat med,\n\n41\n25:4334\u20134344, 2006. (cid:11)159, 160\n\n "}, {"Page_number": 581, "text": "references\n\n565\n\n566. j. shao and r. r. sitter. bootstrap for imputed survey data. j am stat assoc,\n\n564. s. senn and s. julious. measurement in clinical trials: a neglected issue for\n\n565. j. shao. linear model selection by cross-validation. j am stat assoc, 88:486\u2013\n\nstatisticians? (with discussion). stat med, 28:3189\u20133225, 2009. (cid:11)313\n494, 1993. (cid:11)100, 113, 122\n91:1278\u20131288, 1996. (cid:11)54\n99:751\u2013762, 2004. (cid:11)102\nrisks and death. stat med, 17:999\u20131015, 1998. (cid:11)421\ndonor selection. stat med, 27:83\u2013102, 2008. (cid:11)58\n\n568. y. shen and p. f. thall. parametric likelihoods for multiple non-fatal competing\n\n569. j. siddique. multiple imputation using an iterative hot-deck with distance-based\n\n567. x. shen, h. huang, and j. ye. inference after model selection. j am stat assoc,\n\n570. r. simon and r. w. makuch. a non-parametric graphical representation of\nthe relationship between survival and the occurrence of an event: application\nto responder versus non-responder bias. stat med, 3:35\u201344, 1984. (cid:11)401, 420\n\n571. j. s. simonoff. the \u201cunusual episode\u201d and a second statistics course. j stat\nedu, 5(1), 1997. online journal at www.amstat.org/publications/jse/v5n1/-\nsimonoff.html. (cid:11)291\n\n572. s. l. simpson, l. j. edwards, k. e. muller, p. k. sen, and m. a. styner. a\nlinear exponent ar(1) family of correlation structures. stat med, 29:1825\u20131838,\n2010. (cid:11)148\nanalyses of randomized trials. j clin epi, 47:881\u2013889, 1994. (cid:11)272\n\n573. j. c. sinclair and m. b. bracken. clinically useful measures of effect in binary\n\n574. j. d. singer and j. b. willett. modeling the days of our lives: using survival\nanalysis when designing and analyzing longitudinal studies of duration and the\ntiming of events. psych bull, 110:268\u2013290, 1991. (cid:11)420\n\n575. l. a. sleeper and d. p. harrington. regression splines in the cox model with\napplication to covariate effects in liver disease. j am stat assoc, 85:941\u2013949,\n1990. (cid:11)23, 40\nlinear models. j roy stat soc b, 42:213\u2013220, 1980. (cid:11)214\n\n576. a. f. m. smith and d. j. spiegelhalter. bayes factors and choice criteria for\n\n577. l. r. smith, f. e. harrell, and l. h. muhlbaier. problems and potentials\nin modeling survival.\nin m. l. grady and h. a. schwartz, editors, medical\neffectiveness research data methods (summary report), ahcpr pub. no.\n92-0056, pages 151\u2013159. us dept. of health and human services, agency for\nhealth care policy and research, rockville, md, 1992. (cid:11)72\n33:57\u201362, 1979. (cid:11)40\nam soc rev, 27:799\u2013811, 1962. (cid:11)257, 505\n\n578. p. l. smith. splines as a useful and convenient statistical tool. am statistician,\n\n579. r. h. somers. a new asymmetric measure of association for ordinal variables.\n\n581. i. spence and r. f. garrison. a remarkable scatterplot. am statistician, 47:12\u2013\n\n582. d. j. spiegelhalter. probabilistic prediction in patient management and clinical\n\n580. a. spanos, f. e. harrell, and d. t. durack. differential diagnosis of acute\nmeningitis: an analysis of the predictive value of initial observations. jama,\n262:2700\u20132707, 1989. (cid:11)266, 267, 268\n19, 1993. (cid:11)91\ntrials. stat med, 5:421\u2013433, 1986. (cid:11)97, 101, 115, 116, 523\n583. d. m. stablein, w. h. carter, and j. w. novak. analysis of survival data with\nnonproportional hazard functions. controlled clin trials, 2:149\u2013159, 1981. (cid:11)\n500\nscores. stat med, 28:377\u2013388, 2009. (cid:11)237\n\n584. n. stallard. simple tests for the external validation of mortality prediction\n\n585. j. stare, f. e. harrell, and h. heinzl. bj: an s-plus program to fit linear\nregression models to censored data using the buckley and james method. comp\nmeth prog biomed, 64:45\u201352, 2001. (cid:11)447\n\n "}, {"Page_number": 582, "text": "566\nreferences\n586. e. w. steyerberg. clinical prediction models. springer, new york, 2009. (cid:11)viii\n587. e. w. steyerberg, s. e. bleeker, h. a. moll, d. e. grobbee, and k. g. m. moons.\ninternal and external validation of predictive models: a simulation study of bias\nand precision in small samples. journal of clinical epi, 56(5):441\u2013447, may\n2003. (cid:11)123\n\n588. e. w. steyerberg, p. m. m. bossuyt, and k. l. lee. clinical trials in acute\nmyocardial infarction: should we adjust for baseline characteristics? am heart\nj, 139:745\u2013751, 2000. editorial, pp. 761\u2013763. (cid:11)4, 231\n\n589. e. w. steyerberg, m. j. c. eijkemans, f. e. harrell, and j. d. f. habbema.\nprognostic modelling with logistic regression analysis: a comparison of selection\nand estimation methods in small data sets. stat med, 19:1059\u20131079, 2000. (cid:11)69,\n100, 286\n\n590. e. w. steyerberg, m. j. c. eijkemans, f. e. harrell, and j. d. f. habbema.\nprognostic modeling with logistic regression analysis: in search of a sensible\nstrategy in small data sets. med decis mak, 21:45\u201356, 2001. (cid:11)100, 271\n\n591. e. w. steyerberg, f. e. harrell, g. j. j. m. borsboom, m. j. c. eijkemans,\ny. vergouwe, and j. d. f. habbema. internal validation of predictive models:\nefficiency of some procedures for logistic regression analysis. j clin epi, 54:774\u2013\n781, 2001. (cid:11)115\n\n592. e. w. steyerberg, a. j. vickers, n. r. cook, t. gerds, m. gonen, n. obu-\nchowski, m. j. pencina, and m. w. kattan. assessing the performance of pre-\ndiction models: a framework for traditional and novel measures. epi (cambridge,\nmass.), 21(1):128\u2013138, jan. 2010. (cid:11)101\n1986. (cid:11)26, 28\n\n593. c. j. stone. comment: generalized additive models. statistical sci, 1:312\u2013314,\n\n594. c. j. stone, m. h. hansen, c. kooperberg, and y. k. truong. polynomial\nsplines and their tensor products in extended linear modeling (with discussion).\nann stat, 25:1371\u20131470, 1997. (cid:11)420, 450\n595. c. j. stone and c. y. koo. additive splines in statistics. in proceedings of the\nstatistical computing section asa, pages 45\u201348, washington, dc, 1985. (cid:11)24,\n28, 41\nplications. stat med, 17:971\u2013982, 1998. (cid:11)416\n14:247\u2013255, 1995. (cid:11)11, 19\n\n597. s. suissa and l. blais. binary regression with continuous outcomes. stat med,\n\n596. d. strauss and r. shavelle. an extended kaplan\u2013meier estimator and its ap-\n\n598. g. sun, t. l. shook, and g. l. kay. inappropriate use of bivariable analysis\nto screen risk factors for use in multivariable analysis. j clin epi, 49:907\u2013916,\n1996. (cid:11)72\n\n599. b. tai, d. machin, i. white, and v. gebski. competing risks analysis of patients\nwith osteosarcoma: a comparison of four different approaches. stat med, 20:661\u2013\n684, 2001. (cid:11)420\nto a model. j roy stat soc b, 58:593\u2013607, 1996. (cid:11)101\n\n600. j. m. g. taylor, a. l. siqueira, and r. e. weiss. the cost of adding parameters\n\n603. p. f. thall and j. m. lachin. assessment of stratum-covariate interactions in\n\n602. h. t. thaler. nonparametric estimation of the hazard ratio. j am stat assoc,\n\n601. r. d. c. team. r: a language and environment for statistical computing. r\nfoundation for statistical computing, vienna, austria, 2015. isbn 3-900051-\n07-0. (cid:11)127\n79:290\u2013293, 1984. (cid:11)518\ncox\u2019s proportional hazards regression model. stat med, 5:73\u201383, 1986. (cid:11)482\nmodel. springer-verlag, new york, 2000. (cid:11)420, 447, 478, 517\n605. t. m. therneau, p. m. grambsch, and t. r. fleming. martingale-based residu-\nals for survival models. biometrika, 77:216\u2013218, 1990. (cid:11)197, 413, 487, 493, 494,\n504\n\n604. t. therneau and p. grambsch. modeling survival data: extending the cox\n\n "}, {"Page_number": 583, "text": "references\n\n567\n\n606. t. m. therneau and s. a. hamilton. rhdnase as an example of recurrent event\n\n607. r. tibshirani. estimating transformations for regression via additivity and\n\nanalysis. stat med, 16:2029\u20132047, 1997. (cid:11)420, 421\nvariance stabilization. j am stat assoc, 83:394\u2013405, 1988. (cid:11)391\nb, 58:267\u2013288, 1996. (cid:11)71, 215, 356\nmed, 16:385\u2013395, 1997. (cid:11)71, 356\n\n608. r. tibshirani. regression shrinkage and selection via the lasso. j roy stat soc\n\n609. r. tibshirani. the lasso method for variable selection in the cox model. stat\n\n610. r. tibshirani and k. knight. model search and inference by bootstrap \u201cbump-\ning\u201d. technical report, department of statistics, university of toronto, 1997.\nhttp://www-stat.stanford.edu/tibs. presented at the joint statistical meet-\nings, chicago, august 1996. (cid:11)xii, 214\nmodel selection. j roy stat soc b, 61:529\u2013546, 1999. (cid:11)11, 123\nfrom incomplete data. psychometrika, 35:417\u2013437, 1970. (cid:11)52\n\n611. r. tibshirani and k. knight. the covariance inflation criterion for adaptive\n\n612. n. h. timm. the estimation of variance-covariance and correlation matrices\n\n613. t. tjur. coefficients of determination in logistic regression models\u2014a new pro-\nposal: the coefficient of discrimination. am statistician, 63(4):366\u2013372, 2009.\n(cid:11)257, 272\n614. w. y. tsai, n. p. jewell, and m. c. wang. a note on the product limit estimator\nunder right censoring and left truncation. biometrika, 74:883\u2013886, 1987. (cid:11)420\n615. a. a. tsiatis. a large sample study of cox\u2019s regression model. ann stat,\n9:93\u2013108, 1981. (cid:11)485\nbly censored data. j am stat assoc, 69:169\u2013173, 1974. (cid:11)420\n\n616. b. w. turnbull. nonparametric estimation of a survivorship function with dou-\n\n617. j. twisk, m. de boer, w. de vente, and m. heymans. multiple imputation of\nmissing values was not necessary before performing a longitudinal mixed-model\nanalysis. j clin epi, 66(9):1022\u20131028, 2013. (cid:11)58\n\n619. \u00a8u. uzuno=gullari and j.-l. wang. a comparison of hazard rate estimators for\n\n618. h. uno, t. cai, m. j. pencina, r. b. d\u2019agostino, and l. j. wei. on the\nc-statistics for evaluating overall adequacy of risk prediction procedures with\ncensored survival data. stat med, 30:1105\u20131117, 2011. (cid:11)519\nleft truncated and right censored data. biometrika, 79:297\u2013310, 1992. (cid:11)420\nof lecture notes in statistics. springer-verlag, new york, 1994. (cid:11)59\nplete covariate data. stat med, 16:57\u201372, 1997. (cid:11)52, 59\n\n621. w. vach. some issues in estimating the effect of prognostic factors from incom-\n\n620. w. vach. logistic regression with missing values in the covariates, volume 86\n\n622. w. vach and m. blettner. logistic regression with incompletely observed cate-\ngorical covariates\u2014investigating the sensitivity against violation of the missing\nat random assumption. stat med, 14:1315\u20131329, 1995. (cid:11)59\nbiostatistics, pages 2641\u20132654. wiley, new york, 1998. (cid:11)52, 58, 59\n\n623. w. vach and m. blettner. missing data in epidemiologic studies. in ency of\n\n624. w. vach and m. schumacher. logistic regression with incompletely observed\ncategorical covariates: a comparison of three approaches. biometrika, 80:353\u2013\n362, 1993. (cid:11)59\n\n625. m. g. valsecchi, d. silvestri, and p. sasieni. evaluation of long-term survival:\nuse of diagnostics and robust estimators with cox\u2019s proportional hazards model.\nstat med, 15:2763\u20132780, 1996. (cid:11)518\n\n626. s. van buuren, h. c. boshuizen, and d. l. knook. multiple imputation of\nmissing blood pressure covariates in survival analysis. stat med, 18:681\u2013694,\n1999. (cid:11)58\n\n627. s. van buuren, j. p. l. brand, c. g. m. groothuis-oudshoorn, and d. b. rubin.\nfully conditional specification in multivariate imputation. j stat computation\nsim, 76(12):1049\u20131064, 2006. (cid:11)55\n\n "}, {"Page_number": 584, "text": "568\n\nreferences\n\n628. g. j. m. g. van der heijden, donders, t. stijnen, and k. g. m. moons. impu-\ntation of missing values is superior to complete case analysis and the missing-\nindicator method in multivariable diagnostic research: a clinical example. j\nclin epi, 59:1102\u20131109, 2006. (cid:11)48, 49\n\n629. t. van der ploeg, p. c. austin, and e. w. steyerberg. modern modelling\ntechniques are data hungry: a simulation study for predicting dichotomous end-\npoints. bmc medical research methodology, 14(1):137+, dec. 2014. (cid:11)41, 100\n630. m. j. van gorp, e. w. steyerberg, m. kallewaard, and y. var der graaf. clin-\nical prediction rule for 30-day mortality in bj\u00a8ork-shiley convexo-concave valve\nreplacement. j clin epi, 56:1006\u20131012, 2003. (cid:11)122\n\n632. j. c. van houwelingen and s. le cessie. logistic regression, a review. statistica\n\n631. h. c. van houwelingen and j. thorogood. construction, validation and updat-\ning of a prognostic model for kidney graft survival. stat med, 14:1999\u20132008,\n1995. (cid:11)100, 101, 123, 215\nneerlandica, 42:215\u2013232, 1988. (cid:11)271\n633. j. c. van houwelingen and s. le cessie. predictive value of statistical models.\nstat med, 9:1303\u20131325, 1990. (cid:11)77, 101, 113, 115, 123, 204, 214, 215, 258, 259,\n273, 508, 509, 518\nspringer-verlag, new york, third edition, 1999. (cid:11)101\nverlag, new york, fourth edition, 2003. (cid:11)xi, 127, 129, 143, 359\nbased confidence intervals. appl stat, 37:87\u201394, 1988. (cid:11)214\nspringer, new york, 2000. (cid:11)143\n\n636. d. j. venzon and s. h. moolgavkar. a method for computing profile-likelihood-\n\n634. w. n. venables and b. d. ripley. modern applied statistics with s-plus.\n\n637. g. verbeke and g. molenberghs. linear mixed models for longitudinal data.\n\n635. w. n. venables and b. d. ripley. modern applied statistics with s. springer-\n\n639. p. verweij and h. c. van houwelingen. penalized likelihood in cox regression.\n\n640. p. j. m. verweij and h. c. van houwelingen. cross-validation in survival anal-\n\n638. y. vergouwe, e. w. steyerberg, m. j. c. eijkemans, and j. d. f. habbema.\nsubstantial effective sample sizes were required for external validation studies\nof predictive logistic regression models. j clin epi, 58:475\u2013483, 2005. (cid:11)122\nstat med, 13:2427\u20132436, 1994. (cid:11)77, 209, 210, 211, 215\nysis. stat med, 12:2305\u20132314, 1993. (cid:11)100, 123, 207, 215, 509, 518\ncovariates in cox regression. biometrics, 51:1550\u20131556, 1995. (cid:11)209, 211, 501\nmodels, and molecular markers. am statistician, 62(4):314\u2013320, 2008. (cid:11)5\n\n642. a. j. vickers. decision analysis for the evaluation of diagnostic tests, prediction\n643. s. k. vines. simple principal components. appl stat, 49:441\u2013451, 2000. (cid:11)101\n644. e. vittinghoff and c. e. mcculloch. relaxing the rule of ten events per variable\n\n641. p. j. m. verweij and h. c. van houwelingen. time-dependent effects of fixed\n\n646. h. wainer. finding what is not there through the unfortunate binning of results:\n\n645. p. t. von hippel. regression with missing ys: an improved strategy for analyzing\n\nin logistic and cox regression. am j epi, 165:710\u2013718, 2006. (cid:11)100\nmultiple imputed data. soc meth, 37(1):83\u2013117, 2007. (cid:11)47\nthe mendel effect. chance, 19(1):49\u201356, 2006. (cid:11)19, 20\n647. s. h. walker and d. b. duncan. estimation of the probability of an event as a\nfunction of several independent variables. biometrika, 54:167\u2013178, 1967. (cid:11)14,\n220, 311, 313\nvariables in multiple regression analyses. am j epi, 125:319\u2013323, 1987. (cid:11)39\nprincipal component analysis. stat med, 24:2069\u20132087, 2005. (cid:11)101\ntion. j am stat assoc, 94:146\u2013153, 1999. (cid:11)421\nmissing observations. j am stat assoc, 87:952\u2013961, 1992. (cid:11)53\n\n651. r. wang, j. sedransk, and j. h. jinn. secondary data analysis when there are\n\n650. m. wang and s. chang. nonparametric estimation of a recurrent survival func-\n\n649. a. wang and e. a. gehan. gene selection for microarray data analysis using\n\n648. a. r. walter, a. r. feinstein, and c. k. wells. coding ordinal independent\n\n "}, {"Page_number": 585, "text": "references\n\n569\n\n652. y. wang and j. m. g. taylor. inference for smooth curves in longitudinal data\nwith application to an aids clinical trial. stat med, 14:1205\u20131218, 1995. (cid:11)215\n653. y. wang, g. wahba, c. gu, r. klein, and b. klein. using smoothing spline\nanova to examine the relation of risk factors to the incidence and progression\nof diabetic retinopathy. stat med, 16:1357\u20131376, 1997. (cid:11)41\n\n654. y. wax. collinearity diagnosis for a relative risk regression analysis: an appli-\ncation to assessment of diet-cancer relationship in epidemiological studies. stat\nmed, 11:1273\u20131287, 1992. (cid:11)79, 138, 255\n\n656. r. e. weiss. the influence of variable selection: a bayesian diagnostic perspec-\n\n655. l. j. wei, d. y. lin, and l. weissfeld. regression analysis of multivariate\nincomplete failure time data by modeling marginal distributions. j am stat\nassoc, 84:1065\u20131073, 1989. (cid:11)417\ntive. j am stat assoc, 90:619\u2013625, 1995. (cid:11)100\n49:877\u2013881, 1993. (cid:11)450\n\n657. s. wellek. a log-rank test for equivalence of two survivor functions. biometrics,\n\n658. t. l. wenger, f. e. harrell, k. k. brown, s. lederman, and h. c. strauss.\nventricular fibrillation following canine coronary reperfusion: different outcomes\nwith pentobarbital and \u03b1-chloralose. can j phys pharm, 62:224\u2013228, 1984. (cid:11)\n266\ndirect test for heteroskedasticity. econometrica, 48:817\u2013838, 1980. (cid:11)196\n\n659. h. white. a heteroskedasticity-consistent covariance matrix estimator and a\n\n661. i. r. white and p. royston.\n\n660. i. r. white and j. b. carlin. bias and efficiency of multiple imputation\ncompared with complete-case analysis for missing covariate values. stat med,\n29:2920\u20132931, 2010. (cid:11)59\nmodel. stat med, 28:1982\u20131998, 2009. (cid:11)54\n662. i. r. white, p. royston, and a. m. wood. multiple imputation using chained\nequations: issues and guidance for practice. stat med, 30(4):377\u2013399, 2011. (cid:11)\n53, 54, 58\n\nimputing missing covariate values for the cox\n\n663. a. whitehead, r. z. omar, j. p. t. higgins, e. savaluny, r. m. turner, and\ns. g. thompson. meta-analysis of ordinal outcomes using individual patient\ndata. stat med, 20:2243\u20132260, 2001. (cid:11)324\n\n665. j. whittaker. model interpretation from the additive elements of the likelihood\n\n664. j. whitehead. sample size calculations for ordered categorical data. stat med,\n12:2257\u20132271, 1993. see letter to editor sm 15:1065-6 for binary case;see errata\nin sm 13:871 1994;see kol95com, jul96sam. (cid:11)2, 73, 313, 324\nfunction. appl stat, 33:52\u201364, 1984. (cid:11)205, 207\n42:495\u2013506, 1986. (cid:11)420\n2009. (cid:11)xi\nselection. stat med, 29:1647\u20131659, 2010. (cid:11)100\n\n667. h. wickham. ggplot2: elegant graphics for data analysis. springer, new york,\n\n666. a. s. whittemore and j. b. keller. survival estimation using splines. biometrics,\n\n668. r. e. wiegand. performance of using multiple stepwise algorithms for variable\n\n670. a. winnett and p. sasieni. a note on scaled schoenfeld residuals for the pro-\n\n669. a. r. willan, w. ross, and t. a. mackenzie. comparing in-patient classifica-\ntion systems: a problem of non-nested regression models. stat med, 11:1321\u2013\n1331, 1992. (cid:11)205, 215\nportional hazards model. biometrika, 88:565\u2013571, 2001. (cid:11)518\nin cox regression. j roy stat soc b, 65:473\u2013488, 2003. (cid:11)518\nprincipal components. ann appl stat, 2(3):986\u20131012, 2008. (cid:11)175\n\n672. d. m. witten and r. tibshirani. testing significance of features by lassoed\n\n671. a. winnett and p. sasieni. iterated residuals and time-varying covariate effects\n\n673. a. m. wood, i. r. white, and s. g. thompson. are missing outcome data\nadequately handled? a review of published randomized controlled trials in major\nmedical journals. clin trials, 1:368\u2013376, 2004. (cid:11)58\n\n "}, {"Page_number": 586, "text": "570\n\nreferences\n\n674. s. n. wood. generalized additive models: an introduction with r. chapman\n\n& hall/crc, boca raton, fl, 2006. isbn 9781584884743. (cid:11)90\nanalysis. ann stat, 14(4):1261\u20131350, 1986. (cid:11)113\n\n675. c. f. j. wu. jackknife, bootstrap and other resampling methods in regression\n\n677. y. xie. knitr: a general-purpose package for dynamic report generation in r,\n\n676. y. xiao and m. abrahamowicz. bootstrap-based methods for estimating stan-\ndard errors in cox\u2019s regression analyses of clustered event times. stat med,\n29:915\u2013923, 2010. (cid:11)213\n2013. r package version 1.5. (cid:11)xi, 138\ntion. j am stat assoc, 93:120\u2013131, 1998. (cid:11)10\nb, 58:481\u2013493, 1996. (cid:11)324\n\n679. t. w. yee and c. j. wild. vector generalized additive models. j roy stat soc\n\n678. j. ye. on measuring and correcting the effects of data mining and model selec-\n\n684. b. zheng and a. agresti. summarizing the predictive power of a generalized\n\n683. h. zhang, t. holford, and m. b. bracken. a tree-based method of analysis for\n\n681. r. m. yucel and a. m. zaslavsky. using calibration to improve rounding in\n\n682. h. zhang. classification trees for multiple binary responses. j am stat assoc,\n\n680. f. w. young, y. takane, and j. de leeuw. the principal components of mixed\nmeasurement level multivariate data: an alternating least squares method with\noptimal scaling features. psychometrika, 43:279\u2013281, 1978. (cid:11)81\nimputation. am statistician, 62(2):125\u2013129, 2008. (cid:11)56\n93:180\u2013193, 1998. (cid:11)41\nprospective studies. stat med, 15:37\u201349, 1996. (cid:11)41\nlinear model. stat med, 19:1771\u20131781, 2000. (cid:11)215, 273\nstat assoc, 90:151\u2013156, 1995. (cid:11)214\ncomp graph stat, 15:265\u2013286, 2006. (cid:11)101\nstat med, 13:1737\u20131745, 1994. (cid:11)328\nresearch. stat med, 20:1541\u20131549, 2001. (cid:11)59\nann stat, 35:2173\u20132192, 2007. (cid:11)11\nselection theory. ann stat, 36(3):1108\u20131126, 2008. (cid:11)361\n\n686. h. zhou, t. hastie, and r. tibshirani. sparse principal component analysis. j\n\n687. x. zhou. effect of verification bias on positive and negative predictive values.\n\n685. x. zheng and w. loh. consistent variable selection in linear models. j am\n\n690. h. zou and m. yuan. composite quantile regression and the oracle model\n\n688. x. zhou, g. j. eckert, and w. m. tierney. multiple imputation in public health\n\n689. h. zou, t. hastie, and r. tibshirani. on the \u201cdegrees of freedom\u201d of the lasso.\n\n691. d. m. zucker. the efficiency of a weighted log-rank test under a percent error\nmisspecification model for the log hazard ratio. biometrics, 48:893\u2013899, 1992.\n(cid:11)518\n\n "}, {"Page_number": 587, "text": "index\n\nentries in this font are names of software components. page numbers in\nbold denote the most comprehensive treatment of the topic.\n\nsymbols\ndxy, 105, 142, 257, 257\u2013259, 269,\n\n284, 318, 461, 505, 529\n\ncensored data, 505, 517\n\nr2, 110, 111, 206, 272, 390, 391\n\nadjusted, 74, 77, 105\ngeneralized, 207\nsignificant difference in, 215\nc index, 93, 100, 105, 142, 257,\n\n257, 259, 318, 505, 517\n\ncensored data, 505\ngeneralized, 318, 505\n\nhba1c, 365\n15:1 rule, 72, 100\n\na\naalen survival function estimator,\n\nsee survival function\n\nabs.error.pred, 102\naccelerated failure time, see\n\nmodel\n\naccuracy, 104, 111, 113, 114, 210,\n\n354, 446\n\ng-index, 105\nabsolute, 93, 102\n\napparent, 114, 269, 529\napproximation, 119, 275,\n\n287, 348, 469\n\nbias-corrected, 100, 109,\n\n114, 115, 141, 391, 529\n\ncalibration, 72\u201378,\n\n88, 92, 93, 105, 111, 115, 141,\n236, 237, 259, 260,\n264, 269, 271, 284, 301, 322,\n446, 467, 506\n\ndiscrimination, 72, 92, 93,\n105, 111, 111, 257, 259,\n269, 284, 287, 318, 331, 346,\n467, 505, 506, 508\n\nfuture, 211\nindex, 122, 123, 141\n\nace, 82, 176, 179, 390, 391, 392\nace, 176, 392\nacepack package, 176, 392\nactuarial survival, 410\nadequacy index, 207\naic, 28, 69, 78, 88, 172, 204, 204,\n\n210, 211, 214, 215,\n240, 241, 269, 275, 277, 332,\n374, 375\n\n\u00a9 springer international publishing switzerland 2015\nf.e. harrell, jr., regression modeling strategies, springer series\nin statistics, doi 10.1007/978-3-319-19425-7\n\n571\n\n "}, {"Page_number": 588, "text": "572\n\nindex\n\naic, 134, 135, 277\nakaike information criterion, see\n\naic\n\nanalysis of covariance, see\n\nanocova\n\nanocova, 16, 223, 230, 447\nanova, 13, 32, 75, 230, 235, 317,\n\n447, 480, 531\n\nanova, 65, 127, 133, 134, 136,\n\n149, 155, 278, 302, 306, 336,\n342, 346, 464, 466\n\nanova.gls, 149\nareg.boot, 392\u2013394\naregimpute, 51, 53\u201356, 59,\n\n304, 305\n\narjas plot, 495\nasis, 132, 133\nassumptions\n\naccelerated failure time,\n\n436, 437, 458\n\nadditivity, 37, 248\ncontinuation ratio, 320,\n\n321, 338\n\ncorrelation pattern, 148, 153\ndistributional, 39, 97,\n148, 317, 446, 525\n\nlinearity, 21\u201326\nordinality, 312, 319, 333, 340\nproportional hazards, 429,\n\n494\u2013503\n\nproportional odds, 313,\n\n315, 317, 336, 362\n\navas, 390\u2013392\n\ncase study, 393\u2013398\n\navas, 392, 394, 395\n\nb\nb-spline, see spline function\nbattery reduction, 87\nbayesian modeling, 71, 209, 215\nbic, 211, 214, 269\nbinary response, see response\nbj, 131, 135, 447, 449\nbootcov, 134\u2013136, 198\u2013202, 319\nbootkm, 419\n\nbootstrap, 106\u2013109, 114\u2013116\n\n.632, 115, 123\nadjusting for imputation, 53\napproximate bayesian, 50\nbasic, 202, 203\nbca, 202, 203\ncluster, 135, 197, 199, 213\nconditional, 115, 122, 197\nconfidence intervals, see\n\nconfidence intervals, 199\ncovariance matrix, 135, 198\ndensity, 107, 136\ndistribution, 201\nestimating shrinkage, 77, 115\nmodel uncertainty, 11, 113, 304\noverfitting correction, 112,\n\n114, 115, 257, 391\n\nranks, 117\nvariable selection, 70, 97,\n\n113, 177, 260, 275, 282, 286\n\nbplot, 134\nbreslow survival function\n\nestimator, see survival\nfunction\n\nbrier score, 142, 237,\n\n257\u2013259, 271, 318\n\nc\ncabg, 484\ncalibrate, 135, 141, 269,\n\n271, 284, 300, 319, 323, 355,\n450, 467, 517\n\ncalibration, see accuracy\ncaliper matching, 372\ncancor, 141\ncanonical correlation, 141\ncanonical variate, 82, 83, 129,\n\n141, 167, 169, 393\n\ncart, see recursive partitioning\ncasewise deletion, see missing\n\ndata\n\ncategorical predictor, see\n\npredictor\n\ncategorization of continuous\n\nvariable, 8, 18\u201321\n\n "}, {"Page_number": 589, "text": "index\n\n573\n\ncatg, 132, 133\ncausal inference, 103\ncause removal, 414\ncensoring, 401\u2013402, 406, 424\n\ninformative, 402, 414, 415, 420\ninterval, 401, 418, 420\nleft, 401\nright, 402, 418\ntype i, 401\ntype ii, 402\nciapower, 513\nclassification, 4, 6\nclassifier, 4, 6\nclustered data, 197, 417\nclustering\n\nhierarchical, 129, 166, 330\nvariable, 81, 101, 175, 355\n\nclustofvar, 101\ncoef, 134\ncoefficient of discrimination, see\n\naccuracy\n\ncollinearity, 78\u201379\ncompeting risks, 414, 420\nconcordance probability, see c\n\nindex\n\nconditional logistic model, see\n\nlogistic model\n\nconditional probability, 320, 404,\n\n476, 484\n\nconfidence intervals, 10, 30,\n35, 64, 66, 96, 136, 185,\n198, 273, 282, 391\nbootstrap, 107, 109,\n\n119, 122, 135, 149, 199,\n201\u2013203, 214, 217\n\ncoverage, 35, 198, 199, 389\nsimultaneous, 136, 199,\n\n202, 214, 420, 517\n\nconfounding, 31, 103, 231\nconfplot, 214\ncontingency table, 195, 228,\n\n230, 235\n\ncontrast, see hypothesis test\ncontrast, 134, 136,\n\n192, 193, 198, 199\n\nconvergence, 193, 264\ncoronary artery disease, 48, 207,\n\n240, 245, 252, 492, 497\n\ncorrelation structures, 147, 148\ncorrespondence analysis, 81, 129\ncost-effectiveness, 4\ncox model, 362, 375, 392,\n\n475\u2013517\n\ncase study, 521\u2013531\ndata reduction example, 172\nmultiple imputation, 54\ncox.zph, 499, 516, 517, 526\ncoxph, 131, 422, 513\ncph, 131, 133, 135, 172, 422,\n\n448, 513, 513, 514, 516, 517\n\ncpower, 513\ncr.setup, 323, 340, 354\ncross-validation, see validation of\n\nmodel\n\ncubic spline, see spline function\ncumcategory, 357\ncumulative hazard function, see\n\nhazard function\n\ncumulative probability model,\n\n359, 361\u2013363, 370, 371\n\ncut2, 129, 133, 334, 419\ncutpoint, 21\n\nd\ndata reduction, 79\u201388, 275\n\ncase study 1, 161\u2013177\ncase study 2, 277\ncase study 3, 329\u2013333\n\ndata-splitting, see validation of\n\nmodel\n\ndata.frame, 309\ndatadist, 130, 130, 138, 292, 463\ndatasets, 535\n\ncdystonia, 149\ncervical dystonia, 149\ndiabetes, 317\nmeningitis, 266, 267\nnhanes, 365\nprostate, 161, 275, 521\nsupport, 59, 453\n\n "}, {"Page_number": 590, "text": "574\n\nindex\n\ntitanic, 291\n\ndegrees of freedom, 193\n\neffective, 30, 41, 77, 96, 136,\n\n210, 269\n\ngeneralized, 10\nphantom, 35, 111\n\ndelayed entry, 401\ndelta method, 439\ndescribe, 129, 291, 453\ndeviance, 236, 449, 487, 516\ndfbeta, 91\ndfbetas, 91\ndffit, 91\ndffits, 91\ndiabetes, see datasets, 365\ndifference in predictions, 192, 201\ndimensionality, 88\ndiscriminant analysis, 220, 230,\n\n272\n\ndiscrimination, see accuracy, see\n\naccuracy\n\ndistribution, 317\n\nt, 186\nbinomial, 73, 181, 194, 235\ncauchy, 362\nexponential, 142, 407, 408,\n\n425, 427, 451\n\nextreme value, 362, 363, 427,\n\n437\n\ngumbel, 362, 363\nlog-logistic, 9, 423,\n\n427, 440, 442, 503\n\nlog-normal, 9, 106,\n\n391, 423, 427, 442, 463, 464\n\nnormal, 187\nweibull, 39, 408, 408, 420, 426,\n\n432\u2013437, 444, 448\n\ndose-response, 523\ndoubly nonlinear, 131\ndrop-in, 513\ndropouts, 143\ndummy variable, 1, see indicator\n\nvariable, 75, 129, 130,\n209, 210\n\ne\neconomists, 71\neffective.df, 134, 136, 345, 346\nemax, 353\nepidemiology, 38\nestimation, 2, 98, 104\nestimator\n\nbuckley\u2013james, 447, 449\nmaximum likelihood, 181\nmean, 362\npenalized, see maximum\n\nlikelihood, 175\n\nquantile, 362\nself-consistent, 525\nsmearing, 392, 393\n\nexplained variation, 273\nexponential distribution, see\n\ndistribution\n\nexprob, 135\nexternal validation, see validation\n\nof model\n\nf\nfailure time, 399\nfastbw, 133, 134, 137, 280, 286,\n\n351, 469\n\nfeature selection, 94\nfinancial data, 3\nfit.mult.impute, 54, 306\nfleming\u2013harrington survival\nfunction estimator, see\nsurvival function\n\nformula, 134\nfractional polynomial, 40\nfunction, 134, 135, 138, 149, 310,\n\n395\n\nfunctions, generating r code, 395\n\ng\ngam, see generalized additive\n\nmodel, see generalized\nadditive model\n\ngam package, 390\ngdf, see degrees of freedom\ngee, 147\n\n "}, {"Page_number": 591, "text": "index\n\ngehan\u2013wilcoxon test, see\n\nhypothesis test\n\ngendata, 134, 136\ngeneralized additive model,\n\n29, 41, 138, 142, 390\n\ncase study, 393\u2013398\ngethdata, 59, 178, 535\nggplot, 134\nggplot2 package, xi, 134, 294\ngindex, 105\nglht, 199\nglm, 131, 135, 271\nglm, 131, 141, 271\ngls, 131, 135, 149\ngls, 131, 149\ngoodness of fit, 236, 269,\n\n427, 440, 458\n\ngreenwood\u2019s formula, see survival\n\nfunction\n\ngroupkm, 419\n\nh\nhare, 450\nhat matrix, 91\nhazard, 135, 448\nhazard function, 135, 362,\n\n375, 400, 402, 405, 409, 427,\n475, 476\n\nbathtub, 408\ncause-specific, 414, 415\ncumulative, 402\u2013409\nhazard ratio, 429\u2013431,\n433, 478, 479, 481\n\ninterval-specific, 495\u2013497, 502\n\nhazard.ratio.plot, 517\nhclust, 129\nheft, 419\nheterogeneity, unexplained, 4, 231,\n\n400\n\nhistspikeg, 294\nhmisc package, xi, 129, 133, 137,\n167, 176, 273, 277, 294, 304,\n319, 357, 392, 418, 458, 463,\n513, 536\n\nhoeffd, 129\n\n575\n\nhoeffding d, 129, 166, 458\nhosmer\u2013lemeshow test, 236, 237\nhotelling test, see hypothesis test\nhuber\u2013white estimator, 196\nhypothesis test, 1, 18, 32, 99\n\nadditivity, 37, 248\nassociation, 2, 18, 32, 43, 66,\n\n129, 235, 338, 486\n\ncontrast, 157, 192, 193, 198\nequal slopes, 315, 321, 322,\n\n338, 339, 458, 460, 495\n\nexponentiality, 408, 426\ngehan-wilcoxon, 505\nglobal, 69, 97, 189, 205,\n\n230, 232, 342, 526\n\nhotelling, 230\nindependence, 129, 166\nkruskal\u2013wallis, 2, 66, 129\nlinearity, 18, 32, 35, 36, 39, 42,\n\n66, 91, 238\n\nlog-rank, 41, 363, 422, 475, 486,\n\n513, 518\n\nmantel\u2013haenszel, 486\nnormal scores, 364\npartial, 190\npearson \u03c72, 195, 235\nrobust, 9, 81, 311\nvan der waerden, 364\nwilcoxon, 1, 73, 129,\n\n230, 257, 311, 313, 325,\n363, 364\n\ni\nignorable nonresponse, see\n\nmissing data\n\nimbalances, baseline, 400\nimproveprob, 142\nimputation, 47\u201357, 83\n\nchained equations, 55, 304\nmodel for, 49, 50, 50\u201352,\n\n59, 84, 129\n\nmultiple, 47, 53, 54, 54\u201356,\n\n95, 129, 304, 382, 537\n\ncensored data, 54\n\n "}, {"Page_number": 592, "text": "576\n\nindex\n\npredictive mean matching, 51,\n\nlatex, 129, 134, 135, 137, 138, 149,\n\n52, 55\n\nsingle, 52, 56, 57, 138,\n\n171, 275, 276, 334\n\nimpute, 129, 135, 138, 171,\n\n276, 277, 334, 461\n\nincidence\n\ncrude, 416\ncumulative, 415\n\nincomplete principal component\n\nregression, 170, 275\n\nindicator variable, 16, 17, 38, 39\ninfinite regression coefficient, 234\ninfluential observations, 90\u201392,\n\n246, 282, 292, 336, 342, 346,\n453, 466, 470, 536\n\nlattice package, 134\nleast squares\n\ncensored, 447\n\nleave-out-one, see validation of\n\nmodel\n\nleft truncation, 401, 420\nlife expectancy, 4, 408, 472\nlift curve, 5\nlikelihood function, 182,\n\n187, 188, 190,\n194, 195, 424, 425, 476\n\n116, 255, 256, 269, 504\n\npartial, 477\n\ninformation function, 182, 183\ninformation matrix, 79, 188, 189,\n\n191, 196, 208, 211, 232, 346\ninformative missing, see missing\n\ndata\n\ninteraction, 16, 36, 375\ninterquartile-range effect, 104, 136\nintracluster correlation, 135, 141,\n\n197, 417\n\nisotropic correlation structure, see\n\ncorrelation structures\n\nj\njackknife, 113, 504\n\nk\nkalbfleisch\u2013prentice estimator,\n\nsee survival function\n\nkaplan\u2013meier estimator, see\n\nsurvival function\n\nknots, 22\nkullback\u2013leibler information, 215\n\nl\nlandmark survival time analysis,\n\n447\n\nlasso, 71, 100, 121, 175, 356\nlatex, 129, 536\n\nlikelihood ratio test, 185\u2013186,\n\n189\u2013191, 193\u2013195,\n198, 204, 205, 207, 228, 240\nlinear model, 73, 74, 143, 311, 359,\n\n361, 362, 364, 368, 370, 372\n\ncase study, 143\n\nlinear spline, see spline function\nlink function, 15\n\ncauchy, 362\ncomplementary log-log, 362\nlog-log, 362\nprobit, 362\n\nlm, 131\nlme, 149\nlocal regression, see\nnonparametric\n\nloess, see nonparametric\nloess, 29, 142, 493\nlog-rank, see hypothesis test\nlogistic, 315\nlogistic model\n\nbinary, 219\u2013231\n\ncase study 1, 275\u2013288\ncase study 2, 291\u2013310\n\nconditional, 483\ncontinuation ratio, 319\u2013323\n\ncase study, 338\u2013340\n\nextended continuation ratio,\n\n321\u2013322\n\ncase study, 340\u2013355\n\n "}, {"Page_number": 593, "text": "index\n\n577\n\nordinal, 311\nproportional odds, 73, 311, 312,\n\nmissing data, 143, 302\n\ncasewise deletion, 47, 48, 81,\n\n313\u2013319, 333, 362, 364\n\ncase study, 333\u2013338\n\nloglik, 134, 135\nlongitudinal data, 143\nlowess, see nonparametric\nlowess, 141, 294\nlrm, 65, 131, 134, 135, 201,\n\n269, 269, 273, 277, 278,\n296, 297, 302, 306, 319, 323,\n335, 337, 339, 341, 342, 448,\n513\n\nlrtest, 134, 135\nlsp, 133\n\nm\nmallows\u2019 cp, 69\nmantel\u2013haenszel test, see\n\nhypothesis test\n\nmarginal distribution, 26, 417,\n\n478\n\nmarginal estimates, see\n\nunconditioning\n\nmartingale residual, 487, 493, 494,\n\n515, 516\n\nmatrix, 133\nmatrx, 133\nmaximal correlation, 390\nmaximum generalized variance,\n\n82, 83\n\nmaximum likelihood, 147\n\nestimation, 181, 231, 424, 425,\n\n477\n\npenalized, 11, 77, 78, 115, 136,\n\n209\u2013212, 269, 327, 328, 353\n\ncase study, 342\u2013355\n\nweighted, 208\n\nmaximum total variance, 81\nmean, 135, 319, 448, 472, 513, 514\nmeningitis, see datasets\nmgcv package, 390\nmgv, see maximum generalized\n\nvariance\n\nmice, 54, 55, 59\n\n296, 307, 384\n\ndescribing patterns, see\n\nnaclus, naplot\n\nimputation, see imputation\ninformative, 46, 424\nrandom, 46\n\nmle, see maximum likelihood\nmodel\n\naccelerated failure time,\n\n436\u2013446, 453\n\ncase study, 453\u2013473\n\nandersen\u2013gill, 513\napproximate, 119\u2013123,\n\n275, 287, 349, 352\u2013354, 356\n\nbuckley\u2013james, 447, 449\ncomparing more than one, 92\ncox, see cox model\ncumulative link, see cumulative\n\nprobability model\n\ncumulative probability, see\ncumulative probability\nmodel\n\nextended linear, 146\ngeneralized additive, see\n\ngeneralized additive model,\n359\n\ngeneralized linear, 146, 359\ngrowth curve, 146\nlinear, see linear model,\n\n117, 199, 287, 317, 389\n\nlog-logistic, 437\nlog-normal, 437, 453\nlogistic, see logistic model\nlongitudinal, 143\nols, 146\nordinal, see ordinal model\nparametric proportional\n\nhazards, 427\n\nquantile regression, see quantile\n\nregression\n\nsemiparametric, see\n\nsemiparametric model\n\n "}, {"Page_number": 594, "text": "578\n\nindex\n\nvalidation, see validation of\n\nmodel\n\nmodel approximation, see model\nmodel uncertainty, 170, 304\nmodel validation, see validation\n\nof model\n\nmodeling strategy, see strategy\nmonotone, 393\nmonotonicity, 66, 83, 84,\n\n95, 129, 166, 389, 390, 393,\n458\n\nmtv, see maximum total\n\nvariance\n\nmultcomp package, 199, 202\nmulti-state model, 420\nmultiple events, 417\n\nn\nna.action, 131\nna.delete, 131, 132\nna.detail.response, 131\nna.fail, 132\nna.fun.response, 131\nna.omit, 132\nnaclus, 47, 142, 302, 458, 461\nnaplot, 47, 302, 461\nnaprint, 135\nnaresid, 132, 135\nnatural spline, see restricted\n\ncubic spline\n\nnearest neighbor, 51\nnelson estimator, see survival\n\nfunction, 422\n\nnewlabels, 473\nnewton\u2013raphson algorithm, 193,\n\n195, 196, 209, 231, 426\n\nnhanes, 365\nnlme package, 131, 148, 149\nnoise, 34, 68, 69, 72, 209, 488, 523\nnomogram, 104, 268,\n\n310, 318, 353, 514, 531\n\nnomogram, 135, 138, 149, 282, 319,\n\n353, 473, 514\n\nnon-proportional hazards, 73, 450,\n\n506\n\nnoncompliance, 402, 513\nnonignorable nonresponse, see\n\nmissing data\n\nnonparametric\n\ncorrelation, 66\n\ncensored data, 517\n\ngeneralized spearman\ncorrelation, 66, 376\n\nindependence test, 129, 166\nregression, 29, 41, 105, 142, 245,\n\n285\n\ntest, 2, 66, 129\n\nnonproportional hazards, 495\nnpsurv, 418, 419\nns, 132, 133\nnuisance parameter, 190, 191\n\no\nobject-oriented program, x, 127,\n\n133\n\nobservational study, 3, 58,\n\n230, 400\n\nodds ratio, 222, 224, 318\nols, see linear model\nols, 131, 135, 137, 350, 351,\n\n448, 469, 470\n\noptimism, 109, 111, 114, 391\nordered, 133\nordinal model, 311, 359, 361\u2013363,\n\n370, 371\n\ncase study, 327\u2013356, 359\u2013387\nprobit, 364\n\nordinal response, see response\nordinality, see assumptions\norm, 131, 135, 319, 362, 363\noutlier, 116, 294\noveradjustment, 2\noverfitting, 72, 109\u2013110\n\np\nparsimony, 87, 97, 119\npartial effect plot, 104, 318\npartial residual, see residual\npartial test, see hypothesis test\npc, see principal component,\n\n170, 172, 175, 275\n\n "}, {"Page_number": 595, "text": "index\n\n579\n\npcapp package, 175\npec package, 519\npenalized maximum likelihood,\n\nsee maximum likelihood\n\npentrace, 134, 136, 269, 323, 342,\n\n344\n\nperson-years, 408, 425\nplclust, 129\nplot.lrm.partial, 339\nplot.xmean.ordinaly, 319, 323, 333\nplsmo, 358\npoisson model, 271\npol, 133\npoly, 132, 133\npolynomial, 21\npopower, 319\nposamsize, 319\npower calculation, see cpower,\n\nspower, ciapower, popower\n\npphsm, 448\nprcomp, 141\npreconditioning, 118, 123\npredab.resample, 141, 269, 323\npredict, 130, 134, 136, 149,\n\n198, 199, 202, 278, 299, 307,\n319, 448, 466\n\npredict, 127, 132, 136, 140, 309,\n\n319, 469, 517, 526\n\npredictor\n\ncontinuous, 21, 40\nnominal, 16, 210\nordinal, 38\n\nprincipal component, 81, 87,\n\n101, 275\n\nsparse, 101, 175\nprincomp, 141, 171\nprinqual, 82, 83\nproduct-limit estimator, see\n\nsurvival function\n\npropensity score, 3, 58, 231\nproportional hazards model, see\n\ncox model\n\nproportional odds model, see\n\nlogistic model\n\nprostate, see datasets\npsm, 131, 135, 448, 448,\n\n460, 464, 513\n\nq\nq\u2013r decomposition, 23\nq-q plot, 148\nqr, 192\nquantile, 135, 448, 472, 513, 514\nquantile regression, 359, 360, 364,\n\n370, 379, 392\ncomposite, 361\nquantreg, 131, 360\n\nr\nrandom forests, 100\nrank correlation, see\nnonparametric\n\nrao score test, 186\u2013187,\n\n191, 193\u2013195, 198\n\nrcorr, 166\nrcorr.cens, 142, 461, 517\nrcorrcens, 461\nrcorrp.cens, 142\nrcs, 133, 296, 297\nrcspline.eval, 129\nrcspline.plot, 273\nrcspline.restate, 129\nreceiver operating characteristic\n\ncurve, 6, 11\n\narea, 92, 93, 111, 257, 346\narea, generalized, 318, 505\n\nrecursive partitioning, 10, 30, 31,\n\n41, 46, 47, 51, 52, 83, 87,\n100, 120, 142, 302, 349\n\nredun, 80, 463\nredundancy analysis, 80, 175\nregression to the mean, 75, 530\nresampling, 105, 112\nresid, 134, 336, 337, 460, 516\nresidual\n\nlogistic score, 314, 336\nmartingale, 487, 493, 494,\n\n515, 516\n\npartial, 34, 272, 315, 321, 337\n\n "}, {"Page_number": 596, "text": "580\n\nindex\n\nschoenfeld score, 314, 487,\n\n498, 499, 516, 517, 525, 526\n\nresiduals, 132, 134, 269, 336, 337,\n\n460, 516\n\nresiduals.coxph, 516\nresponse\n\nbinary, 219\u2013221\ncensored or truncated, 401\ncontinuous, 389\u2013398\nordinal, 311, 327, 359\n\nrestricted cubic spline, see spline\n\nfunction\n\nridge regression, 77, 115, 209, 210\nrisk difference, 224, 430\nrisk ratio, 224, 430\nrms package, xi, 129, 130\u2013141,\n\n149, 192, 193, 198, 199, 211,\n214, 319, 362, 363, 418,\n422, 535\n\nrobcov, 134, 135, 198, 202\nrobust covariance estimator, see\nvariance\u2013covariance matrix\n\nrobustgam package, 390\nroc, see receiver operating\n\ncharacteristic curve, 105\n\nrpart, 142, 302, 303\nrq, 131, 135, 360\nrq, 131\nrunif, 460\n\ns\nsample size, 73, 74, 148,\n\n233, 363, 486\n\nsample survey, 135, 197, 208, 417\nsas.get, 129\nsascode, 138\nscientific quantity, 20\nscore function, 182, 183, 186\nscore test, see rao score test,\n\n235, 363\n\nscore.binary, 86\nscored, 132, 133\nscoring, hierarchical, 86\nscree plot, 172\n\nsemiparametric model, 311, 359,\n\n361\u2013363, 370, 371, 475\n\nsensuc, 134\nshrinkage, 75\u201378, 87, 88,\n\n209\u2013212, 342\u2013348\n\nsimilarity measure, 81, 330, 458\nsmearing estimator, see estimator\nsmoother, 390\nsomers\u2019 rank correlation, see dxy\nsomers2, 346\nspca package, 175\nspcagrid, 175, 179\nspearman rank correlation, see\n\nnonparametric\n\nspearman2, 129, 460\nspecs, 134, 135\nspline function, 22, 30,\n\n167, 192, 393\n\nb-spline, 23, 41, 132, 500\ncubic, 23\nlinear, 22, 133\nnormalization, 26\nrestricted cubic, 24\u201328\ntensor, 37, 247, 374, 375\n\nspower, 513\nstandardized regression\n\ncoefficient, 103\n\nstate transition, 416, 420\nstep, 134\nstep halving, 196\nstrat, 133\nstrata, 133\nstrategy, 63\n\ncomparing models, 92\ndata reduction, 79\ndescribing model, 103, 318\ndeveloping imputations, 49\ndeveloping model for effect\n\nestimation, 98\n\ndeveloping models for\n\nhypothesis testing, 99\n\ndeveloping predictive model, 95\nglobal, 94\nin a nutshell, ix, 95\ninfluential observations, 90\n\n "}, {"Page_number": 597, "text": "index\n\n581\n\nmaximum number of\n\nparameters, 72\n\nmodel approximation, 118, 275,\n\n287\n\nmultiple imputation, 53\nprespecification of complexity,\n\n64\n\nshrinkage, 77\nvalidation, 109, 110\nvariable selection, 63, 67\n\nstratification, 225, 237, 238, 254,\n\n418, 419, 481\u2013483, 488\n\nsubgroup estimates, 34, 241, 400\nsummary, 127, 130, 134, 136, 149,\n\n167, 198, 199, 201, 278, 292,\n466\n\nsummary.formula, 302, 319, 357\nsummary.gls, 149\nsuper smoother, 29\nsupport study, see datasets\nsuppression, 101\nsupsmu, 141, 273, 390\nsurv, 172, 418, 422, 458, 516\nsurvconcordance, 517\nsurvdiff, 517\nsurvest, 135, 448\nsurvfit, 135, 418, 419\nsurvival, 135, 448, 513, 514\nsurvival function\n\naalen estimator, 412, 413\nbreslow estimator, 485\ncrude, 416\nfleming\u2013harrington estimator,\n\n412, 413, 485\n\nkalbfleisch\u2013prentice estimator,\n\n484, 485\n\nkaplan\u2013meier estimator,\n\n409\u2013413, 414\u2013416, 420\n\nmultiple state estimator, 416,\n\n420\n\nnelson estimator, 412, 413, 418,\n\n485\n\nstandard error, 412\nsurvival package, 131,\n\n418, 422, 499, 513, 517, 536\n\nsurvplot, 135, 419, 448, 458, 460\nsurvreg, 131, 448\nsurvreg.auxinfo, 449\nsurvreg.distributions, 449\n\nt\ntest of linearity, see hypothesis\n\ntest\n\ntest statistic, see hypothesis test\ntime to event, 399\n\nand severity of event, 417\ntime-dependent covariable,\n\n322, 418, 447, 499\u2013503,\n513, 518, 526\n\ntitanic, see datasets\ntraining sample, 111\u2013113, 122\ntransace, 176, 177\ntranscan, 51, 55, 80, 83,\n\n83\u201385, 129, 135, 138, 167,\n170\u2013172, 175\u2013177,\n276, 277, 330, 334, 335, 521,\n525\n\ntransform both sides regression,\n\n176, 389, 392\n\ntransformation, 389, 393, 395\n\npost, 133\npre, 179\n\ntree model, see recursive\n\npartitioning\n\ntruncation, 401\n\nu\nunconditioning, 119\nuniqueness analysis, 94\nunivariable screening, 72\nunivarlr, 134, 135\nunsupervised learning, 79\n\nv\nval.prob, 109, 135, 271\nval.surv, 109, 449, 517\nvalidate, 135, 141, 142,\n\n260, 269, 271, 282, 286,\n300, 301, 319, 323, 354, 466,\n517\n\n "}, {"Page_number": 598, "text": "582\n\nindex\n\nvalidation of model, 109\u2013116,\n\nvariance\u2013covariance matrix,\n\n259, 299, 318, 322, 353, 446,\n466, 506, 529\n\nbootstrap, 114\u2013116\ncross, 113, 115, 116, 210\ndata-splitting, 111, 112, 271\nexternal, 109, 110, 237,\n\n271, 449, 517\n\nleave-out-one, 113, 122,\n\n215, 255\n\nquantities to validate, 110\nrandomization, 113\n\nvarclus, 79, 129, 167, 330, 458,\n\n463\n\nvariable selection, 67\u201372, 171\n\nstep-down, 70, 137,\n\n275, 280, 282, 286, 377\n\nvariance inflation factors, 79, 135,\n\n138, 255\n\nvariance stabilization, 390\n\n51, 54, 120, 129, 189,\n191, 193, 196\u2013198, 208,\n211, 215\n\ncluster sandwich, 197, 202\nhuber\u2013white estimator, 147\nsandwich, 147, 211, 217\n\nvariogram, 148, 153\nvcov, 134, 135\nvif, 135, 138\n\nw\nwaiting time, 401\nwald statistic, 186, 189, 191, 192,\n194, 196, 198, 206, 244, 278\nweighted analysis, see maximum\n\nlikelihood\n\nwhich.influence, 134, 137, 269\nworking independence model, 197\n\n "}]}